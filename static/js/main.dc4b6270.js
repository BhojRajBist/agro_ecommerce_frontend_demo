/*! For license information please see main.dc4b6270.js.LICENSE.txt */
(()=>{var e={43:(e,t,i)=>{"use strict";e.exports=i(202)},66:function(e){e.exports=function(){"use strict";var e,t,i;function n(n,r){if(e)if(t){var a="var sharedChunk = {}; ("+e+")(sharedChunk); ("+t+")(sharedChunk);",s={};e(s),i=r(s),"undefined"!==typeof window&&(i.workerUrl=window.URL.createObjectURL(new Blob([a],{type:"text/javascript"})))}else t=r;else e=r}return n(["exports"],(function(e){function t(e,t,i,n){return new(i||(i=Promise))((function(r,a){function s(e){try{l(n.next(e))}catch(e){a(e)}}function o(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,o)}l((n=n.apply(e,t||[])).next())}))}function i(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}"function"==typeof SuppressedError&&SuppressedError;var n=r;function r(e,t){this.x=e,this.y=t}r.prototype={clone:function(){return new r(this.x,this.y)},add:function(e){return this.clone()._add(e)},sub:function(e){return this.clone()._sub(e)},multByPoint:function(e){return this.clone()._multByPoint(e)},divByPoint:function(e){return this.clone()._divByPoint(e)},mult:function(e){return this.clone()._mult(e)},div:function(e){return this.clone()._div(e)},rotate:function(e){return this.clone()._rotate(e)},rotateAround:function(e,t){return this.clone()._rotateAround(e,t)},matMult:function(e){return this.clone()._matMult(e)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(e){return this.x===e.x&&this.y===e.y},dist:function(e){return Math.sqrt(this.distSqr(e))},distSqr:function(e){var t=e.x-this.x,i=e.y-this.y;return t*t+i*i},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(e){return Math.atan2(this.y-e.y,this.x-e.x)},angleWith:function(e){return this.angleWithSep(e.x,e.y)},angleWithSep:function(e,t){return Math.atan2(this.x*t-this.y*e,this.x*e+this.y*t)},_matMult:function(e){var t=e[2]*this.x+e[3]*this.y;return this.x=e[0]*this.x+e[1]*this.y,this.y=t,this},_add:function(e){return this.x+=e.x,this.y+=e.y,this},_sub:function(e){return this.x-=e.x,this.y-=e.y,this},_mult:function(e){return this.x*=e,this.y*=e,this},_div:function(e){return this.x/=e,this.y/=e,this},_multByPoint:function(e){return this.x*=e.x,this.y*=e.y,this},_divByPoint:function(e){return this.x/=e.x,this.y/=e.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var e=this.y;return this.y=this.x,this.x=-e,this},_rotate:function(e){var t=Math.cos(e),i=Math.sin(e),n=i*this.x+t*this.y;return this.x=t*this.x-i*this.y,this.y=n,this},_rotateAround:function(e,t){var i=Math.cos(e),n=Math.sin(e),r=t.y+n*(this.x-t.x)+i*(this.y-t.y);return this.x=t.x+i*(this.x-t.x)-n*(this.y-t.y),this.y=r,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},r.convert=function(e){return e instanceof r?e:Array.isArray(e)?new r(e[0],e[1]):e};var a=i(n),s=o;function o(e,t,i,n){this.cx=3*e,this.bx=3*(i-e)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(n-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=e,this.p1y=t,this.p2x=i,this.p2y=n}o.prototype={sampleCurveX:function(e){return((this.ax*e+this.bx)*e+this.cx)*e},sampleCurveY:function(e){return((this.ay*e+this.by)*e+this.cy)*e},sampleCurveDerivativeX:function(e){return(3*this.ax*e+2*this.bx)*e+this.cx},solveCurveX:function(e,t){if(void 0===t&&(t=1e-6),e<0)return 0;if(e>1)return 1;for(var i=e,n=0;n<8;n++){var r=this.sampleCurveX(i)-e;if(Math.abs(r)<t)return i;var a=this.sampleCurveDerivativeX(i);if(Math.abs(a)<1e-6)break;i-=r/a}var s=0,o=1;for(i=e,n=0;n<20&&(r=this.sampleCurveX(i),!(Math.abs(r-e)<t));n++)e>r?s=i:o=i,i=.5*(o-s)+s;return i},solve:function(e,t){return this.sampleCurveY(this.solveCurveX(e,t))}};var l=i(s);let c,u;function h(){return null==c&&(c="undefined"!=typeof OffscreenCanvas&&new OffscreenCanvas(1,1).getContext("2d")&&"function"==typeof createImageBitmap),c}function d(){if(null==u&&(u=!1,h())){const e=5,t=new OffscreenCanvas(e,e).getContext("2d",{willReadFrequently:!0});if(t){for(let n=0;n<e*e;n++){const i=4*n;t.fillStyle=`rgb(${i},${i+1},${i+2})`,t.fillRect(n%e,Math.floor(n/e),1,1)}const i=t.getImageData(0,0,e,e).data;for(let t=0;t<e*e*4;t++)if(t%4!=3&&i[t]!==t){u=!0;break}}}return u||!1}function p(e,t,i,n){const r=new l(e,t,i,n);return function(e){return r.solve(e)}}const f=p(.25,.1,.25,1);function m(e,t,i){return Math.min(i,Math.max(t,e))}function g(e,t,i){const n=i-t,r=((e-t)%n+n)%n+t;return r===t?i:r}function y(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];for(const r of i)for(const t in r)e[t]=r[t];return e}let _=1;function v(e,t,i){const n={};for(const r in e)n[r]=t.call(i||this,e[r],r,e);return n}function x(e,t,i){const n={};for(const r in e)t.call(i||this,e[r],r,e)&&(n[r]=e[r]);return n}function b(e){return Array.isArray(e)?e.map(b):"object"==typeof e&&e?v(e,b):e}const w={};function S(e){w[e]||("undefined"!=typeof console&&console.warn(e),w[e]=!0)}function T(e,t,i){return(i.y-e.y)*(t.x-e.x)>(t.y-e.y)*(i.x-e.x)}function k(e){let t=0;for(let i,n,r=0,a=e.length,s=a-1;r<a;s=r++)i=e[r],n=e[s],t+=(n.x-i.x)*(i.y+n.y);return t}function E(){return"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope}let P=null;function C(e){return"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap}const I="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function A(e,i,n,r,a){return t(this,void 0,void 0,(function*(){if("undefined"==typeof VideoFrame)throw new Error("VideoFrame not supported");const t=new VideoFrame(e,{timestamp:0});try{const s=null==t?void 0:t.format;if(!s||!s.startsWith("BGR")&&!s.startsWith("RGB"))throw new Error(`Unrecognized format ${s}`);const o=s.startsWith("BGR"),l=new Uint8ClampedArray(r*a*4);if(yield t.copyTo(l,function(e,t,i,n,r){const a=4*Math.max(-t,0),s=(Math.max(0,i)-i)*n*4+a,o=4*n,l=Math.max(0,t),c=Math.max(0,i);return{rect:{x:l,y:c,width:Math.min(e.width,t+n)-l,height:Math.min(e.height,i+r)-c},layout:[{offset:s,stride:o}]}}(e,i,n,r,a)),o)for(let e=0;e<l.length;e+=4){const t=l[e];l[e]=l[e+2],l[e+2]=t}return l}finally{t.close()}}))}let M,z,D,L;const R={now:"undefined"!=typeof performance&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(e){const t=requestAnimationFrame(e);return{cancel:()=>cancelAnimationFrame(t)}},getImageData(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.getImageCanvasContext(e).getImageData(-t,-t,e.width+2*t,e.height+2*t)},getImageCanvasContext(e){const t=window.document.createElement("canvas"),i=t.getContext("2d",{willReadFrequently:!0});if(!i)throw new Error("failed to create canvas 2d context");return t.width=e.width,t.height=e.height,i.drawImage(e,0,0,e.width,e.height),i},resolveURL:e=>(D||(D=document.createElement("a")),D.href=e,D.href),hardwareConcurrency:"undefined"!=typeof navigator&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(null==L&&(L=matchMedia("(prefers-reduced-motion: reduce)")),L.matches)}},F={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};class B extends Error{constructor(e,t,i,n){super(`AJAXError: ${t} (${e}): ${i}`),this.status=e,this.statusText=t,this.url=i,this.body=n}}const O=E()?()=>self.worker&&self.worker.referrer:()=>("blob:"===window.location.protocol?window.parent:window).location.href,N=e=>F.REGISTERED_PROTOCOLS[e.substring(0,e.indexOf("://"))];function V(e,t){const i=new AbortController,n=new Request(e.url,{method:e.method||"GET",body:e.body,credentials:e.credentials,headers:e.headers,cache:e.cache,referrer:O(),signal:i.signal});let r=!1,a=!1;return"json"===e.type&&n.headers.set("Accept","application/json"),a||fetch(n).then((i=>i.ok?(i=>{("arrayBuffer"===e.type||"image"===e.type?i.arrayBuffer():"json"===e.type?i.json():i.text()).then((e=>{a||(r=!0,t(null,e,i.headers.get("Cache-Control"),i.headers.get("Expires")))})).catch((e=>{a||t(new Error(e.message))}))})(i):i.blob().then((n=>t(new B(i.status,i.statusText,e.url,n)))))).catch((e=>{20!==e.code&&t(new Error(e.message))})),{cancel:()=>{a=!0,r||i.abort()}}}const j=function(e,t){if(/:\/\//.test(e.url)&&!/^https?:|^file:/.test(e.url)){if(E()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",e,t);if(!E())return(N(e.url)||V)(e,t)}if(!(/^file:/.test(i=e.url)||/^file:/.test(O())&&!/^\w+:/.test(i))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return V(e,t);if(E()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",e,t,void 0,!0)}var i;return function(e,t){const i=new XMLHttpRequest;i.open(e.method||"GET",e.url,!0),"arrayBuffer"!==e.type&&"image"!==e.type||(i.responseType="arraybuffer");for(const n in e.headers)i.setRequestHeader(n,e.headers[n]);return"json"===e.type&&(i.responseType="text",i.setRequestHeader("Accept","application/json")),i.withCredentials="include"===e.credentials,i.onerror=()=>{t(new Error(i.statusText))},i.onload=()=>{if((i.status>=200&&i.status<300||0===i.status)&&null!==i.response){let n=i.response;if("json"===e.type)try{n=JSON.parse(i.response)}catch(e){return t(e)}t(null,n,i.getResponseHeader("Cache-Control"),i.getResponseHeader("Expires"))}else{const n=new Blob([i.response],{type:i.getResponseHeader("Content-Type")});t(new B(i.status,i.statusText,e.url,n))}},i.send(e.body),{cancel:()=>i.abort()}}(e,t)},U=function(e,t){return j(y(e,{type:"arrayBuffer"}),t)};function $(e){if(!e||e.indexOf("://")<=0||0===e.indexOf("data:image/")||0===e.indexOf("blob:"))return!0;const t=new URL(e),i=window.location;return t.protocol===i.protocol&&t.host===i.host}function q(e,t,i){i[e]&&-1!==i[e].indexOf(t)||(i[e]=i[e]||[],i[e].push(t))}function Z(e,t,i){if(i&&i[e]){const n=i[e].indexOf(t);-1!==n&&i[e].splice(n,1)}}class G{constructor(e){y(this,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}),this.type=e}}class W extends G{constructor(e){super("error",y({error:e},arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}))}}class H{on(e,t){return this._listeners=this._listeners||{},q(e,t,this._listeners),this}off(e,t){return Z(e,t,this._listeners),Z(e,t,this._oneTimeListeners),this}once(e,t){return t?(this._oneTimeListeners=this._oneTimeListeners||{},q(e,t,this._oneTimeListeners),this):new Promise((t=>this.once(e,t)))}fire(e,t){"string"==typeof e&&(e=new G(e,t||{}));const i=e.type;if(this.listens(i)){e.target=this;const t=this._listeners&&this._listeners[i]?this._listeners[i].slice():[];for(const i of t)i.call(this,e);const n=this._oneTimeListeners&&this._oneTimeListeners[i]?this._oneTimeListeners[i].slice():[];for(const a of n)Z(i,a,this._oneTimeListeners),a.call(this,e);const r=this._eventedParent;r&&(y(e,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),r.fire(e))}else e instanceof W&&console.error(e.error);return this}listens(e){return this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e)}setEventedParent(e,t){return this._eventedParent=e,this._eventedParentData=t,this}}var X={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const K=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function Y(e,t){const i={};for(const n in e)"ref"!==n&&(i[n]=e[n]);return K.forEach((e=>{e in t&&(i[e]=t[e])})),i}function J(e,t){if(Array.isArray(e)){if(!Array.isArray(t)||e.length!==t.length)return!1;for(let i=0;i<e.length;i++)if(!J(e[i],t[i]))return!1;return!0}if("object"==typeof e&&null!==e&&null!==t){if("object"!=typeof t)return!1;if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const i in e)if(!J(e[i],t[i]))return!1;return!0}return e===t}const Q={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function ee(e,t,i){i.push({command:Q.addSource,args:[e,t[e]]})}function te(e,t,i){t.push({command:Q.removeSource,args:[e]}),i[e]=!0}function ie(e,t,i,n){te(e,i,n),ee(e,t,i)}function ne(e,t,i){let n;for(n in e[i])if(Object.prototype.hasOwnProperty.call(e[i],n)&&"data"!==n&&!J(e[i][n],t[i][n]))return!1;for(n in t[i])if(Object.prototype.hasOwnProperty.call(t[i],n)&&"data"!==n&&!J(e[i][n],t[i][n]))return!1;return!0}function re(e,t,i,n,r,a){let s;for(s in t=t||{},e=e||{})Object.prototype.hasOwnProperty.call(e,s)&&(J(e[s],t[s])||i.push({command:a,args:[n,s,t[s],r]}));for(s in t)Object.prototype.hasOwnProperty.call(t,s)&&!Object.prototype.hasOwnProperty.call(e,s)&&(J(e[s],t[s])||i.push({command:a,args:[n,s,t[s],r]}))}function ae(e){return e.id}function se(e,t){return e[t.id]=t,e}class oe{constructor(e,t,i,n){this.message=(e?`${e}: `:"")+i,n&&(this.identifier=n),null!=t&&t.__line__&&(this.line=t.__line__)}}function le(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];for(const r of i)for(const t in r)e[t]=r[t];return e}class ce extends Error{constructor(e,t){super(t),this.message=t,this.key=e}}class ue{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];this.parent=e,this.bindings={};for(const[i,n]of t)this.bindings[i]=n}concat(e){return new ue(this,e)}get(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(`${e} not found in scope.`)}has(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)}}const he={kind:"null"},de={kind:"number"},pe={kind:"string"},fe={kind:"boolean"},me={kind:"color"},ge={kind:"object"},ye={kind:"value"},_e={kind:"collator"},ve={kind:"formatted"},xe={kind:"padding"},be={kind:"resolvedImage"},we={kind:"variableAnchorOffsetCollection"};function Se(e,t){return{kind:"array",itemType:e,N:t}}function Te(e){if("array"===e.kind){const t=Te(e.itemType);return"number"==typeof e.N?`array<${t}, ${e.N}>`:"value"===e.itemType.kind?"array":`array<${t}>`}return e.kind}const ke=[he,de,pe,fe,me,ve,ge,Se(ye),xe,be,we];function Ee(e,t){if("error"===t.kind)return null;if("array"===e.kind){if("array"===t.kind&&(0===t.N&&"value"===t.itemType.kind||!Ee(e.itemType,t.itemType))&&("number"!=typeof e.N||e.N===t.N))return null}else{if(e.kind===t.kind)return null;if("value"===e.kind)for(const e of ke)if(!Ee(e,t))return null}return`Expected ${Te(e)} but found ${Te(t)} instead.`}function Pe(e,t){return t.some((t=>t.kind===e.kind))}function Ce(e,t){return t.some((t=>"null"===t?null===e:"array"===t?Array.isArray(e):"object"===t?e&&!Array.isArray(e)&&"object"==typeof e:t===typeof e))}function Ie(e,t){return"array"===e.kind&&"array"===t.kind?e.itemType.kind===t.itemType.kind&&"number"==typeof e.N:e.kind===t.kind}const Ae=.96422,Me=.82521,ze=4/29,De=6/29,Le=3*De*De,Re=De*De*De,Fe=Math.PI/180,Be=180/Math.PI;function Oe(e){return(e%=360)<0&&(e+=360),e}function Ne(e){let t,i,[n,r,a,s]=e;const o=je((.2225045*(n=Ve(n))+.7168786*(r=Ve(r))+.0606169*(a=Ve(a)))/1);n===r&&r===a?t=i=o:(t=je((.4360747*n+.3850649*r+.1430804*a)/Ae),i=je((.0139322*n+.0971045*r+.7141733*a)/Me));const l=116*o-16;return[l<0?0:l,500*(t-o),200*(o-i),s]}function Ve(e){return e<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function je(e){return e>Re?Math.pow(e,1/3):e/Le+ze}function Ue(e){let[t,i,n,r]=e,a=(t+16)/116,s=isNaN(i)?a:a+i/500,o=isNaN(n)?a:a-n/200;return a=1*qe(a),s=Ae*qe(s),o=Me*qe(o),[$e(3.1338561*s-1.6168667*a-.4906146*o),$e(-.9787684*s+1.9161415*a+.033454*o),$e(.0719453*s-.2289914*a+1.4052427*o),r]}function $e(e){return(e=e<=.00304?12.92*e:1.055*Math.pow(e,1/2.4)-.055)<0?0:e>1?1:e}function qe(e){return e>De?e*e*e:Le*(e-ze)}function Ze(e){return parseInt(e.padEnd(2,e),16)/255}function Ge(e,t){return We(t?e/100:e,0,1)}function We(e,t,i){return Math.min(Math.max(t,e),i)}function He(e){return!e.some(Number.isNaN)}const Xe={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};class Ke{constructor(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,r=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];this.r=e,this.g=t,this.b=i,this.a=n,r||(this.r*=n,this.g*=n,this.b*=n,n||this.overwriteGetter("rgb",[e,t,i,n]))}static parse(e){if(e instanceof Ke)return e;if("string"!=typeof e)return;const t=function(e){if("transparent"===(e=e.toLowerCase().trim()))return[0,0,0,0];const t=Xe[e];if(t){const[e,i,n]=t;return[e/255,i/255,n/255,1]}if(e.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(e)){const t=e.length<6?1:2;let i=1;return[Ze(e.slice(i,i+=t)),Ze(e.slice(i,i+=t)),Ze(e.slice(i,i+=t)),Ze(e.slice(i,i+t)||"ff")]}if(e.startsWith("rgb")){const t=e.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(t){const[e,i,n,r,a,s,o,l,c,u,h,d]=t,p=[r||" ",o||" ",u].join("");if("  "===p||"  /"===p||",,"===p||",,,"===p){const e=[n,s,c].join(""),t="%%%"===e?100:""===e?255:0;if(t){const e=[We(+i/t,0,1),We(+a/t,0,1),We(+l/t,0,1),h?Ge(+h,d):1];if(He(e))return e}}return}}const i=e.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(i){const[e,t,n,r,a,s,o,l,c]=i,u=[n||" ",a||" ",o].join("");if("  "===u||"  /"===u||",,"===u||",,,"===u){const e=[+t,We(+r,0,100),We(+s,0,100),l?Ge(+l,c):1];if(He(e))return function(e){let[t,i,n,r]=e;function a(e){const r=(e+t/30)%12,a=i*Math.min(n,1-n);return n-a*Math.max(-1,Math.min(r-3,9-r,1))}return t=Oe(t),i/=100,n/=100,[a(0),a(8),a(4),r]}(e)}}}(e);return t?new Ke(...t,!1):void 0}get rgb(){const{r:e,g:t,b:i,a:n}=this,r=n||1/0;return this.overwriteGetter("rgb",[e/r,t/r,i/r,n])}get hcl(){return this.overwriteGetter("hcl",function(e){const[t,i,n,r]=Ne(e),a=Math.sqrt(i*i+n*n);return[Math.round(1e4*a)?Oe(Math.atan2(n,i)*Be):NaN,a,t,r]}(this.rgb))}get lab(){return this.overwriteGetter("lab",Ne(this.rgb))}overwriteGetter(e,t){return Object.defineProperty(this,e,{value:t}),t}toString(){const[e,t,i,n]=this.rgb;return`rgba(${[e,t,i].map((e=>Math.round(255*e))).join(",")},${n})`}}Ke.black=new Ke(0,0,0,1),Ke.white=new Ke(1,1,1,1),Ke.transparent=new Ke(0,0,0,0),Ke.red=new Ke(1,0,0,1);class Ye{constructor(e,t,i){this.sensitivity=e?t?"variant":"case":t?"accent":"base",this.locale=i,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(e,t){return this.collator.compare(e,t)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Je{constructor(e,t,i,n,r){this.text=e,this.image=t,this.scale=i,this.fontStack=n,this.textColor=r}}class Qe{constructor(e){this.sections=e}static fromString(e){return new Qe([new Je(e,null,null,null,null)])}isEmpty(){return 0===this.sections.length||!this.sections.some((e=>0!==e.text.length||e.image&&0!==e.image.name.length))}static factory(e){return e instanceof Qe?e:Qe.fromString(e)}toString(){return 0===this.sections.length?"":this.sections.map((e=>e.text)).join("")}}class et{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof et)return e;if("number"==typeof e)return new et([e,e,e,e]);if(Array.isArray(e)&&!(e.length<1||e.length>4)){for(const t of e)if("number"!=typeof t)return;switch(e.length){case 1:e=[e[0],e[0],e[0],e[0]];break;case 2:e=[e[0],e[1],e[0],e[1]];break;case 3:e=[e[0],e[1],e[2],e[1]]}return new et(e)}}toString(){return JSON.stringify(this.values)}}const tt=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class it{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof it)return e;if(Array.isArray(e)&&!(e.length<1)&&e.length%2==0){for(let t=0;t<e.length;t+=2){const i=e[t],n=e[t+1];if("string"!=typeof i||!tt.has(i))return;if(!Array.isArray(n)||2!==n.length||"number"!=typeof n[0]||"number"!=typeof n[1])return}return new it(e)}}toString(){return JSON.stringify(this.values)}}class nt{constructor(e){this.name=e.name,this.available=e.available}toString(){return this.name}static fromString(e){return e?new nt({name:e,available:!1}):null}}function rt(e,t,i,n){return"number"==typeof e&&e>=0&&e<=255&&"number"==typeof t&&t>=0&&t<=255&&"number"==typeof i&&i>=0&&i<=255?void 0===n||"number"==typeof n&&n>=0&&n<=1?null:`Invalid rgba value [${[e,t,i,n].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${("number"==typeof n?[e,t,i,n]:[e,t,i]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function at(e){if(null===e||"string"==typeof e||"boolean"==typeof e||"number"==typeof e||e instanceof Ke||e instanceof Ye||e instanceof Qe||e instanceof et||e instanceof it||e instanceof nt)return!0;if(Array.isArray(e)){for(const t of e)if(!at(t))return!1;return!0}if("object"==typeof e){for(const t in e)if(!at(e[t]))return!1;return!0}return!1}function st(e){if(null===e)return he;if("string"==typeof e)return pe;if("boolean"==typeof e)return fe;if("number"==typeof e)return de;if(e instanceof Ke)return me;if(e instanceof Ye)return _e;if(e instanceof Qe)return ve;if(e instanceof et)return xe;if(e instanceof it)return we;if(e instanceof nt)return be;if(Array.isArray(e)){const t=e.length;let i;for(const n of e){const e=st(n);if(i){if(i===e)continue;i=ye;break}i=e}return Se(i||ye,t)}return ge}function ot(e){const t=typeof e;return null===e?"":"string"===t||"number"===t||"boolean"===t?String(e):e instanceof Ke||e instanceof Qe||e instanceof et||e instanceof it||e instanceof nt?e.toString():JSON.stringify(e)}class lt{constructor(e,t){this.type=e,this.value=t}static parse(e,t){if(2!==e.length)return t.error(`'literal' expression requires exactly one argument, but found ${e.length-1} instead.`);if(!at(e[1]))return t.error("invalid value");const i=e[1];let n=st(i);const r=t.expectedType;return"array"!==n.kind||0!==n.N||!r||"array"!==r.kind||"number"==typeof r.N&&0!==r.N||(n=r),new lt(n,i)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}class ct{constructor(e){this.name="ExpressionEvaluationError",this.message=e}toJSON(){return this.message}}const ut={string:pe,number:de,boolean:fe,object:ge};class ht{constructor(e,t){this.type=e,this.args=t}static parse(e,t){if(e.length<2)return t.error("Expected at least one argument.");let i,n=1;const r=e[0];if("array"===r){let r,a;if(e.length>2){const i=e[1];if("string"!=typeof i||!(i in ut)||"object"===i)return t.error('The item type argument of "array" must be one of string, number, boolean',1);r=ut[i],n++}else r=ye;if(e.length>3){if(null!==e[2]&&("number"!=typeof e[2]||e[2]<0||e[2]!==Math.floor(e[2])))return t.error('The length argument to "array" must be a positive integer literal',2);a=e[2],n++}i=Se(r,a)}else{if(!ut[r])throw new Error(`Types doesn't contain name = ${r}`);i=ut[r]}const a=[];for(;n<e.length;n++){const i=t.parse(e[n],n,ye);if(!i)return null;a.push(i)}return new ht(i,a)}evaluate(e){for(let t=0;t<this.args.length;t++){const i=this.args[t].evaluate(e);if(!Ee(this.type,st(i)))return i;if(t===this.args.length-1)throw new ct(`Expected value to be of type ${Te(this.type)}, but found ${Te(st(i))} instead.`)}throw new Error}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every((e=>e.outputDefined()))}}const dt={"to-boolean":fe,"to-color":me,"to-number":de,"to-string":pe};class pt{constructor(e,t){this.type=e,this.args=t}static parse(e,t){if(e.length<2)return t.error("Expected at least one argument.");const i=e[0];if(!dt[i])throw new Error(`Can't parse ${i} as it is not part of the known types`);if(("to-boolean"===i||"to-string"===i)&&2!==e.length)return t.error("Expected one argument.");const n=dt[i],r=[];for(let a=1;a<e.length;a++){const i=t.parse(e[a],a,ye);if(!i)return null;r.push(i)}return new pt(n,r)}evaluate(e){switch(this.type.kind){case"boolean":return Boolean(this.args[0].evaluate(e));case"color":{let t,i;for(const n of this.args){if(t=n.evaluate(e),i=null,t instanceof Ke)return t;if("string"==typeof t){const i=e.parseColor(t);if(i)return i}else if(Array.isArray(t)&&(i=t.length<3||t.length>4?`Invalid rbga value ${JSON.stringify(t)}: expected an array containing either three or four numeric values.`:rt(t[0],t[1],t[2],t[3]),!i))return new Ke(t[0]/255,t[1]/255,t[2]/255,t[3])}throw new ct(i||`Could not parse color from value '${"string"==typeof t?t:JSON.stringify(t)}'`)}case"padding":{let t;for(const i of this.args){t=i.evaluate(e);const n=et.parse(t);if(n)return n}throw new ct(`Could not parse padding from value '${"string"==typeof t?t:JSON.stringify(t)}'`)}case"variableAnchorOffsetCollection":{let t;for(const i of this.args){t=i.evaluate(e);const n=it.parse(t);if(n)return n}throw new ct(`Could not parse variableAnchorOffsetCollection from value '${"string"==typeof t?t:JSON.stringify(t)}'`)}case"number":{let t=null;for(const i of this.args){if(t=i.evaluate(e),null===t)return 0;const n=Number(t);if(!isNaN(n))return n}throw new ct(`Could not convert ${JSON.stringify(t)} to number.`)}case"formatted":return Qe.fromString(ot(this.args[0].evaluate(e)));case"resolvedImage":return nt.fromString(ot(this.args[0].evaluate(e)));default:return ot(this.args[0].evaluate(e))}}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every((e=>e.outputDefined()))}}const ft=["Unknown","Point","LineString","Polygon"];class mt{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?"number"==typeof this.feature.type?ft[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(e){let t=this._parseColorCache[e];return t||(t=this._parseColorCache[e]=Ke.parse(e)),t}}class gt{constructor(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],n=arguments.length>3?arguments[3]:void 0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:new ue,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[];this.registry=e,this.path=i,this.key=i.map((e=>`[${e}]`)).join(""),this.scope=r,this.errors=a,this.expectedType=n,this._isConstant=t}parse(e,t,i,n){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};return t?this.concat(t,i,n)._parse(e,r):this._parse(e,r)}_parse(e,t){function i(e,t,i){return"assert"===i?new ht(t,[e]):"coerce"===i?new pt(t,[e]):e}if(null!==e&&"string"!=typeof e&&"boolean"!=typeof e&&"number"!=typeof e||(e=["literal",e]),Array.isArray(e)){if(0===e.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const n=e[0];if("string"!=typeof n)return this.error(`Expression name must be a string, but found ${typeof n} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const r=this.registry[n];if(r){let n=r.parse(e,this);if(!n)return null;if(this.expectedType){const e=this.expectedType,r=n.type;if("string"!==e.kind&&"number"!==e.kind&&"boolean"!==e.kind&&"object"!==e.kind&&"array"!==e.kind||"value"!==r.kind)if("color"!==e.kind&&"formatted"!==e.kind&&"resolvedImage"!==e.kind||"value"!==r.kind&&"string"!==r.kind)if("padding"!==e.kind||"value"!==r.kind&&"number"!==r.kind&&"array"!==r.kind)if("variableAnchorOffsetCollection"!==e.kind||"value"!==r.kind&&"array"!==r.kind){if(this.checkSubtype(e,r))return null}else n=i(n,e,t.typeAnnotation||"coerce");else n=i(n,e,t.typeAnnotation||"coerce");else n=i(n,e,t.typeAnnotation||"coerce");else n=i(n,e,t.typeAnnotation||"assert")}if(!(n instanceof lt)&&"resolvedImage"!==n.type.kind&&this._isConstant(n)){const t=new mt;try{n=new lt(n.type,n.evaluate(t))}catch(e){return this.error(e.message),null}}return n}return this.error(`Unknown expression "${n}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(void 0===e?"'undefined' value invalid. Use null instead.":"object"==typeof e?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof e} instead.`)}concat(e,t,i){const n="number"==typeof e?this.path.concat(e):this.path,r=i?this.scope.concat(i):this.scope;return new gt(this.registry,this._isConstant,n,t||null,r,this.errors)}error(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];const r=`${this.key}${i.map((e=>`[${e}]`)).join("")}`;this.errors.push(new ce(r,e))}checkSubtype(e,t){const i=Ee(e,t);return i&&this.error(i),i}}class yt{constructor(e,t,i){this.type=_e,this.locale=i,this.caseSensitive=e,this.diacriticSensitive=t}static parse(e,t){if(2!==e.length)return t.error("Expected one argument.");const i=e[1];if("object"!=typeof i||Array.isArray(i))return t.error("Collator options argument must be an object.");const n=t.parse(void 0!==i["case-sensitive"]&&i["case-sensitive"],1,fe);if(!n)return null;const r=t.parse(void 0!==i["diacritic-sensitive"]&&i["diacritic-sensitive"],1,fe);if(!r)return null;let a=null;return i.locale&&(a=t.parse(i.locale,1,pe),!a)?null:new yt(n,r,a)}evaluate(e){return new Ye(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)}eachChild(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)}outputDefined(){return!1}}const _t=8192;function vt(e,t){e[0]=Math.min(e[0],t[0]),e[1]=Math.min(e[1],t[1]),e[2]=Math.max(e[2],t[0]),e[3]=Math.max(e[3],t[1])}function xt(e,t){return!(e[0]<=t[0]||e[2]>=t[2]||e[1]<=t[1]||e[3]>=t[3])}function bt(e,t){const i=(180+e[0])/360,n=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e[1]*Math.PI/360)))/360,r=Math.pow(2,t.z);return[Math.round(i*r*_t),Math.round(n*r*_t)]}function wt(e,t,i){const n=e[0]-t[0],r=e[1]-t[1],a=e[0]-i[0],s=e[1]-i[1];return n*s-a*r==0&&n*a<=0&&r*s<=0}function St(e,t){let i=!1;for(let s=0,o=t.length;s<o;s++){const o=t[s];for(let t=0,s=o.length;t<s-1;t++){if(wt(e,o[t],o[t+1]))return!1;(r=o[t])[1]>(n=e)[1]!=(a=o[t+1])[1]>n[1]&&n[0]<(a[0]-r[0])*(n[1]-r[1])/(a[1]-r[1])+r[0]&&(i=!i)}}var n,r,a;return i}function Tt(e,t){for(let i=0;i<t.length;i++)if(St(e,t[i]))return!0;return!1}function kt(e,t,i,n){const r=n[0]-i[0],a=n[1]-i[1],s=(e[0]-i[0])*a-r*(e[1]-i[1]),o=(t[0]-i[0])*a-r*(t[1]-i[1]);return s>0&&o<0||s<0&&o>0}function Et(e,t,i){for(const c of i)for(let i=0;i<c.length-1;++i)if(0!=(o=[(s=c[i+1])[0]-(a=c[i])[0],s[1]-a[1]])[0]*(l=[(r=t)[0]-(n=e)[0],r[1]-n[1]])[1]-o[1]*l[0]&&kt(n,r,a,s)&&kt(a,s,n,r))return!0;var n,r,a,s,o,l;return!1}function Pt(e,t){for(let i=0;i<e.length;++i)if(!St(e[i],t))return!1;for(let i=0;i<e.length-1;++i)if(Et(e[i],e[i+1],t))return!1;return!0}function Ct(e,t){for(let i=0;i<t.length;i++)if(Pt(e,t[i]))return!0;return!1}function It(e,t,i){const n=[];for(let r=0;r<e.length;r++){const a=[];for(let n=0;n<e[r].length;n++){const s=bt(e[r][n],i);vt(t,s),a.push(s)}n.push(a)}return n}function At(e,t,i){const n=[];for(let r=0;r<e.length;r++){const a=It(e[r],t,i);n.push(a)}return n}function Mt(e,t,i,n){if(e[0]<i[0]||e[0]>i[2]){const t=.5*n;let r=e[0]-i[0]>t?-n:i[0]-e[0]>t?n:0;0===r&&(r=e[0]-i[2]>t?-n:i[2]-e[0]>t?n:0),e[0]+=r}vt(t,e)}function zt(e,t,i,n){const r=Math.pow(2,n.z)*_t,a=[n.x*_t,n.y*_t],s=[];for(const o of e)for(const e of o){const n=[e.x+a[0],e.y+a[1]];Mt(n,t,i,r),s.push(n)}return s}function Dt(e,t,i,n){const r=Math.pow(2,n.z)*_t,a=[n.x*_t,n.y*_t],s=[];for(const l of e){const e=[];for(const i of l){const n=[i.x+a[0],i.y+a[1]];vt(t,n),e.push(n)}s.push(e)}if(t[2]-t[0]<=r/2){(o=t)[0]=o[1]=1/0,o[2]=o[3]=-1/0;for(const e of s)for(const n of e)Mt(n,t,i,r)}var o;return s}class Lt{constructor(e,t){this.type=fe,this.geojson=e,this.geometries=t}static parse(e,t){if(2!==e.length)return t.error(`'within' expression requires exactly one argument, but found ${e.length-1} instead.`);if(at(e[1])){const t=e[1];if("FeatureCollection"===t.type)for(let e=0;e<t.features.length;++e){const i=t.features[e].geometry.type;if("Polygon"===i||"MultiPolygon"===i)return new Lt(t,t.features[e].geometry)}else if("Feature"===t.type){const e=t.geometry.type;if("Polygon"===e||"MultiPolygon"===e)return new Lt(t,t.geometry)}else if("Polygon"===t.type||"MultiPolygon"===t.type)return new Lt(t,t)}return t.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(null!=e.geometry()&&null!=e.canonicalID()){if("Point"===e.geometryType())return function(e,t){const i=[1/0,1/0,-1/0,-1/0],n=[1/0,1/0,-1/0,-1/0],r=e.canonicalID();if("Polygon"===t.type){const a=It(t.coordinates,n,r),s=zt(e.geometry(),i,n,r);if(!xt(i,n))return!1;for(const e of s)if(!St(e,a))return!1}if("MultiPolygon"===t.type){const a=At(t.coordinates,n,r),s=zt(e.geometry(),i,n,r);if(!xt(i,n))return!1;for(const e of s)if(!Tt(e,a))return!1}return!0}(e,this.geometries);if("LineString"===e.geometryType())return function(e,t){const i=[1/0,1/0,-1/0,-1/0],n=[1/0,1/0,-1/0,-1/0],r=e.canonicalID();if("Polygon"===t.type){const a=It(t.coordinates,n,r),s=Dt(e.geometry(),i,n,r);if(!xt(i,n))return!1;for(const e of s)if(!Pt(e,a))return!1}if("MultiPolygon"===t.type){const a=At(t.coordinates,n,r),s=Dt(e.geometry(),i,n,r);if(!xt(i,n))return!1;for(const e of s)if(!Ct(e,a))return!1}return!0}(e,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}class Rt{constructor(e,t){this.type=t.type,this.name=e,this.boundExpression=t}static parse(e,t){if(2!==e.length||"string"!=typeof e[1])return t.error("'var' expression requires exactly one string literal argument.");const i=e[1];return t.scope.has(i)?new Rt(i,t.scope.get(i)):t.error(`Unknown variable "${i}". Make sure "${i}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(e){return this.boundExpression.evaluate(e)}eachChild(){}outputDefined(){return!1}}class Ft{constructor(e,t,i,n){this.name=e,this.type=t,this._evaluate=i,this.args=n}evaluate(e){return this._evaluate(e,this.args)}eachChild(e){this.args.forEach(e)}outputDefined(){return!1}static parse(e,t){const i=e[0],n=Ft.definitions[i];if(!n)return t.error(`Unknown expression "${i}". If you wanted a literal array, use ["literal", [...]].`,0);const r=Array.isArray(n)?n[0]:n.type,a=Array.isArray(n)?[[n[1],n[2]]]:n.overloads,s=a.filter((t=>{let[i]=t;return!Array.isArray(i)||i.length===e.length-1}));let o=null;for(const[l,c]of s){o=new gt(t.registry,Bt,t.path,null,t.scope);const n=[];let a=!1;for(let t=1;t<e.length;t++){const i=e[t],r=Array.isArray(l)?l[t-1]:l.type,s=o.parse(i,1+n.length,r);if(!s){a=!0;break}n.push(s)}if(!a)if(Array.isArray(l)&&l.length!==n.length)o.error(`Expected ${l.length} arguments, but found ${n.length} instead.`);else{for(let e=0;e<n.length;e++){const t=Array.isArray(l)?l[e]:l.type,i=n[e];o.concat(e+1).checkSubtype(t,i.type)}if(0===o.errors.length)return new Ft(i,r,c,n)}}if(1===s.length)t.errors.push(...o.errors);else{const i=(s.length?s:a).map((e=>{let[t]=e;return i=t,Array.isArray(i)?`(${i.map(Te).join(", ")})`:`(${Te(i.type)}...)`;var i})).join(" | "),n=[];for(let r=1;r<e.length;r++){const i=t.parse(e[r],1+n.length);if(!i)return null;n.push(Te(i.type))}t.error(`Expected arguments of type ${i}, but found (${n.join(", ")}) instead.`)}return null}static register(e,t){Ft.definitions=t;for(const i in t)e[i]=Ft}}function Bt(e){if(e instanceof Rt)return Bt(e.boundExpression);if(e instanceof Ft&&"error"===e.name)return!1;if(e instanceof yt)return!1;if(e instanceof Lt)return!1;const t=e instanceof pt||e instanceof ht;let i=!0;return e.eachChild((e=>{i=t?i&&Bt(e):i&&e instanceof lt})),!!i&&Ot(e)&&Vt(e,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function Ot(e){if(e instanceof Ft){if("get"===e.name&&1===e.args.length)return!1;if("feature-state"===e.name)return!1;if("has"===e.name&&1===e.args.length)return!1;if("properties"===e.name||"geometry-type"===e.name||"id"===e.name)return!1;if(/^filter-/.test(e.name))return!1}if(e instanceof Lt)return!1;let t=!0;return e.eachChild((e=>{t&&!Ot(e)&&(t=!1)})),t}function Nt(e){if(e instanceof Ft&&"feature-state"===e.name)return!1;let t=!0;return e.eachChild((e=>{t&&!Nt(e)&&(t=!1)})),t}function Vt(e,t){if(e instanceof Ft&&t.indexOf(e.name)>=0)return!1;let i=!0;return e.eachChild((e=>{i&&!Vt(e,t)&&(i=!1)})),i}function jt(e,t){const i=e.length-1;let n,r,a=0,s=i,o=0;for(;a<=s;)if(o=Math.floor((a+s)/2),n=e[o],r=e[o+1],n<=t){if(o===i||t<r)return o;a=o+1}else{if(!(n>t))throw new ct("Input is not a number.");s=o-1}return 0}class Ut{constructor(e,t,i){this.type=e,this.input=t,this.labels=[],this.outputs=[];for(const[n,r]of i)this.labels.push(n),this.outputs.push(r)}static parse(e,t){if(e.length-1<4)return t.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return t.error("Expected an even number of arguments.");const i=t.parse(e[1],1,de);if(!i)return null;const n=[];let r=null;t.expectedType&&"value"!==t.expectedType.kind&&(r=t.expectedType);for(let a=1;a<e.length;a+=2){const i=1===a?-1/0:e[a],s=e[a+1],o=a,l=a+1;if("number"!=typeof i)return t.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',o);if(n.length&&n[n.length-1][0]>=i)return t.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',o);const c=t.parse(s,l,r);if(!c)return null;r=r||c.type,n.push([i,c])}return new Ut(r,i,n)}evaluate(e){const t=this.labels,i=this.outputs;if(1===t.length)return i[0].evaluate(e);const n=this.input.evaluate(e);if(n<=t[0])return i[0].evaluate(e);const r=t.length;return n>=t[r-1]?i[r-1].evaluate(e):i[jt(t,n)].evaluate(e)}eachChild(e){e(this.input);for(const t of this.outputs)e(t)}outputDefined(){return this.outputs.every((e=>e.outputDefined()))}}function $t(e,t,i){return e+i*(t-e)}function qt(e,t,i){return e.map(((e,n)=>$t(e,t[n],i)))}const Zt={number:$t,color:function(e,t,i){switch(arguments.length>3&&void 0!==arguments[3]?arguments[3]:"rgb"){case"rgb":{const[n,r,a,s]=qt(e.rgb,t.rgb,i);return new Ke(n,r,a,s,!1)}case"hcl":{const[n,r,a,s]=e.hcl,[o,l,c,u]=t.hcl;let h,d;if(isNaN(n)||isNaN(o))isNaN(n)?isNaN(o)?h=NaN:(h=o,1!==a&&0!==a||(d=l)):(h=n,1!==c&&0!==c||(d=r));else{let e=o-n;o>n&&e>180?e-=360:o<n&&n-o>180&&(e+=360),h=n+i*e}const[p,f,m,g]=function(e){let[t,i,n,r]=e;return t=isNaN(t)?0:t*Fe,Ue([n,Math.cos(t)*i,Math.sin(t)*i,r])}([h,null!=d?d:$t(r,l,i),$t(a,c,i),$t(s,u,i)]);return new Ke(p,f,m,g,!1)}case"lab":{const[n,r,a,s]=Ue(qt(e.lab,t.lab,i));return new Ke(n,r,a,s,!1)}}},array:qt,padding:function(e,t,i){return new et(qt(e.values,t.values,i))},variableAnchorOffsetCollection:function(e,t,i){const n=e.values,r=t.values;if(n.length!==r.length)throw new ct(`Cannot interpolate values of different length. from: ${e.toString()}, to: ${t.toString()}`);const a=[];for(let s=0;s<n.length;s+=2){if(n[s]!==r[s])throw new ct(`Cannot interpolate values containing mismatched anchors. from[${s}]: ${n[s]}, to[${s}]: ${r[s]}`);a.push(n[s]);const[e,t]=n[s+1],[o,l]=r[s+1];a.push([$t(e,o,i),$t(t,l,i)])}return new it(a)}};class Gt{constructor(e,t,i,n,r){this.type=e,this.operator=t,this.interpolation=i,this.input=n,this.labels=[],this.outputs=[];for(const[a,s]of r)this.labels.push(a),this.outputs.push(s)}static interpolationFactor(e,t,i,n){let r=0;if("exponential"===e.name)r=Wt(t,e.base,i,n);else if("linear"===e.name)r=Wt(t,1,i,n);else if("cubic-bezier"===e.name){const a=e.controlPoints;r=new l(a[0],a[1],a[2],a[3]).solve(Wt(t,1,i,n))}return r}static parse(e,t){let[i,n,r,...a]=e;if(!Array.isArray(n)||0===n.length)return t.error("Expected an interpolation type expression.",1);if("linear"===n[0])n={name:"linear"};else if("exponential"===n[0]){const e=n[1];if("number"!=typeof e)return t.error("Exponential interpolation requires a numeric base.",1,1);n={name:"exponential",base:e}}else{if("cubic-bezier"!==n[0])return t.error(`Unknown interpolation type ${String(n[0])}`,1,0);{const e=n.slice(1);if(4!==e.length||e.some((e=>"number"!=typeof e||e<0||e>1)))return t.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);n={name:"cubic-bezier",controlPoints:e}}}if(e.length-1<4)return t.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return t.error("Expected an even number of arguments.");if(r=t.parse(r,2,de),!r)return null;const s=[];let o=null;"interpolate-hcl"===i||"interpolate-lab"===i?o=me:t.expectedType&&"value"!==t.expectedType.kind&&(o=t.expectedType);for(let l=0;l<a.length;l+=2){const e=a[l],i=a[l+1],n=l+3,r=l+4;if("number"!=typeof e)return t.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',n);if(s.length&&s[s.length-1][0]>=e)return t.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',n);const c=t.parse(i,r,o);if(!c)return null;o=o||c.type,s.push([e,c])}return Ie(o,de)||Ie(o,me)||Ie(o,xe)||Ie(o,we)||Ie(o,Se(de))?new Gt(o,i,n,r,s):t.error(`Type ${Te(o)} is not interpolatable.`)}evaluate(e){const t=this.labels,i=this.outputs;if(1===t.length)return i[0].evaluate(e);const n=this.input.evaluate(e);if(n<=t[0])return i[0].evaluate(e);const r=t.length;if(n>=t[r-1])return i[r-1].evaluate(e);const a=jt(t,n),s=Gt.interpolationFactor(this.interpolation,n,t[a],t[a+1]),o=i[a].evaluate(e),l=i[a+1].evaluate(e);switch(this.operator){case"interpolate":return Zt[this.type.kind](o,l,s);case"interpolate-hcl":return Zt.color(o,l,s,"hcl");case"interpolate-lab":return Zt.color(o,l,s,"lab")}}eachChild(e){e(this.input);for(const t of this.outputs)e(t)}outputDefined(){return this.outputs.every((e=>e.outputDefined()))}}function Wt(e,t,i,n){const r=n-i,a=e-i;return 0===r?0:1===t?a/r:(Math.pow(t,a)-1)/(Math.pow(t,r)-1)}class Ht{constructor(e,t){this.type=e,this.args=t}static parse(e,t){if(e.length<2)return t.error("Expectected at least one argument.");let i=null;const n=t.expectedType;n&&"value"!==n.kind&&(i=n);const r=[];for(const s of e.slice(1)){const e=t.parse(s,1+r.length,i,void 0,{typeAnnotation:"omit"});if(!e)return null;i=i||e.type,r.push(e)}if(!i)throw new Error("No output type");const a=n&&r.some((e=>Ee(n,e.type)));return new Ht(a?ye:i,r)}evaluate(e){let t,i=null,n=0;for(const r of this.args)if(n++,i=r.evaluate(e),i&&i instanceof nt&&!i.available&&(t||(t=i.name),i=null,n===this.args.length&&(i=t)),null!==i)break;return i}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every((e=>e.outputDefined()))}}class Xt{constructor(e,t){this.type=t.type,this.bindings=[].concat(e),this.result=t}evaluate(e){return this.result.evaluate(e)}eachChild(e){for(const t of this.bindings)e(t[1]);e(this.result)}static parse(e,t){if(e.length<4)return t.error(`Expected at least 3 arguments, but found ${e.length-1} instead.`);const i=[];for(let r=1;r<e.length-1;r+=2){const n=e[r];if("string"!=typeof n)return t.error(`Expected string, but found ${typeof n} instead.`,r);if(/[^a-zA-Z0-9_]/.test(n))return t.error("Variable names must contain only alphanumeric characters or '_'.",r);const a=t.parse(e[r+1],r+1);if(!a)return null;i.push([n,a])}const n=t.parse(e[e.length-1],e.length-1,t.expectedType,i);return n?new Xt(i,n):null}outputDefined(){return this.result.outputDefined()}}class Kt{constructor(e,t,i){this.type=e,this.index=t,this.input=i}static parse(e,t){if(3!==e.length)return t.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const i=t.parse(e[1],1,de),n=t.parse(e[2],2,Se(t.expectedType||ye));return i&&n?new Kt(n.type.itemType,i,n):null}evaluate(e){const t=this.index.evaluate(e),i=this.input.evaluate(e);if(t<0)throw new ct(`Array index out of bounds: ${t} < 0.`);if(t>=i.length)throw new ct(`Array index out of bounds: ${t} > ${i.length-1}.`);if(t!==Math.floor(t))throw new ct(`Array index must be an integer, but found ${t} instead.`);return i[t]}eachChild(e){e(this.index),e(this.input)}outputDefined(){return!1}}class Yt{constructor(e,t){this.type=fe,this.needle=e,this.haystack=t}static parse(e,t){if(3!==e.length)return t.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const i=t.parse(e[1],1,ye),n=t.parse(e[2],2,ye);return i&&n?Pe(i.type,[fe,pe,de,he,ye])?new Yt(i,n):t.error(`Expected first argument to be of type boolean, string, number or null, but found ${Te(i.type)} instead`):null}evaluate(e){const t=this.needle.evaluate(e),i=this.haystack.evaluate(e);if(!i)return!1;if(!Ce(t,["boolean","string","number","null"]))throw new ct(`Expected first argument to be of type boolean, string, number or null, but found ${Te(st(t))} instead.`);if(!Ce(i,["string","array"]))throw new ct(`Expected second argument to be of type array or string, but found ${Te(st(i))} instead.`);return i.indexOf(t)>=0}eachChild(e){e(this.needle),e(this.haystack)}outputDefined(){return!0}}class Jt{constructor(e,t,i){this.type=de,this.needle=e,this.haystack=t,this.fromIndex=i}static parse(e,t){if(e.length<=2||e.length>=5)return t.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const i=t.parse(e[1],1,ye),n=t.parse(e[2],2,ye);if(!i||!n)return null;if(!Pe(i.type,[fe,pe,de,he,ye]))return t.error(`Expected first argument to be of type boolean, string, number or null, but found ${Te(i.type)} instead`);if(4===e.length){const r=t.parse(e[3],3,de);return r?new Jt(i,n,r):null}return new Jt(i,n)}evaluate(e){const t=this.needle.evaluate(e),i=this.haystack.evaluate(e);if(!Ce(t,["boolean","string","number","null"]))throw new ct(`Expected first argument to be of type boolean, string, number or null, but found ${Te(st(t))} instead.`);if(!Ce(i,["string","array"]))throw new ct(`Expected second argument to be of type array or string, but found ${Te(st(i))} instead.`);if(this.fromIndex){const n=this.fromIndex.evaluate(e);return i.indexOf(t,n)}return i.indexOf(t)}eachChild(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)}outputDefined(){return!1}}class Qt{constructor(e,t,i,n,r,a){this.inputType=e,this.type=t,this.input=i,this.cases=n,this.outputs=r,this.otherwise=a}static parse(e,t){if(e.length<5)return t.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if(e.length%2!=1)return t.error("Expected an even number of arguments.");let i,n;t.expectedType&&"value"!==t.expectedType.kind&&(n=t.expectedType);const r={},a=[];for(let l=2;l<e.length-1;l+=2){let s=e[l];const o=e[l+1];Array.isArray(s)||(s=[s]);const c=t.concat(l);if(0===s.length)return c.error("Expected at least one branch label.");for(const e of s){if("number"!=typeof e&&"string"!=typeof e)return c.error("Branch labels must be numbers or strings.");if("number"==typeof e&&Math.abs(e)>Number.MAX_SAFE_INTEGER)return c.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if("number"==typeof e&&Math.floor(e)!==e)return c.error("Numeric branch labels must be integer values.");if(i){if(c.checkSubtype(i,st(e)))return null}else i=st(e);if(void 0!==r[String(e)])return c.error("Branch labels must be unique.");r[String(e)]=a.length}const u=t.parse(o,l,n);if(!u)return null;n=n||u.type,a.push(u)}const s=t.parse(e[1],1,ye);if(!s)return null;const o=t.parse(e[e.length-1],e.length-1,n);return o?"value"!==s.type.kind&&t.concat(1).checkSubtype(i,s.type)?null:new Qt(i,n,s,r,a,o):null}evaluate(e){const t=this.input.evaluate(e);return(st(t)===this.inputType&&this.outputs[this.cases[t]]||this.otherwise).evaluate(e)}eachChild(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)}outputDefined(){return this.outputs.every((e=>e.outputDefined()))&&this.otherwise.outputDefined()}}class ei{constructor(e,t,i){this.type=e,this.branches=t,this.otherwise=i}static parse(e,t){if(e.length<4)return t.error(`Expected at least 3 arguments, but found only ${e.length-1}.`);if(e.length%2!=0)return t.error("Expected an odd number of arguments.");let i;t.expectedType&&"value"!==t.expectedType.kind&&(i=t.expectedType);const n=[];for(let a=1;a<e.length-1;a+=2){const r=t.parse(e[a],a,fe);if(!r)return null;const s=t.parse(e[a+1],a+1,i);if(!s)return null;n.push([r,s]),i=i||s.type}const r=t.parse(e[e.length-1],e.length-1,i);if(!r)return null;if(!i)throw new Error("Can't infer output type");return new ei(i,n,r)}evaluate(e){for(const[t,i]of this.branches)if(t.evaluate(e))return i.evaluate(e);return this.otherwise.evaluate(e)}eachChild(e){for(const[t,i]of this.branches)e(t),e(i);e(this.otherwise)}outputDefined(){return this.branches.every((e=>{let[t,i]=e;return i.outputDefined()}))&&this.otherwise.outputDefined()}}class ti{constructor(e,t,i,n){this.type=e,this.input=t,this.beginIndex=i,this.endIndex=n}static parse(e,t){if(e.length<=2||e.length>=5)return t.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const i=t.parse(e[1],1,ye),n=t.parse(e[2],2,de);if(!i||!n)return null;if(!Pe(i.type,[Se(ye),pe,ye]))return t.error(`Expected first argument to be of type array or string, but found ${Te(i.type)} instead`);if(4===e.length){const r=t.parse(e[3],3,de);return r?new ti(i.type,i,n,r):null}return new ti(i.type,i,n)}evaluate(e){const t=this.input.evaluate(e),i=this.beginIndex.evaluate(e);if(!Ce(t,["string","array"]))throw new ct(`Expected first argument to be of type array or string, but found ${Te(st(t))} instead.`);if(this.endIndex){const n=this.endIndex.evaluate(e);return t.slice(i,n)}return t.slice(i)}eachChild(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)}outputDefined(){return!1}}function ii(e,t){return"=="===e||"!="===e?"boolean"===t.kind||"string"===t.kind||"number"===t.kind||"null"===t.kind||"value"===t.kind:"string"===t.kind||"number"===t.kind||"value"===t.kind}function ni(e,t,i,n){return 0===n.compare(t,i)}function ri(e,t,i){const n="=="!==e&&"!="!==e;return class r{constructor(e,t,i){this.type=fe,this.lhs=e,this.rhs=t,this.collator=i,this.hasUntypedArgument="value"===e.type.kind||"value"===t.type.kind}static parse(e,t){if(3!==e.length&&4!==e.length)return t.error("Expected two or three arguments.");const i=e[0];let a=t.parse(e[1],1,ye);if(!a)return null;if(!ii(i,a.type))return t.concat(1).error(`"${i}" comparisons are not supported for type '${Te(a.type)}'.`);let s=t.parse(e[2],2,ye);if(!s)return null;if(!ii(i,s.type))return t.concat(2).error(`"${i}" comparisons are not supported for type '${Te(s.type)}'.`);if(a.type.kind!==s.type.kind&&"value"!==a.type.kind&&"value"!==s.type.kind)return t.error(`Cannot compare types '${Te(a.type)}' and '${Te(s.type)}'.`);n&&("value"===a.type.kind&&"value"!==s.type.kind?a=new ht(s.type,[a]):"value"!==a.type.kind&&"value"===s.type.kind&&(s=new ht(a.type,[s])));let o=null;if(4===e.length){if("string"!==a.type.kind&&"string"!==s.type.kind&&"value"!==a.type.kind&&"value"!==s.type.kind)return t.error("Cannot use collator to compare non-string types.");if(o=t.parse(e[3],3,_e),!o)return null}return new r(a,s,o)}evaluate(r){const a=this.lhs.evaluate(r),s=this.rhs.evaluate(r);if(n&&this.hasUntypedArgument){const t=st(a),i=st(s);if(t.kind!==i.kind||"string"!==t.kind&&"number"!==t.kind)throw new ct(`Expected arguments for "${e}" to be (string, string) or (number, number), but found (${t.kind}, ${i.kind}) instead.`)}if(this.collator&&!n&&this.hasUntypedArgument){const e=st(a),i=st(s);if("string"!==e.kind||"string"!==i.kind)return t(r,a,s)}return this.collator?i(r,a,s,this.collator.evaluate(r)):t(r,a,s)}eachChild(e){e(this.lhs),e(this.rhs),this.collator&&e(this.collator)}outputDefined(){return!0}}}const ai=ri("==",(function(e,t,i){return t===i}),ni),si=ri("!=",(function(e,t,i){return t!==i}),(function(e,t,i,n){return!ni(0,t,i,n)})),oi=ri("<",(function(e,t,i){return t<i}),(function(e,t,i,n){return n.compare(t,i)<0})),li=ri(">",(function(e,t,i){return t>i}),(function(e,t,i,n){return n.compare(t,i)>0})),ci=ri("<=",(function(e,t,i){return t<=i}),(function(e,t,i,n){return n.compare(t,i)<=0})),ui=ri(">=",(function(e,t,i){return t>=i}),(function(e,t,i,n){return n.compare(t,i)>=0}));class hi{constructor(e,t,i,n,r){this.type=pe,this.number=e,this.locale=t,this.currency=i,this.minFractionDigits=n,this.maxFractionDigits=r}static parse(e,t){if(3!==e.length)return t.error("Expected two arguments.");const i=t.parse(e[1],1,de);if(!i)return null;const n=e[2];if("object"!=typeof n||Array.isArray(n))return t.error("NumberFormat options argument must be an object.");let r=null;if(n.locale&&(r=t.parse(n.locale,1,pe),!r))return null;let a=null;if(n.currency&&(a=t.parse(n.currency,1,pe),!a))return null;let s=null;if(n["min-fraction-digits"]&&(s=t.parse(n["min-fraction-digits"],1,de),!s))return null;let o=null;return n["max-fraction-digits"]&&(o=t.parse(n["max-fraction-digits"],1,de),!o)?null:new hi(i,r,a,s,o)}evaluate(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))}eachChild(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)}outputDefined(){return!1}}class di{constructor(e){this.type=ve,this.sections=e}static parse(e,t){if(e.length<2)return t.error("Expected at least one argument.");const i=e[1];if(!Array.isArray(i)&&"object"==typeof i)return t.error("First argument must be an image or text section.");const n=[];let r=!1;for(let a=1;a<=e.length-1;++a){const i=e[a];if(r&&"object"==typeof i&&!Array.isArray(i)){r=!1;let e=null;if(i["font-scale"]&&(e=t.parse(i["font-scale"],1,de),!e))return null;let a=null;if(i["text-font"]&&(a=t.parse(i["text-font"],1,Se(pe)),!a))return null;let s=null;if(i["text-color"]&&(s=t.parse(i["text-color"],1,me),!s))return null;const o=n[n.length-1];o.scale=e,o.font=a,o.textColor=s}else{const i=t.parse(e[a],1,ye);if(!i)return null;const s=i.type.kind;if("string"!==s&&"value"!==s&&"null"!==s&&"resolvedImage"!==s)return t.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");r=!0,n.push({content:i,scale:null,font:null,textColor:null})}}return new di(n)}evaluate(e){return new Qe(this.sections.map((t=>{const i=t.content.evaluate(e);return st(i)===be?new Je("",i,null,null,null):new Je(ot(i),null,t.scale?t.scale.evaluate(e):null,t.font?t.font.evaluate(e).join(","):null,t.textColor?t.textColor.evaluate(e):null)})))}eachChild(e){for(const t of this.sections)e(t.content),t.scale&&e(t.scale),t.font&&e(t.font),t.textColor&&e(t.textColor)}outputDefined(){return!1}}class pi{constructor(e){this.type=be,this.input=e}static parse(e,t){if(2!==e.length)return t.error("Expected two arguments.");const i=t.parse(e[1],1,pe);return i?new pi(i):t.error("No image name provided.")}evaluate(e){const t=this.input.evaluate(e),i=nt.fromString(t);return i&&e.availableImages&&(i.available=e.availableImages.indexOf(t)>-1),i}eachChild(e){e(this.input)}outputDefined(){return!1}}class fi{constructor(e){this.type=de,this.input=e}static parse(e,t){if(2!==e.length)return t.error(`Expected 1 argument, but found ${e.length-1} instead.`);const i=t.parse(e[1],1);return i?"array"!==i.type.kind&&"string"!==i.type.kind&&"value"!==i.type.kind?t.error(`Expected argument of type string or array, but found ${Te(i.type)} instead.`):new fi(i):null}evaluate(e){const t=this.input.evaluate(e);if("string"==typeof t)return t.length;if(Array.isArray(t))return t.length;throw new ct(`Expected value to be of type string or array, but found ${Te(st(t))} instead.`)}eachChild(e){e(this.input)}outputDefined(){return!1}}const mi={"==":ai,"!=":si,">":li,"<":oi,">=":ui,"<=":ci,array:ht,at:Kt,boolean:ht,case:ei,coalesce:Ht,collator:yt,format:di,image:pi,in:Yt,"index-of":Jt,interpolate:Gt,"interpolate-hcl":Gt,"interpolate-lab":Gt,length:fi,let:Xt,literal:lt,match:Qt,number:ht,"number-format":hi,object:ht,slice:ti,step:Ut,string:ht,"to-boolean":pt,"to-color":pt,"to-number":pt,"to-string":pt,var:Rt,within:Lt};function gi(e,t){let[i,n,r,a]=t;i=i.evaluate(e),n=n.evaluate(e),r=r.evaluate(e);const s=a?a.evaluate(e):1,o=rt(i,n,r,s);if(o)throw new ct(o);return new Ke(i/255,n/255,r/255,s,!1)}function yi(e,t){return e in t}function _i(e,t){const i=t[e];return void 0===i?null:i}function vi(e){return{type:e}}function xi(e){return{result:"success",value:e}}function bi(e){return{result:"error",value:e}}function wi(e){return"data-driven"===e["property-type"]||"cross-faded-data-driven"===e["property-type"]}function Si(e){return!!e.expression&&e.expression.parameters.indexOf("zoom")>-1}function Ti(e){return!!e.expression&&e.expression.interpolated}function ki(e){return e instanceof Number?"number":e instanceof String?"string":e instanceof Boolean?"boolean":Array.isArray(e)?"array":null===e?"null":typeof e}function Ei(e){return"object"==typeof e&&null!==e&&!Array.isArray(e)}function Pi(e){return e}function Ci(e,t){const i="color"===t.type,n=e.stops&&"object"==typeof e.stops[0][0],r=n||!(n||void 0!==e.property),a=e.type||(Ti(t)?"exponential":"interval");if(i||"padding"===t.type){const n=i?Ke.parse:et.parse;(e=le({},e)).stops&&(e.stops=e.stops.map((e=>[e[0],n(e[1])]))),e.default=n(e.default?e.default:t.default)}if(e.colorSpace&&"rgb"!==(s=e.colorSpace)&&"hcl"!==s&&"lab"!==s)throw new Error(`Unknown color space: "${e.colorSpace}"`);var s;let o,l,c;if("exponential"===a)o=zi;else if("interval"===a)o=Mi;else if("categorical"===a){o=Ai,l=Object.create(null);for(const t of e.stops)l[t[0]]=t[1];c=typeof e.stops[0][0]}else{if("identity"!==a)throw new Error(`Unknown function type "${a}"`);o=Di}if(n){const i={},n=[];for(let t=0;t<e.stops.length;t++){const r=e.stops[t],a=r[0].zoom;void 0===i[a]&&(i[a]={zoom:a,type:e.type,property:e.property,default:e.default,stops:[]},n.push(a)),i[a].stops.push([r[0].value,r[1]])}const r=[];for(const e of n)r.push([i[e].zoom,Ci(i[e],t)]);const a={name:"linear"};return{kind:"composite",interpolationType:a,interpolationFactor:Gt.interpolationFactor.bind(void 0,a),zoomStops:r.map((e=>e[0])),evaluate:(i,n)=>{let{zoom:a}=i;return zi({stops:r,base:e.base},t,a).evaluate(a,n)}}}if(r){const i="exponential"===a?{name:"exponential",base:void 0!==e.base?e.base:1}:null;return{kind:"camera",interpolationType:i,interpolationFactor:Gt.interpolationFactor.bind(void 0,i),zoomStops:e.stops.map((e=>e[0])),evaluate:i=>{let{zoom:n}=i;return o(e,t,n,l,c)}}}return{kind:"source",evaluate(i,n){const r=n&&n.properties?n.properties[e.property]:void 0;return void 0===r?Ii(e.default,t.default):o(e,t,r,l,c)}}}function Ii(e,t,i){return void 0!==e?e:void 0!==t?t:void 0!==i?i:void 0}function Ai(e,t,i,n,r){return Ii(typeof i===r?n[i]:void 0,e.default,t.default)}function Mi(e,t,i){if("number"!==ki(i))return Ii(e.default,t.default);const n=e.stops.length;if(1===n)return e.stops[0][1];if(i<=e.stops[0][0])return e.stops[0][1];if(i>=e.stops[n-1][0])return e.stops[n-1][1];const r=jt(e.stops.map((e=>e[0])),i);return e.stops[r][1]}function zi(e,t,i){const n=void 0!==e.base?e.base:1;if("number"!==ki(i))return Ii(e.default,t.default);const r=e.stops.length;if(1===r)return e.stops[0][1];if(i<=e.stops[0][0])return e.stops[0][1];if(i>=e.stops[r-1][0])return e.stops[r-1][1];const a=jt(e.stops.map((e=>e[0])),i),s=function(e,t,i,n){const r=n-i,a=e-i;return 0===r?0:1===t?a/r:(Math.pow(t,a)-1)/(Math.pow(t,r)-1)}(i,n,e.stops[a][0],e.stops[a+1][0]),o=e.stops[a][1],l=e.stops[a+1][1],c=Zt[t.type]||Pi;return"function"==typeof o.evaluate?{evaluate(){for(var t=arguments.length,i=new Array(t),n=0;n<t;n++)i[n]=arguments[n];const r=o.evaluate.apply(void 0,i),a=l.evaluate.apply(void 0,i);if(void 0!==r&&void 0!==a)return c(r,a,s,e.colorSpace)}}:c(o,l,s,e.colorSpace)}function Di(e,t,i){switch(t.type){case"color":i=Ke.parse(i);break;case"formatted":i=Qe.fromString(i.toString());break;case"resolvedImage":i=nt.fromString(i.toString());break;case"padding":i=et.parse(i);break;default:ki(i)===t.type||"enum"===t.type&&t.values[i]||(i=void 0)}return Ii(i,e.default,t.default)}Ft.register(mi,{error:[{kind:"error"},[pe],(e,t)=>{let[i]=t;throw new ct(i.evaluate(e))}],typeof:[pe,[ye],(e,t)=>{let[i]=t;return Te(st(i.evaluate(e)))}],"to-rgba":[Se(de,4),[me],(e,t)=>{let[i]=t;const[n,r,a,s]=i.evaluate(e).rgb;return[255*n,255*r,255*a,s]}],rgb:[me,[de,de,de],gi],rgba:[me,[de,de,de,de],gi],has:{type:fe,overloads:[[[pe],(e,t)=>{let[i]=t;return yi(i.evaluate(e),e.properties())}],[[pe,ge],(e,t)=>{let[i,n]=t;return yi(i.evaluate(e),n.evaluate(e))}]]},get:{type:ye,overloads:[[[pe],(e,t)=>{let[i]=t;return _i(i.evaluate(e),e.properties())}],[[pe,ge],(e,t)=>{let[i,n]=t;return _i(i.evaluate(e),n.evaluate(e))}]]},"feature-state":[ye,[pe],(e,t)=>{let[i]=t;return _i(i.evaluate(e),e.featureState||{})}],properties:[ge,[],e=>e.properties()],"geometry-type":[pe,[],e=>e.geometryType()],id:[ye,[],e=>e.id()],zoom:[de,[],e=>e.globals.zoom],"heatmap-density":[de,[],e=>e.globals.heatmapDensity||0],"line-progress":[de,[],e=>e.globals.lineProgress||0],accumulated:[ye,[],e=>void 0===e.globals.accumulated?null:e.globals.accumulated],"+":[de,vi(de),(e,t)=>{let i=0;for(const n of t)i+=n.evaluate(e);return i}],"*":[de,vi(de),(e,t)=>{let i=1;for(const n of t)i*=n.evaluate(e);return i}],"-":{type:de,overloads:[[[de,de],(e,t)=>{let[i,n]=t;return i.evaluate(e)-n.evaluate(e)}],[[de],(e,t)=>{let[i]=t;return-i.evaluate(e)}]]},"/":[de,[de,de],(e,t)=>{let[i,n]=t;return i.evaluate(e)/n.evaluate(e)}],"%":[de,[de,de],(e,t)=>{let[i,n]=t;return i.evaluate(e)%n.evaluate(e)}],ln2:[de,[],()=>Math.LN2],pi:[de,[],()=>Math.PI],e:[de,[],()=>Math.E],"^":[de,[de,de],(e,t)=>{let[i,n]=t;return Math.pow(i.evaluate(e),n.evaluate(e))}],sqrt:[de,[de],(e,t)=>{let[i]=t;return Math.sqrt(i.evaluate(e))}],log10:[de,[de],(e,t)=>{let[i]=t;return Math.log(i.evaluate(e))/Math.LN10}],ln:[de,[de],(e,t)=>{let[i]=t;return Math.log(i.evaluate(e))}],log2:[de,[de],(e,t)=>{let[i]=t;return Math.log(i.evaluate(e))/Math.LN2}],sin:[de,[de],(e,t)=>{let[i]=t;return Math.sin(i.evaluate(e))}],cos:[de,[de],(e,t)=>{let[i]=t;return Math.cos(i.evaluate(e))}],tan:[de,[de],(e,t)=>{let[i]=t;return Math.tan(i.evaluate(e))}],asin:[de,[de],(e,t)=>{let[i]=t;return Math.asin(i.evaluate(e))}],acos:[de,[de],(e,t)=>{let[i]=t;return Math.acos(i.evaluate(e))}],atan:[de,[de],(e,t)=>{let[i]=t;return Math.atan(i.evaluate(e))}],min:[de,vi(de),(e,t)=>Math.min(...t.map((t=>t.evaluate(e))))],max:[de,vi(de),(e,t)=>Math.max(...t.map((t=>t.evaluate(e))))],abs:[de,[de],(e,t)=>{let[i]=t;return Math.abs(i.evaluate(e))}],round:[de,[de],(e,t)=>{let[i]=t;const n=i.evaluate(e);return n<0?-Math.round(-n):Math.round(n)}],floor:[de,[de],(e,t)=>{let[i]=t;return Math.floor(i.evaluate(e))}],ceil:[de,[de],(e,t)=>{let[i]=t;return Math.ceil(i.evaluate(e))}],"filter-==":[fe,[pe,ye],(e,t)=>{let[i,n]=t;return e.properties()[i.value]===n.value}],"filter-id-==":[fe,[ye],(e,t)=>{let[i]=t;return e.id()===i.value}],"filter-type-==":[fe,[pe],(e,t)=>{let[i]=t;return e.geometryType()===i.value}],"filter-<":[fe,[pe,ye],(e,t)=>{let[i,n]=t;const r=e.properties()[i.value],a=n.value;return typeof r==typeof a&&r<a}],"filter-id-<":[fe,[ye],(e,t)=>{let[i]=t;const n=e.id(),r=i.value;return typeof n==typeof r&&n<r}],"filter->":[fe,[pe,ye],(e,t)=>{let[i,n]=t;const r=e.properties()[i.value],a=n.value;return typeof r==typeof a&&r>a}],"filter-id->":[fe,[ye],(e,t)=>{let[i]=t;const n=e.id(),r=i.value;return typeof n==typeof r&&n>r}],"filter-<=":[fe,[pe,ye],(e,t)=>{let[i,n]=t;const r=e.properties()[i.value],a=n.value;return typeof r==typeof a&&r<=a}],"filter-id-<=":[fe,[ye],(e,t)=>{let[i]=t;const n=e.id(),r=i.value;return typeof n==typeof r&&n<=r}],"filter->=":[fe,[pe,ye],(e,t)=>{let[i,n]=t;const r=e.properties()[i.value],a=n.value;return typeof r==typeof a&&r>=a}],"filter-id->=":[fe,[ye],(e,t)=>{let[i]=t;const n=e.id(),r=i.value;return typeof n==typeof r&&n>=r}],"filter-has":[fe,[ye],(e,t)=>{let[i]=t;return i.value in e.properties()}],"filter-has-id":[fe,[],e=>null!==e.id()&&void 0!==e.id()],"filter-type-in":[fe,[Se(pe)],(e,t)=>{let[i]=t;return i.value.indexOf(e.geometryType())>=0}],"filter-id-in":[fe,[Se(ye)],(e,t)=>{let[i]=t;return i.value.indexOf(e.id())>=0}],"filter-in-small":[fe,[pe,Se(ye)],(e,t)=>{let[i,n]=t;return n.value.indexOf(e.properties()[i.value])>=0}],"filter-in-large":[fe,[pe,Se(ye)],(e,t)=>{let[i,n]=t;return function(e,t,i,n){for(;i<=n;){const r=i+n>>1;if(t[r]===e)return!0;t[r]>e?n=r-1:i=r+1}return!1}(e.properties()[i.value],n.value,0,n.value.length-1)}],all:{type:fe,overloads:[[[fe,fe],(e,t)=>{let[i,n]=t;return i.evaluate(e)&&n.evaluate(e)}],[vi(fe),(e,t)=>{for(const i of t)if(!i.evaluate(e))return!1;return!0}]]},any:{type:fe,overloads:[[[fe,fe],(e,t)=>{let[i,n]=t;return i.evaluate(e)||n.evaluate(e)}],[vi(fe),(e,t)=>{for(const i of t)if(i.evaluate(e))return!0;return!1}]]},"!":[fe,[fe],(e,t)=>{let[i]=t;return!i.evaluate(e)}],"is-supported-script":[fe,[pe],(e,t)=>{let[i]=t;const n=e.globals&&e.globals.isSupportedScript;return!n||n(i.evaluate(e))}],upcase:[pe,[pe],(e,t)=>{let[i]=t;return i.evaluate(e).toUpperCase()}],downcase:[pe,[pe],(e,t)=>{let[i]=t;return i.evaluate(e).toLowerCase()}],concat:[pe,vi(ye),(e,t)=>t.map((t=>ot(t.evaluate(e)))).join("")],"resolved-locale":[pe,[_e],(e,t)=>{let[i]=t;return i.evaluate(e).resolvedLocale()}]});class Li{constructor(e,t){var i;this.expression=e,this._warningHistory={},this._evaluator=new mt,this._defaultValue=t?"color"===(i=t).type&&Ei(i.default)?new Ke(0,0,0,0):"color"===i.type?Ke.parse(i.default)||null:"padding"===i.type?et.parse(i.default)||null:"variableAnchorOffsetCollection"===i.type?it.parse(i.default)||null:void 0===i.default?null:i.default:null,this._enumValues=t&&"enum"===t.type?t.values:null}evaluateWithoutErrorHandling(e,t,i,n,r,a){return this._evaluator.globals=e,this._evaluator.feature=t,this._evaluator.featureState=i,this._evaluator.canonical=n,this._evaluator.availableImages=r||null,this._evaluator.formattedSection=a,this.expression.evaluate(this._evaluator)}evaluate(e,t,i,n,r,a){this._evaluator.globals=e,this._evaluator.feature=t||null,this._evaluator.featureState=i||null,this._evaluator.canonical=n,this._evaluator.availableImages=r||null,this._evaluator.formattedSection=a||null;try{const e=this.expression.evaluate(this._evaluator);if(null==e||"number"==typeof e&&e!=e)return this._defaultValue;if(this._enumValues&&!(e in this._enumValues))throw new ct(`Expected value to be one of ${Object.keys(this._enumValues).map((e=>JSON.stringify(e))).join(", ")}, but found ${JSON.stringify(e)} instead.`);return e}catch(e){return this._warningHistory[e.message]||(this._warningHistory[e.message]=!0,"undefined"!=typeof console&&console.warn(e.message)),this._defaultValue}}}function Ri(e){return Array.isArray(e)&&e.length>0&&"string"==typeof e[0]&&e[0]in mi}function Fi(e,t){const i=new gt(mi,Bt,[],t?function(e){const t={color:me,string:pe,number:de,enum:pe,boolean:fe,formatted:ve,padding:xe,resolvedImage:be,variableAnchorOffsetCollection:we};return"array"===e.type?Se(t[e.value]||ye,e.length):t[e.type]}(t):void 0),n=i.parse(e,void 0,void 0,void 0,t&&"string"===t.type?{typeAnnotation:"coerce"}:void 0);return n?xi(new Li(n,t)):bi(i.errors)}class Bi{constructor(e,t){this.kind=e,this._styleExpression=t,this.isStateDependent="constant"!==e&&!Nt(t.expression)}evaluateWithoutErrorHandling(e,t,i,n,r,a){return this._styleExpression.evaluateWithoutErrorHandling(e,t,i,n,r,a)}evaluate(e,t,i,n,r,a){return this._styleExpression.evaluate(e,t,i,n,r,a)}}class Oi{constructor(e,t,i,n){this.kind=e,this.zoomStops=i,this._styleExpression=t,this.isStateDependent="camera"!==e&&!Nt(t.expression),this.interpolationType=n}evaluateWithoutErrorHandling(e,t,i,n,r,a){return this._styleExpression.evaluateWithoutErrorHandling(e,t,i,n,r,a)}evaluate(e,t,i,n,r,a){return this._styleExpression.evaluate(e,t,i,n,r,a)}interpolationFactor(e,t,i){return this.interpolationType?Gt.interpolationFactor(this.interpolationType,e,t,i):0}}function Ni(e,t){const i=Fi(e,t);if("error"===i.result)return i;const n=i.value.expression,r=Ot(n);if(!r&&!wi(t))return bi([new ce("","data expressions not supported")]);const a=Vt(n,["zoom"]);if(!a&&!Si(t))return bi([new ce("","zoom expressions not supported")]);const s=ji(n);return s||a?s instanceof ce?bi([s]):s instanceof Gt&&!Ti(t)?bi([new ce("",'"interpolate" expressions cannot be used with this property')]):xi(s?new Oi(r?"camera":"composite",i.value,s.labels,s instanceof Gt?s.interpolation:void 0):new Bi(r?"constant":"source",i.value)):bi([new ce("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Vi{constructor(e,t){this._parameters=e,this._specification=t,le(this,Ci(this._parameters,this._specification))}static deserialize(e){return new Vi(e._parameters,e._specification)}static serialize(e){return{_parameters:e._parameters,_specification:e._specification}}}function ji(e){let t=null;if(e instanceof Xt)t=ji(e.result);else if(e instanceof Ht){for(const i of e.args)if(t=ji(i),t)break}else(e instanceof Ut||e instanceof Gt)&&e.input instanceof Ft&&"zoom"===e.input.name&&(t=e);return t instanceof ce||e.eachChild((e=>{const i=ji(e);i instanceof ce?t=i:!t&&i?t=new ce("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):t&&i&&t!==i&&(t=new ce("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))})),t}function Ui(e){if(!0===e||!1===e)return!0;if(!Array.isArray(e)||0===e.length)return!1;switch(e[0]){case"has":return e.length>=2&&"$id"!==e[1]&&"$type"!==e[1];case"in":return e.length>=3&&("string"!=typeof e[1]||Array.isArray(e[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==e.length||Array.isArray(e[1])||Array.isArray(e[2]);case"any":case"all":for(const t of e.slice(1))if(!Ui(t)&&"boolean"!=typeof t)return!1;return!0;default:return!0}}const $i={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function qi(e){if(null==e)return{filter:()=>!0,needGeometry:!1};Ui(e)||(e=Wi(e));const t=Fi(e,$i);if("error"===t.result)throw new Error(t.value.map((e=>`${e.key}: ${e.message}`)).join(", "));return{filter:(e,i,n)=>t.value.evaluate(e,i,{},n),needGeometry:Gi(e)}}function Zi(e,t){return e<t?-1:e>t?1:0}function Gi(e){if(!Array.isArray(e))return!1;if("within"===e[0])return!0;for(let t=1;t<e.length;t++)if(Gi(e[t]))return!0;return!1}function Wi(e){if(!e)return!0;const t=e[0];return e.length<=1?"any"!==t:"=="===t?Hi(e[1],e[2],"=="):"!="===t?Yi(Hi(e[1],e[2],"==")):"<"===t||">"===t||"<="===t||">="===t?Hi(e[1],e[2],t):"any"===t?(i=e.slice(1),["any"].concat(i.map(Wi))):"all"===t?["all"].concat(e.slice(1).map(Wi)):"none"===t?["all"].concat(e.slice(1).map(Wi).map(Yi)):"in"===t?Xi(e[1],e.slice(2)):"!in"===t?Yi(Xi(e[1],e.slice(2))):"has"===t?Ki(e[1]):"!has"===t?Yi(Ki(e[1])):"within"!==t||e;var i}function Hi(e,t,i){switch(e){case"$type":return[`filter-type-${i}`,t];case"$id":return[`filter-id-${i}`,t];default:return[`filter-${i}`,e,t]}}function Xi(e,t){if(0===t.length)return!1;switch(e){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some((e=>typeof e!=typeof t[0]))?["filter-in-large",e,["literal",t.sort(Zi)]]:["filter-in-small",e,["literal",t]]}}function Ki(e){switch(e){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",e]}}function Yi(e){return["!",e]}function Ji(e){const t=typeof e;if("number"===t||"boolean"===t||"string"===t||null==e)return JSON.stringify(e);if(Array.isArray(e)){let t="[";for(const i of e)t+=`${Ji(i)},`;return`${t}]`}const i=Object.keys(e).sort();let n="{";for(let r=0;r<i.length;r++)n+=`${JSON.stringify(i[r])}:${Ji(e[i[r]])},`;return`${n}}`}function Qi(e){let t="";for(const i of K)t+=`/${Ji(e[i])}`;return t}function en(e){const t=e.value;return t?[new oe(e.key,t,"constants have been deprecated as of v8")]:[]}function tn(e){return e instanceof Number||e instanceof String||e instanceof Boolean?e.valueOf():e}function nn(e){if(Array.isArray(e))return e.map(nn);if(e instanceof Object&&!(e instanceof Number||e instanceof String||e instanceof Boolean)){const t={};for(const i in e)t[i]=nn(e[i]);return t}return tn(e)}function rn(e){const t=e.key,i=e.value,n=e.valueSpec||{},r=e.objectElementValidators||{},a=e.style,s=e.styleSpec,o=e.validateSpec;let l=[];const c=ki(i);if("object"!==c)return[new oe(t,i,`object expected, ${c} found`)];for(const u in i){const e=u.split(".")[0],c=n[e]||n["*"];let h;if(r[e])h=r[e];else if(n[e])h=o;else if(r["*"])h=r["*"];else{if(!n["*"]){l.push(new oe(t,i[u],`unknown property "${u}"`));continue}h=o}l=l.concat(h({key:(t?`${t}.`:t)+u,value:i[u],valueSpec:c,style:a,styleSpec:s,object:i,objectKey:u,validateSpec:o},i))}for(const u in n)r[u]||n[u].required&&void 0===n[u].default&&void 0===i[u]&&l.push(new oe(t,i,`missing required property "${u}"`));return l}function an(e){const t=e.value,i=e.valueSpec,n=e.style,r=e.styleSpec,a=e.key,s=e.arrayElementValidator||e.validateSpec;if("array"!==ki(t))return[new oe(a,t,`array expected, ${ki(t)} found`)];if(i.length&&t.length!==i.length)return[new oe(a,t,`array length ${i.length} expected, length ${t.length} found`)];if(i["min-length"]&&t.length<i["min-length"])return[new oe(a,t,`array length at least ${i["min-length"]} expected, length ${t.length} found`)];let o={type:i.value,values:i.values};r.$version<7&&(o.function=i.function),"object"===ki(i.value)&&(o=i.value);let l=[];for(let c=0;c<t.length;c++)l=l.concat(s({array:t,arrayIndex:c,value:t[c],valueSpec:o,validateSpec:e.validateSpec,style:n,styleSpec:r,key:`${a}[${c}]`}));return l}function sn(e){const t=e.key,i=e.value,n=e.valueSpec;let r=ki(i);return"number"===r&&i!=i&&(r="NaN"),"number"!==r?[new oe(t,i,`number expected, ${r} found`)]:"minimum"in n&&i<n.minimum?[new oe(t,i,`${i} is less than the minimum value ${n.minimum}`)]:"maximum"in n&&i>n.maximum?[new oe(t,i,`${i} is greater than the maximum value ${n.maximum}`)]:[]}function on(e){const t=e.valueSpec,i=tn(e.value.type);let n,r,a,s={};const o="categorical"!==i&&void 0===e.value.property,l=!o,c="array"===ki(e.value.stops)&&"array"===ki(e.value.stops[0])&&"object"===ki(e.value.stops[0][0]),u=rn({key:e.key,value:e.value,valueSpec:e.styleSpec.function,validateSpec:e.validateSpec,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{stops:function(e){if("identity"===i)return[new oe(e.key,e.value,'identity function may not have a "stops" property')];let t=[];const n=e.value;return t=t.concat(an({key:e.key,value:n,valueSpec:e.valueSpec,validateSpec:e.validateSpec,style:e.style,styleSpec:e.styleSpec,arrayElementValidator:h})),"array"===ki(n)&&0===n.length&&t.push(new oe(e.key,n,"array must have at least one stop")),t},default:function(e){return e.validateSpec({key:e.key,value:e.value,valueSpec:t,validateSpec:e.validateSpec,style:e.style,styleSpec:e.styleSpec})}}});return"identity"===i&&o&&u.push(new oe(e.key,e.value,'missing required property "property"')),"identity"===i||e.value.stops||u.push(new oe(e.key,e.value,'missing required property "stops"')),"exponential"===i&&e.valueSpec.expression&&!Ti(e.valueSpec)&&u.push(new oe(e.key,e.value,"exponential functions not supported")),e.styleSpec.$version>=8&&(l&&!wi(e.valueSpec)?u.push(new oe(e.key,e.value,"property functions not supported")):o&&!Si(e.valueSpec)&&u.push(new oe(e.key,e.value,"zoom functions not supported"))),"categorical"!==i&&!c||void 0!==e.value.property||u.push(new oe(e.key,e.value,'"property" property is required')),u;function h(e){let i=[];const n=e.value,o=e.key;if("array"!==ki(n))return[new oe(o,n,`array expected, ${ki(n)} found`)];if(2!==n.length)return[new oe(o,n,`array length 2 expected, length ${n.length} found`)];if(c){if("object"!==ki(n[0]))return[new oe(o,n,`object expected, ${ki(n[0])} found`)];if(void 0===n[0].zoom)return[new oe(o,n,"object stop key must have zoom")];if(void 0===n[0].value)return[new oe(o,n,"object stop key must have value")];if(a&&a>tn(n[0].zoom))return[new oe(o,n[0].zoom,"stop zoom values must appear in ascending order")];tn(n[0].zoom)!==a&&(a=tn(n[0].zoom),r=void 0,s={}),i=i.concat(rn({key:`${o}[0]`,value:n[0],valueSpec:{zoom:{}},validateSpec:e.validateSpec,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{zoom:sn,value:d}}))}else i=i.concat(d({key:`${o}[0]`,value:n[0],valueSpec:{},validateSpec:e.validateSpec,style:e.style,styleSpec:e.styleSpec},n));return Ri(nn(n[1]))?i.concat([new oe(`${o}[1]`,n[1],"expressions are not allowed in function stops.")]):i.concat(e.validateSpec({key:`${o}[1]`,value:n[1],valueSpec:t,validateSpec:e.validateSpec,style:e.style,styleSpec:e.styleSpec}))}function d(e,a){const o=ki(e.value),l=tn(e.value),c=null!==e.value?e.value:a;if(n){if(o!==n)return[new oe(e.key,c,`${o} stop domain type must match previous stop domain type ${n}`)]}else n=o;if("number"!==o&&"string"!==o&&"boolean"!==o)return[new oe(e.key,c,"stop domain value must be a number, string, or boolean")];if("number"!==o&&"categorical"!==i){let n=`number expected, ${o} found`;return wi(t)&&void 0===i&&(n+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new oe(e.key,c,n)]}return"categorical"!==i||"number"!==o||isFinite(l)&&Math.floor(l)===l?"categorical"!==i&&"number"===o&&void 0!==r&&l<r?[new oe(e.key,c,"stop domain values must appear in ascending order")]:(r=l,"categorical"===i&&l in s?[new oe(e.key,c,"stop domain values must be unique")]:(s[l]=!0,[])):[new oe(e.key,c,`integer expected, found ${l}`)]}}function ln(e){const t=("property"===e.expressionContext?Ni:Fi)(nn(e.value),e.valueSpec);if("error"===t.result)return t.value.map((t=>new oe(`${e.key}${t.key}`,e.value,t.message)));const i=t.value.expression||t.value._styleExpression.expression;if("property"===e.expressionContext&&"text-font"===e.propertyKey&&!i.outputDefined())return[new oe(e.key,e.value,`Invalid data expression for "${e.propertyKey}". Output values must be contained as literals within the expression.`)];if("property"===e.expressionContext&&"layout"===e.propertyType&&!Nt(i))return[new oe(e.key,e.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===e.expressionContext&&!Nt(i))return[new oe(e.key,e.value,'"feature-state" data expressions are not supported with filters.')];if(e.expressionContext&&0===e.expressionContext.indexOf("cluster")){if(!Vt(i,["zoom","feature-state"]))return[new oe(e.key,e.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===e.expressionContext&&!Ot(i))return[new oe(e.key,e.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function cn(e){const t=e.key,i=e.value,n=e.valueSpec,r=[];return Array.isArray(n.values)?-1===n.values.indexOf(tn(i))&&r.push(new oe(t,i,`expected one of [${n.values.join(", ")}], ${JSON.stringify(i)} found`)):-1===Object.keys(n.values).indexOf(tn(i))&&r.push(new oe(t,i,`expected one of [${Object.keys(n.values).join(", ")}], ${JSON.stringify(i)} found`)),r}function un(e){return Ui(nn(e.value))?ln(le({},e,{expressionContext:"filter",valueSpec:{value:"boolean"}})):hn(e)}function hn(e){const t=e.value,i=e.key;if("array"!==ki(t))return[new oe(i,t,`array expected, ${ki(t)} found`)];const n=e.styleSpec;let r,a=[];if(t.length<1)return[new oe(i,t,"filter array must have at least 1 element")];switch(a=a.concat(cn({key:`${i}[0]`,value:t[0],valueSpec:n.filter_operator,style:e.style,styleSpec:e.styleSpec})),tn(t[0])){case"<":case"<=":case">":case">=":t.length>=2&&"$type"===tn(t[1])&&a.push(new oe(i,t,`"$type" cannot be use with operator "${t[0]}"`));case"==":case"!=":3!==t.length&&a.push(new oe(i,t,`filter array for operator "${t[0]}" must have 3 elements`));case"in":case"!in":t.length>=2&&(r=ki(t[1]),"string"!==r&&a.push(new oe(`${i}[1]`,t[1],`string expected, ${r} found`)));for(let s=2;s<t.length;s++)r=ki(t[s]),"$type"===tn(t[1])?a=a.concat(cn({key:`${i}[${s}]`,value:t[s],valueSpec:n.geometry_type,style:e.style,styleSpec:e.styleSpec})):"string"!==r&&"number"!==r&&"boolean"!==r&&a.push(new oe(`${i}[${s}]`,t[s],`string, number, or boolean expected, ${r} found`));break;case"any":case"all":case"none":for(let n=1;n<t.length;n++)a=a.concat(hn({key:`${i}[${n}]`,value:t[n],style:e.style,styleSpec:e.styleSpec}));break;case"has":case"!has":r=ki(t[1]),2!==t.length?a.push(new oe(i,t,`filter array for "${t[0]}" operator must have 2 elements`)):"string"!==r&&a.push(new oe(`${i}[1]`,t[1],`string expected, ${r} found`));break;case"within":r=ki(t[1]),2!==t.length?a.push(new oe(i,t,`filter array for "${t[0]}" operator must have 2 elements`)):"object"!==r&&a.push(new oe(`${i}[1]`,t[1],`object expected, ${r} found`))}return a}function dn(e,t){const i=e.key,n=e.validateSpec,r=e.style,a=e.styleSpec,s=e.value,o=e.objectKey,l=a[`${t}_${e.layerType}`];if(!l)return[];const c=o.match(/^(.*)-transition$/);if("paint"===t&&c&&l[c[1]]&&l[c[1]].transition)return n({key:i,value:s,valueSpec:a.transition,style:r,styleSpec:a});const u=e.valueSpec||l[o];if(!u)return[new oe(i,s,`unknown property "${o}"`)];let h;if("string"===ki(s)&&wi(u)&&!u.tokens&&(h=/^{([^}]+)}$/.exec(s)))return[new oe(i,s,`"${o}" does not support interpolation syntax\nUse an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(h[1])} }\`.`)];const d=[];return"symbol"===e.layerType&&("text-field"===o&&r&&!r.glyphs&&d.push(new oe(i,s,'use of "text-field" requires a style "glyphs" property')),"text-font"===o&&Ei(nn(s))&&"identity"===tn(s.type)&&d.push(new oe(i,s,'"text-font" does not support identity functions'))),d.concat(n({key:e.key,value:s,valueSpec:u,style:r,styleSpec:a,expressionContext:"property",propertyType:t,propertyKey:o}))}function pn(e){return dn(e,"paint")}function fn(e){return dn(e,"layout")}function mn(e){let t=[];const i=e.value,n=e.key,r=e.style,a=e.styleSpec;i.type||i.ref||t.push(new oe(n,i,'either "type" or "ref" is required'));let s=tn(i.type);const o=tn(i.ref);if(i.id){const a=tn(i.id);for(let s=0;s<e.arrayIndex;s++){const e=r.layers[s];tn(e.id)===a&&t.push(new oe(n,i.id,`duplicate layer id "${i.id}", previously used at line ${e.id.__line__}`))}}if("ref"in i){let e;["type","source","source-layer","filter","layout"].forEach((e=>{e in i&&t.push(new oe(n,i[e],`"${e}" is prohibited for ref layers`))})),r.layers.forEach((t=>{tn(t.id)===o&&(e=t)})),e?e.ref?t.push(new oe(n,i.ref,"ref cannot reference another ref layer")):s=tn(e.type):t.push(new oe(n,i.ref,`ref layer "${o}" not found`))}else if("background"!==s)if(i.source){const e=r.sources&&r.sources[i.source],a=e&&tn(e.type);e?"vector"===a&&"raster"===s?t.push(new oe(n,i.source,`layer "${i.id}" requires a raster source`)):"raster-dem"!==a&&"hillshade"===s?t.push(new oe(n,i.source,`layer "${i.id}" requires a raster-dem source`)):"raster"===a&&"raster"!==s?t.push(new oe(n,i.source,`layer "${i.id}" requires a vector source`)):"vector"!==a||i["source-layer"]?"raster-dem"===a&&"hillshade"!==s?t.push(new oe(n,i.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"!==s||!i.paint||!i.paint["line-gradient"]||"geojson"===a&&e.lineMetrics||t.push(new oe(n,i,`layer "${i.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):t.push(new oe(n,i,`layer "${i.id}" must specify a "source-layer"`)):t.push(new oe(n,i.source,`source "${i.source}" not found`))}else t.push(new oe(n,i,'missing required property "source"'));return t=t.concat(rn({key:n,value:i,valueSpec:a.layer,style:e.style,styleSpec:e.styleSpec,validateSpec:e.validateSpec,objectElementValidators:{"*":()=>[],type:()=>e.validateSpec({key:`${n}.type`,value:i.type,valueSpec:a.layer.type,style:e.style,styleSpec:e.styleSpec,validateSpec:e.validateSpec,object:i,objectKey:"type"}),filter:un,layout:e=>rn({layer:i,key:e.key,value:e.value,style:e.style,styleSpec:e.styleSpec,validateSpec:e.validateSpec,objectElementValidators:{"*":e=>fn(le({layerType:s},e))}}),paint:e=>rn({layer:i,key:e.key,value:e.value,style:e.style,styleSpec:e.styleSpec,validateSpec:e.validateSpec,objectElementValidators:{"*":e=>pn(le({layerType:s},e))}})}})),t}function gn(e){const t=e.value,i=e.key,n=ki(t);return"string"!==n?[new oe(i,t,`string expected, ${n} found`)]:[]}const yn={promoteId:function(e){let{key:t,value:i}=e;if("string"===ki(i))return gn({key:t,value:i});{const e=[];for(const n in i)e.push(...gn({key:`${t}.${n}`,value:i[n]}));return e}}};function _n(e){const t=e.value,i=e.key,n=e.styleSpec,r=e.style,a=e.validateSpec;if(!t.type)return[new oe(i,t,'"type" is required')];const s=tn(t.type);let o;switch(s){case"vector":case"raster":return o=rn({key:i,value:t,valueSpec:n[`source_${s.replace("-","_")}`],style:e.style,styleSpec:n,objectElementValidators:yn,validateSpec:a}),o;case"raster-dem":return o=function(e){var t;const i=null!==(t=e.sourceName)&&void 0!==t?t:"",n=e.value,r=e.styleSpec,a=r.source_raster_dem,s=e.style;let o=[];const l=ki(n);if(void 0===n)return o;if("object"!==l)return o.push(new oe("source_raster_dem",n,`object expected, ${l} found`)),o;const c="custom"===tn(n.encoding),u=["redFactor","greenFactor","blueFactor","baseShift"],h=e.value.encoding?`"${e.value.encoding}"`:"Default";for(const d in n)!c&&u.includes(d)?o.push(new oe(d,n[d],`In "${i}": "${d}" is only valid when "encoding" is set to "custom". ${h} encoding found`)):a[d]?o=o.concat(e.validateSpec({key:d,value:n[d],valueSpec:a[d],validateSpec:e.validateSpec,style:s,styleSpec:r})):o.push(new oe(d,n[d],`unknown property "${d}"`));return o}({sourceName:i,value:t,style:e.style,styleSpec:n,validateSpec:a}),o;case"geojson":if(o=rn({key:i,value:t,valueSpec:n.source_geojson,style:r,styleSpec:n,validateSpec:a,objectElementValidators:yn}),t.cluster)for(const e in t.clusterProperties){const[n,r]=t.clusterProperties[e],s="string"==typeof n?[n,["accumulated"],["get",e]]:n;o.push(...ln({key:`${i}.${e}.map`,value:r,validateSpec:a,expressionContext:"cluster-map"})),o.push(...ln({key:`${i}.${e}.reduce`,value:s,validateSpec:a,expressionContext:"cluster-reduce"}))}return o;case"video":return rn({key:i,value:t,valueSpec:n.source_video,style:r,validateSpec:a,styleSpec:n});case"image":return rn({key:i,value:t,valueSpec:n.source_image,style:r,validateSpec:a,styleSpec:n});case"canvas":return[new oe(i,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return cn({key:`${i}.type`,value:t.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:r,validateSpec:a,styleSpec:n})}}function vn(e){const t=e.value,i=e.styleSpec,n=i.light,r=e.style;let a=[];const s=ki(t);if(void 0===t)return a;if("object"!==s)return a=a.concat([new oe("light",t,`object expected, ${s} found`)]),a;for(const o in t){const s=o.match(/^(.*)-transition$/);a=a.concat(s&&n[s[1]]&&n[s[1]].transition?e.validateSpec({key:o,value:t[o],valueSpec:i.transition,validateSpec:e.validateSpec,style:r,styleSpec:i}):n[o]?e.validateSpec({key:o,value:t[o],valueSpec:n[o],validateSpec:e.validateSpec,style:r,styleSpec:i}):[new oe(o,t[o],`unknown property "${o}"`)])}return a}function xn(e){const t=e.value,i=e.styleSpec,n=i.terrain,r=e.style;let a=[];const s=ki(t);if(void 0===t)return a;if("object"!==s)return a=a.concat([new oe("terrain",t,`object expected, ${s} found`)]),a;for(const o in t)a=a.concat(n[o]?e.validateSpec({key:o,value:t[o],valueSpec:n[o],validateSpec:e.validateSpec,style:r,styleSpec:i}):[new oe(o,t[o],`unknown property "${o}"`)]);return a}function bn(e){let t=[];const i=e.value,n=e.key;if(Array.isArray(i)){const r=[],a=[];for(const s in i)i[s].id&&r.includes(i[s].id)&&t.push(new oe(n,i,`all the sprites' ids must be unique, but ${i[s].id} is duplicated`)),r.push(i[s].id),i[s].url&&a.includes(i[s].url)&&t.push(new oe(n,i,`all the sprites' URLs must be unique, but ${i[s].url} is duplicated`)),a.push(i[s].url),t=t.concat(rn({key:`${n}[${s}]`,value:i[s],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:e.validateSpec}));return t}return gn({key:n,value:i})}const wn={"*":()=>[],array:an,boolean:function(e){const t=e.value,i=e.key,n=ki(t);return"boolean"!==n?[new oe(i,t,`boolean expected, ${n} found`)]:[]},number:sn,color:function(e){const t=e.key,i=e.value,n=ki(i);return"string"!==n?[new oe(t,i,`color expected, ${n} found`)]:Ke.parse(String(i))?[]:[new oe(t,i,`color expected, "${i}" found`)]},constants:en,enum:cn,filter:un,function:on,layer:mn,object:rn,source:_n,light:vn,terrain:xn,string:gn,formatted:function(e){return 0===gn(e).length?[]:ln(e)},resolvedImage:function(e){return 0===gn(e).length?[]:ln(e)},padding:function(e){const t=e.key,i=e.value;if("array"===ki(i)){if(i.length<1||i.length>4)return[new oe(t,i,`padding requires 1 to 4 values; ${i.length} values found`)];const n={type:"number"};let r=[];for(let a=0;a<i.length;a++)r=r.concat(e.validateSpec({key:`${t}[${a}]`,value:i[a],validateSpec:e.validateSpec,valueSpec:n}));return r}return sn({key:t,value:i,valueSpec:{}})},variableAnchorOffsetCollection:function(e){const t=e.key,i=e.value,n=ki(i),r=e.styleSpec;if("array"!==n||i.length<1||i.length%2!=0)return[new oe(t,i,"variableAnchorOffsetCollection requires a non-empty array of even length")];let a=[];for(let s=0;s<i.length;s+=2)a=a.concat(cn({key:`${t}[${s}]`,value:i[s],valueSpec:r.layout_symbol["text-anchor"]})),a=a.concat(an({key:`${t}[${s+1}]`,value:i[s+1],valueSpec:{length:2,value:"number"},validateSpec:e.validateSpec,style:e.style,styleSpec:r}));return a},sprite:bn};function Sn(e){const t=e.value,i=e.valueSpec,n=e.styleSpec;return e.validateSpec=Sn,i.expression&&Ei(tn(t))?on(e):i.expression&&Ri(nn(t))?ln(e):i.type&&wn[i.type]?wn[i.type](e):rn(le({},e,{valueSpec:i.type?n[i.type]:i}))}function Tn(e){const t=e.value,i=e.key,n=gn(e);return n.length||(-1===t.indexOf("{fontstack}")&&n.push(new oe(i,t,'"glyphs" url must include a "{fontstack}" token')),-1===t.indexOf("{range}")&&n.push(new oe(i,t,'"glyphs" url must include a "{range}" token'))),n}function kn(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:X,i=[];return i=i.concat(Sn({key:"",value:e,valueSpec:t.$root,styleSpec:t,style:e,validateSpec:Sn,objectElementValidators:{glyphs:Tn,"*":()=>[]}})),e.constants&&(i=i.concat(en({key:"constants",value:e.constants,style:e,styleSpec:t,validateSpec:Sn}))),Pn(i)}function En(e){return function(t){return e({...t,validateSpec:Sn})}}function Pn(e){return[].concat(e).sort(((e,t)=>e.line-t.line))}function Cn(e){return function(){for(var t=arguments.length,i=new Array(t),n=0;n<t;n++)i[n]=arguments[n];return Pn(e.apply(this,i))}}kn.source=Cn(En(_n)),kn.sprite=Cn(En(bn)),kn.glyphs=Cn(En(Tn)),kn.light=Cn(En(vn)),kn.terrain=Cn(En(xn)),kn.layer=Cn(En(mn)),kn.filter=Cn(En(un)),kn.paintProperty=Cn(En(pn)),kn.layoutProperty=Cn(En(fn));const In=kn,An=In.light,Mn=In.paintProperty,zn=In.layoutProperty;function Dn(e,t){let i=!1;if(t&&t.length)for(const n of t)e.fire(new W(new Error(n.message))),i=!0;return i}class Ln{constructor(e,t,i){const n=this.cells=[];if(e instanceof ArrayBuffer){this.arrayBuffer=e;const r=new Int32Array(this.arrayBuffer);e=r[0],this.d=(t=r[1])+2*(i=r[2]);for(let e=0;e<this.d*this.d;e++){const t=r[3+e],i=r[3+e+1];n.push(t===i?null:r.subarray(t,i))}const a=r[3+n.length+1];this.keys=r.subarray(r[3+n.length],a),this.bboxes=r.subarray(a),this.insert=this._insertReadonly}else{this.d=t+2*i;for(let e=0;e<this.d*this.d;e++)n.push([]);this.keys=[],this.bboxes=[]}this.n=t,this.extent=e,this.padding=i,this.scale=t/e,this.uid=0;const r=i/t*e;this.min=-r,this.max=e+r}insert(e,t,i,n,r){this._forEachCell(t,i,n,r,this._insertCell,this.uid++,void 0,void 0),this.keys.push(e),this.bboxes.push(t),this.bboxes.push(i),this.bboxes.push(n),this.bboxes.push(r)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(e,t,i,n,r,a){this.cells[r].push(a)}query(e,t,i,n,r){const a=this.min,s=this.max;if(e<=a&&t<=a&&s<=i&&s<=n&&!r)return Array.prototype.slice.call(this.keys);{const a=[];return this._forEachCell(e,t,i,n,this._queryCell,a,{},r),a}}_queryCell(e,t,i,n,r,a,s,o){const l=this.cells[r];if(null!==l){const r=this.keys,c=this.bboxes;for(let u=0;u<l.length;u++){const h=l[u];if(void 0===s[h]){const l=4*h;(o?o(c[l+0],c[l+1],c[l+2],c[l+3]):e<=c[l+2]&&t<=c[l+3]&&i>=c[l+0]&&n>=c[l+1])?(s[h]=!0,a.push(r[h])):s[h]=!1}}}}_forEachCell(e,t,i,n,r,a,s,o){const l=this._convertToCellCoord(e),c=this._convertToCellCoord(t),u=this._convertToCellCoord(i),h=this._convertToCellCoord(n);for(let d=l;d<=u;d++)for(let l=c;l<=h;l++){const c=this.d*l+d;if((!o||o(this._convertFromCellCoord(d),this._convertFromCellCoord(l),this._convertFromCellCoord(d+1),this._convertFromCellCoord(l+1)))&&r.call(this,e,t,i,n,c,a,s,o))return}}_convertFromCellCoord(e){return(e-this.padding)/this.scale}_convertToCellCoord(e){return Math.max(0,Math.min(this.d-1,Math.floor(e*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const e=this.cells,t=3+this.cells.length+1+1;let i=0;for(let a=0;a<this.cells.length;a++)i+=this.cells[a].length;const n=new Int32Array(t+i+this.keys.length+this.bboxes.length);n[0]=this.extent,n[1]=this.n,n[2]=this.padding;let r=t;for(let a=0;a<e.length;a++){const t=e[a];n[3+a]=r,n.set(t,r),r+=t.length}return n[3+e.length]=r,n.set(this.keys,r),r+=this.keys.length,n[3+e.length+1]=r,n.set(this.bboxes,r),r+=this.bboxes.length,n.buffer}static serialize(e,t){const i=e.toArrayBuffer();return t&&t.push(i),{buffer:i}}static deserialize(e){return new Ln(e.buffer)}}const Rn={};function Fn(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(Rn[e])throw new Error(`${e} is already registered.`);Object.defineProperty(t,"_classRegistryKey",{value:e,writeable:!1}),Rn[e]={klass:t,omit:i.omit||[],shallow:i.shallow||[]}}Fn("Object",Object),Fn("TransferableGridIndex",Ln),Fn("Color",Ke),Fn("Error",Error),Fn("AJAXError",B),Fn("ResolvedImage",nt),Fn("StylePropertyFunction",Vi),Fn("StyleExpression",Li,{omit:["_evaluator"]}),Fn("ZoomDependentExpression",Oi),Fn("ZoomConstantExpression",Bi),Fn("CompoundExpression",Ft,{omit:["_evaluate"]});for(const ph in mi)mi[ph]._classRegistryKey||Fn(`Expression_${ph}`,mi[ph]);function Bn(e){return e&&"undefined"!=typeof ArrayBuffer&&(e instanceof ArrayBuffer||e.constructor&&"ArrayBuffer"===e.constructor.name)}function On(e,t){if(null==e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp||e instanceof Blob)return e;if(Bn(e))return t&&t.push(e),e;if(C(e))return t&&t.push(e),e;if(ArrayBuffer.isView(e)){const i=e;return t&&t.push(i.buffer),i}if(e instanceof ImageData)return t&&t.push(e.data.buffer),e;if(Array.isArray(e)){const i=[];for(const n of e)i.push(On(n,t));return i}if("object"==typeof e){const i=e.constructor,n=i._classRegistryKey;if(!n)throw new Error("can't serialize object of unregistered class");if(!Rn[n])throw new Error(`${n} is not registered.`);const r=i.serialize?i.serialize(e,t):{};if(i.serialize){if(t&&r===t[t.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const i in e){if(!e.hasOwnProperty(i))continue;if(Rn[n].omit.indexOf(i)>=0)continue;const a=e[i];r[i]=Rn[n].shallow.indexOf(i)>=0?a:On(a,t)}e instanceof Error&&(r.message=e.message)}if(r.$name)throw new Error("$name property is reserved for worker serialization logic.");return"Object"!==n&&(r.$name=n),r}throw new Error("can't serialize object of type "+typeof e)}function Nn(e){if(null==e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp||e instanceof Blob||Bn(e)||C(e)||ArrayBuffer.isView(e)||e instanceof ImageData)return e;if(Array.isArray(e))return e.map(Nn);if("object"==typeof e){const t=e.$name||"Object";if(!Rn[t])throw new Error(`can't deserialize unregistered class ${t}`);const{klass:i}=Rn[t];if(!i)throw new Error(`can't deserialize unregistered class ${t}`);if(i.deserialize)return i.deserialize(e);const n=Object.create(i.prototype);for(const r of Object.keys(e)){if("$name"===r)continue;const i=e[r];n[r]=Rn[t].shallow.indexOf(r)>=0?i:Nn(i)}return n}throw new Error("can't deserialize object of type "+typeof e)}class Vn{constructor(){this.first=!0}update(e,t){const i=Math.floor(e);return this.first?(this.first=!1,this.lastIntegerZoom=i,this.lastIntegerZoomTime=0,this.lastZoom=e,this.lastFloorZoom=i,!0):(this.lastFloorZoom>i?(this.lastIntegerZoom=i+1,this.lastIntegerZoomTime=t):this.lastFloorZoom<i&&(this.lastIntegerZoom=i,this.lastIntegerZoomTime=t),e!==this.lastZoom&&(this.lastZoom=e,this.lastFloorZoom=i,!0))}}const jn={"Latin-1 Supplement":e=>e>=128&&e<=255,Arabic:e=>e>=1536&&e<=1791,"Arabic Supplement":e=>e>=1872&&e<=1919,"Arabic Extended-A":e=>e>=2208&&e<=2303,"Hangul Jamo":e=>e>=4352&&e<=4607,"Unified Canadian Aboriginal Syllabics":e=>e>=5120&&e<=5759,Khmer:e=>e>=6016&&e<=6143,"Unified Canadian Aboriginal Syllabics Extended":e=>e>=6320&&e<=6399,"General Punctuation":e=>e>=8192&&e<=8303,"Letterlike Symbols":e=>e>=8448&&e<=8527,"Number Forms":e=>e>=8528&&e<=8591,"Miscellaneous Technical":e=>e>=8960&&e<=9215,"Control Pictures":e=>e>=9216&&e<=9279,"Optical Character Recognition":e=>e>=9280&&e<=9311,"Enclosed Alphanumerics":e=>e>=9312&&e<=9471,"Geometric Shapes":e=>e>=9632&&e<=9727,"Miscellaneous Symbols":e=>e>=9728&&e<=9983,"Miscellaneous Symbols and Arrows":e=>e>=11008&&e<=11263,"CJK Radicals Supplement":e=>e>=11904&&e<=12031,"Kangxi Radicals":e=>e>=12032&&e<=12255,"Ideographic Description Characters":e=>e>=12272&&e<=12287,"CJK Symbols and Punctuation":e=>e>=12288&&e<=12351,Hiragana:e=>e>=12352&&e<=12447,Katakana:e=>e>=12448&&e<=12543,Bopomofo:e=>e>=12544&&e<=12591,"Hangul Compatibility Jamo":e=>e>=12592&&e<=12687,Kanbun:e=>e>=12688&&e<=12703,"Bopomofo Extended":e=>e>=12704&&e<=12735,"CJK Strokes":e=>e>=12736&&e<=12783,"Katakana Phonetic Extensions":e=>e>=12784&&e<=12799,"Enclosed CJK Letters and Months":e=>e>=12800&&e<=13055,"CJK Compatibility":e=>e>=13056&&e<=13311,"CJK Unified Ideographs Extension A":e=>e>=13312&&e<=19903,"Yijing Hexagram Symbols":e=>e>=19904&&e<=19967,"CJK Unified Ideographs":e=>e>=19968&&e<=40959,"Yi Syllables":e=>e>=40960&&e<=42127,"Yi Radicals":e=>e>=42128&&e<=42191,"Hangul Jamo Extended-A":e=>e>=43360&&e<=43391,"Hangul Syllables":e=>e>=44032&&e<=55215,"Hangul Jamo Extended-B":e=>e>=55216&&e<=55295,"Private Use Area":e=>e>=57344&&e<=63743,"CJK Compatibility Ideographs":e=>e>=63744&&e<=64255,"Arabic Presentation Forms-A":e=>e>=64336&&e<=65023,"Vertical Forms":e=>e>=65040&&e<=65055,"CJK Compatibility Forms":e=>e>=65072&&e<=65103,"Small Form Variants":e=>e>=65104&&e<=65135,"Arabic Presentation Forms-B":e=>e>=65136&&e<=65279,"Halfwidth and Fullwidth Forms":e=>e>=65280&&e<=65519};function Un(e){for(const t of e)if(Zn(t.charCodeAt(0)))return!0;return!1}function $n(e){for(const t of e)if(!qn(t.charCodeAt(0)))return!1;return!0}function qn(e){return!(jn.Arabic(e)||jn["Arabic Supplement"](e)||jn["Arabic Extended-A"](e)||jn["Arabic Presentation Forms-A"](e)||jn["Arabic Presentation Forms-B"](e))}function Zn(e){return!(746!==e&&747!==e&&(e<4352||!(jn["Bopomofo Extended"](e)||jn.Bopomofo(e)||jn["CJK Compatibility Forms"](e)&&!(e>=65097&&e<=65103)||jn["CJK Compatibility Ideographs"](e)||jn["CJK Compatibility"](e)||jn["CJK Radicals Supplement"](e)||jn["CJK Strokes"](e)||!(!jn["CJK Symbols and Punctuation"](e)||e>=12296&&e<=12305||e>=12308&&e<=12319||12336===e)||jn["CJK Unified Ideographs Extension A"](e)||jn["CJK Unified Ideographs"](e)||jn["Enclosed CJK Letters and Months"](e)||jn["Hangul Compatibility Jamo"](e)||jn["Hangul Jamo Extended-A"](e)||jn["Hangul Jamo Extended-B"](e)||jn["Hangul Jamo"](e)||jn["Hangul Syllables"](e)||jn.Hiragana(e)||jn["Ideographic Description Characters"](e)||jn.Kanbun(e)||jn["Kangxi Radicals"](e)||jn["Katakana Phonetic Extensions"](e)||jn.Katakana(e)&&12540!==e||!(!jn["Halfwidth and Fullwidth Forms"](e)||65288===e||65289===e||65293===e||e>=65306&&e<=65310||65339===e||65341===e||65343===e||e>=65371&&e<=65503||65507===e||e>=65512&&e<=65519)||!(!jn["Small Form Variants"](e)||e>=65112&&e<=65118||e>=65123&&e<=65126)||jn["Unified Canadian Aboriginal Syllabics"](e)||jn["Unified Canadian Aboriginal Syllabics Extended"](e)||jn["Vertical Forms"](e)||jn["Yijing Hexagram Symbols"](e)||jn["Yi Syllables"](e)||jn["Yi Radicals"](e))))}function Gn(e){return!(Zn(e)||function(e){return!!(jn["Latin-1 Supplement"](e)&&(167===e||169===e||174===e||177===e||188===e||189===e||190===e||215===e||247===e)||jn["General Punctuation"](e)&&(8214===e||8224===e||8225===e||8240===e||8241===e||8251===e||8252===e||8258===e||8263===e||8264===e||8265===e||8273===e)||jn["Letterlike Symbols"](e)||jn["Number Forms"](e)||jn["Miscellaneous Technical"](e)&&(e>=8960&&e<=8967||e>=8972&&e<=8991||e>=8996&&e<=9e3||9003===e||e>=9085&&e<=9114||e>=9150&&e<=9165||9167===e||e>=9169&&e<=9179||e>=9186&&e<=9215)||jn["Control Pictures"](e)&&9251!==e||jn["Optical Character Recognition"](e)||jn["Enclosed Alphanumerics"](e)||jn["Geometric Shapes"](e)||jn["Miscellaneous Symbols"](e)&&!(e>=9754&&e<=9759)||jn["Miscellaneous Symbols and Arrows"](e)&&(e>=11026&&e<=11055||e>=11088&&e<=11097||e>=11192&&e<=11243)||jn["CJK Symbols and Punctuation"](e)||jn.Katakana(e)||jn["Private Use Area"](e)||jn["CJK Compatibility Forms"](e)||jn["Small Form Variants"](e)||jn["Halfwidth and Fullwidth Forms"](e)||8734===e||8756===e||8757===e||e>=9984&&e<=10087||e>=10102&&e<=10131||65532===e||65533===e)}(e))}function Wn(e){return e>=1424&&e<=2303||jn["Arabic Presentation Forms-A"](e)||jn["Arabic Presentation Forms-B"](e)}function Hn(e,t){return!(!t&&Wn(e)||e>=2304&&e<=3583||e>=3840&&e<=4255||jn.Khmer(e))}function Xn(e){for(const t of e)if(Wn(t.charCodeAt(0)))return!0;return!1}const Kn="deferred",Yn="loading",Jn="loaded";let Qn=null,er="unavailable",tr=null;const ir=function(e){e&&"string"==typeof e&&e.indexOf("NetworkError")>-1&&(er="error"),Qn&&Qn(e)};function nr(){rr.fire(new G("pluginStateChange",{pluginStatus:er,pluginURL:tr}))}const rr=new H,ar=function(){return er},sr=function(){if(er!==Kn||!tr)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");er=Yn,nr(),tr&&U({url:tr},(e=>{e?ir(e):(er=Jn,nr())}))},or={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>er===Jn||null!=or.applyArabicShaping,isLoading:()=>er===Yn,setState(e){if(!E())throw new Error("Cannot set the state of the rtl-text-plugin when not in the web-worker context");er=e.pluginStatus,tr=e.pluginURL},isParsed(){if(!E())throw new Error("rtl-text-plugin is only parsed on the worker-threads");return null!=or.applyArabicShaping&&null!=or.processBidirectionalText&&null!=or.processStyledBidirectionalText},getPluginURL(){if(!E())throw new Error("rtl-text-plugin url can only be queried from the worker threads");return tr}};class lr{constructor(e,t){this.zoom=e,t?(this.now=t.now,this.fadeDuration=t.fadeDuration,this.zoomHistory=t.zoomHistory,this.transition=t.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Vn,this.transition={})}isSupportedScript(e){return function(e,t){for(const i of e)if(!Hn(i.charCodeAt(0),t))return!1;return!0}(e,or.isLoaded())}crossFadingFactor(){return 0===this.fadeDuration?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const e=this.zoom,t=e-Math.floor(e),i=this.crossFadingFactor();return e>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:t+(1-t)*i}:{fromScale:.5,toScale:1,t:1-(1-i)*t}}}class cr{constructor(e,t){this.property=e,this.value=t,this.expression=function(e,t){if(Ei(e))return new Vi(e,t);if(Ri(e)){const i=Ni(e,t);if("error"===i.result)throw new Error(i.value.map((e=>`${e.key}: ${e.message}`)).join(", "));return i.value}{let i=e;return"color"===t.type&&"string"==typeof e?i=Ke.parse(e):"padding"!==t.type||"number"!=typeof e&&!Array.isArray(e)?"variableAnchorOffsetCollection"===t.type&&Array.isArray(e)&&(i=it.parse(e)):i=et.parse(e),{kind:"constant",evaluate:()=>i}}}(void 0===t?e.specification.default:t,e.specification)}isDataDriven(){return"source"===this.expression.kind||"composite"===this.expression.kind}possiblyEvaluate(e,t,i){return this.property.possiblyEvaluate(this,e,t,i)}}class ur{constructor(e){this.property=e,this.value=new cr(e,void 0)}transitioned(e,t){return new dr(this.property,this.value,t,y({},e.transition,this.transition),e.now)}untransitioned(){return new dr(this.property,this.value,null,{},0)}}class hr{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues)}getValue(e){return b(this._values[e].value.value)}setValue(e,t){Object.prototype.hasOwnProperty.call(this._values,e)||(this._values[e]=new ur(this._values[e].property)),this._values[e].value=new cr(this._values[e].property,null===t?void 0:b(t))}getTransition(e){return b(this._values[e].transition)}setTransition(e,t){Object.prototype.hasOwnProperty.call(this._values,e)||(this._values[e]=new ur(this._values[e].property)),this._values[e].transition=b(t)||void 0}serialize(){const e={};for(const t of Object.keys(this._values)){const i=this.getValue(t);void 0!==i&&(e[t]=i);const n=this.getTransition(t);void 0!==n&&(e[`${t}-transition`]=n)}return e}transitioned(e,t){const i=new pr(this._properties);for(const n of Object.keys(this._values))i._values[n]=this._values[n].transitioned(e,t._values[n]);return i}untransitioned(){const e=new pr(this._properties);for(const t of Object.keys(this._values))e._values[t]=this._values[t].untransitioned();return e}}class dr{constructor(e,t,i,n,r){this.property=e,this.value=t,this.begin=r+n.delay||0,this.end=this.begin+n.duration||0,e.specification.transition&&(n.delay||n.duration)&&(this.prior=i)}possiblyEvaluate(e,t,i){const n=e.now||0,r=this.value.possiblyEvaluate(e,t,i),a=this.prior;if(a){if(n>this.end)return this.prior=null,r;if(this.value.isDataDriven())return this.prior=null,r;if(n<this.begin)return a.possiblyEvaluate(e,t,i);{const s=(n-this.begin)/(this.end-this.begin);return this.property.interpolate(a.possiblyEvaluate(e,t,i),r,function(e){if(e<=0)return 0;if(e>=1)return 1;const t=e*e,i=t*e;return 4*(e<.5?i:3*(e-t)+i-.75)}(s))}}return r}}class pr{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)}possiblyEvaluate(e,t,i){const n=new gr(this._properties);for(const r of Object.keys(this._values))n._values[r]=this._values[r].possiblyEvaluate(e,t,i);return n}hasTransition(){for(const e of Object.keys(this._values))if(this._values[e].prior)return!0;return!1}}class fr{constructor(e){this._properties=e,this._values=Object.create(e.defaultPropertyValues)}hasValue(e){return void 0!==this._values[e].value}getValue(e){return b(this._values[e].value)}setValue(e,t){this._values[e]=new cr(this._values[e].property,null===t?void 0:b(t))}serialize(){const e={};for(const t of Object.keys(this._values)){const i=this.getValue(t);void 0!==i&&(e[t]=i)}return e}possiblyEvaluate(e,t,i){const n=new gr(this._properties);for(const r of Object.keys(this._values))n._values[r]=this._values[r].possiblyEvaluate(e,t,i);return n}}class mr{constructor(e,t,i){this.property=e,this.value=t,this.parameters=i}isConstant(){return"constant"===this.value.kind}constantOr(e){return"constant"===this.value.kind?this.value.value:e}evaluate(e,t,i,n){return this.property.evaluate(this.value,this.parameters,e,t,i,n)}}class gr{constructor(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)}get(e){return this._values[e]}}class yr{constructor(e){this.specification=e}possiblyEvaluate(e,t){if(e.isDataDriven())throw new Error("Value should not be data driven");return e.expression.evaluate(t)}interpolate(e,t,i){const n=Zt[this.specification.type];return n?n(e,t,i):e}}class _r{constructor(e,t){this.specification=e,this.overrides=t}possiblyEvaluate(e,t,i,n){return new mr(this,"constant"===e.expression.kind||"camera"===e.expression.kind?{kind:"constant",value:e.expression.evaluate(t,null,{},i,n)}:e.expression,t)}interpolate(e,t,i){if("constant"!==e.value.kind||"constant"!==t.value.kind)return e;if(void 0===e.value.value||void 0===t.value.value)return new mr(this,{kind:"constant",value:void 0},e.parameters);const n=Zt[this.specification.type];if(n){const r=n(e.value.value,t.value.value,i);return new mr(this,{kind:"constant",value:r},e.parameters)}return e}evaluate(e,t,i,n,r,a){return"constant"===e.kind?e.value:e.evaluate(t,i,n,r,a)}}class vr extends _r{possiblyEvaluate(e,t,i,n){if(void 0===e.value)return new mr(this,{kind:"constant",value:void 0},t);if("constant"===e.expression.kind){const r=e.expression.evaluate(t,null,{},i,n),a="resolvedImage"===e.property.specification.type&&"string"!=typeof r?r.name:r,s=this._calculate(a,a,a,t);return new mr(this,{kind:"constant",value:s},t)}if("camera"===e.expression.kind){const i=this._calculate(e.expression.evaluate({zoom:t.zoom-1}),e.expression.evaluate({zoom:t.zoom}),e.expression.evaluate({zoom:t.zoom+1}),t);return new mr(this,{kind:"constant",value:i},t)}return new mr(this,e.expression,t)}evaluate(e,t,i,n,r,a){if("source"===e.kind){const s=e.evaluate(t,i,n,r,a);return this._calculate(s,s,s,t)}return"composite"===e.kind?this._calculate(e.evaluate({zoom:Math.floor(t.zoom)-1},i,n),e.evaluate({zoom:Math.floor(t.zoom)},i,n),e.evaluate({zoom:Math.floor(t.zoom)+1},i,n),t):e.value}_calculate(e,t,i,n){return n.zoom>n.zoomHistory.lastIntegerZoom?{from:e,to:t}:{from:i,to:t}}interpolate(e){return e}}class xr{constructor(e){this.specification=e}possiblyEvaluate(e,t,i,n){if(void 0!==e.value){if("constant"===e.expression.kind){const r=e.expression.evaluate(t,null,{},i,n);return this._calculate(r,r,r,t)}return this._calculate(e.expression.evaluate(new lr(Math.floor(t.zoom-1),t)),e.expression.evaluate(new lr(Math.floor(t.zoom),t)),e.expression.evaluate(new lr(Math.floor(t.zoom+1),t)),t)}}_calculate(e,t,i,n){return n.zoom>n.zoomHistory.lastIntegerZoom?{from:e,to:t}:{from:i,to:t}}interpolate(e){return e}}class br{constructor(e){this.specification=e}possiblyEvaluate(e,t,i,n){return!!e.expression.evaluate(t,null,{},i,n)}interpolate(){return!1}}class wr{constructor(e){this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const t in e){const i=e[t];i.specification.overridable&&this.overridableProperties.push(t);const n=this.defaultPropertyValues[t]=new cr(i,void 0),r=this.defaultTransitionablePropertyValues[t]=new ur(i);this.defaultTransitioningPropertyValues[t]=r.untransitioned(),this.defaultPossiblyEvaluatedValues[t]=n.possiblyEvaluate({})}}}Fn("DataDrivenProperty",_r),Fn("DataConstantProperty",yr),Fn("CrossFadedDataDrivenProperty",vr),Fn("CrossFadedProperty",xr),Fn("ColorRampProperty",br);const Sr="-transition";class Tr extends H{constructor(e,t){if(super(),this.id=e.id,this.type=e.type,this._featureFilter={filter:()=>!0,needGeometry:!1},"custom"!==e.type&&(this.metadata=e.metadata,this.minzoom=e.minzoom,this.maxzoom=e.maxzoom,"background"!==e.type&&(this.source=e.source,this.sourceLayer=e["source-layer"],this.filter=e.filter),t.layout&&(this._unevaluatedLayout=new fr(t.layout)),t.paint)){this._transitionablePaint=new hr(t.paint);for(const t in e.paint)this.setPaintProperty(t,e.paint[t],{validate:!1});for(const t in e.layout)this.setLayoutProperty(t,e.layout[t],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new gr(t.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(e){return"visibility"===e?this.visibility:this._unevaluatedLayout.getValue(e)}setLayoutProperty(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};null!=t&&this._validate(zn,`layers.${this.id}.layout.${e}`,e,t,i)||("visibility"!==e?this._unevaluatedLayout.setValue(e,t):this.visibility=t)}getPaintProperty(e){return e.endsWith(Sr)?this._transitionablePaint.getTransition(e.slice(0,-11)):this._transitionablePaint.getValue(e)}setPaintProperty(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(null!=t&&this._validate(Mn,`layers.${this.id}.paint.${e}`,e,t,i))return!1;if(e.endsWith(Sr))return this._transitionablePaint.setTransition(e.slice(0,-11),t||void 0),!1;{const i=this._transitionablePaint._values[e],n="cross-faded-data-driven"===i.property.specification["property-type"],r=i.value.isDataDriven(),a=i.value;this._transitionablePaint.setValue(e,t),this._handleSpecialPaintPropertyUpdate(e);const s=this._transitionablePaint._values[e].value;return s.isDataDriven()||r||n||this._handleOverridablePaintPropertyUpdate(e,a,s)}}_handleSpecialPaintPropertyUpdate(e){}_handleOverridablePaintPropertyUpdate(e,t,i){return!1}isHidden(e){return!!(this.minzoom&&e<this.minzoom)||!!(this.maxzoom&&e>=this.maxzoom)||"none"===this.visibility}updateTransitions(e){this._transitioningPaint=this._transitionablePaint.transitioned(e,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(e,t){e.getCrossfadeParameters&&(this._crossfadeParameters=e.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(e,void 0,t)),this.paint=this._transitioningPaint.possiblyEvaluate(e,void 0,t)}serialize(){const e={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(e.layout=e.layout||{},e.layout.visibility=this.visibility),x(e,((e,t)=>!(void 0===e||"layout"===t&&!Object.keys(e).length||"paint"===t&&!Object.keys(e).length)))}_validate(e,t,i,n){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};return(!r||!1!==r.validate)&&Dn(this,e.call(In,{key:t,layerType:this.type,objectKey:i,value:n,styleSpec:X,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const e in this.paint._values){const t=this.paint.get(e);if(t instanceof mr&&wi(t.property.specification)&&("source"===t.value.kind||"composite"===t.value.kind)&&t.value.isStateDependent)return!0}return!1}}const kr={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Er{constructor(e,t){this._structArray=e,this._pos1=t*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Pr{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(e,t){return e._trim(),t&&(e.isTransferred=!0,t.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}}static deserialize(e){const t=Object.create(this.prototype);return t.arrayBuffer=e.arrayBuffer,t.length=e.length,t.capacity=e.arrayBuffer.byteLength/t.bytesPerElement,t._refreshViews(),t}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(e){this.reserve(e),this.length=e}reserve(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const t=this.uint8;this._refreshViews(),t&&this.uint8.set(t)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function Cr(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=0,n=0;return{members:e.map((e=>{const r=kr[e.type].BYTES_PER_ELEMENT,a=i=Ir(i,Math.max(t,r)),s=e.components||1;return n=Math.max(n,r),i+=r*s,{name:e.name,type:e.type,components:s,offset:a}})),size:Ir(i,Math.max(n,t)),alignment:t}}function Ir(e,t){return Math.ceil(e/t)*t}class Ar extends Pr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t){const i=this.length;return this.resize(i+1),this.emplace(i,e,t)}emplace(e,t,i){const n=2*e;return this.int16[n+0]=t,this.int16[n+1]=i,e}}Ar.prototype.bytesPerElement=4,Fn("StructArrayLayout2i4",Ar);class Mr extends Pr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t,i){const n=this.length;return this.resize(n+1),this.emplace(n,e,t,i)}emplace(e,t,i,n){const r=3*e;return this.int16[r+0]=t,this.int16[r+1]=i,this.int16[r+2]=n,e}}Mr.prototype.bytesPerElement=6,Fn("StructArrayLayout3i6",Mr);class zr extends Pr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t,i,n){const r=this.length;return this.resize(r+1),this.emplace(r,e,t,i,n)}emplace(e,t,i,n,r){const a=4*e;return this.int16[a+0]=t,this.int16[a+1]=i,this.int16[a+2]=n,this.int16[a+3]=r,e}}zr.prototype.bytesPerElement=8,Fn("StructArrayLayout4i8",zr);class Dr extends Pr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t,i,n,r,a){const s=this.length;return this.resize(s+1),this.emplace(s,e,t,i,n,r,a)}emplace(e,t,i,n,r,a,s){const o=6*e;return this.int16[o+0]=t,this.int16[o+1]=i,this.int16[o+2]=n,this.int16[o+3]=r,this.int16[o+4]=a,this.int16[o+5]=s,e}}Dr.prototype.bytesPerElement=12,Fn("StructArrayLayout2i4i12",Dr);class Lr extends Pr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t,i,n,r,a){const s=this.length;return this.resize(s+1),this.emplace(s,e,t,i,n,r,a)}emplace(e,t,i,n,r,a,s){const o=4*e,l=8*e;return this.int16[o+0]=t,this.int16[o+1]=i,this.uint8[l+4]=n,this.uint8[l+5]=r,this.uint8[l+6]=a,this.uint8[l+7]=s,e}}Lr.prototype.bytesPerElement=8,Fn("StructArrayLayout2i4ub8",Lr);class Rr extends Pr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t){const i=this.length;return this.resize(i+1),this.emplace(i,e,t)}emplace(e,t,i){const n=2*e;return this.float32[n+0]=t,this.float32[n+1]=i,e}}Rr.prototype.bytesPerElement=8,Fn("StructArrayLayout2f8",Rr);class Fr extends Pr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,t,i,n,r,a,s,o,l,c){const u=this.length;return this.resize(u+1),this.emplace(u,e,t,i,n,r,a,s,o,l,c)}emplace(e,t,i,n,r,a,s,o,l,c,u){const h=10*e;return this.uint16[h+0]=t,this.uint16[h+1]=i,this.uint16[h+2]=n,this.uint16[h+3]=r,this.uint16[h+4]=a,this.uint16[h+5]=s,this.uint16[h+6]=o,this.uint16[h+7]=l,this.uint16[h+8]=c,this.uint16[h+9]=u,e}}Fr.prototype.bytesPerElement=20,Fn("StructArrayLayout10ui20",Fr);class Br extends Pr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,t,i,n,r,a,s,o,l,c,u,h){const d=this.length;return this.resize(d+1),this.emplace(d,e,t,i,n,r,a,s,o,l,c,u,h)}emplace(e,t,i,n,r,a,s,o,l,c,u,h,d){const p=12*e;return this.int16[p+0]=t,this.int16[p+1]=i,this.int16[p+2]=n,this.int16[p+3]=r,this.uint16[p+4]=a,this.uint16[p+5]=s,this.uint16[p+6]=o,this.uint16[p+7]=l,this.int16[p+8]=c,this.int16[p+9]=u,this.int16[p+10]=h,this.int16[p+11]=d,e}}Br.prototype.bytesPerElement=24,Fn("StructArrayLayout4i4ui4i24",Br);class Or extends Pr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,i){const n=this.length;return this.resize(n+1),this.emplace(n,e,t,i)}emplace(e,t,i,n){const r=3*e;return this.float32[r+0]=t,this.float32[r+1]=i,this.float32[r+2]=n,e}}Or.prototype.bytesPerElement=12,Fn("StructArrayLayout3f12",Or);class Nr extends Pr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e){const t=this.length;return this.resize(t+1),this.emplace(t,e)}emplace(e,t){return this.uint32[1*e+0]=t,e}}Nr.prototype.bytesPerElement=4,Fn("StructArrayLayout1ul4",Nr);class Vr extends Pr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,t,i,n,r,a,s,o,l){const c=this.length;return this.resize(c+1),this.emplace(c,e,t,i,n,r,a,s,o,l)}emplace(e,t,i,n,r,a,s,o,l,c){const u=10*e,h=5*e;return this.int16[u+0]=t,this.int16[u+1]=i,this.int16[u+2]=n,this.int16[u+3]=r,this.int16[u+4]=a,this.int16[u+5]=s,this.uint32[h+3]=o,this.uint16[u+8]=l,this.uint16[u+9]=c,e}}Vr.prototype.bytesPerElement=20,Fn("StructArrayLayout6i1ul2ui20",Vr);class jr extends Pr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t,i,n,r,a){const s=this.length;return this.resize(s+1),this.emplace(s,e,t,i,n,r,a)}emplace(e,t,i,n,r,a,s){const o=6*e;return this.int16[o+0]=t,this.int16[o+1]=i,this.int16[o+2]=n,this.int16[o+3]=r,this.int16[o+4]=a,this.int16[o+5]=s,e}}jr.prototype.bytesPerElement=12,Fn("StructArrayLayout2i2i2i12",jr);class Ur extends Pr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t,i,n,r){const a=this.length;return this.resize(a+1),this.emplace(a,e,t,i,n,r)}emplace(e,t,i,n,r,a){const s=4*e,o=8*e;return this.float32[s+0]=t,this.float32[s+1]=i,this.float32[s+2]=n,this.int16[o+6]=r,this.int16[o+7]=a,e}}Ur.prototype.bytesPerElement=16,Fn("StructArrayLayout2f1f2i16",Ur);class $r extends Pr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,i,n){const r=this.length;return this.resize(r+1),this.emplace(r,e,t,i,n)}emplace(e,t,i,n,r){const a=12*e,s=3*e;return this.uint8[a+0]=t,this.uint8[a+1]=i,this.float32[s+1]=n,this.float32[s+2]=r,e}}$r.prototype.bytesPerElement=12,Fn("StructArrayLayout2ub2f12",$r);class qr extends Pr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,t,i){const n=this.length;return this.resize(n+1),this.emplace(n,e,t,i)}emplace(e,t,i,n){const r=3*e;return this.uint16[r+0]=t,this.uint16[r+1]=i,this.uint16[r+2]=n,e}}qr.prototype.bytesPerElement=6,Fn("StructArrayLayout3ui6",qr);class Zr extends Pr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,i,n,r,a,s,o,l,c,u,h,d,p,f,m,g){const y=this.length;return this.resize(y+1),this.emplace(y,e,t,i,n,r,a,s,o,l,c,u,h,d,p,f,m,g)}emplace(e,t,i,n,r,a,s,o,l,c,u,h,d,p,f,m,g,y){const _=24*e,v=12*e,x=48*e;return this.int16[_+0]=t,this.int16[_+1]=i,this.uint16[_+2]=n,this.uint16[_+3]=r,this.uint32[v+2]=a,this.uint32[v+3]=s,this.uint32[v+4]=o,this.uint16[_+10]=l,this.uint16[_+11]=c,this.uint16[_+12]=u,this.float32[v+7]=h,this.float32[v+8]=d,this.uint8[x+36]=p,this.uint8[x+37]=f,this.uint8[x+38]=m,this.uint32[v+10]=g,this.int16[_+22]=y,e}}Zr.prototype.bytesPerElement=48,Fn("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",Zr);class Gr extends Pr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,i,n,r,a,s,o,l,c,u,h,d,p,f,m,g,y,_,v,x,b,w,S,T,k,E,P){const C=this.length;return this.resize(C+1),this.emplace(C,e,t,i,n,r,a,s,o,l,c,u,h,d,p,f,m,g,y,_,v,x,b,w,S,T,k,E,P)}emplace(e,t,i,n,r,a,s,o,l,c,u,h,d,p,f,m,g,y,_,v,x,b,w,S,T,k,E,P,C){const I=32*e,A=16*e;return this.int16[I+0]=t,this.int16[I+1]=i,this.int16[I+2]=n,this.int16[I+3]=r,this.int16[I+4]=a,this.int16[I+5]=s,this.int16[I+6]=o,this.int16[I+7]=l,this.uint16[I+8]=c,this.uint16[I+9]=u,this.uint16[I+10]=h,this.uint16[I+11]=d,this.uint16[I+12]=p,this.uint16[I+13]=f,this.uint16[I+14]=m,this.uint16[I+15]=g,this.uint16[I+16]=y,this.uint16[I+17]=_,this.uint16[I+18]=v,this.uint16[I+19]=x,this.uint16[I+20]=b,this.uint16[I+21]=w,this.uint16[I+22]=S,this.uint32[A+12]=T,this.float32[A+13]=k,this.float32[A+14]=E,this.uint16[I+30]=P,this.uint16[I+31]=C,e}}Gr.prototype.bytesPerElement=64,Fn("StructArrayLayout8i15ui1ul2f2ui64",Gr);class Wr extends Pr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e){const t=this.length;return this.resize(t+1),this.emplace(t,e)}emplace(e,t){return this.float32[1*e+0]=t,e}}Wr.prototype.bytesPerElement=4,Fn("StructArrayLayout1f4",Wr);class Hr extends Pr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,i){const n=this.length;return this.resize(n+1),this.emplace(n,e,t,i)}emplace(e,t,i,n){const r=3*e;return this.uint16[6*e+0]=t,this.float32[r+1]=i,this.float32[r+2]=n,e}}Hr.prototype.bytesPerElement=12,Fn("StructArrayLayout1ui2f12",Hr);class Xr extends Pr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,t,i){const n=this.length;return this.resize(n+1),this.emplace(n,e,t,i)}emplace(e,t,i,n){const r=4*e;return this.uint32[2*e+0]=t,this.uint16[r+2]=i,this.uint16[r+3]=n,e}}Xr.prototype.bytesPerElement=8,Fn("StructArrayLayout1ul2ui8",Xr);class Kr extends Pr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,t){const i=this.length;return this.resize(i+1),this.emplace(i,e,t)}emplace(e,t,i){const n=2*e;return this.uint16[n+0]=t,this.uint16[n+1]=i,e}}Kr.prototype.bytesPerElement=4,Fn("StructArrayLayout2ui4",Kr);class Yr extends Pr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e){const t=this.length;return this.resize(t+1),this.emplace(t,e)}emplace(e,t){return this.uint16[1*e+0]=t,e}}Yr.prototype.bytesPerElement=2,Fn("StructArrayLayout1ui2",Yr);class Jr extends Pr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,i,n){const r=this.length;return this.resize(r+1),this.emplace(r,e,t,i,n)}emplace(e,t,i,n,r){const a=4*e;return this.float32[a+0]=t,this.float32[a+1]=i,this.float32[a+2]=n,this.float32[a+3]=r,e}}Jr.prototype.bytesPerElement=16,Fn("StructArrayLayout4f16",Jr);class Qr extends Er{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new a(this.anchorPointX,this.anchorPointY)}}Qr.prototype.size=20;class ea extends Vr{get(e){return new Qr(this,e)}}Fn("CollisionBoxArray",ea);class ta extends Er{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(e){this._structArray.uint8[this._pos1+37]=e}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(e){this._structArray.uint8[this._pos1+38]=e}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(e){this._structArray.uint32[this._pos4+10]=e}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}ta.prototype.size=48;class ia extends Zr{get(e){return new ta(this,e)}}Fn("PlacedSymbolArray",ia);class na extends Er{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(e){this._structArray.uint32[this._pos4+12]=e}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}na.prototype.size=64;class ra extends Gr{get(e){return new na(this,e)}}Fn("SymbolInstanceArray",ra);class aa extends Wr{getoffsetX(e){return this.float32[1*e+0]}}Fn("GlyphOffsetArray",aa);class sa extends Mr{getx(e){return this.int16[3*e+0]}gety(e){return this.int16[3*e+1]}gettileUnitDistanceFromAnchor(e){return this.int16[3*e+2]}}Fn("SymbolLineVertexArray",sa);class oa extends Er{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}oa.prototype.size=12;class la extends Hr{get(e){return new oa(this,e)}}Fn("TextAnchorOffsetArray",la);class ca extends Er{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}ca.prototype.size=8;class ua extends Xr{get(e){return new ca(this,e)}}Fn("FeatureIndexArray",ua);class ha extends Ar{}class da extends Ar{}class pa extends Ar{}class fa extends Dr{}class ma extends Lr{}class ga extends Rr{}class ya extends Fr{}class _a extends Br{}class va extends Or{}class xa extends Nr{}class ba extends jr{}class wa extends $r{}class Sa extends qr{}class Ta extends Kr{}const ka=Cr([{name:"a_pos",components:2,type:"Int16"}],4),{members:Ea}=ka;class Pa{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.segments=e}prepareSegment(e,t,i,n){let r=this.segments[this.segments.length-1];return e>Pa.MAX_VERTEX_ARRAY_LENGTH&&S(`Max vertices per segment is ${Pa.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${e}`),(!r||r.vertexLength+e>Pa.MAX_VERTEX_ARRAY_LENGTH||r.sortKey!==n)&&(r={vertexOffset:t.length,primitiveOffset:i.length,vertexLength:0,primitiveLength:0},void 0!==n&&(r.sortKey=n),this.segments.push(r)),r}get(){return this.segments}destroy(){for(const e of this.segments)for(const t in e.vaos)e.vaos[t].destroy()}static simpleSegment(e,t,i,n){return new Pa([{vertexOffset:e,primitiveOffset:t,vertexLength:i,primitiveLength:n,vaos:{},sortKey:0}])}}function Ca(e,t){return 256*(e=m(Math.floor(e),0,255))+m(Math.floor(t),0,255)}Pa.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Fn("SegmentVector",Pa);const Ia=Cr([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var Aa={exports:{}},Ma={exports:{}};Ma.exports=function(e,t){var i,n,r,a,s,o,l,c;for(n=e.length-(i=3&e.length),r=t,s=3432918353,o=461845907,c=0;c<n;)l=255&e.charCodeAt(c)|(255&e.charCodeAt(++c))<<8|(255&e.charCodeAt(++c))<<16|(255&e.charCodeAt(++c))<<24,++c,r=27492+(65535&(a=5*(65535&(r=(r^=l=(65535&(l=(l=(65535&l)*s+(((l>>>16)*s&65535)<<16)&4294967295)<<15|l>>>17))*o+(((l>>>16)*o&65535)<<16)&4294967295)<<13|r>>>19))+((5*(r>>>16)&65535)<<16)&4294967295))+((58964+(a>>>16)&65535)<<16);switch(l=0,i){case 3:l^=(255&e.charCodeAt(c+2))<<16;case 2:l^=(255&e.charCodeAt(c+1))<<8;case 1:r^=l=(65535&(l=(l=(65535&(l^=255&e.charCodeAt(c)))*s+(((l>>>16)*s&65535)<<16)&4294967295)<<15|l>>>17))*o+(((l>>>16)*o&65535)<<16)&4294967295}return r^=e.length,r=2246822507*(65535&(r^=r>>>16))+((2246822507*(r>>>16)&65535)<<16)&4294967295,r=3266489909*(65535&(r^=r>>>13))+((3266489909*(r>>>16)&65535)<<16)&4294967295,(r^=r>>>16)>>>0};var za=Ma.exports,Da={exports:{}};Da.exports=function(e,t){for(var i,n=e.length,r=t^n,a=0;n>=4;)i=1540483477*(65535&(i=255&e.charCodeAt(a)|(255&e.charCodeAt(++a))<<8|(255&e.charCodeAt(++a))<<16|(255&e.charCodeAt(++a))<<24))+((1540483477*(i>>>16)&65535)<<16),r=1540483477*(65535&r)+((1540483477*(r>>>16)&65535)<<16)^(i=1540483477*(65535&(i^=i>>>24))+((1540483477*(i>>>16)&65535)<<16)),n-=4,++a;switch(n){case 3:r^=(255&e.charCodeAt(a+2))<<16;case 2:r^=(255&e.charCodeAt(a+1))<<8;case 1:r=1540483477*(65535&(r^=255&e.charCodeAt(a)))+((1540483477*(r>>>16)&65535)<<16)}return r=1540483477*(65535&(r^=r>>>13))+((1540483477*(r>>>16)&65535)<<16),(r^=r>>>15)>>>0};var La=za,Ra=Da.exports;Aa.exports=La,Aa.exports.murmur3=La,Aa.exports.murmur2=Ra;var Fa=i(Aa.exports);class Ba{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(e,t,i,n){this.ids.push(Oa(e)),this.positions.push(t,i,n)}getPositions(e){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const t=Oa(e);let i=0,n=this.ids.length-1;for(;i<n;){const e=i+n>>1;this.ids[e]>=t?n=e:i=e+1}const r=[];for(;this.ids[i]===t;)r.push({index:this.positions[3*i],start:this.positions[3*i+1],end:this.positions[3*i+2]}),i++;return r}static serialize(e,t){const i=new Float64Array(e.ids),n=new Uint32Array(e.positions);return Na(i,n,0,i.length-1),t&&t.push(i.buffer,n.buffer),{ids:i,positions:n}}static deserialize(e){const t=new Ba;return t.ids=e.ids,t.positions=e.positions,t.indexed=!0,t}}function Oa(e){const t=+e;return!isNaN(t)&&t<=Number.MAX_SAFE_INTEGER?t:Fa(String(e))}function Na(e,t,i,n){for(;i<n;){const r=e[i+n>>1];let a=i-1,s=n+1;for(;;){do{a++}while(e[a]<r);do{s--}while(e[s]>r);if(a>=s)break;Va(e,a,s),Va(t,3*a,3*s),Va(t,3*a+1,3*s+1),Va(t,3*a+2,3*s+2)}s-i<n-s?(Na(e,t,i,s),i=s+1):(Na(e,t,s+1,n),n=s)}}function Va(e,t,i){const n=e[t];e[t]=e[i],e[i]=n}Fn("FeaturePositionMap",Ba);class ja{constructor(e,t){this.gl=e.gl,this.location=t}}class Ua extends ja{constructor(e,t){super(e,t),this.current=0}set(e){this.current!==e&&(this.current=e,this.gl.uniform1f(this.location,e))}}class $a extends ja{constructor(e,t){super(e,t),this.current=[0,0,0,0]}set(e){e[0]===this.current[0]&&e[1]===this.current[1]&&e[2]===this.current[2]&&e[3]===this.current[3]||(this.current=e,this.gl.uniform4f(this.location,e[0],e[1],e[2],e[3]))}}class qa extends ja{constructor(e,t){super(e,t),this.current=Ke.transparent}set(e){e.r===this.current.r&&e.g===this.current.g&&e.b===this.current.b&&e.a===this.current.a||(this.current=e,this.gl.uniform4f(this.location,e.r,e.g,e.b,e.a))}}const Za=new Float32Array(16);function Ga(e){return[Ca(255*e.r,255*e.g),Ca(255*e.b,255*e.a)]}class Wa{constructor(e,t,i){this.value=e,this.uniformNames=t.map((e=>`u_${e}`)),this.type=i}setUniform(e,t,i){e.set(i.constantOr(this.value))}getBinding(e,t,i){return"color"===this.type?new qa(e,t):new Ua(e,t)}}class Ha{constructor(e,t){this.uniformNames=t.map((e=>`u_${e}`)),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(e,t){this.pixelRatioFrom=t.pixelRatio,this.pixelRatioTo=e.pixelRatio,this.patternFrom=t.tlbr,this.patternTo=e.tlbr}setUniform(e,t,i,n){const r="u_pattern_to"===n?this.patternTo:"u_pattern_from"===n?this.patternFrom:"u_pixel_ratio_to"===n?this.pixelRatioTo:"u_pixel_ratio_from"===n?this.pixelRatioFrom:null;r&&e.set(r)}getBinding(e,t,i){return"u_pattern"===i.substr(0,9)?new $a(e,t):new Ua(e,t)}}class Xa{constructor(e,t,i,n){this.expression=e,this.type=i,this.maxValue=0,this.paintVertexAttributes=t.map((e=>({name:`a_${e}`,type:"Float32",components:"color"===i?2:1,offset:0}))),this.paintVertexArray=new n}populatePaintArray(e,t,i,n,r){const a=this.paintVertexArray.length,s=this.expression.evaluate(new lr(0),t,{},n,[],r);this.paintVertexArray.resize(e),this._setPaintValue(a,e,s)}updatePaintArray(e,t,i,n){const r=this.expression.evaluate({zoom:0},i,n);this._setPaintValue(e,t,r)}_setPaintValue(e,t,i){if("color"===this.type){const n=Ga(i);for(let i=e;i<t;i++)this.paintVertexArray.emplace(i,n[0],n[1])}else{for(let n=e;n<t;n++)this.paintVertexArray.emplace(n,i);this.maxValue=Math.max(this.maxValue,Math.abs(i))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Ka{constructor(e,t,i,n,r,a){this.expression=e,this.uniformNames=t.map((e=>`u_${e}_t`)),this.type=i,this.useIntegerZoom=n,this.zoom=r,this.maxValue=0,this.paintVertexAttributes=t.map((e=>({name:`a_${e}`,type:"Float32",components:"color"===i?4:2,offset:0}))),this.paintVertexArray=new a}populatePaintArray(e,t,i,n,r){const a=this.expression.evaluate(new lr(this.zoom),t,{},n,[],r),s=this.expression.evaluate(new lr(this.zoom+1),t,{},n,[],r),o=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(o,e,a,s)}updatePaintArray(e,t,i,n){const r=this.expression.evaluate({zoom:this.zoom},i,n),a=this.expression.evaluate({zoom:this.zoom+1},i,n);this._setPaintValue(e,t,r,a)}_setPaintValue(e,t,i,n){if("color"===this.type){const r=Ga(i),a=Ga(n);for(let i=e;i<t;i++)this.paintVertexArray.emplace(i,r[0],r[1],a[0],a[1])}else{for(let r=e;r<t;r++)this.paintVertexArray.emplace(r,i,n);this.maxValue=Math.max(this.maxValue,Math.abs(i),Math.abs(n))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(e,t){const i=this.useIntegerZoom?Math.floor(t.zoom):t.zoom,n=m(this.expression.interpolationFactor(i,this.zoom,this.zoom+1),0,1);e.set(n)}getBinding(e,t,i){return new Ua(e,t)}}class Ya{constructor(e,t,i,n,r,a){this.expression=e,this.type=t,this.useIntegerZoom=i,this.zoom=n,this.layerId=a,this.zoomInPaintVertexArray=new r,this.zoomOutPaintVertexArray=new r}populatePaintArray(e,t,i){const n=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(e),this.zoomOutPaintVertexArray.resize(e),this._setPaintValues(n,e,t.patterns&&t.patterns[this.layerId],i)}updatePaintArray(e,t,i,n,r){this._setPaintValues(e,t,i.patterns&&i.patterns[this.layerId],r)}_setPaintValues(e,t,i,n){if(!n||!i)return;const{min:r,mid:a,max:s}=i,o=n[r],l=n[a],c=n[s];if(o&&l&&c)for(let u=e;u<t;u++)this.zoomInPaintVertexArray.emplace(u,l.tl[0],l.tl[1],l.br[0],l.br[1],o.tl[0],o.tl[1],o.br[0],o.br[1],l.pixelRatio,o.pixelRatio),this.zoomOutPaintVertexArray.emplace(u,l.tl[0],l.tl[1],l.br[0],l.br[1],c.tl[0],c.tl[1],c.br[0],c.br[1],l.pixelRatio,c.pixelRatio)}upload(e){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=e.createVertexBuffer(this.zoomInPaintVertexArray,Ia.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=e.createVertexBuffer(this.zoomOutPaintVertexArray,Ia.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class Ja{constructor(e,t,i){this.binders={},this._buffers=[];const n=[];for(const r in e.paint._values){if(!i(r))continue;const a=e.paint.get(r);if(!(a instanceof mr&&wi(a.property.specification)))continue;const s=es(r,e.type),o=a.value,l=a.property.specification.type,c=a.property.useIntegerZoom,u=a.property.specification["property-type"],h="cross-faded"===u||"cross-faded-data-driven"===u;if("constant"===o.kind)this.binders[r]=h?new Ha(o.value,s):new Wa(o.value,s,l),n.push(`/u_${r}`);else if("source"===o.kind||h){const i=ts(r,l,"source");this.binders[r]=h?new Ya(o,l,c,t,i,e.id):new Xa(o,s,l,i),n.push(`/a_${r}`)}else{const e=ts(r,l,"composite");this.binders[r]=new Ka(o,s,l,c,t,e),n.push(`/z_${r}`)}}this.cacheKey=n.sort().join("")}getMaxValue(e){const t=this.binders[e];return t instanceof Xa||t instanceof Ka?t.maxValue:0}populatePaintArrays(e,t,i,n,r){for(const a in this.binders){const s=this.binders[a];(s instanceof Xa||s instanceof Ka||s instanceof Ya)&&s.populatePaintArray(e,t,i,n,r)}}setConstantPatternPositions(e,t){for(const i in this.binders){const n=this.binders[i];n instanceof Ha&&n.setConstantPatternPositions(e,t)}}updatePaintArrays(e,t,i,n,r){let a=!1;for(const s in e){const o=t.getPositions(s);for(const t of o){const o=i.feature(t.index);for(const i in this.binders){const l=this.binders[i];if((l instanceof Xa||l instanceof Ka||l instanceof Ya)&&!0===l.expression.isStateDependent){const c=n.paint.get(i);l.expression=c.value,l.updatePaintArray(t.start,t.end,o,e[s],r),a=!0}}}}return a}defines(){const e=[];for(const t in this.binders){const i=this.binders[t];(i instanceof Wa||i instanceof Ha)&&e.push(...i.uniformNames.map((e=>`#define HAS_UNIFORM_${e}`)))}return e}getBinderAttributes(){const e=[];for(const t in this.binders){const i=this.binders[t];if(i instanceof Xa||i instanceof Ka)for(let t=0;t<i.paintVertexAttributes.length;t++)e.push(i.paintVertexAttributes[t].name);else if(i instanceof Ya)for(let t=0;t<Ia.members.length;t++)e.push(Ia.members[t].name)}return e}getBinderUniforms(){const e=[];for(const t in this.binders){const i=this.binders[t];if(i instanceof Wa||i instanceof Ha||i instanceof Ka)for(const t of i.uniformNames)e.push(t)}return e}getPaintVertexBuffers(){return this._buffers}getUniforms(e,t){const i=[];for(const n in this.binders){const r=this.binders[n];if(r instanceof Wa||r instanceof Ha||r instanceof Ka)for(const a of r.uniformNames)if(t[a]){const s=r.getBinding(e,t[a],a);i.push({name:a,property:n,binding:s})}}return i}setUniforms(e,t,i,n){for(const{name:r,property:a,binding:s}of t)this.binders[a].setUniform(s,n,i.get(a),r)}updatePaintBuffers(e){this._buffers=[];for(const t in this.binders){const i=this.binders[t];if(e&&i instanceof Ya){const t=2===e.fromScale?i.zoomInPaintVertexBuffer:i.zoomOutPaintVertexBuffer;t&&this._buffers.push(t)}else(i instanceof Xa||i instanceof Ka)&&i.paintVertexBuffer&&this._buffers.push(i.paintVertexBuffer)}}upload(e){for(const t in this.binders){const i=this.binders[t];(i instanceof Xa||i instanceof Ka||i instanceof Ya)&&i.upload(e)}this.updatePaintBuffers()}destroy(){for(const e in this.binders){const t=this.binders[e];(t instanceof Xa||t instanceof Ka||t instanceof Ya)&&t.destroy()}}}class Qa{constructor(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>!0;this.programConfigurations={};for(const n of e)this.programConfigurations[n.id]=new Ja(n,t,i);this.needsUpload=!1,this._featureMap=new Ba,this._bufferOffset=0}populatePaintArrays(e,t,i,n,r,a){for(const s in this.programConfigurations)this.programConfigurations[s].populatePaintArrays(e,t,n,r,a);void 0!==t.id&&this._featureMap.add(t.id,i,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0}updatePaintArrays(e,t,i,n){for(const r of i)this.needsUpload=this.programConfigurations[r.id].updatePaintArrays(e,this._featureMap,t,r,n)||this.needsUpload}get(e){return this.programConfigurations[e]}upload(e){if(this.needsUpload){for(const t in this.programConfigurations)this.programConfigurations[t].upload(e);this.needsUpload=!1}}destroy(){for(const e in this.programConfigurations)this.programConfigurations[e].destroy()}}function es(e,t){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[e]||[e.replace(`${t}-`,"").replace(/-/g,"_")]}function ts(e,t,i){const n={color:{source:Rr,composite:Jr},number:{source:Wr,composite:Rr}},r=function(e){return{"line-pattern":{source:ya,composite:ya},"fill-pattern":{source:ya,composite:ya},"fill-extrusion-pattern":{source:ya,composite:ya}}[e]}(e);return r&&r[i]||n[t][i]}Fn("ConstantBinder",Wa),Fn("CrossFadedConstantBinder",Ha),Fn("SourceExpressionBinder",Xa),Fn("CrossFadedCompositeBinder",Ya),Fn("CompositeExpressionBinder",Ka),Fn("ProgramConfiguration",Ja,{omit:["_buffers"]}),Fn("ProgramConfigurationSet",Qa);const is=8192,ns=Math.pow(2,14)-1,rs=-ns-1;function as(e){const t=is/e.extent,i=e.loadGeometry();for(let n=0;n<i.length;n++){const e=i[n];for(let i=0;i<e.length;i++){const n=e[i],r=Math.round(n.x*t),a=Math.round(n.y*t);n.x=m(r,rs,ns),n.y=m(a,rs,ns),(r<n.x||r>n.x+1||a<n.y||a>n.y+1)&&S("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return i}function ss(e,t){return{type:e.type,id:e.id,properties:e.properties,geometry:t?as(e):[]}}function os(e,t,i,n,r){e.emplaceBack(2*t+(n+1)/2,2*i+(r+1)/2)}class ls{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((e=>e.id)),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new da,this.indexArray=new Sa,this.segments=new Pa,this.programConfigurations=new Qa(e.layers,e.zoom),this.stateDependentLayerIds=this.layers.filter((e=>e.isStateDependent())).map((e=>e.id))}populate(e,t,i){const n=this.layers[0],r=[];let a=null,s=!1;"circle"===n.type&&(a=n.layout.get("circle-sort-key"),s=!a.isConstant());for(const{feature:o,id:l,index:c,sourceLayerIndex:u}of e){const e=this.layers[0]._featureFilter.needGeometry,t=ss(o,e);if(!this.layers[0]._featureFilter.filter(new lr(this.zoom),t,i))continue;const n=s?a.evaluate(t,{},i):void 0,h={id:l,properties:o.properties,type:o.type,sourceLayerIndex:u,index:c,geometry:e?t.geometry:as(o),patterns:{},sortKey:n};r.push(h)}s&&r.sort(((e,t)=>e.sortKey-t.sortKey));for(const o of r){const{geometry:n,index:r,sourceLayerIndex:a}=o,s=e[r].feature;this.addFeature(o,n,r,i),t.featureIndex.insert(s,n,r,a,this.index)}}update(e,t,i){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,i)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Ea),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(e,t,i,n){for(const r of t)for(const t of r){const i=t.x,n=t.y;if(i<0||i>=is||n<0||n>=is)continue;const r=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),a=r.vertexLength;os(this.layoutVertexArray,i,n,-1,-1),os(this.layoutVertexArray,i,n,1,-1),os(this.layoutVertexArray,i,n,1,1),os(this.layoutVertexArray,i,n,-1,1),this.indexArray.emplaceBack(a,a+1,a+2),this.indexArray.emplaceBack(a,a+3,a+2),r.vertexLength+=4,r.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,i,{},n)}}function cs(e,t){for(let i=0;i<e.length;i++)if(_s(t,e[i]))return!0;for(let i=0;i<t.length;i++)if(_s(e,t[i]))return!0;return!!ps(e,t)}function us(e,t,i){return!!_s(e,t)||!!ms(t,e,i)}function hs(e,t){if(1===e.length)return ys(t,e[0]);for(let i=0;i<t.length;i++){const n=t[i];for(let t=0;t<n.length;t++)if(_s(e,n[t]))return!0}for(let i=0;i<e.length;i++)if(ys(t,e[i]))return!0;for(let i=0;i<t.length;i++)if(ps(e,t[i]))return!0;return!1}function ds(e,t,i){if(e.length>1){if(ps(e,t))return!0;for(let n=0;n<t.length;n++)if(ms(t[n],e,i))return!0}for(let n=0;n<e.length;n++)if(ms(e[n],t,i))return!0;return!1}function ps(e,t){if(0===e.length||0===t.length)return!1;for(let i=0;i<e.length-1;i++){const n=e[i],r=e[i+1];for(let e=0;e<t.length-1;e++)if(fs(n,r,t[e],t[e+1]))return!0}return!1}function fs(e,t,i,n){return T(e,i,n)!==T(t,i,n)&&T(e,t,i)!==T(e,t,n)}function ms(e,t,i){const n=i*i;if(1===t.length)return e.distSqr(t[0])<n;for(let r=1;r<t.length;r++)if(gs(e,t[r-1],t[r])<n)return!0;return!1}function gs(e,t,i){const n=t.distSqr(i);if(0===n)return e.distSqr(t);const r=((e.x-t.x)*(i.x-t.x)+(e.y-t.y)*(i.y-t.y))/n;return e.distSqr(r<0?t:r>1?i:i.sub(t)._mult(r)._add(t))}function ys(e,t){let i,n,r,a=!1;for(let s=0;s<e.length;s++){i=e[s];for(let e=0,s=i.length-1;e<i.length;s=e++)n=i[e],r=i[s],n.y>t.y!=r.y>t.y&&t.x<(r.x-n.x)*(t.y-n.y)/(r.y-n.y)+n.x&&(a=!a)}return a}function _s(e,t){let i=!1;for(let n=0,r=e.length-1;n<e.length;r=n++){const a=e[n],s=e[r];a.y>t.y!=s.y>t.y&&t.x<(s.x-a.x)*(t.y-a.y)/(s.y-a.y)+a.x&&(i=!i)}return i}function vs(e,t,i){const n=i[0],r=i[2];if(e.x<n.x&&t.x<n.x||e.x>r.x&&t.x>r.x||e.y<n.y&&t.y<n.y||e.y>r.y&&t.y>r.y)return!1;const a=T(e,t,i[0]);return a!==T(e,t,i[1])||a!==T(e,t,i[2])||a!==T(e,t,i[3])}function xs(e,t,i){const n=t.paint.get(e).value;return"constant"===n.kind?n.value:i.programConfigurations.get(t.id).getMaxValue(e)}function bs(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])}function ws(e,t,i,n,r){if(!t[0]&&!t[1])return e;const s=a.convert(t)._mult(r);"viewport"===i&&s._rotate(-n);const o=[];for(let a=0;a<e.length;a++)o.push(e[a].sub(s));return o}let Ss,Ts;Fn("CircleBucket",ls,{omit:["layers"]});var ks={get paint(){return Ts=Ts||new wr({"circle-radius":new _r(X.paint_circle["circle-radius"]),"circle-color":new _r(X.paint_circle["circle-color"]),"circle-blur":new _r(X.paint_circle["circle-blur"]),"circle-opacity":new _r(X.paint_circle["circle-opacity"]),"circle-translate":new yr(X.paint_circle["circle-translate"]),"circle-translate-anchor":new yr(X.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new yr(X.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new yr(X.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new _r(X.paint_circle["circle-stroke-width"]),"circle-stroke-color":new _r(X.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new _r(X.paint_circle["circle-stroke-opacity"])})},get layout(){return Ss=Ss||new wr({"circle-sort-key":new _r(X.layout_circle["circle-sort-key"])})}},Es=1e-6,Ps="undefined"!=typeof Float32Array?Float32Array:Array;function Cs(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Is(e,t,i){var n=t[0],r=t[1],a=t[2],s=t[3],o=t[4],l=t[5],c=t[6],u=t[7],h=t[8],d=t[9],p=t[10],f=t[11],m=t[12],g=t[13],y=t[14],_=t[15],v=i[0],x=i[1],b=i[2],w=i[3];return e[0]=v*n+x*o+b*h+w*m,e[1]=v*r+x*l+b*d+w*g,e[2]=v*a+x*c+b*p+w*y,e[3]=v*s+x*u+b*f+w*_,e[4]=(v=i[4])*n+(x=i[5])*o+(b=i[6])*h+(w=i[7])*m,e[5]=v*r+x*l+b*d+w*g,e[6]=v*a+x*c+b*p+w*y,e[7]=v*s+x*u+b*f+w*_,e[8]=(v=i[8])*n+(x=i[9])*o+(b=i[10])*h+(w=i[11])*m,e[9]=v*r+x*l+b*d+w*g,e[10]=v*a+x*c+b*p+w*y,e[11]=v*s+x*u+b*f+w*_,e[12]=(v=i[12])*n+(x=i[13])*o+(b=i[14])*h+(w=i[15])*m,e[13]=v*r+x*l+b*d+w*g,e[14]=v*a+x*c+b*p+w*y,e[15]=v*s+x*u+b*f+w*_,e}Math.hypot||(Math.hypot=function(){for(var e=0,t=arguments.length;t--;)e+=arguments[t]*arguments[t];return Math.sqrt(e)});var As,Ms=Is;function zs(e,t,i){var n=t[0],r=t[1],a=t[2],s=t[3];return e[0]=i[0]*n+i[4]*r+i[8]*a+i[12]*s,e[1]=i[1]*n+i[5]*r+i[9]*a+i[13]*s,e[2]=i[2]*n+i[6]*r+i[10]*a+i[14]*s,e[3]=i[3]*n+i[7]*r+i[11]*a+i[15]*s,e}As=new Ps(4),Ps!=Float32Array&&(As[0]=0,As[1]=0,As[2]=0,As[3]=0);class Ds extends Tr{constructor(e){super(e,ks)}createBucket(e){return new ls(e)}queryRadius(e){const t=e;return xs("circle-radius",this,t)+xs("circle-stroke-width",this,t)+bs(this.paint.get("circle-translate"))}queryIntersectsFeature(e,t,i,n,r,a,s,o){const l=ws(e,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),a.angle,s),c=this.paint.get("circle-radius").evaluate(t,i)+this.paint.get("circle-stroke-width").evaluate(t,i),u="map"===this.paint.get("circle-pitch-alignment"),h=u?l:function(e,t){return e.map((e=>Ls(e,t)))}(l,o),d=u?c*s:c;for(const p of n)for(const e of p){const t=u?e:Ls(e,o);let i=d;const n=zs([],[e.x,e.y,0,1],o);if("viewport"===this.paint.get("circle-pitch-scale")&&"map"===this.paint.get("circle-pitch-alignment")?i*=n[3]/a.cameraToCenterDistance:"map"===this.paint.get("circle-pitch-scale")&&"viewport"===this.paint.get("circle-pitch-alignment")&&(i*=a.cameraToCenterDistance/n[3]),us(h,t,i))return!0}return!1}}function Ls(e,t){const i=zs([],[e.x,e.y,0,1],t);return new a(i[0]/i[3],i[1]/i[3])}class Rs extends ls{}let Fs;Fn("HeatmapBucket",Rs,{omit:["layers"]});var Bs={get paint(){return Fs=Fs||new wr({"heatmap-radius":new _r(X.paint_heatmap["heatmap-radius"]),"heatmap-weight":new _r(X.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new yr(X.paint_heatmap["heatmap-intensity"]),"heatmap-color":new br(X.paint_heatmap["heatmap-color"]),"heatmap-opacity":new yr(X.paint_heatmap["heatmap-opacity"])})}};function Os(e,t,i,n){let{width:r,height:a}=t;if(n){if(n instanceof Uint8ClampedArray)n=new Uint8Array(n.buffer);else if(n.length!==r*a*i)throw new RangeError(`mismatched image size. expected: ${n.length} but got: ${r*a*i}`)}else n=new Uint8Array(r*a*i);return e.width=r,e.height=a,e.data=n,e}function Ns(e,t,i){let{width:n,height:r}=t;if(n===e.width&&r===e.height)return;const a=Os({},{width:n,height:r},i);Vs(e,a,{x:0,y:0},{x:0,y:0},{width:Math.min(e.width,n),height:Math.min(e.height,r)},i),e.width=n,e.height=r,e.data=a.data}function Vs(e,t,i,n,r,a){if(0===r.width||0===r.height)return t;if(r.width>e.width||r.height>e.height||i.x>e.width-r.width||i.y>e.height-r.height)throw new RangeError("out of range source coordinates for image copy");if(r.width>t.width||r.height>t.height||n.x>t.width-r.width||n.y>t.height-r.height)throw new RangeError("out of range destination coordinates for image copy");const s=e.data,o=t.data;if(s===o)throw new Error("srcData equals dstData, so image is already copied");for(let l=0;l<r.height;l++){const c=((i.y+l)*e.width+i.x)*a,u=((n.y+l)*t.width+n.x)*a;for(let e=0;e<r.width*a;e++)o[u+e]=s[c+e]}return t}class js{constructor(e,t){Os(this,e,1,t)}resize(e){Ns(this,e,1)}clone(){return new js({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,t,i,n,r){Vs(e,t,i,n,r,1)}}class Us{constructor(e,t){Os(this,e,4,t)}resize(e){Ns(this,e,4)}replace(e,t){t?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e}clone(){return new Us({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,t,i,n,r){Vs(e,t,i,n,r,4)}}function $s(e){const t={},i=e.resolution||256,n=e.clips?e.clips.length:1,r=e.image||new Us({width:i,height:n});if(Math.log(i)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${i}`);const a=(i,n,a)=>{t[e.evaluationKey]=a;const s=e.expression.evaluate(t);r.data[i+n+0]=Math.floor(255*s.r/s.a),r.data[i+n+1]=Math.floor(255*s.g/s.a),r.data[i+n+2]=Math.floor(255*s.b/s.a),r.data[i+n+3]=Math.floor(255*s.a)};if(e.clips)for(let s=0,o=0;s<n;++s,o+=4*i)for(let t=0,n=0;t<i;t++,n+=4){const r=t/(i-1),{start:l,end:c}=e.clips[s];a(o,n,l*(1-r)+c*r)}else for(let s=0,o=0;s<i;s++,o+=4)a(0,o,s/(i-1));return r}Fn("AlphaImage",js),Fn("RGBAImage",Us);class qs extends Tr{createBucket(e){return new Rs(e)}constructor(e){super(e,Bs),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(e){"heatmap-color"===e&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=$s({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility}}let Zs;var Gs={get paint(){return Zs=Zs||new wr({"hillshade-illumination-direction":new yr(X.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new yr(X.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new yr(X.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new yr(X.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new yr(X.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new yr(X.paint_hillshade["hillshade-accent-color"])})}};class Ws extends Tr{constructor(e){super(e,Gs)}hasOffscreenPass(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility}}const Hs=Cr([{name:"a_pos",components:2,type:"Int16"}],4),{members:Xs}=Hs;var Ks={exports:{}};function Ys(e,t,i){i=i||2;var n,r,a,s,o,l,c,u=t&&t.length,h=u?t[0]*i:e.length,d=Js(e,0,h,i,!0),p=[];if(!d||d.next===d.prev)return p;if(u&&(d=function(e,t,i,n){var r,a,s,o=[];for(r=0,a=t.length;r<a;r++)(s=Js(e,t[r]*n,r<a-1?t[r+1]*n:e.length,n,!1))===s.next&&(s.steiner=!0),o.push(co(s));for(o.sort(ao),r=0;r<o.length;r++)i=so(o[r],i);return i}(e,t,d,i)),e.length>80*i){n=a=e[0],r=s=e[1];for(var f=i;f<h;f+=i)(o=e[f])<n&&(n=o),(l=e[f+1])<r&&(r=l),o>a&&(a=o),l>s&&(s=l);c=0!==(c=Math.max(a-n,s-r))?32767/c:0}return eo(d,p,i,n,r,c,0),p}function Js(e,t,i,n,r){var a,s;if(r===So(e,t,i,n)>0)for(a=t;a<i;a+=n)s=xo(a,e[a],e[a+1],s);else for(a=i-n;a>=t;a-=n)s=xo(a,e[a],e[a+1],s);return s&&fo(s,s.next)&&(bo(s),s=s.next),s}function Qs(e,t){if(!e)return e;t||(t=e);var i,n=e;do{if(i=!1,n.steiner||!fo(n,n.next)&&0!==po(n.prev,n,n.next))n=n.next;else{if(bo(n),(n=t=n.prev)===n.next)break;i=!0}}while(i||n!==t);return t}function eo(e,t,i,n,r,a,s){if(e){!s&&a&&function(e,t,i,n){var r=e;do{0===r.z&&(r.z=lo(r.x,r.y,t,i,n)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next}while(r!==e);r.prevZ.nextZ=null,r.prevZ=null,function(e){var t,i,n,r,a,s,o,l,c=1;do{for(i=e,e=null,a=null,s=0;i;){for(s++,n=i,o=0,t=0;t<c&&(o++,n=n.nextZ);t++);for(l=c;o>0||l>0&&n;)0!==o&&(0===l||!n||i.z<=n.z)?(r=i,i=i.nextZ,o--):(r=n,n=n.nextZ,l--),a?a.nextZ=r:e=r,r.prevZ=a,a=r;i=n}a.nextZ=null,c*=2}while(s>1)}(r)}(e,n,r,a);for(var o,l,c=e;e.prev!==e.next;)if(o=e.prev,l=e.next,a?io(e,n,r,a):to(e))t.push(o.i/i|0),t.push(e.i/i|0),t.push(l.i/i|0),bo(e),e=l.next,c=l.next;else if((e=l)===c){s?1===s?eo(e=no(Qs(e),t,i),t,i,n,r,a,2):2===s&&ro(e,t,i,n,r,a):eo(Qs(e),t,i,n,r,a,1);break}}}function to(e){var t=e.prev,i=e,n=e.next;if(po(t,i,n)>=0)return!1;for(var r=t.x,a=i.x,s=n.x,o=t.y,l=i.y,c=n.y,u=r<a?r<s?r:s:a<s?a:s,h=o<l?o<c?o:c:l<c?l:c,d=r>a?r>s?r:s:a>s?a:s,p=o>l?o>c?o:c:l>c?l:c,f=n.next;f!==t;){if(f.x>=u&&f.x<=d&&f.y>=h&&f.y<=p&&uo(r,o,a,l,s,c,f.x,f.y)&&po(f.prev,f,f.next)>=0)return!1;f=f.next}return!0}function io(e,t,i,n){var r=e.prev,a=e,s=e.next;if(po(r,a,s)>=0)return!1;for(var o=r.x,l=a.x,c=s.x,u=r.y,h=a.y,d=s.y,p=o<l?o<c?o:c:l<c?l:c,f=u<h?u<d?u:d:h<d?h:d,m=o>l?o>c?o:c:l>c?l:c,g=u>h?u>d?u:d:h>d?h:d,y=lo(p,f,t,i,n),_=lo(m,g,t,i,n),v=e.prevZ,x=e.nextZ;v&&v.z>=y&&x&&x.z<=_;){if(v.x>=p&&v.x<=m&&v.y>=f&&v.y<=g&&v!==r&&v!==s&&uo(o,u,l,h,c,d,v.x,v.y)&&po(v.prev,v,v.next)>=0)return!1;if(v=v.prevZ,x.x>=p&&x.x<=m&&x.y>=f&&x.y<=g&&x!==r&&x!==s&&uo(o,u,l,h,c,d,x.x,x.y)&&po(x.prev,x,x.next)>=0)return!1;x=x.nextZ}for(;v&&v.z>=y;){if(v.x>=p&&v.x<=m&&v.y>=f&&v.y<=g&&v!==r&&v!==s&&uo(o,u,l,h,c,d,v.x,v.y)&&po(v.prev,v,v.next)>=0)return!1;v=v.prevZ}for(;x&&x.z<=_;){if(x.x>=p&&x.x<=m&&x.y>=f&&x.y<=g&&x!==r&&x!==s&&uo(o,u,l,h,c,d,x.x,x.y)&&po(x.prev,x,x.next)>=0)return!1;x=x.nextZ}return!0}function no(e,t,i){var n=e;do{var r=n.prev,a=n.next.next;!fo(r,a)&&mo(r,n,n.next,a)&&_o(r,a)&&_o(a,r)&&(t.push(r.i/i|0),t.push(n.i/i|0),t.push(a.i/i|0),bo(n),bo(n.next),n=e=a),n=n.next}while(n!==e);return Qs(n)}function ro(e,t,i,n,r,a){var s=e;do{for(var o=s.next.next;o!==s.prev;){if(s.i!==o.i&&ho(s,o)){var l=vo(s,o);return s=Qs(s,s.next),l=Qs(l,l.next),eo(s,t,i,n,r,a,0),void eo(l,t,i,n,r,a,0)}o=o.next}s=s.next}while(s!==e)}function ao(e,t){return e.x-t.x}function so(e,t){var i=function(e,t){var i,n=t,r=e.x,a=e.y,s=-1/0;do{if(a<=n.y&&a>=n.next.y&&n.next.y!==n.y){var o=n.x+(a-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(o<=r&&o>s&&(s=o,i=n.x<n.next.x?n:n.next,o===r))return i}n=n.next}while(n!==t);if(!i)return null;var l,c=i,u=i.x,h=i.y,d=1/0;n=i;do{r>=n.x&&n.x>=u&&r!==n.x&&uo(a<h?r:s,a,u,h,a<h?s:r,a,n.x,n.y)&&(l=Math.abs(a-n.y)/(r-n.x),_o(n,e)&&(l<d||l===d&&(n.x>i.x||n.x===i.x&&oo(i,n)))&&(i=n,d=l)),n=n.next}while(n!==c);return i}(e,t);if(!i)return t;var n=vo(i,e);return Qs(n,n.next),Qs(i,i.next)}function oo(e,t){return po(e.prev,e,t.prev)<0&&po(t.next,e,e.next)<0}function lo(e,t,i,n,r){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-i)*r|0)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-n)*r|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function co(e){var t=e,i=e;do{(t.x<i.x||t.x===i.x&&t.y<i.y)&&(i=t),t=t.next}while(t!==e);return i}function uo(e,t,i,n,r,a,s,o){return(r-s)*(t-o)>=(e-s)*(a-o)&&(e-s)*(n-o)>=(i-s)*(t-o)&&(i-s)*(a-o)>=(r-s)*(n-o)}function ho(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){var i=e;do{if(i.i!==e.i&&i.next.i!==e.i&&i.i!==t.i&&i.next.i!==t.i&&mo(i,i.next,e,t))return!0;i=i.next}while(i!==e);return!1}(e,t)&&(_o(e,t)&&_o(t,e)&&function(e,t){var i=e,n=!1,r=(e.x+t.x)/2,a=(e.y+t.y)/2;do{i.y>a!=i.next.y>a&&i.next.y!==i.y&&r<(i.next.x-i.x)*(a-i.y)/(i.next.y-i.y)+i.x&&(n=!n),i=i.next}while(i!==e);return n}(e,t)&&(po(e.prev,e,t.prev)||po(e,t.prev,t))||fo(e,t)&&po(e.prev,e,e.next)>0&&po(t.prev,t,t.next)>0)}function po(e,t,i){return(t.y-e.y)*(i.x-t.x)-(t.x-e.x)*(i.y-t.y)}function fo(e,t){return e.x===t.x&&e.y===t.y}function mo(e,t,i,n){var r=yo(po(e,t,i)),a=yo(po(e,t,n)),s=yo(po(i,n,e)),o=yo(po(i,n,t));return r!==a&&s!==o||!(0!==r||!go(e,i,t))||!(0!==a||!go(e,n,t))||!(0!==s||!go(i,e,n))||!(0!==o||!go(i,t,n))}function go(e,t,i){return t.x<=Math.max(e.x,i.x)&&t.x>=Math.min(e.x,i.x)&&t.y<=Math.max(e.y,i.y)&&t.y>=Math.min(e.y,i.y)}function yo(e){return e>0?1:e<0?-1:0}function _o(e,t){return po(e.prev,e,e.next)<0?po(e,t,e.next)>=0&&po(e,e.prev,t)>=0:po(e,t,e.prev)<0||po(e,e.next,t)<0}function vo(e,t){var i=new wo(e.i,e.x,e.y),n=new wo(t.i,t.x,t.y),r=e.next,a=t.prev;return e.next=t,t.prev=e,i.next=r,r.prev=i,n.next=i,i.prev=n,a.next=n,n.prev=a,n}function xo(e,t,i,n){var r=new wo(e,t,i);return n?(r.next=n.next,r.prev=n,n.next.prev=r,n.next=r):(r.prev=r,r.next=r),r}function bo(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function wo(e,t,i){this.i=e,this.x=t,this.y=i,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function So(e,t,i,n){for(var r=0,a=t,s=i-n;a<i;a+=n)r+=(e[s]-e[a])*(e[a+1]+e[s+1]),s=a;return r}Ks.exports=Ys,Ks.exports.default=Ys,Ys.deviation=function(e,t,i,n){var r=t&&t.length,a=Math.abs(So(e,0,r?t[0]*i:e.length,i));if(r)for(var s=0,o=t.length;s<o;s++)a-=Math.abs(So(e,t[s]*i,s<o-1?t[s+1]*i:e.length,i));var l=0;for(s=0;s<n.length;s+=3){var c=n[s]*i,u=n[s+1]*i,h=n[s+2]*i;l+=Math.abs((e[c]-e[h])*(e[u+1]-e[c+1])-(e[c]-e[u])*(e[h+1]-e[c+1]))}return 0===a&&0===l?0:Math.abs((l-a)/a)},Ys.flatten=function(e){for(var t=e[0][0].length,i={vertices:[],holes:[],dimensions:t},n=0,r=0;r<e.length;r++){for(var a=0;a<e[r].length;a++)for(var s=0;s<t;s++)i.vertices.push(e[r][a][s]);r>0&&i.holes.push(n+=e[r-1].length)}return i};var To=i(Ks.exports);function ko(e,t,i,n,r){Eo(e,t,i||0,n||e.length-1,r||Co)}function Eo(e,t,i,n,r){for(;n>i;){if(n-i>600){var a=n-i+1,s=t-i+1,o=Math.log(a),l=.5*Math.exp(2*o/3),c=.5*Math.sqrt(o*l*(a-l)/a)*(s-a/2<0?-1:1);Eo(e,t,Math.max(i,Math.floor(t-s*l/a+c)),Math.min(n,Math.floor(t+(a-s)*l/a+c)),r)}var u=e[t],h=i,d=n;for(Po(e,i,t),r(e[n],u)>0&&Po(e,i,n);h<d;){for(Po(e,h,d),h++,d--;r(e[h],u)<0;)h++;for(;r(e[d],u)>0;)d--}0===r(e[i],u)?Po(e,i,d):Po(e,++d,n),d<=t&&(i=d+1),t<=d&&(n=d-1)}}function Po(e,t,i){var n=e[t];e[t]=e[i],e[i]=n}function Co(e,t){return e<t?-1:e>t?1:0}function Io(e,t){const i=e.length;if(i<=1)return[e];const n=[];let r,a;for(let s=0;s<i;s++){const t=k(e[s]);0!==t&&(e[s].area=Math.abs(t),void 0===a&&(a=t<0),a===t<0?(r&&n.push(r),r=[e[s]]):r.push(e[s]))}if(r&&n.push(r),t>1)for(let s=0;s<n.length;s++)n[s].length<=t||(ko(n[s],t,1,n[s].length-1,Ao),n[s]=n[s].slice(0,t));return n}function Ao(e,t){return t.area-e.area}function Mo(e,t,i){const n=i.patternDependencies;let r=!1;for(const a of t){const t=a.paint.get(`${e}-pattern`);t.isConstant()||(r=!0);const i=t.constantOr(null);i&&(r=!0,n[i.to]=!0,n[i.from]=!0)}return r}function zo(e,t,i,n,r){const a=r.patternDependencies;for(const s of t){const t=s.paint.get(`${e}-pattern`).value;if("constant"!==t.kind){let e=t.evaluate({zoom:n-1},i,{},r.availableImages),o=t.evaluate({zoom:n},i,{},r.availableImages),l=t.evaluate({zoom:n+1},i,{},r.availableImages);e=e&&e.name?e.name:e,o=o&&o.name?o.name:o,l=l&&l.name?l.name:l,a[e]=!0,a[o]=!0,a[l]=!0,i.patterns[s.id]={min:e,mid:o,max:l}}}return i}class Do{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((e=>e.id)),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new pa,this.indexArray=new Sa,this.indexArray2=new Ta,this.programConfigurations=new Qa(e.layers,e.zoom),this.segments=new Pa,this.segments2=new Pa,this.stateDependentLayerIds=this.layers.filter((e=>e.isStateDependent())).map((e=>e.id))}populate(e,t,i){this.hasPattern=Mo("fill",this.layers,t);const n=this.layers[0].layout.get("fill-sort-key"),r=!n.isConstant(),a=[];for(const{feature:s,id:o,index:l,sourceLayerIndex:c}of e){const e=this.layers[0]._featureFilter.needGeometry,u=ss(s,e);if(!this.layers[0]._featureFilter.filter(new lr(this.zoom),u,i))continue;const h=r?n.evaluate(u,{},i,t.availableImages):void 0,d={id:o,properties:s.properties,type:s.type,sourceLayerIndex:c,index:l,geometry:e?u.geometry:as(s),patterns:{},sortKey:h};a.push(d)}r&&a.sort(((e,t)=>e.sortKey-t.sortKey));for(const s of a){const{geometry:n,index:r,sourceLayerIndex:a}=s;if(this.hasPattern){const e=zo("fill",this.layers,s,this.zoom,t);this.patternFeatures.push(e)}else this.addFeature(s,n,r,i,{});t.featureIndex.insert(e[r].feature,n,r,a,this.index)}}update(e,t,i){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,i)}addFeatures(e,t,i){for(const n of this.patternFeatures)this.addFeature(n,n.geometry,n.index,t,i)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Xs),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(e,t,i,n,r){for(const a of Io(t,500)){let e=0;for(const o of a)e+=o.length;const t=this.segments.prepareSegment(e,this.layoutVertexArray,this.indexArray),i=t.vertexLength,n=[],r=[];for(const o of a){if(0===o.length)continue;o!==a[0]&&r.push(n.length/2);const e=this.segments2.prepareSegment(o.length,this.layoutVertexArray,this.indexArray2),t=e.vertexLength;this.layoutVertexArray.emplaceBack(o[0].x,o[0].y),this.indexArray2.emplaceBack(t+o.length-1,t),n.push(o[0].x),n.push(o[0].y);for(let i=1;i<o.length;i++)this.layoutVertexArray.emplaceBack(o[i].x,o[i].y),this.indexArray2.emplaceBack(t+i-1,t+i),n.push(o[i].x),n.push(o[i].y);e.vertexLength+=o.length,e.primitiveLength+=o.length}const s=To(n,r);for(let a=0;a<s.length;a+=3)this.indexArray.emplaceBack(i+s[a],i+s[a+1],i+s[a+2]);t.vertexLength+=e,t.primitiveLength+=s.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,i,r,n)}}let Lo,Ro;Fn("FillBucket",Do,{omit:["layers","patternFeatures"]});var Fo={get paint(){return Ro=Ro||new wr({"fill-antialias":new yr(X.paint_fill["fill-antialias"]),"fill-opacity":new _r(X.paint_fill["fill-opacity"]),"fill-color":new _r(X.paint_fill["fill-color"]),"fill-outline-color":new _r(X.paint_fill["fill-outline-color"]),"fill-translate":new yr(X.paint_fill["fill-translate"]),"fill-translate-anchor":new yr(X.paint_fill["fill-translate-anchor"]),"fill-pattern":new vr(X.paint_fill["fill-pattern"])})},get layout(){return Lo=Lo||new wr({"fill-sort-key":new _r(X.layout_fill["fill-sort-key"])})}};class Bo extends Tr{constructor(e){super(e,Fo)}recalculate(e,t){super.recalculate(e,t);const i=this.paint._values["fill-outline-color"];"constant"===i.value.kind&&void 0===i.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(e){return new Do(e)}queryRadius(){return bs(this.paint.get("fill-translate"))}queryIntersectsFeature(e,t,i,n,r,a,s){return hs(ws(e,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),a.angle,s),n)}isTileClipped(){return!0}}const Oo=Cr([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),No=Cr([{name:"a_centroid",components:2,type:"Int16"}],4),{members:Vo}=Oo;var jo={},Uo=n,$o=qo;function qo(e,t,i,n,r){this.properties={},this.extent=i,this.type=0,this._pbf=e,this._geometry=-1,this._keys=n,this._values=r,e.readFields(Zo,this,t)}function Zo(e,t,i){1==e?t.id=i.readVarint():2==e?function(e,t){for(var i=e.readVarint()+e.pos;e.pos<i;){var n=t._keys[e.readVarint()],r=t._values[e.readVarint()];t.properties[n]=r}}(i,t):3==e?t.type=i.readVarint():4==e&&(t._geometry=i.pos)}function Go(e){for(var t,i,n=0,r=0,a=e.length,s=a-1;r<a;s=r++)n+=((i=e[s]).x-(t=e[r]).x)*(t.y+i.y);return n}qo.types=["Unknown","Point","LineString","Polygon"],qo.prototype.loadGeometry=function(){var e=this._pbf;e.pos=this._geometry;for(var t,i=e.readVarint()+e.pos,n=1,r=0,a=0,s=0,o=[];e.pos<i;){if(r<=0){var l=e.readVarint();n=7&l,r=l>>3}if(r--,1===n||2===n)a+=e.readSVarint(),s+=e.readSVarint(),1===n&&(t&&o.push(t),t=[]),t.push(new Uo(a,s));else{if(7!==n)throw new Error("unknown command "+n);t&&t.push(t[0].clone())}}return t&&o.push(t),o},qo.prototype.bbox=function(){var e=this._pbf;e.pos=this._geometry;for(var t=e.readVarint()+e.pos,i=1,n=0,r=0,a=0,s=1/0,o=-1/0,l=1/0,c=-1/0;e.pos<t;){if(n<=0){var u=e.readVarint();i=7&u,n=u>>3}if(n--,1===i||2===i)(r+=e.readSVarint())<s&&(s=r),r>o&&(o=r),(a+=e.readSVarint())<l&&(l=a),a>c&&(c=a);else if(7!==i)throw new Error("unknown command "+i)}return[s,l,o,c]},qo.prototype.toGeoJSON=function(e,t,i){var n,r,a=this.extent*Math.pow(2,i),s=this.extent*e,o=this.extent*t,l=this.loadGeometry(),c=qo.types[this.type];function u(e){for(var t=0;t<e.length;t++){var i=e[t];e[t]=[360*(i.x+s)/a-180,360/Math.PI*Math.atan(Math.exp((180-360*(i.y+o)/a)*Math.PI/180))-90]}}switch(this.type){case 1:var h=[];for(n=0;n<l.length;n++)h[n]=l[n][0];u(l=h);break;case 2:for(n=0;n<l.length;n++)u(l[n]);break;case 3:for(l=function(e){var t=e.length;if(t<=1)return[e];for(var i,n,r=[],a=0;a<t;a++){var s=Go(e[a]);0!==s&&(void 0===n&&(n=s<0),n===s<0?(i&&r.push(i),i=[e[a]]):i.push(e[a]))}return i&&r.push(i),r}(l),n=0;n<l.length;n++)for(r=0;r<l[n].length;r++)u(l[n][r])}1===l.length?l=l[0]:c="Multi"+c;var d={type:"Feature",geometry:{type:c,coordinates:l},properties:this.properties};return"id"in this&&(d.id=this.id),d};var Wo=$o,Ho=Xo;function Xo(e,t){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=e,this._keys=[],this._values=[],this._features=[],e.readFields(Ko,this,t),this.length=this._features.length}function Ko(e,t,i){15===e?t.version=i.readVarint():1===e?t.name=i.readString():5===e?t.extent=i.readVarint():2===e?t._features.push(i.pos):3===e?t._keys.push(i.readString()):4===e&&t._values.push(function(e){for(var t=null,i=e.readVarint()+e.pos;e.pos<i;){var n=e.readVarint()>>3;t=1===n?e.readString():2===n?e.readFloat():3===n?e.readDouble():4===n?e.readVarint64():5===n?e.readVarint():6===n?e.readSVarint():7===n?e.readBoolean():null}return t}(i))}Xo.prototype.feature=function(e){if(e<0||e>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[e];var t=this._pbf.readVarint()+this._pbf.pos;return new Wo(this._pbf,t,this.extent,this._keys,this._values)};var Yo=Ho;function Jo(e,t,i){if(3===e){var n=new Yo(i,i.readVarint()+i.pos);n.length&&(t[n.name]=n)}}jo.VectorTile=function(e,t){this.layers=e.readFields(Jo,{},t)},jo.VectorTileFeature=$o,jo.VectorTileLayer=Ho;const Qo=jo.VectorTileFeature.types,el=Math.pow(2,13);function tl(e,t,i,n,r,a,s,o){e.emplaceBack(t,i,2*Math.floor(n*el)+s,r*el*2,a*el*2,Math.round(o))}class il{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((e=>e.id)),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new fa,this.centroidVertexArray=new ha,this.indexArray=new Sa,this.programConfigurations=new Qa(e.layers,e.zoom),this.segments=new Pa,this.stateDependentLayerIds=this.layers.filter((e=>e.isStateDependent())).map((e=>e.id))}populate(e,t,i){this.features=[],this.hasPattern=Mo("fill-extrusion",this.layers,t);for(const{feature:n,id:r,index:a,sourceLayerIndex:s}of e){const e=this.layers[0]._featureFilter.needGeometry,o=ss(n,e);if(!this.layers[0]._featureFilter.filter(new lr(this.zoom),o,i))continue;const l={id:r,sourceLayerIndex:s,index:a,geometry:e?o.geometry:as(n),properties:n.properties,type:n.type,patterns:{}};this.hasPattern?this.features.push(zo("fill-extrusion",this.layers,l,this.zoom,t)):this.addFeature(l,l.geometry,a,i,{}),t.featureIndex.insert(n,l.geometry,a,s,this.index,!0)}}addFeatures(e,t,i){for(const n of this.features){const{geometry:e}=n;this.addFeature(n,e,n.index,t,i)}}update(e,t,i){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,i)}isEmpty(){return 0===this.layoutVertexArray.length&&0===this.centroidVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Vo),this.centroidVertexBuffer=e.createVertexBuffer(this.centroidVertexArray,No.members,!0),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(e,t,i,n,r){const a={x:0,y:0,vertexCount:0};for(const s of Io(t,500)){let t=0;for(const e of s)t+=e.length;let i=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(const e of s){if(0===e.length)continue;if(rl(e))continue;let t=0;for(let n=0;n<e.length;n++){const r=e[n];if(n>=1){const s=e[n-1];if(!nl(r,s)){i.vertexLength+4>Pa.MAX_VERTEX_ARRAY_LENGTH&&(i=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const e=r.sub(s)._perp()._unit(),n=s.dist(r);t+n>32768&&(t=0),tl(this.layoutVertexArray,r.x,r.y,e.x,e.y,0,0,t),tl(this.layoutVertexArray,r.x,r.y,e.x,e.y,0,1,t),a.x+=2*r.x,a.y+=2*r.y,a.vertexCount+=2,t+=n,tl(this.layoutVertexArray,s.x,s.y,e.x,e.y,0,0,t),tl(this.layoutVertexArray,s.x,s.y,e.x,e.y,0,1,t),a.x+=2*s.x,a.y+=2*s.y,a.vertexCount+=2;const o=i.vertexLength;this.indexArray.emplaceBack(o,o+2,o+1),this.indexArray.emplaceBack(o+1,o+2,o+3),i.vertexLength+=4,i.primitiveLength+=2}}}}if(i.vertexLength+t>Pa.MAX_VERTEX_ARRAY_LENGTH&&(i=this.segments.prepareSegment(t,this.layoutVertexArray,this.indexArray)),"Polygon"!==Qo[e.type])continue;const n=[],r=[],o=i.vertexLength;for(const e of s)if(0!==e.length){e!==s[0]&&r.push(n.length/2);for(let t=0;t<e.length;t++){const i=e[t];tl(this.layoutVertexArray,i.x,i.y,0,0,1,1,0),a.x+=i.x,a.y+=i.y,a.vertexCount+=1,n.push(i.x),n.push(i.y)}}const l=To(n,r);for(let e=0;e<l.length;e+=3)this.indexArray.emplaceBack(o+l[e],o+l[e+2],o+l[e+1]);i.primitiveLength+=l.length/3,i.vertexLength+=t}for(let s=0;s<a.vertexCount;s++)this.centroidVertexArray.emplaceBack(Math.floor(a.x/a.vertexCount),Math.floor(a.y/a.vertexCount));this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,i,r,n)}}function nl(e,t){return e.x===t.x&&(e.x<0||e.x>is)||e.y===t.y&&(e.y<0||e.y>is)}function rl(e){return e.every((e=>e.x<0))||e.every((e=>e.x>is))||e.every((e=>e.y<0))||e.every((e=>e.y>is))}let al;Fn("FillExtrusionBucket",il,{omit:["layers","features"]});var sl={get paint(){return al=al||new wr({"fill-extrusion-opacity":new yr(X["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new _r(X["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new yr(X["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new yr(X["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new vr(X["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new _r(X["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new _r(X["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new yr(X["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class ol extends Tr{constructor(e){super(e,sl)}createBucket(e){return new il(e)}queryRadius(){return bs(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(e,t,i,n,r,s,o,l){const c=ws(e,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),s.angle,o),u=this.paint.get("fill-extrusion-height").evaluate(t,i),h=this.paint.get("fill-extrusion-base").evaluate(t,i),d=function(e,t){const i=[];for(const n of e){const e=[n.x,n.y,0,1];zs(e,e,t),i.push(new a(e[0]/e[3],e[1]/e[3]))}return i}(c,l),p=function(e,t,i,n){const r=[],s=[],o=n[8]*t,l=n[9]*t,c=n[10]*t,u=n[11]*t,h=n[8]*i,d=n[9]*i,p=n[10]*i,f=n[11]*i;for(const m of e){const e=[],t=[];for(const i of m){const r=i.x,s=i.y,m=n[0]*r+n[4]*s+n[12],g=n[1]*r+n[5]*s+n[13],y=n[2]*r+n[6]*s+n[14],_=n[3]*r+n[7]*s+n[15],v=y+c,x=_+u,b=m+h,w=g+d,S=y+p,T=_+f,k=new a((m+o)/x,(g+l)/x);k.z=v/x,e.push(k);const E=new a(b/T,w/T);E.z=S/T,t.push(E)}r.push(e),s.push(t)}return[r,s]}(n,h,u,l);return function(e,t,i){let n=1/0;hs(i,t)&&(n=cl(i,t[0]));for(let r=0;r<t.length;r++){const a=t[r],s=e[r];for(let e=0;e<a.length-1;e++){const t=a[e],r=[t,a[e+1],s[e+1],s[e],t];cs(i,r)&&(n=Math.min(n,cl(i,r)))}}return n!==1/0&&n}(p[0],p[1],d)}}function ll(e,t){return e.x*t.x+e.y*t.y}function cl(e,t){if(1===e.length){let i=0;const n=t[i++];let r;for(;!r||n.equals(r);)if(r=t[i++],!r)return 1/0;for(;i<t.length;i++){const a=t[i],s=e[0],o=r.sub(n),l=a.sub(n),c=s.sub(n),u=ll(o,o),h=ll(o,l),d=ll(l,l),p=ll(c,o),f=ll(c,l),m=u*d-h*h,g=(d*p-h*f)/m,y=(u*f-h*p)/m,_=n.z*(1-g-y)+r.z*g+a.z*y;if(isFinite(_))return _}return 1/0}{let e=1/0;for(const i of t)e=Math.min(e,i.z);return e}}const ul=Cr([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:hl}=ul,dl=Cr([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:pl}=dl,fl=jo.VectorTileFeature.types,ml=Math.cos(Math.PI/180*37.5),gl=Math.pow(2,14)/.5;class yl{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((e=>e.id)),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach((e=>{this.gradients[e.id]={}})),this.layoutVertexArray=new ma,this.layoutVertexArray2=new ga,this.indexArray=new Sa,this.programConfigurations=new Qa(e.layers,e.zoom),this.segments=new Pa,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter((e=>e.isStateDependent())).map((e=>e.id))}populate(e,t,i){this.hasPattern=Mo("line",this.layers,t);const n=this.layers[0].layout.get("line-sort-key"),r=!n.isConstant(),a=[];for(const{feature:s,id:o,index:l,sourceLayerIndex:c}of e){const e=this.layers[0]._featureFilter.needGeometry,t=ss(s,e);if(!this.layers[0]._featureFilter.filter(new lr(this.zoom),t,i))continue;const u=r?n.evaluate(t,{},i):void 0,h={id:o,properties:s.properties,type:s.type,sourceLayerIndex:c,index:l,geometry:e?t.geometry:as(s),patterns:{},sortKey:u};a.push(h)}r&&a.sort(((e,t)=>e.sortKey-t.sortKey));for(const s of a){const{geometry:n,index:r,sourceLayerIndex:a}=s;if(this.hasPattern){const e=zo("line",this.layers,s,this.zoom,t);this.patternFeatures.push(e)}else this.addFeature(s,n,r,i,{});t.featureIndex.insert(e[r].feature,n,r,a,this.index)}}update(e,t,i){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,i)}addFeatures(e,t,i){for(const n of this.patternFeatures)this.addFeature(n,n.geometry,n.index,t,i)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(0!==this.layoutVertexArray2.length&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,pl)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,hl),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(e){if(e.properties&&Object.prototype.hasOwnProperty.call(e.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(e.properties,"mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}}addFeature(e,t,i,n,r){const a=this.layers[0].layout,s=a.get("line-join").evaluate(e,{}),o=a.get("line-cap"),l=a.get("line-miter-limit"),c=a.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(const u of t)this.addLine(u,e,s,o,l,c);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,i,r,n)}addLine(e,t,i,n,r,a){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let t=0;t<e.length-1;t++)this.totalDistance+=e[t].dist(e[t+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const s="Polygon"===fl[t.type];let o=e.length;for(;o>=2&&e[o-1].equals(e[o-2]);)o--;let l=0;for(;l<o-1&&e[l].equals(e[l+1]);)l++;if(o<(s?3:2))return;"bevel"===i&&(r=1.05);const c=this.overscaling<=16?15*is/(512*this.overscaling):0,u=this.segments.prepareSegment(10*o,this.layoutVertexArray,this.indexArray);let h,d,p,f,m;this.e1=this.e2=-1,s&&(h=e[o-2],m=e[l].sub(h)._unit()._perp());for(let g=l;g<o;g++){if(p=g===o-1?s?e[l+1]:void 0:e[g+1],p&&e[g].equals(p))continue;m&&(f=m),h&&(d=h),h=e[g],m=p?p.sub(h)._unit()._perp():f,f=f||m;let t=f.add(m);0===t.x&&0===t.y||t._unit();const y=f.x*m.x+f.y*m.y,_=t.x*m.x+t.y*m.y,v=0!==_?1/_:1/0,x=2*Math.sqrt(2-2*_),b=_<ml&&d&&p,w=f.x*m.y-f.y*m.x>0;if(b&&g>l){const e=h.dist(d);if(e>2*c){const t=h.sub(h.sub(d)._mult(c/e)._round());this.updateDistance(d,t),this.addCurrentVertex(t,f,0,0,u),d=t}}const S=d&&p;let T=S?i:s?"butt":n;if(S&&"round"===T&&(v<a?T="miter":v<=2&&(T="fakeround")),"miter"===T&&v>r&&(T="bevel"),"bevel"===T&&(v>2&&(T="flipbevel"),v<r&&(T="miter")),d&&this.updateDistance(d,h),"miter"===T)t._mult(v),this.addCurrentVertex(h,t,0,0,u);else if("flipbevel"===T){if(v>100)t=m.mult(-1);else{const e=v*f.add(m).mag()/f.sub(m).mag();t._perp()._mult(e*(w?-1:1))}this.addCurrentVertex(h,t,0,0,u),this.addCurrentVertex(h,t.mult(-1),0,0,u)}else if("bevel"===T||"fakeround"===T){const e=-Math.sqrt(v*v-1),t=w?e:0,i=w?0:e;if(d&&this.addCurrentVertex(h,f,t,i,u),"fakeround"===T){const e=Math.round(180*x/Math.PI/20);for(let t=1;t<e;t++){let i=t/e;if(.5!==i){const e=i-.5;i+=i*e*(i-1)*((1.0904+y*(y*(3.55645-1.43519*y)-3.2452))*e*e+(.848013+y*(.215638*y-1.06021)))}const n=m.sub(f)._mult(i)._add(f)._unit()._mult(w?-1:1);this.addHalfVertex(h,n.x,n.y,!1,w,0,u)}}p&&this.addCurrentVertex(h,m,-t,-i,u)}else if("butt"===T)this.addCurrentVertex(h,t,0,0,u);else if("square"===T){const e=d?1:-1;this.addCurrentVertex(h,t,e,e,u)}else"round"===T&&(d&&(this.addCurrentVertex(h,f,0,0,u),this.addCurrentVertex(h,f,1,1,u,!0)),p&&(this.addCurrentVertex(h,m,-1,-1,u,!0),this.addCurrentVertex(h,m,0,0,u)));if(b&&g<o-1){const e=h.dist(p);if(e>2*c){const t=h.add(p.sub(h)._mult(c/e)._round());this.updateDistance(h,t),this.addCurrentVertex(t,m,0,0,u),h=t}}}}addCurrentVertex(e,t,i,n,r){let a=arguments.length>5&&void 0!==arguments[5]&&arguments[5];const s=t.y*n-t.x,o=-t.y-t.x*n;this.addHalfVertex(e,t.x+t.y*i,t.y-t.x*i,a,!1,i,r),this.addHalfVertex(e,s,o,a,!0,-n,r),this.distance>gl/2&&0===this.totalDistance&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(e,t,i,n,r,a))}addHalfVertex(e,t,i,n,r,a,s){let{x:o,y:l}=e;const c=.5*(this.lineClips?this.scaledDistance*(gl-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((o<<1)+(n?1:0),(l<<1)+(r?1:0),Math.round(63*t)+128,Math.round(63*i)+128,1+(0===a?0:a<0?-1:1)|(63&c)<<2,c>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const u=s.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,u),s.primitiveLength++),r?this.e2=u:this.e1=u}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(e,t){this.distance+=e.dist(t),this.updateScaledDistance()}}let _l,vl;Fn("LineBucket",yl,{omit:["layers","patternFeatures"]});var xl={get paint(){return vl=vl||new wr({"line-opacity":new _r(X.paint_line["line-opacity"]),"line-color":new _r(X.paint_line["line-color"]),"line-translate":new yr(X.paint_line["line-translate"]),"line-translate-anchor":new yr(X.paint_line["line-translate-anchor"]),"line-width":new _r(X.paint_line["line-width"]),"line-gap-width":new _r(X.paint_line["line-gap-width"]),"line-offset":new _r(X.paint_line["line-offset"]),"line-blur":new _r(X.paint_line["line-blur"]),"line-dasharray":new xr(X.paint_line["line-dasharray"]),"line-pattern":new vr(X.paint_line["line-pattern"]),"line-gradient":new br(X.paint_line["line-gradient"])})},get layout(){return _l=_l||new wr({"line-cap":new yr(X.layout_line["line-cap"]),"line-join":new _r(X.layout_line["line-join"]),"line-miter-limit":new yr(X.layout_line["line-miter-limit"]),"line-round-limit":new yr(X.layout_line["line-round-limit"]),"line-sort-key":new _r(X.layout_line["line-sort-key"])})}};class bl extends _r{possiblyEvaluate(e,t){return t=new lr(Math.floor(t.zoom),{now:t.now,fadeDuration:t.fadeDuration,zoomHistory:t.zoomHistory,transition:t.transition}),super.possiblyEvaluate(e,t)}evaluate(e,t,i,n){return t=y({},t,{zoom:Math.floor(t.zoom)}),super.evaluate(e,t,i,n)}}let wl;class Sl extends Tr{constructor(e){super(e,xl),this.gradientVersion=0,wl||(wl=new bl(xl.paint.properties["line-width"].specification),wl.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(e){if("line-gradient"===e){const e=this.gradientExpression();this.stepInterpolant=!!function(e){return void 0!==e._styleExpression}(e)&&e._styleExpression.expression instanceof Ut,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(e,t){super.recalculate(e,t),this.paint._values["line-floorwidth"]=wl.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,e)}createBucket(e){return new yl(e)}queryRadius(e){const t=e,i=Tl(xs("line-width",this,t),xs("line-gap-width",this,t)),n=xs("line-offset",this,t);return i/2+Math.abs(n)+bs(this.paint.get("line-translate"))}queryIntersectsFeature(e,t,i,n,r,s,o){const l=ws(e,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),s.angle,o),c=o/2*Tl(this.paint.get("line-width").evaluate(t,i),this.paint.get("line-gap-width").evaluate(t,i)),u=this.paint.get("line-offset").evaluate(t,i);return u&&(n=function(e,t){const i=[];for(let n=0;n<e.length;n++){const r=e[n],s=[];for(let e=0;e<r.length;e++){const i=r[e-1],n=r[e],o=r[e+1],l=0===e?new a(0,0):n.sub(i)._unit()._perp(),c=e===r.length-1?new a(0,0):o.sub(n)._unit()._perp(),u=l._add(c)._unit(),h=u.x*c.x+u.y*c.y;0!==h&&u._mult(1/h),s.push(u._mult(t)._add(n))}i.push(s)}return i}(n,u*o)),function(e,t,i){for(let n=0;n<t.length;n++){const r=t[n];if(e.length>=3)for(let t=0;t<r.length;t++)if(_s(e,r[t]))return!0;if(ds(e,r,i))return!0}return!1}(l,n,c)}isTileClipped(){return!0}}function Tl(e,t){return t>0?t+2*e:e}const kl=Cr([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),El=Cr([{name:"a_projected_pos",components:3,type:"Float32"}],4);Cr([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const Pl=Cr([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]);Cr([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const Cl=Cr([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),Il=Cr([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function Al(e,t,i){return e.sections.forEach((e=>{e.text=function(e,t,i){const n=t.layout.get("text-transform").evaluate(i,{});return"uppercase"===n?e=e.toLocaleUpperCase():"lowercase"===n&&(e=e.toLocaleLowerCase()),or.applyArabicShaping&&(e=or.applyArabicShaping(e)),e}(e.text,t,i)})),e}Cr([{name:"triangle",components:3,type:"Uint16"}]),Cr([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),Cr([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),Cr([{type:"Float32",name:"offsetX"}]),Cr([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),Cr([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const Ml={"!":"\ufe15","#":"\uff03",$:"\uff04","%":"\uff05","&":"\uff06","(":"\ufe35",")":"\ufe36","*":"\uff0a","+":"\uff0b",",":"\ufe10","-":"\ufe32",".":"\u30fb","/":"\uff0f",":":"\ufe13",";":"\ufe14","<":"\ufe3f","=":"\uff1d",">":"\ufe40","?":"\ufe16","@":"\uff20","[":"\ufe47","\\":"\uff3c","]":"\ufe48","^":"\uff3e",_:"\ufe33","`":"\uff40","{":"\ufe37","|":"\u2015","}":"\ufe38","~":"\uff5e","\xa2":"\uffe0","\xa3":"\uffe1","\xa5":"\uffe5","\xa6":"\uffe4","\xac":"\uffe2","\xaf":"\uffe3","\u2013":"\ufe32","\u2014":"\ufe31","\u2018":"\ufe43","\u2019":"\ufe44","\u201c":"\ufe41","\u201d":"\ufe42","\u2026":"\ufe19","\u2027":"\u30fb","\u20a9":"\uffe6","\u3001":"\ufe11","\u3002":"\ufe12","\u3008":"\ufe3f","\u3009":"\ufe40","\u300a":"\ufe3d","\u300b":"\ufe3e","\u300c":"\ufe41","\u300d":"\ufe42","\u300e":"\ufe43","\u300f":"\ufe44","\u3010":"\ufe3b","\u3011":"\ufe3c","\u3014":"\ufe39","\u3015":"\ufe3a","\u3016":"\ufe17","\u3017":"\ufe18","\uff01":"\ufe15","\uff08":"\ufe35","\uff09":"\ufe36","\uff0c":"\ufe10","\uff0d":"\ufe32","\uff0e":"\u30fb","\uff1a":"\ufe13","\uff1b":"\ufe14","\uff1c":"\ufe3f","\uff1e":"\ufe40","\uff1f":"\ufe16","\uff3b":"\ufe47","\uff3d":"\ufe48","\uff3f":"\ufe33","\uff5b":"\ufe37","\uff5c":"\u2015","\uff5d":"\ufe38","\uff5f":"\ufe35","\uff60":"\ufe36","\uff61":"\ufe12","\uff62":"\ufe41","\uff63":"\ufe42"};var zl=24,Dl=Fl,Ll=function(e,t,i,n,r){var a,s,o=8*r-n-1,l=(1<<o)-1,c=l>>1,u=-7,h=i?r-1:0,d=i?-1:1,p=e[t+h];for(h+=d,a=p&(1<<-u)-1,p>>=-u,u+=o;u>0;a=256*a+e[t+h],h+=d,u-=8);for(s=a&(1<<-u)-1,a>>=-u,u+=n;u>0;s=256*s+e[t+h],h+=d,u-=8);if(0===a)a=1-c;else{if(a===l)return s?NaN:1/0*(p?-1:1);s+=Math.pow(2,n),a-=c}return(p?-1:1)*s*Math.pow(2,a-n)},Rl=function(e,t,i,n,r,a){var s,o,l,c=8*a-r-1,u=(1<<c)-1,h=u>>1,d=23===r?Math.pow(2,-24)-Math.pow(2,-77):0,p=n?0:a-1,f=n?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(o=isNaN(t)?1:0,s=u):(s=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-s))<1&&(s--,l*=2),(t+=s+h>=1?d/l:d*Math.pow(2,1-h))*l>=2&&(s++,l/=2),s+h>=u?(o=0,s=u):s+h>=1?(o=(t*l-1)*Math.pow(2,r),s+=h):(o=t*Math.pow(2,h-1)*Math.pow(2,r),s=0));r>=8;e[i+p]=255&o,p+=f,o/=256,r-=8);for(s=s<<r|o,c+=r;c>0;e[i+p]=255&s,p+=f,s/=256,c-=8);e[i+p-f]|=128*m};function Fl(e){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(e)?e:new Uint8Array(e||0),this.pos=0,this.type=0,this.length=this.buf.length}Fl.Varint=0,Fl.Fixed64=1,Fl.Bytes=2,Fl.Fixed32=5;var Bl=4294967296,Ol=1/Bl,Nl="undefined"==typeof TextDecoder?null:new TextDecoder("utf8");function Vl(e){return e.type===Fl.Bytes?e.readVarint()+e.pos:e.pos+1}function jl(e,t,i){return i?4294967296*t+(e>>>0):4294967296*(t>>>0)+(e>>>0)}function Ul(e,t,i){var n=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(7*Math.LN2));i.realloc(n);for(var r=i.pos-1;r>=e;r--)i.buf[r+n]=i.buf[r]}function $l(e,t){for(var i=0;i<e.length;i++)t.writeVarint(e[i])}function ql(e,t){for(var i=0;i<e.length;i++)t.writeSVarint(e[i])}function Zl(e,t){for(var i=0;i<e.length;i++)t.writeFloat(e[i])}function Gl(e,t){for(var i=0;i<e.length;i++)t.writeDouble(e[i])}function Wl(e,t){for(var i=0;i<e.length;i++)t.writeBoolean(e[i])}function Hl(e,t){for(var i=0;i<e.length;i++)t.writeFixed32(e[i])}function Xl(e,t){for(var i=0;i<e.length;i++)t.writeSFixed32(e[i])}function Kl(e,t){for(var i=0;i<e.length;i++)t.writeFixed64(e[i])}function Yl(e,t){for(var i=0;i<e.length;i++)t.writeSFixed64(e[i])}function Jl(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+16777216*e[t+3]}function Ql(e,t,i){e[i]=t,e[i+1]=t>>>8,e[i+2]=t>>>16,e[i+3]=t>>>24}function ec(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+(e[t+3]<<24)}Fl.prototype={destroy:function(){this.buf=null},readFields:function(e,t,i){for(i=i||this.length;this.pos<i;){var n=this.readVarint(),r=n>>3,a=this.pos;this.type=7&n,e(r,t,this),this.pos===a&&this.skip(n)}return t},readMessage:function(e,t){return this.readFields(e,t,this.readVarint()+this.pos)},readFixed32:function(){var e=Jl(this.buf,this.pos);return this.pos+=4,e},readSFixed32:function(){var e=ec(this.buf,this.pos);return this.pos+=4,e},readFixed64:function(){var e=Jl(this.buf,this.pos)+Jl(this.buf,this.pos+4)*Bl;return this.pos+=8,e},readSFixed64:function(){var e=Jl(this.buf,this.pos)+ec(this.buf,this.pos+4)*Bl;return this.pos+=8,e},readFloat:function(){var e=Ll(this.buf,this.pos,!0,23,4);return this.pos+=4,e},readDouble:function(){var e=Ll(this.buf,this.pos,!0,52,8);return this.pos+=8,e},readVarint:function(e){var t,i,n=this.buf;return t=127&(i=n[this.pos++]),i<128?t:(t|=(127&(i=n[this.pos++]))<<7,i<128?t:(t|=(127&(i=n[this.pos++]))<<14,i<128?t:(t|=(127&(i=n[this.pos++]))<<21,i<128?t:function(e,t,i){var n,r,a=i.buf;if(n=(112&(r=a[i.pos++]))>>4,r<128)return jl(e,n,t);if(n|=(127&(r=a[i.pos++]))<<3,r<128)return jl(e,n,t);if(n|=(127&(r=a[i.pos++]))<<10,r<128)return jl(e,n,t);if(n|=(127&(r=a[i.pos++]))<<17,r<128)return jl(e,n,t);if(n|=(127&(r=a[i.pos++]))<<24,r<128)return jl(e,n,t);if(n|=(1&(r=a[i.pos++]))<<31,r<128)return jl(e,n,t);throw new Error("Expected varint not more than 10 bytes")}(t|=(15&(i=n[this.pos]))<<28,e,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var e=this.readVarint();return e%2==1?(e+1)/-2:e/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var e=this.readVarint()+this.pos,t=this.pos;return this.pos=e,e-t>=12&&Nl?function(e,t,i){return Nl.decode(e.subarray(t,i))}(this.buf,t,e):function(e,t,i){for(var n="",r=t;r<i;){var a,s,o,l=e[r],c=null,u=l>239?4:l>223?3:l>191?2:1;if(r+u>i)break;1===u?l<128&&(c=l):2===u?128==(192&(a=e[r+1]))&&(c=(31&l)<<6|63&a)<=127&&(c=null):3===u?(s=e[r+2],128==(192&(a=e[r+1]))&&128==(192&s)&&((c=(15&l)<<12|(63&a)<<6|63&s)<=2047||c>=55296&&c<=57343)&&(c=null)):4===u&&(s=e[r+2],o=e[r+3],128==(192&(a=e[r+1]))&&128==(192&s)&&128==(192&o)&&((c=(15&l)<<18|(63&a)<<12|(63&s)<<6|63&o)<=65535||c>=1114112)&&(c=null)),null===c?(c=65533,u=1):c>65535&&(c-=65536,n+=String.fromCharCode(c>>>10&1023|55296),c=56320|1023&c),n+=String.fromCharCode(c),r+=u}return n}(this.buf,t,e)},readBytes:function(){var e=this.readVarint()+this.pos,t=this.buf.subarray(this.pos,e);return this.pos=e,t},readPackedVarint:function(e,t){if(this.type!==Fl.Bytes)return e.push(this.readVarint(t));var i=Vl(this);for(e=e||[];this.pos<i;)e.push(this.readVarint(t));return e},readPackedSVarint:function(e){if(this.type!==Fl.Bytes)return e.push(this.readSVarint());var t=Vl(this);for(e=e||[];this.pos<t;)e.push(this.readSVarint());return e},readPackedBoolean:function(e){if(this.type!==Fl.Bytes)return e.push(this.readBoolean());var t=Vl(this);for(e=e||[];this.pos<t;)e.push(this.readBoolean());return e},readPackedFloat:function(e){if(this.type!==Fl.Bytes)return e.push(this.readFloat());var t=Vl(this);for(e=e||[];this.pos<t;)e.push(this.readFloat());return e},readPackedDouble:function(e){if(this.type!==Fl.Bytes)return e.push(this.readDouble());var t=Vl(this);for(e=e||[];this.pos<t;)e.push(this.readDouble());return e},readPackedFixed32:function(e){if(this.type!==Fl.Bytes)return e.push(this.readFixed32());var t=Vl(this);for(e=e||[];this.pos<t;)e.push(this.readFixed32());return e},readPackedSFixed32:function(e){if(this.type!==Fl.Bytes)return e.push(this.readSFixed32());var t=Vl(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed32());return e},readPackedFixed64:function(e){if(this.type!==Fl.Bytes)return e.push(this.readFixed64());var t=Vl(this);for(e=e||[];this.pos<t;)e.push(this.readFixed64());return e},readPackedSFixed64:function(e){if(this.type!==Fl.Bytes)return e.push(this.readSFixed64());var t=Vl(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed64());return e},skip:function(e){var t=7&e;if(t===Fl.Varint)for(;this.buf[this.pos++]>127;);else if(t===Fl.Bytes)this.pos=this.readVarint()+this.pos;else if(t===Fl.Fixed32)this.pos+=4;else{if(t!==Fl.Fixed64)throw new Error("Unimplemented type: "+t);this.pos+=8}},writeTag:function(e,t){this.writeVarint(e<<3|t)},realloc:function(e){for(var t=this.length||16;t<this.pos+e;)t*=2;if(t!==this.length){var i=new Uint8Array(t);i.set(this.buf),this.buf=i,this.length=t}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(e){this.realloc(4),Ql(this.buf,e,this.pos),this.pos+=4},writeSFixed32:function(e){this.realloc(4),Ql(this.buf,e,this.pos),this.pos+=4},writeFixed64:function(e){this.realloc(8),Ql(this.buf,-1&e,this.pos),Ql(this.buf,Math.floor(e*Ol),this.pos+4),this.pos+=8},writeSFixed64:function(e){this.realloc(8),Ql(this.buf,-1&e,this.pos),Ql(this.buf,Math.floor(e*Ol),this.pos+4),this.pos+=8},writeVarint:function(e){(e=+e||0)>268435455||e<0?function(e,t){var i,n;if(e>=0?(i=e%4294967296|0,n=e/4294967296|0):(n=~(-e/4294967296),4294967295^(i=~(-e%4294967296))?i=i+1|0:(i=0,n=n+1|0)),e>=0x10000000000000000||e<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");t.realloc(10),function(e,t,i){i.buf[i.pos++]=127&e|128,e>>>=7,i.buf[i.pos++]=127&e|128,e>>>=7,i.buf[i.pos++]=127&e|128,e>>>=7,i.buf[i.pos++]=127&e|128,i.buf[i.pos]=127&(e>>>=7)}(i,0,t),function(e,t){var i=(7&e)<<4;t.buf[t.pos++]|=i|((e>>>=3)?128:0),e&&(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=127&e)))))}(n,t)}(e,this):(this.realloc(4),this.buf[this.pos++]=127&e|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=e>>>7&127))))},writeSVarint:function(e){this.writeVarint(e<0?2*-e-1:2*e)},writeBoolean:function(e){this.writeVarint(Boolean(e))},writeString:function(e){e=String(e),this.realloc(4*e.length),this.pos++;var t=this.pos;this.pos=function(e,t,i){for(var n,r,a=0;a<t.length;a++){if((n=t.charCodeAt(a))>55295&&n<57344){if(!r){n>56319||a+1===t.length?(e[i++]=239,e[i++]=191,e[i++]=189):r=n;continue}if(n<56320){e[i++]=239,e[i++]=191,e[i++]=189,r=n;continue}n=r-55296<<10|n-56320|65536,r=null}else r&&(e[i++]=239,e[i++]=191,e[i++]=189,r=null);n<128?e[i++]=n:(n<2048?e[i++]=n>>6|192:(n<65536?e[i++]=n>>12|224:(e[i++]=n>>18|240,e[i++]=n>>12&63|128),e[i++]=n>>6&63|128),e[i++]=63&n|128)}return i}(this.buf,e,this.pos);var i=this.pos-t;i>=128&&Ul(t,i,this),this.pos=t-1,this.writeVarint(i),this.pos+=i},writeFloat:function(e){this.realloc(4),Rl(this.buf,e,this.pos,!0,23,4),this.pos+=4},writeDouble:function(e){this.realloc(8),Rl(this.buf,e,this.pos,!0,52,8),this.pos+=8},writeBytes:function(e){var t=e.length;this.writeVarint(t),this.realloc(t);for(var i=0;i<t;i++)this.buf[this.pos++]=e[i]},writeRawMessage:function(e,t){this.pos++;var i=this.pos;e(t,this);var n=this.pos-i;n>=128&&Ul(i,n,this),this.pos=i-1,this.writeVarint(n),this.pos+=n},writeMessage:function(e,t,i){this.writeTag(e,Fl.Bytes),this.writeRawMessage(t,i)},writePackedVarint:function(e,t){t.length&&this.writeMessage(e,$l,t)},writePackedSVarint:function(e,t){t.length&&this.writeMessage(e,ql,t)},writePackedBoolean:function(e,t){t.length&&this.writeMessage(e,Wl,t)},writePackedFloat:function(e,t){t.length&&this.writeMessage(e,Zl,t)},writePackedDouble:function(e,t){t.length&&this.writeMessage(e,Gl,t)},writePackedFixed32:function(e,t){t.length&&this.writeMessage(e,Hl,t)},writePackedSFixed32:function(e,t){t.length&&this.writeMessage(e,Xl,t)},writePackedFixed64:function(e,t){t.length&&this.writeMessage(e,Kl,t)},writePackedSFixed64:function(e,t){t.length&&this.writeMessage(e,Yl,t)},writeBytesField:function(e,t){this.writeTag(e,Fl.Bytes),this.writeBytes(t)},writeFixed32Field:function(e,t){this.writeTag(e,Fl.Fixed32),this.writeFixed32(t)},writeSFixed32Field:function(e,t){this.writeTag(e,Fl.Fixed32),this.writeSFixed32(t)},writeFixed64Field:function(e,t){this.writeTag(e,Fl.Fixed64),this.writeFixed64(t)},writeSFixed64Field:function(e,t){this.writeTag(e,Fl.Fixed64),this.writeSFixed64(t)},writeVarintField:function(e,t){this.writeTag(e,Fl.Varint),this.writeVarint(t)},writeSVarintField:function(e,t){this.writeTag(e,Fl.Varint),this.writeSVarint(t)},writeStringField:function(e,t){this.writeTag(e,Fl.Bytes),this.writeString(t)},writeFloatField:function(e,t){this.writeTag(e,Fl.Fixed32),this.writeFloat(t)},writeDoubleField:function(e,t){this.writeTag(e,Fl.Fixed64),this.writeDouble(t)},writeBooleanField:function(e,t){this.writeVarintField(e,Boolean(t))}};var tc=i(Dl);const ic=3;function nc(e,t,i){1===e&&i.readMessage(rc,t)}function rc(e,t,i){if(3===e){const{id:e,bitmap:n,width:r,height:a,left:s,top:o,advance:l}=i.readMessage(ac,{});t.push({id:e,bitmap:new js({width:r+2*ic,height:a+2*ic},n),metrics:{width:r,height:a,left:s,top:o,advance:l}})}}function ac(e,t,i){1===e?t.id=i.readVarint():2===e?t.bitmap=i.readBytes():3===e?t.width=i.readVarint():4===e?t.height=i.readVarint():5===e?t.left=i.readSVarint():6===e?t.top=i.readSVarint():7===e&&(t.advance=i.readVarint())}const sc=ic;function oc(e){let t=0,i=0;for(const s of e)t+=s.w*s.h,i=Math.max(i,s.w);e.sort(((e,t)=>t.h-e.h));const n=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),i),h:1/0}];let r=0,a=0;for(const s of e)for(let e=n.length-1;e>=0;e--){const t=n[e];if(!(s.w>t.w||s.h>t.h)){if(s.x=t.x,s.y=t.y,a=Math.max(a,s.y+s.h),r=Math.max(r,s.x+s.w),s.w===t.w&&s.h===t.h){const t=n.pop();e<n.length&&(n[e]=t)}else s.h===t.h?(t.x+=s.w,t.w-=s.w):s.w===t.w?(t.y+=s.h,t.h-=s.h):(n.push({x:t.x+s.w,y:t.y,w:t.w-s.w,h:s.h}),t.y+=s.h,t.h-=s.h);break}}return{w:r,h:a,fill:t/(r*a)||0}}const lc=1;class cc{constructor(e,t){let{pixelRatio:i,version:n,stretchX:r,stretchY:a,content:s}=t;this.paddedRect=e,this.pixelRatio=i,this.stretchX=r,this.stretchY=a,this.content=s,this.version=n}get tl(){return[this.paddedRect.x+lc,this.paddedRect.y+lc]}get br(){return[this.paddedRect.x+this.paddedRect.w-lc,this.paddedRect.y+this.paddedRect.h-lc]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2*lc)/this.pixelRatio,(this.paddedRect.h-2*lc)/this.pixelRatio]}}class uc{constructor(e,t){const i={},n={};this.haveRenderCallbacks=[];const r=[];this.addImages(e,i,r),this.addImages(t,n,r);const{w:a,h:s}=oc(r),o=new Us({width:a||1,height:s||1});for(const l in e){const t=e[l],n=i[l].paddedRect;Us.copy(t.data,o,{x:0,y:0},{x:n.x+lc,y:n.y+lc},t.data)}for(const l in t){const e=t[l],i=n[l].paddedRect,r=i.x+lc,a=i.y+lc,s=e.data.width,c=e.data.height;Us.copy(e.data,o,{x:0,y:0},{x:r,y:a},e.data),Us.copy(e.data,o,{x:0,y:c-1},{x:r,y:a-1},{width:s,height:1}),Us.copy(e.data,o,{x:0,y:0},{x:r,y:a+c},{width:s,height:1}),Us.copy(e.data,o,{x:s-1,y:0},{x:r-1,y:a},{width:1,height:c}),Us.copy(e.data,o,{x:0,y:0},{x:r+s,y:a},{width:1,height:c})}this.image=o,this.iconPositions=i,this.patternPositions=n}addImages(e,t,i){for(const n in e){const r=e[n],a={x:0,y:0,w:r.data.width+2*lc,h:r.data.height+2*lc};i.push(a),t[n]=new cc(a,r),r.hasRenderCallback&&this.haveRenderCallbacks.push(n)}}patchUpdatedImages(e,t){e.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const i in e.updatedImages)this.patchUpdatedImage(this.iconPositions[i],e.getImage(i),t),this.patchUpdatedImage(this.patternPositions[i],e.getImage(i),t)}patchUpdatedImage(e,t,i){if(!e||!t)return;if(e.version===t.version)return;e.version=t.version;const[n,r]=e.tl;i.update(t.data,void 0,{x:n,y:r})}}var hc;Fn("ImagePosition",cc),Fn("ImageAtlas",uc),e.ai=void 0,(hc=e.ai||(e.ai={}))[hc.none=0]="none",hc[hc.horizontal=1]="horizontal",hc[hc.vertical=2]="vertical",hc[hc.horizontalOnly=3]="horizontalOnly";const dc=-17;class pc{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(e,t){const i=new pc;return i.scale=e||1,i.fontStack=t,i}static forImage(e){const t=new pc;return t.imageName=e,t}}class fc{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(e,t){const i=new fc;for(let n=0;n<e.sections.length;n++){const r=e.sections[n];r.image?i.addImageSection(r):i.addTextSection(r,t)}return i}length(){return this.text.length}getSection(e){return this.sections[this.sectionIndex[e]]}getSectionIndex(e){return this.sectionIndex[e]}getCharCode(e){return this.text.charCodeAt(e)}verticalizePunctuation(){this.text=function(e){let t="";for(let i=0;i<e.length;i++){const n=e.charCodeAt(i+1)||null,r=e.charCodeAt(i-1)||null;t+=n&&Gn(n)&&!Ml[e[i+1]]||r&&Gn(r)&&!Ml[e[i-1]]||!Ml[e[i]]?e[i]:Ml[e[i]]}return t}(this.text)}trim(){let e=0;for(let i=0;i<this.text.length&&gc[this.text.charCodeAt(i)];i++)e++;let t=this.text.length;for(let i=this.text.length-1;i>=0&&i>=e&&gc[this.text.charCodeAt(i)];i--)t--;this.text=this.text.substring(e,t),this.sectionIndex=this.sectionIndex.slice(e,t)}substring(e,t){const i=new fc;return i.text=this.text.substring(e,t),i.sectionIndex=this.sectionIndex.slice(e,t),i.sections=this.sections,i}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce(((e,t)=>Math.max(e,this.sections[t].scale)),0)}addTextSection(e,t){this.text+=e.text,this.sections.push(pc.forText(e.scale,e.fontStack||t));const i=this.sections.length-1;for(let n=0;n<e.text.length;++n)this.sectionIndex.push(i)}addImageSection(e){const t=e.image?e.image.name:"";if(0===t.length)return void S("Can't add FormattedSection with an empty image.");const i=this.getNextImageSectionCharCode();i?(this.text+=String.fromCharCode(i),this.sections.push(pc.forImage(t)),this.sectionIndex.push(this.sections.length-1)):S("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function mc(t,i,n,r,a,s,o,l,c,u,h,d,p,f,m,g){const y=fc.fromFeature(t,a);let _;d===e.ai.vertical&&y.verticalizePunctuation();const{processBidirectionalText:v,processStyledBidirectionalText:x}=or;if(v&&1===y.sections.length){_=[];const e=v(y.toString(),Sc(y,u,s,i,r,f,m));for(const t of e){const e=new fc;e.text=t,e.sections=y.sections;for(let i=0;i<t.length;i++)e.sectionIndex.push(0);_.push(e)}}else if(x){_=[];const e=x(y.text,y.sectionIndex,Sc(y,u,s,i,r,f,m));for(const t of e){const e=new fc;e.text=t[0],e.sectionIndex=t[1],e.sections=y.sections,_.push(e)}}else _=function(e,t){const i=[],n=e.text;let r=0;for(const a of t)i.push(e.substring(r,a)),r=a;return r<n.length&&i.push(e.substring(r,n.length)),i}(y,Sc(y,u,s,i,r,f,m));const b=[],w={positionedLines:b,text:y.toString(),top:h[1],bottom:h[1],left:h[0],right:h[0],writingMode:d,iconsInText:!1,verticalizable:!1};return function(t,i,n,r,a,s,o,l,c,u,h,d){let p=0,f=dc,m=0,g=0;const y="right"===l?1:"left"===l?0:.5;let _=0;for(const S of a){S.trim();const a=S.getMaxScale(),o=(a-1)*zl,l={positionedGlyphs:[],lineOffset:0};t.positionedLines[_]=l;const x=l.positionedGlyphs;let b=0;if(!S.length()){f+=s,++_;continue}for(let s=0;s<S.length();s++){const l=S.getSection(s),m=S.getSectionIndex(s),g=S.getCharCode(s);let y=0,_=null,w=null,T=null,k=zl;const E=!(c===e.ai.horizontal||!h&&!Zn(g)||h&&(gc[g]||(v=g,jn.Arabic(v)||jn["Arabic Supplement"](v)||jn["Arabic Extended-A"](v)||jn["Arabic Presentation Forms-A"](v)||jn["Arabic Presentation Forms-B"](v))));if(l.imageName){const e=r[l.imageName];if(!e)continue;T=l.imageName,t.iconsInText=t.iconsInText||!0,w=e.paddedRect;const i=e.displaySize;l.scale=l.scale*zl/d,_={width:i[0],height:i[1],left:lc,top:-sc,advance:E?i[1]:i[0]},y=o+(zl-i[1]*l.scale),k=_.advance;const n=E?i[0]*l.scale-zl*a:i[1]*l.scale-zl*a;n>0&&n>b&&(b=n)}else{const e=n[l.fontStack],t=e&&e[g];if(t&&t.rect)w=t.rect,_=t.metrics;else{const e=i[l.fontStack],t=e&&e[g];if(!t)continue;_=t.metrics}y=(a-l.scale)*zl}E?(t.verticalizable=!0,x.push({glyph:g,imageName:T,x:p,y:f+y,vertical:E,scale:l.scale,fontStack:l.fontStack,sectionIndex:m,metrics:_,rect:w}),p+=k*l.scale+u):(x.push({glyph:g,imageName:T,x:p,y:f+y,vertical:E,scale:l.scale,fontStack:l.fontStack,sectionIndex:m,metrics:_,rect:w}),p+=_.advance*l.scale+u)}0!==x.length&&(m=Math.max(p-u,m),kc(x,0,x.length-1,y,b)),p=0;const w=s*a+b;l.lineOffset=Math.max(b,o),f+=w,g=Math.max(w,g),++_}var v;const x=f-dc,{horizontalAlign:b,verticalAlign:w}=Tc(o);(function(e,t,i,n,r,a,s,o,l){const c=(t-i)*r;let u=0;u=a!==s?-o*n-dc:(-n*l+.5)*s;for(const h of e)for(const e of h.positionedGlyphs)e.x+=c,e.y+=u})(t.positionedLines,y,b,w,m,g,s,x,a.length),t.top+=-w*x,t.bottom=t.top+x,t.left+=-b*m,t.right=t.left+m}(w,i,n,r,_,o,l,c,d,u,p,g),!function(e){for(const t of e)if(0!==t.positionedGlyphs.length)return!1;return!0}(b)&&w}const gc={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},yc={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function _c(e,t,i,n,r,a){if(t.imageName){const e=n[t.imageName];return e?e.displaySize[0]*t.scale*zl/a+r:0}{const n=i[t.fontStack],a=n&&n[e];return a?a.metrics.advance*t.scale+r:0}}function vc(e,t,i,n){const r=Math.pow(e-t,2);return n?e<t?r/2:2*r:r+Math.abs(i)*i}function xc(e,t,i){let n=0;return 10===e&&(n-=1e4),i&&(n+=150),40!==e&&65288!==e||(n+=50),41!==t&&65289!==t||(n+=50),n}function bc(e,t,i,n,r,a){let s=null,o=vc(t,i,r,a);for(const l of n){const e=vc(t-l.x,i,r,a)+l.badness;e<=o&&(s=l,o=e)}return{index:e,x:t,priorBreak:s,badness:o}}function wc(e){return e?wc(e.priorBreak).concat(e.index):[]}function Sc(e,t,i,n,r,a,s){if("point"!==a)return[];if(!e)return[];const o=[],l=function(e,t,i,n,r,a){let s=0;for(let o=0;o<e.length();o++){const i=e.getSection(o);s+=_c(e.getCharCode(o),i,n,r,t,a)}return s/Math.max(1,Math.ceil(s/i))}(e,t,i,n,r,s),c=e.text.indexOf("\u200b")>=0;let u=0;for(let d=0;d<e.length();d++){const i=e.getSection(d),a=e.getCharCode(d);if(gc[a]||(u+=_c(a,i,n,r,t,s)),d<e.length()-1){const t=!((h=a)<11904||!(jn["Bopomofo Extended"](h)||jn.Bopomofo(h)||jn["CJK Compatibility Forms"](h)||jn["CJK Compatibility Ideographs"](h)||jn["CJK Compatibility"](h)||jn["CJK Radicals Supplement"](h)||jn["CJK Strokes"](h)||jn["CJK Symbols and Punctuation"](h)||jn["CJK Unified Ideographs Extension A"](h)||jn["CJK Unified Ideographs"](h)||jn["Enclosed CJK Letters and Months"](h)||jn["Halfwidth and Fullwidth Forms"](h)||jn.Hiragana(h)||jn["Ideographic Description Characters"](h)||jn["Kangxi Radicals"](h)||jn["Katakana Phonetic Extensions"](h)||jn.Katakana(h)||jn["Vertical Forms"](h)||jn["Yi Radicals"](h)||jn["Yi Syllables"](h)));(yc[a]||t||i.imageName)&&o.push(bc(d+1,u,l,o,xc(a,e.getCharCode(d+1),t&&c),!1))}}var h;return wc(bc(e.length(),u,l,o,0,!0))}function Tc(e){let t=.5,i=.5;switch(e){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(e){case"bottom":case"bottom-right":case"bottom-left":i=1;break;case"top":case"top-right":case"top-left":i=0}return{horizontalAlign:t,verticalAlign:i}}function kc(e,t,i,n,r){if(!n&&!r)return;const a=e[i],s=(e[i].x+a.metrics.advance*a.scale)*n;for(let o=t;o<=i;o++)e[o].x-=s,e[o].y+=r}function Ec(e,t,i){const{horizontalAlign:n,verticalAlign:r}=Tc(i),a=t[0]-e.displaySize[0]*n,s=t[1]-e.displaySize[1]*r;return{image:e,top:s,bottom:s+e.displaySize[1],left:a,right:a+e.displaySize[0]}}function Pc(e,t,i,n,r,a){const s=e.image;let o;if(s.content){const e=s.content,t=s.pixelRatio||1;o=[e[0]/t,e[1]/t,s.displaySize[0]-e[2]/t,s.displaySize[1]-e[3]/t]}const l=t.left*a,c=t.right*a;let u,h,d,p;"width"===i||"both"===i?(p=r[0]+l-n[3],h=r[0]+c+n[1]):(p=r[0]+(l+c-s.displaySize[0])/2,h=p+s.displaySize[0]);const f=t.top*a,m=t.bottom*a;return"height"===i||"both"===i?(u=r[1]+f-n[0],d=r[1]+m+n[2]):(u=r[1]+(f+m-s.displaySize[1])/2,d=u+s.displaySize[1]),{image:s,top:u,right:h,bottom:d,left:p,collisionPadding:o}}const Cc=255,Ic=128,Ac=Cc*Ic;function Mc(e,t){const{expression:i}=t;if("constant"===i.kind)return{kind:"constant",layoutSize:i.evaluate(new lr(e+1))};if("source"===i.kind)return{kind:"source"};{const{zoomStops:t,interpolationType:n}=i;let r=0;for(;r<t.length&&t[r]<=e;)r++;r=Math.max(0,r-1);let a=r;for(;a<t.length&&t[a]<e+1;)a++;a=Math.min(t.length-1,a);const s=t[r],o=t[a];return"composite"===i.kind?{kind:"composite",minZoom:s,maxZoom:o,interpolationType:n}:{kind:"camera",minZoom:s,maxZoom:o,minSize:i.evaluate(new lr(s)),maxSize:i.evaluate(new lr(o)),interpolationType:n}}}function zc(e,t,i){let n="never";const r=e.get(t);return r?n=r:e.get(i)&&(n="always"),n}const Dc=jo.VectorTileFeature.types,Lc=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Rc(e,t,i,n,r,a,s,o,l,c,u,h,d){const p=o?Math.min(Ac,Math.round(o[0])):0,f=o?Math.min(Ac,Math.round(o[1])):0;e.emplaceBack(t,i,Math.round(32*n),Math.round(32*r),a,s,(p<<1)+(l?1:0),f,16*c,16*u,256*h,256*d)}function Fc(e,t,i){e.emplaceBack(t.x,t.y,i),e.emplaceBack(t.x,t.y,i),e.emplaceBack(t.x,t.y,i),e.emplaceBack(t.x,t.y,i)}function Bc(e){for(const t of e.sections)if(Xn(t.text))return!0;return!1}class Oc{constructor(e){this.layoutVertexArray=new _a,this.indexArray=new Sa,this.programConfigurations=e,this.segments=new Pa,this.dynamicLayoutVertexArray=new va,this.opacityVertexArray=new xa,this.hasVisibleVertices=!1,this.placedSymbolArray=new ia}isEmpty(){return 0===this.layoutVertexArray.length&&0===this.indexArray.length&&0===this.dynamicLayoutVertexArray.length&&0===this.opacityVertexArray.length}upload(e,t,i,n){this.isEmpty()||(i&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,kl.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,t),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,El.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,Lc,!0),this.opacityVertexBuffer.itemSize=1),(i||n)&&this.programConfigurations.upload(e))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}Fn("SymbolBuffers",Oc);class Nc{constructor(e,t,i){this.layoutVertexArray=new e,this.layoutAttributes=t,this.indexArray=new i,this.segments=new Pa,this.collisionVertexArray=new wa}upload(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,Pl.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}Fn("CollisionBuffers",Nc);class Vc{constructor(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((e=>e.id)),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Cs([]),this.placementViewportMatrix=Cs([]);const i=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Mc(this.zoom,i["text-size"]),this.iconSizeData=Mc(this.zoom,i["icon-size"]);const n=this.layers[0].layout,r=n.get("symbol-sort-key"),a=n.get("symbol-z-order");this.canOverlap="never"!==zc(n,"text-overlap","text-allow-overlap")||"never"!==zc(n,"icon-overlap","icon-allow-overlap")||n.get("text-ignore-placement")||n.get("icon-ignore-placement"),this.sortFeaturesByKey="viewport-y"!==a&&!r.isConstant(),this.sortFeaturesByY=("viewport-y"===a||"auto"===a&&!this.sortFeaturesByKey)&&this.canOverlap,"point"===n.get("symbol-placement")&&(this.writingModes=n.get("text-writing-mode").map((t=>e.ai[t]))),this.stateDependentLayerIds=this.layers.filter((e=>e.isStateDependent())).map((e=>e.id)),this.sourceID=t.sourceID}createArrays(){this.text=new Oc(new Qa(this.layers,this.zoom,(e=>/^text/.test(e)))),this.icon=new Oc(new Qa(this.layers,this.zoom,(e=>/^icon/.test(e)))),this.glyphOffsetArray=new aa,this.lineVertexArray=new sa,this.symbolInstances=new ra,this.textAnchorOffsets=new la}calculateGlyphDependencies(e,t,i,n,r){for(let a=0;a<e.length;a++)if(t[e.charCodeAt(a)]=!0,(i||n)&&r){const i=Ml[e.charAt(a)];i&&(t[i.charCodeAt(0)]=!0)}}populate(t,i,n){const r=this.layers[0],a=r.layout,s=a.get("text-font"),o=a.get("text-field"),l=a.get("icon-image"),c=("constant"!==o.value.kind||o.value.value instanceof Qe&&!o.value.value.isEmpty()||o.value.value.toString().length>0)&&("constant"!==s.value.kind||s.value.value.length>0),u="constant"!==l.value.kind||!!l.value.value||Object.keys(l.parameters).length>0,h=a.get("symbol-sort-key");if(this.features=[],!c&&!u)return;const d=i.iconDependencies,p=i.glyphDependencies,f=i.availableImages,m=new lr(this.zoom);for(const{feature:g,id:y,index:_,sourceLayerIndex:v}of t){const t=r._featureFilter.needGeometry,i=ss(g,t);if(!r._featureFilter.filter(m,i,n))continue;let o,l;if(t||(i.geometry=as(g)),c){const e=r.getValueAndResolveTokens("text-field",i,n,f),t=Qe.factory(e);Bc(t)&&(this.hasRTLText=!0),(!this.hasRTLText||"unavailable"===ar()||this.hasRTLText&&or.isParsed())&&(o=Al(t,r,i))}if(u){const e=r.getValueAndResolveTokens("icon-image",i,n,f);l=e instanceof nt?e:nt.fromString(e)}if(!o&&!l)continue;const x=this.sortFeaturesByKey?h.evaluate(i,{},n):void 0;if(this.features.push({id:y,text:o,icon:l,index:_,sourceLayerIndex:v,geometry:i.geometry,properties:g.properties,type:Dc[g.type],sortKey:x}),l&&(d[l.name]=!0),o){const t=s.evaluate(i,{},n).join(","),r="viewport"!==a.get("text-rotation-alignment")&&"point"!==a.get("symbol-placement");this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(e.ai.vertical)>=0;for(const e of o.sections)if(e.image)d[e.image.name]=!0;else{const i=Un(o.toString()),n=e.fontStack||t,a=p[n]=p[n]||{};this.calculateGlyphDependencies(e.text,a,r,this.allowVerticalPlacement,i)}}}"line"===a.get("symbol-placement")&&(this.features=function(e){const t={},i={},n=[];let r=0;function a(t){n.push(e[t]),r++}function s(e,t,r){const a=i[e];return delete i[e],i[t]=a,n[a].geometry[0].pop(),n[a].geometry[0]=n[a].geometry[0].concat(r[0]),a}function o(e,i,r){const a=t[i];return delete t[i],t[e]=a,n[a].geometry[0].shift(),n[a].geometry[0]=r[0].concat(n[a].geometry[0]),a}function l(e,t,i){const n=i?t[0][t[0].length-1]:t[0][0];return`${e}:${n.x}:${n.y}`}for(let c=0;c<e.length;c++){const u=e[c],h=u.geometry,d=u.text?u.text.toString():null;if(!d){a(c);continue}const p=l(d,h),f=l(d,h,!0);if(p in i&&f in t&&i[p]!==t[f]){const e=o(p,f,h),r=s(p,f,n[e].geometry);delete t[p],delete i[f],i[l(d,n[r].geometry,!0)]=r,n[e].geometry=null}else p in i?s(p,f,h):f in t?o(p,f,h):(a(c),t[p]=r-1,i[f]=r-1)}return n.filter((e=>e.geometry))}(this.features)),this.sortFeaturesByKey&&this.features.sort(((e,t)=>e.sortKey-t.sortKey))}update(e,t,i){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,t,this.layers,i),this.icon.programConfigurations.updatePaintArrays(e,t,this.layers,i))}isEmpty(){return 0===this.symbolInstances.length&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(e,t){const i=this.lineVertexArray.length;if(void 0!==e.segment){let i=e.dist(t[e.segment+1]),n=e.dist(t[e.segment]);const r={};for(let a=e.segment+1;a<t.length;a++)r[a]={x:t[a].x,y:t[a].y,tileUnitDistanceFromAnchor:i},a<t.length-1&&(i+=t[a+1].dist(t[a]));for(let a=e.segment||0;a>=0;a--)r[a]={x:t[a].x,y:t[a].y,tileUnitDistanceFromAnchor:n},a>0&&(n+=t[a-1].dist(t[a]));for(let e=0;e<t.length;e++){const t=r[e];this.lineVertexArray.emplaceBack(t.x,t.y,t.tileUnitDistanceFromAnchor)}}return{lineStartIndex:i,lineLength:this.lineVertexArray.length-i}}addSymbols(t,i,n,r,a,s,o,l,c,u,h,d){const p=t.indexArray,f=t.layoutVertexArray,m=t.segments.prepareSegment(4*i.length,f,p,this.canOverlap?s.sortKey:void 0),g=this.glyphOffsetArray.length,y=m.vertexLength,_=this.allowVerticalPlacement&&o===e.ai.vertical?Math.PI/2:0,v=s.text&&s.text.sections;for(let e=0;e<i.length;e++){const{tl:r,tr:a,bl:o,br:c,tex:u,pixelOffsetTL:h,pixelOffsetBR:g,minFontScaleX:y,minFontScaleY:x,glyphOffset:b,isSDF:w,sectionIndex:S}=i[e],T=m.vertexLength,k=b[1];Rc(f,l.x,l.y,r.x,k+r.y,u.x,u.y,n,w,h.x,h.y,y,x),Rc(f,l.x,l.y,a.x,k+a.y,u.x+u.w,u.y,n,w,g.x,h.y,y,x),Rc(f,l.x,l.y,o.x,k+o.y,u.x,u.y+u.h,n,w,h.x,g.y,y,x),Rc(f,l.x,l.y,c.x,k+c.y,u.x+u.w,u.y+u.h,n,w,g.x,g.y,y,x),Fc(t.dynamicLayoutVertexArray,l,_),p.emplaceBack(T,T+1,T+2),p.emplaceBack(T+1,T+2,T+3),m.vertexLength+=4,m.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(b[0]),e!==i.length-1&&S===i[e+1].sectionIndex||t.programConfigurations.populatePaintArrays(f.length,s,s.index,{},d,v&&v[S])}t.placedSymbolArray.emplaceBack(l.x,l.y,g,this.glyphOffsetArray.length-g,y,c,u,l.segment,n?n[0]:0,n?n[1]:0,r[0],r[1],o,0,!1,0,h)}_addCollisionDebugVertex(e,t,i,n,r,a){return t.emplaceBack(0,0),e.emplaceBack(i.x,i.y,n,r,Math.round(a.x),Math.round(a.y))}addCollisionDebugVertices(e,t,i,n,r,s,o){const l=r.segments.prepareSegment(4,r.layoutVertexArray,r.indexArray),c=l.vertexLength,u=r.layoutVertexArray,h=r.collisionVertexArray,d=o.anchorX,p=o.anchorY;this._addCollisionDebugVertex(u,h,s,d,p,new a(e,t)),this._addCollisionDebugVertex(u,h,s,d,p,new a(i,t)),this._addCollisionDebugVertex(u,h,s,d,p,new a(i,n)),this._addCollisionDebugVertex(u,h,s,d,p,new a(e,n)),l.vertexLength+=4;const f=r.indexArray;f.emplaceBack(c,c+1),f.emplaceBack(c+1,c+2),f.emplaceBack(c+2,c+3),f.emplaceBack(c+3,c),l.primitiveLength+=4}addDebugCollisionBoxes(e,t,i,n){for(let r=e;r<t;r++){const e=this.collisionBoxArray.get(r);this.addCollisionDebugVertices(e.x1,e.y1,e.x2,e.y2,n?this.textCollisionBox:this.iconCollisionBox,e.anchorPoint,i)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Nc(ba,Cl.members,Ta),this.iconCollisionBox=new Nc(ba,Cl.members,Ta);for(let e=0;e<this.symbolInstances.length;e++){const t=this.symbolInstances.get(e);this.addDebugCollisionBoxes(t.textBoxStartIndex,t.textBoxEndIndex,t,!0),this.addDebugCollisionBoxes(t.verticalTextBoxStartIndex,t.verticalTextBoxEndIndex,t,!0),this.addDebugCollisionBoxes(t.iconBoxStartIndex,t.iconBoxEndIndex,t,!1),this.addDebugCollisionBoxes(t.verticalIconBoxStartIndex,t.verticalIconBoxEndIndex,t,!1)}}_deserializeCollisionBoxesForSymbol(e,t,i,n,r,a,s,o,l){const c={};for(let u=t;u<i;u++){const t=e.get(u);c.textBox={x1:t.x1,y1:t.y1,x2:t.x2,y2:t.y2,anchorPointX:t.anchorPointX,anchorPointY:t.anchorPointY},c.textFeatureIndex=t.featureIndex;break}for(let u=n;u<r;u++){const t=e.get(u);c.verticalTextBox={x1:t.x1,y1:t.y1,x2:t.x2,y2:t.y2,anchorPointX:t.anchorPointX,anchorPointY:t.anchorPointY},c.verticalTextFeatureIndex=t.featureIndex;break}for(let u=a;u<s;u++){const t=e.get(u);c.iconBox={x1:t.x1,y1:t.y1,x2:t.x2,y2:t.y2,anchorPointX:t.anchorPointX,anchorPointY:t.anchorPointY},c.iconFeatureIndex=t.featureIndex;break}for(let u=o;u<l;u++){const t=e.get(u);c.verticalIconBox={x1:t.x1,y1:t.y1,x2:t.x2,y2:t.y2,anchorPointX:t.anchorPointX,anchorPointY:t.anchorPointY},c.verticalIconFeatureIndex=t.featureIndex;break}return c}deserializeCollisionBoxes(e){this.collisionArrays=[];for(let t=0;t<this.symbolInstances.length;t++){const i=this.symbolInstances.get(t);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,i.textBoxStartIndex,i.textBoxEndIndex,i.verticalTextBoxStartIndex,i.verticalTextBoxEndIndex,i.iconBoxStartIndex,i.iconBoxEndIndex,i.verticalIconBoxStartIndex,i.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(e,t){const i=e.placedSymbolArray.get(t),n=i.vertexStartIndex+4*i.numGlyphs;for(let r=i.vertexStartIndex;r<n;r+=4)e.indexArray.emplaceBack(r,r+1,r+2),e.indexArray.emplaceBack(r+1,r+2,r+3)}getSortedSymbolIndexes(e){if(this.sortedAngle===e&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;const t=Math.sin(e),i=Math.cos(e),n=[],r=[],a=[];for(let s=0;s<this.symbolInstances.length;++s){a.push(s);const e=this.symbolInstances.get(s);n.push(0|Math.round(t*e.anchorX+i*e.anchorY)),r.push(e.featureIndex)}return a.sort(((e,t)=>n[e]-n[t]||r[t]-r[e])),a}addToSortKeyRanges(e,t){const i=this.sortKeyRanges[this.sortKeyRanges.length-1];i&&i.sortKey===t?i.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:t,symbolInstanceStart:e,symbolInstanceEnd:e+1})}sortFeatures(e){if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const e of this.symbolInstanceIndexes){const t=this.symbolInstances.get(e);this.featureSortOrder.push(t.featureIndex),[t.rightJustifiedTextSymbolIndex,t.centerJustifiedTextSymbolIndex,t.leftJustifiedTextSymbolIndex].forEach(((e,t,i)=>{e>=0&&i.indexOf(e)===t&&this.addIndicesForPlacedSymbol(this.text,e)})),t.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,t.verticalPlacedTextSymbolIndex),t.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,t.placedIconSymbolIndex),t.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,t.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let jc,Uc;Fn("SymbolBucket",Vc,{omit:["layers","collisionBoxArray","features","compareText"]}),Vc.MAX_GLYPHS=65535,Vc.addDynamicAttributes=Fc;var $c={get paint(){return Uc=Uc||new wr({"icon-opacity":new _r(X.paint_symbol["icon-opacity"]),"icon-color":new _r(X.paint_symbol["icon-color"]),"icon-halo-color":new _r(X.paint_symbol["icon-halo-color"]),"icon-halo-width":new _r(X.paint_symbol["icon-halo-width"]),"icon-halo-blur":new _r(X.paint_symbol["icon-halo-blur"]),"icon-translate":new yr(X.paint_symbol["icon-translate"]),"icon-translate-anchor":new yr(X.paint_symbol["icon-translate-anchor"]),"text-opacity":new _r(X.paint_symbol["text-opacity"]),"text-color":new _r(X.paint_symbol["text-color"],{runtimeType:me,getOverride:e=>e.textColor,hasOverride:e=>!!e.textColor}),"text-halo-color":new _r(X.paint_symbol["text-halo-color"]),"text-halo-width":new _r(X.paint_symbol["text-halo-width"]),"text-halo-blur":new _r(X.paint_symbol["text-halo-blur"]),"text-translate":new yr(X.paint_symbol["text-translate"]),"text-translate-anchor":new yr(X.paint_symbol["text-translate-anchor"])})},get layout(){return jc=jc||new wr({"symbol-placement":new yr(X.layout_symbol["symbol-placement"]),"symbol-spacing":new yr(X.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new yr(X.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new _r(X.layout_symbol["symbol-sort-key"]),"symbol-z-order":new yr(X.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new yr(X.layout_symbol["icon-allow-overlap"]),"icon-overlap":new yr(X.layout_symbol["icon-overlap"]),"icon-ignore-placement":new yr(X.layout_symbol["icon-ignore-placement"]),"icon-optional":new yr(X.layout_symbol["icon-optional"]),"icon-rotation-alignment":new yr(X.layout_symbol["icon-rotation-alignment"]),"icon-size":new _r(X.layout_symbol["icon-size"]),"icon-text-fit":new yr(X.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new yr(X.layout_symbol["icon-text-fit-padding"]),"icon-image":new _r(X.layout_symbol["icon-image"]),"icon-rotate":new _r(X.layout_symbol["icon-rotate"]),"icon-padding":new _r(X.layout_symbol["icon-padding"]),"icon-keep-upright":new yr(X.layout_symbol["icon-keep-upright"]),"icon-offset":new _r(X.layout_symbol["icon-offset"]),"icon-anchor":new _r(X.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new yr(X.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new yr(X.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new yr(X.layout_symbol["text-rotation-alignment"]),"text-field":new _r(X.layout_symbol["text-field"]),"text-font":new _r(X.layout_symbol["text-font"]),"text-size":new _r(X.layout_symbol["text-size"]),"text-max-width":new _r(X.layout_symbol["text-max-width"]),"text-line-height":new yr(X.layout_symbol["text-line-height"]),"text-letter-spacing":new _r(X.layout_symbol["text-letter-spacing"]),"text-justify":new _r(X.layout_symbol["text-justify"]),"text-radial-offset":new _r(X.layout_symbol["text-radial-offset"]),"text-variable-anchor":new yr(X.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new _r(X.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new _r(X.layout_symbol["text-anchor"]),"text-max-angle":new yr(X.layout_symbol["text-max-angle"]),"text-writing-mode":new yr(X.layout_symbol["text-writing-mode"]),"text-rotate":new _r(X.layout_symbol["text-rotate"]),"text-padding":new yr(X.layout_symbol["text-padding"]),"text-keep-upright":new yr(X.layout_symbol["text-keep-upright"]),"text-transform":new _r(X.layout_symbol["text-transform"]),"text-offset":new _r(X.layout_symbol["text-offset"]),"text-allow-overlap":new yr(X.layout_symbol["text-allow-overlap"]),"text-overlap":new yr(X.layout_symbol["text-overlap"]),"text-ignore-placement":new yr(X.layout_symbol["text-ignore-placement"]),"text-optional":new yr(X.layout_symbol["text-optional"])})}};class qc{constructor(e){if(void 0===e.property.overrides)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=e.property.overrides?e.property.overrides.runtimeType:he,this.defaultValue=e}evaluate(e){if(e.formattedSection){const t=this.defaultValue.property.overrides;if(t&&t.hasOverride(e.formattedSection))return t.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default}eachChild(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Fn("FormatSectionOverride",qc,{omit:["defaultValue"]});class Zc extends Tr{constructor(e){super(e,$c)}recalculate(e,t){if(super.recalculate(e,t),"auto"===this.layout.get("icon-rotation-alignment")&&(this.layout._values["icon-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-rotation-alignment")&&(this.layout._values["text-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]="map"===this.layout.get("text-rotation-alignment")?"map":"viewport"),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),"point"===this.layout.get("symbol-placement")){const e=this.layout.get("text-writing-mode");if(e){const t=[];for(const i of e)t.indexOf(i)<0&&t.push(i);this.layout._values["text-writing-mode"]=t}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(e,t,i,n){const r=this.layout.get(e).evaluate(t,{},i,n),a=this._unevaluatedLayout._values[e];return a.isDataDriven()||Ri(a.value)||!r?r:function(e,t){return t.replace(/{([^{}]+)}/g,((t,i)=>e&&i in e?String(e[i]):""))}(t.properties,r)}createBucket(e){return new Vc(e)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const e of $c.paint.overridableProperties){if(!Zc.hasPaintOverride(this.layout,e))continue;const t=this.paint.get(e),i=new qc(t),n=new Li(i,t.property.specification);let r=null;r="constant"===t.value.kind||"source"===t.value.kind?new Bi("source",n):new Oi("composite",n,t.value.zoomStops),this.paint._values[e]=new mr(t.property,r,t.parameters)}}_handleOverridablePaintPropertyUpdate(e,t,i){return!(!this.layout||t.isDataDriven()||i.isDataDriven())&&Zc.hasPaintOverride(this.layout,e)}static hasPaintOverride(e,t){const i=e.get("text-field"),n=$c.paint.properties[t];let r=!1;const a=e=>{for(const t of e)if(n.overrides&&n.overrides.hasOverride(t))return void(r=!0)};if("constant"===i.value.kind&&i.value.value instanceof Qe)a(i.value.value.sections);else if("source"===i.value.kind){const e=t=>{r||(t instanceof lt&&st(t.value)===ve?a(t.value.sections):t instanceof di?a(t.sections):t.eachChild(e))},t=i.value;t._styleExpression&&e(t._styleExpression.expression)}return r}}let Gc;var Wc={get paint(){return Gc=Gc||new wr({"background-color":new yr(X.paint_background["background-color"]),"background-pattern":new xr(X.paint_background["background-pattern"]),"background-opacity":new yr(X.paint_background["background-opacity"])})}};class Hc extends Tr{constructor(e){super(e,Wc)}}let Xc;var Kc={get paint(){return Xc=Xc||new wr({"raster-opacity":new yr(X.paint_raster["raster-opacity"]),"raster-hue-rotate":new yr(X.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new yr(X.paint_raster["raster-brightness-min"]),"raster-brightness-max":new yr(X.paint_raster["raster-brightness-max"]),"raster-saturation":new yr(X.paint_raster["raster-saturation"]),"raster-contrast":new yr(X.paint_raster["raster-contrast"]),"raster-resampling":new yr(X.paint_raster["raster-resampling"]),"raster-fade-duration":new yr(X.paint_raster["raster-fade-duration"])})}};class Yc extends Tr{constructor(e){super(e,Kc)}}class Jc extends Tr{constructor(e){super(e,{}),this.onAdd=e=>{this.implementation.onAdd&&this.implementation.onAdd(e,e.painter.context.gl)},this.onRemove=e=>{this.implementation.onRemove&&this.implementation.onRemove(e,e.painter.context.gl)},this.implementation=e}is3D(){return"3d"===this.implementation.renderingMode}hasOffscreenPass(){return void 0!==this.implementation.prerender}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class Qc{constructor(e){this._callback=e,this._triggered=!1,"undefined"!=typeof MessageChannel&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout((()=>{this._triggered=!1,this._callback()}),0))}remove(){delete this._channel,this._callback=()=>{}}}const eu=6371008.8;class tu{constructor(e,t){if(isNaN(e)||isNaN(t))throw new Error(`Invalid LngLat object: (${e}, ${t})`);if(this.lng=+e,this.lat=+t,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new tu(g(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(e){const t=Math.PI/180,i=this.lat*t,n=e.lat*t,r=Math.sin(i)*Math.sin(n)+Math.cos(i)*Math.cos(n)*Math.cos((e.lng-this.lng)*t);return eu*Math.acos(Math.min(r,1))}static convert(e){if(e instanceof tu)return e;if(Array.isArray(e)&&(2===e.length||3===e.length))return new tu(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&"object"==typeof e&&null!==e)return new tu(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const iu=2*Math.PI*eu;function nu(e){return iu*Math.cos(e*Math.PI/180)}function ru(e){return(180+e)/360}function au(e){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e*Math.PI/360)))/360}function su(e,t){return e/nu(t)}function ou(e){return 360*e-180}function lu(e){return 360/Math.PI*Math.atan(Math.exp((180-360*e)*Math.PI/180))-90}class cu{constructor(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.x=+e,this.y=+t,this.z=+i}static fromLngLat(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const i=tu.convert(e);return new cu(ru(i.lng),au(i.lat),su(t,i.lat))}toLngLat(){return new tu(ou(this.x),lu(this.y))}toAltitude(){return this.z*nu(lu(this.y))}meterInMercatorCoordinateUnits(){return 1/iu*(e=lu(this.y),1/Math.cos(e*Math.PI/180));var e}}function uu(e,t,i){var n=2*Math.PI*6378137/256/Math.pow(2,i);return[e*n-2*Math.PI*6378137/2,t*n-2*Math.PI*6378137/2]}class hu{constructor(e,t,i){if(e<0||e>25||i<0||i>=Math.pow(2,e)||t<0||t>=Math.pow(2,e))throw new Error(`x=${t}, y=${i}, z=${e} outside of bounds. 0<=x<${Math.pow(2,e)}, 0<=y<${Math.pow(2,e)} 0<=z<=25 `);this.z=e,this.x=t,this.y=i,this.key=fu(0,e,e,t,i)}equals(e){return this.z===e.z&&this.x===e.x&&this.y===e.y}url(e,t,i){const n=(a=this.y,s=this.z,o=uu(256*(r=this.x),256*(a=Math.pow(2,s)-a-1),s),l=uu(256*(r+1),256*(a+1),s),o[0]+","+o[1]+","+l[0]+","+l[1]);var r,a,s,o,l;const c=function(e,t,i){let n,r="";for(let a=e;a>0;a--)n=1<<a-1,r+=(t&n?1:0)+(i&n?2:0);return r}(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String("tms"===i?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,t>1?"@2x":"").replace(/{quadkey}/g,c).replace(/{bbox-epsg-3857}/g,n)}isChildOf(e){const t=this.z-e.z;return t>0&&e.x===this.x>>t&&e.y===this.y>>t}getTilePoint(e){const t=Math.pow(2,this.z);return new a((e.x*t-this.x)*is,(e.y*t-this.y)*is)}toString(){return`${this.z}/${this.x}/${this.y}`}}class du{constructor(e,t){this.wrap=e,this.canonical=t,this.key=fu(e,t.z,t.z,t.x,t.y)}}class pu{constructor(e,t,i,n,r){if(e<i)throw new Error(`overscaledZ should be >= z; overscaledZ = ${e}; z = ${i}`);this.overscaledZ=e,this.wrap=t,this.canonical=new hu(i,+n,+r),this.key=fu(t,e,i,n,r)}clone(){return new pu(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)}scaledTo(e){if(e>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${e}; overscaledZ = ${this.overscaledZ}`);const t=this.canonical.z-e;return e>this.canonical.z?new pu(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new pu(e,this.wrap,e,this.canonical.x>>t,this.canonical.y>>t)}calculateScaledKey(e,t){if(e>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${e}; overscaledZ = ${this.overscaledZ}`);const i=this.canonical.z-e;return e>this.canonical.z?fu(this.wrap*+t,e,this.canonical.z,this.canonical.x,this.canonical.y):fu(this.wrap*+t,e,e,this.canonical.x>>i,this.canonical.y>>i)}isChildOf(e){if(e.wrap!==this.wrap)return!1;const t=this.canonical.z-e.canonical.z;return 0===e.overscaledZ||e.overscaledZ<this.overscaledZ&&e.canonical.x===this.canonical.x>>t&&e.canonical.y===this.canonical.y>>t}children(e){if(this.overscaledZ>=e)return[new pu(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const t=this.canonical.z+1,i=2*this.canonical.x,n=2*this.canonical.y;return[new pu(t,this.wrap,t,i,n),new pu(t,this.wrap,t,i+1,n),new pu(t,this.wrap,t,i,n+1),new pu(t,this.wrap,t,i+1,n+1)]}isLessThan(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))}wrapped(){return new pu(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(e){return new pu(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new du(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(e){return this.canonical.getTilePoint(new cu(e.x-this.wrap,e.y))}}function fu(e,t,i,n,r){(e*=2)<0&&(e=-1*e-1);const a=1<<i;return(a*a*e+a*r+n).toString(36)+i.toString(36)+t.toString(36)}Fn("CanonicalTileID",hu),Fn("OverscaledTileID",pu,{omit:["posMatrix"]});class mu{constructor(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0;if(this.uid=e,t.height!==t.width)throw new RangeError("DEM tiles must be square");if(i&&!["mapbox","terrarium","custom"].includes(i))return void S(`"${i}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=t.height;const o=this.dim=t.height-2;switch(this.data=new Uint32Array(t.data.buffer),i){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=n,this.greenFactor=r,this.blueFactor=a,this.baseShift=s;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let l=0;l<o;l++)this.data[this._idx(-1,l)]=this.data[this._idx(0,l)],this.data[this._idx(o,l)]=this.data[this._idx(o-1,l)],this.data[this._idx(l,-1)]=this.data[this._idx(l,0)],this.data[this._idx(l,o)]=this.data[this._idx(l,o-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(o,-1)]=this.data[this._idx(o-1,0)],this.data[this._idx(-1,o)]=this.data[this._idx(0,o-1)],this.data[this._idx(o,o)]=this.data[this._idx(o-1,o-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let l=0;l<o;l++)for(let e=0;e<o;e++){const t=this.get(l,e);t>this.max&&(this.max=t),t<this.min&&(this.min=t)}}get(e,t){const i=new Uint8Array(this.data.buffer),n=4*this._idx(e,t);return this.unpack(i[n],i[n+1],i[n+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(e,t){if(e<-1||e>=this.dim+1||t<-1||t>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(t+1)*this.stride+(e+1)}unpack(e,t,i){return e*this.redFactor+t*this.greenFactor+i*this.blueFactor-this.baseShift}getPixels(){return new Us({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(e,t,i){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");let n=t*this.dim,r=t*this.dim+this.dim,a=i*this.dim,s=i*this.dim+this.dim;switch(t){case-1:n=r-1;break;case 1:r=n+1}switch(i){case-1:a=s-1;break;case 1:s=a+1}const o=-t*this.dim,l=-i*this.dim;for(let c=a;c<s;c++)for(let t=n;t<r;t++)this.data[this._idx(t,c)]=e.data[this._idx(t+o,c+l)]}}Fn("DEMData",mu);class gu{constructor(e){this._stringToNumber={},this._numberToString=[];for(let t=0;t<e.length;t++){const i=e[t];this._stringToNumber[i]=t,this._numberToString[t]=i}}encode(e){return this._stringToNumber[e]}decode(e){if(e>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${e} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[e]}}class yu{constructor(e,t,i,n,r){this.type="Feature",this._vectorTileFeature=e,e._z=t,e._x=i,e._y=n,this.properties=e.properties,this.id=r}get geometry(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(e){this._geometry=e}toJSON(){const e={geometry:this.geometry};for(const t in this)"_geometry"!==t&&"_vectorTileFeature"!==t&&(e[t]=this[t]);return e}}class _u{constructor(e,t){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new Ln(is,16,0),this.grid3D=new Ln(is,16,0),this.featureIndexArray=new ua,this.promoteId=t}insert(e,t,i,n,r,a){const s=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(i,n,r);const o=a?this.grid3D:this.grid;for(let l=0;l<t.length;l++){const e=t[l],i=[1/0,1/0,-1/0,-1/0];for(let t=0;t<e.length;t++){const n=e[t];i[0]=Math.min(i[0],n.x),i[1]=Math.min(i[1],n.y),i[2]=Math.max(i[2],n.x),i[3]=Math.max(i[3],n.y)}i[0]<is&&i[1]<is&&i[2]>=0&&i[3]>=0&&o.insert(s,i[0],i[1],i[2],i[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new jo.VectorTile(new tc(this.rawTileData)).layers,this.sourceLayerCoder=new gu(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(e,t,i,n){this.loadVTLayers();const r=e.params||{},s=is/e.tileSize/e.scale,o=qi(r.filter),l=e.queryGeometry,c=e.queryPadding*s,u=xu(l),h=this.grid.query(u.minX-c,u.minY-c,u.maxX+c,u.maxY+c),d=xu(e.cameraQueryGeometry),p=this.grid3D.query(d.minX-c,d.minY-c,d.maxX+c,d.maxY+c,((t,i,n,r)=>function(e,t,i,n,r){for(const a of e)if(t<=a.x&&i<=a.y&&n>=a.x&&r>=a.y)return!0;const s=[new a(t,i),new a(t,r),new a(n,r),new a(n,i)];if(e.length>2)for(const a of s)if(_s(e,a))return!0;for(let a=0;a<e.length-1;a++)if(vs(e[a],e[a+1],s))return!0;return!1}(e.cameraQueryGeometry,t-c,i-c,n+c,r+c)));for(const a of p)h.push(a);h.sort(bu);const f={};let m;for(let a=0;a<h.length;a++){const c=h[a];if(c===m)continue;m=c;const u=this.featureIndexArray.get(c);let d=null;this.loadMatchingFeature(f,u.bucketIndex,u.sourceLayerIndex,u.featureIndex,o,r.layers,r.availableImages,t,i,n,((t,i,n)=>(d||(d=as(t)),i.queryIntersectsFeature(l,t,n,d,this.z,e.transform,s,e.pixelPosMatrix))))}return f}loadMatchingFeature(e,t,i,n,r,a,s,o,l,c,u){const h=this.bucketLayerIDs[t];if(a&&!function(e,t){for(let i=0;i<e.length;i++)if(t.indexOf(e[i])>=0)return!0;return!1}(a,h))return;const d=this.sourceLayerCoder.decode(i),p=this.vtLayers[d].feature(n);if(r.needGeometry){const e=ss(p,!0);if(!r.filter(new lr(this.tileID.overscaledZ),e,this.tileID.canonical))return}else if(!r.filter(new lr(this.tileID.overscaledZ),p))return;const f=this.getId(p,d);for(let m=0;m<h.length;m++){const t=h[m];if(a&&a.indexOf(t)<0)continue;const i=o[t];if(!i)continue;let r={};f&&c&&(r=c.getState(i.sourceLayer||"_geojsonTileLayer",f));const d=y({},l[t]);d.paint=vu(d.paint,i.paint,p,r,s),d.layout=vu(d.layout,i.layout,p,r,s);const g=!u||u(p,i,r);if(!g)continue;const _=new yu(p,this.z,this.x,this.y,f);_.layer=d;let v=e[t];void 0===v&&(v=e[t]=[]),v.push({featureIndex:n,feature:_,intersectionZ:g})}}lookupSymbolFeatures(e,t,i,n,r,a,s,o){const l={};this.loadVTLayers();const c=qi(r);for(const u of e)this.loadMatchingFeature(l,i,n,u,c,a,s,o,t);return l}hasLayer(e){for(const t of this.bucketLayerIDs)for(const i of t)if(e===i)return!0;return!1}getId(e,t){let i=e.id;return this.promoteId&&(i=e.properties["string"==typeof this.promoteId?this.promoteId:this.promoteId[t]],"boolean"==typeof i&&(i=Number(i))),i}}function vu(e,t,i,n,r){return v(e,((e,a)=>{const s=t instanceof gr?t.get(a):null;return s&&s.evaluate?s.evaluate(i,n,r):s}))}function xu(e){let t=1/0,i=1/0,n=-1/0,r=-1/0;for(const a of e)t=Math.min(t,a.x),i=Math.min(i,a.y),n=Math.max(n,a.x),r=Math.max(r,a.y);return{minX:t,minY:i,maxX:n,maxY:r}}function bu(e,t){return t-e}function wu(e,t,i,n,r){const s=[];for(let o=0;o<e.length;o++){const l=e[o];let c;for(let e=0;e<l.length-1;e++){let o=l[e],u=l[e+1];o.x<t&&u.x<t||(o.x<t?o=new a(t,o.y+(t-o.x)/(u.x-o.x)*(u.y-o.y))._round():u.x<t&&(u=new a(t,o.y+(t-o.x)/(u.x-o.x)*(u.y-o.y))._round()),o.y<i&&u.y<i||(o.y<i?o=new a(o.x+(i-o.y)/(u.y-o.y)*(u.x-o.x),i)._round():u.y<i&&(u=new a(o.x+(i-o.y)/(u.y-o.y)*(u.x-o.x),i)._round()),o.x>=n&&u.x>=n||(o.x>=n?o=new a(n,o.y+(n-o.x)/(u.x-o.x)*(u.y-o.y))._round():u.x>=n&&(u=new a(n,o.y+(n-o.x)/(u.x-o.x)*(u.y-o.y))._round()),o.y>=r&&u.y>=r||(o.y>=r?o=new a(o.x+(r-o.y)/(u.y-o.y)*(u.x-o.x),r)._round():u.y>=r&&(u=new a(o.x+(r-o.y)/(u.y-o.y)*(u.x-o.x),r)._round()),c&&o.equals(c[c.length-1])||(c=[o],s.push(c)),c.push(u)))))}}return s}Fn("FeatureIndex",_u,{omit:["rawTileData","sourceLayerCoder"]});class Su extends a{constructor(e,t,i,n){super(e,t),this.angle=i,void 0!==n&&(this.segment=n)}clone(){return new Su(this.x,this.y,this.angle,this.segment)}}function Tu(e,t,i,n,r){if(void 0===t.segment||0===i)return!0;let a=t,s=t.segment+1,o=0;for(;o>-i/2;){if(s--,s<0)return!1;o-=e[s].dist(a),a=e[s]}o+=e[s].dist(e[s+1]),s++;const l=[];let c=0;for(;o<i/2;){const t=e[s],i=e[s+1];if(!i)return!1;let a=e[s-1].angleTo(t)-t.angleTo(i);for(a=Math.abs((a+3*Math.PI)%(2*Math.PI)-Math.PI),l.push({distance:o,angleDelta:a}),c+=a;o-l[0].distance>n;)c-=l.shift().angleDelta;if(c>r)return!1;s++,o+=t.dist(i)}return!0}function ku(e){let t=0;for(let i=0;i<e.length-1;i++)t+=e[i].dist(e[i+1]);return t}function Eu(e,t,i){return e?.6*t*i:0}function Pu(e,t){return Math.max(e?e.right-e.left:0,t?t.right-t.left:0)}function Cu(e,t,i,n,r,a){const s=Eu(i,r,a),o=Pu(i,n)*a;let l=0;const c=ku(e)/2;for(let u=0;u<e.length-1;u++){const i=e[u],n=e[u+1],r=i.dist(n);if(l+r>c){const a=(c-l)/r,h=Zt.number(i.x,n.x,a),d=Zt.number(i.y,n.y,a),p=new Su(h,d,n.angleTo(i),u);return p._round(),!s||Tu(e,p,o,s,t)?p:void 0}l+=r}}function Iu(e,t,i,n,r,a,s,o,l){const c=Eu(n,a,s),u=Pu(n,r),h=u*s,d=0===e[0].x||e[0].x===l||0===e[0].y||e[0].y===l;return t-h<t/4&&(t=h+t/4),Au(e,d?t/2*o%t:(u/2+2*a)*s*o%t,t,c,i,h,d,!1,l)}function Au(e,t,i,n,r,a,s,o,l){const c=a/2,u=ku(e);let h=0,d=t-i,p=[];for(let f=0;f<e.length-1;f++){const t=e[f],s=e[f+1],o=t.dist(s),m=s.angleTo(t);for(;d+i<h+o;){d+=i;const g=(d-h)/o,y=Zt.number(t.x,s.x,g),_=Zt.number(t.y,s.y,g);if(y>=0&&y<l&&_>=0&&_<l&&d-c>=0&&d+c<=u){const t=new Su(y,_,m,f);t._round(),n&&!Tu(e,t,a,n,r)||p.push(t)}}h+=o}return o||p.length||s||(p=Au(e,h/2,i,n,r,a,s,!0,l)),p}Fn("Anchor",Su);const Mu=lc;function zu(e,t,i,n){const r=[],s=e.image,o=s.pixelRatio,l=s.paddedRect.w-2*Mu,c=s.paddedRect.h-2*Mu,u=e.right-e.left,h=e.bottom-e.top,d=s.stretchX||[[0,l]],p=s.stretchY||[[0,c]],f=(e,t)=>e+t[1]-t[0],m=d.reduce(f,0),g=p.reduce(f,0),y=l-m,_=c-g;let v=0,x=m,b=0,w=g,S=0,T=y,k=0,E=_;if(s.content&&n){const e=s.content;v=Du(d,0,e[0]),b=Du(p,0,e[1]),x=Du(d,e[0],e[2]),w=Du(p,e[1],e[3]),S=e[0]-v,k=e[1]-b,T=e[2]-e[0]-x,E=e[3]-e[1]-w}const P=(n,r,l,c)=>{const d=Ru(n.stretch-v,x,u,e.left),p=Fu(n.fixed-S,T,n.stretch,m),f=Ru(r.stretch-b,w,h,e.top),y=Fu(r.fixed-k,E,r.stretch,g),_=Ru(l.stretch-v,x,u,e.left),P=Fu(l.fixed-S,T,l.stretch,m),C=Ru(c.stretch-b,w,h,e.top),I=Fu(c.fixed-k,E,c.stretch,g),A=new a(d,f),M=new a(_,f),z=new a(_,C),D=new a(d,C),L=new a(p/o,y/o),R=new a(P/o,I/o),F=t*Math.PI/180;if(F){const e=Math.sin(F),t=Math.cos(F),i=[t,-e,e,t];A._matMult(i),M._matMult(i),D._matMult(i),z._matMult(i)}const B=n.stretch+n.fixed,O=r.stretch+r.fixed;return{tl:A,tr:M,bl:D,br:z,tex:{x:s.paddedRect.x+Mu+B,y:s.paddedRect.y+Mu+O,w:l.stretch+l.fixed-B,h:c.stretch+c.fixed-O},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:L,pixelOffsetBR:R,minFontScaleX:T/o/u,minFontScaleY:E/o/h,isSDF:i}};if(n&&(s.stretchX||s.stretchY)){const e=Lu(d,y,m),t=Lu(p,_,g);for(let i=0;i<e.length-1;i++){const n=e[i],a=e[i+1];for(let e=0;e<t.length-1;e++)r.push(P(n,t[e],a,t[e+1]))}}else r.push(P({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:l+1},{fixed:0,stretch:c+1}));return r}function Du(e,t,i){let n=0;for(const r of e)n+=Math.max(t,Math.min(i,r[1]))-Math.max(t,Math.min(i,r[0]));return n}function Lu(e,t,i){const n=[{fixed:-Mu,stretch:0}];for(const[r,a]of e){const e=n[n.length-1];n.push({fixed:r-e.stretch,stretch:e.stretch}),n.push({fixed:r-e.stretch,stretch:e.stretch+(a-r)})}return n.push({fixed:t+Mu,stretch:i}),n}function Ru(e,t,i,n){return e/t*i+n}function Fu(e,t,i,n){return e-t*i/n}class Bu{constructor(e,t,i,n,r,s,o,l,c,u){if(this.boxStartIndex=e.length,c){let e=s.top,t=s.bottom;const i=s.collisionPadding;i&&(e-=i[1],t+=i[3]);let n=t-e;n>0&&(n=Math.max(10,n),this.circleDiameter=n)}else{let c=s.top*o-l[0],h=s.bottom*o+l[2],d=s.left*o-l[3],p=s.right*o+l[1];const f=s.collisionPadding;if(f&&(d-=f[0]*o,c-=f[1]*o,p+=f[2]*o,h+=f[3]*o),u){const e=new a(d,c),t=new a(p,c),i=new a(d,h),n=new a(p,h),r=u*Math.PI/180;e._rotate(r),t._rotate(r),i._rotate(r),n._rotate(r),d=Math.min(e.x,t.x,i.x,n.x),p=Math.max(e.x,t.x,i.x,n.x),c=Math.min(e.y,t.y,i.y,n.y),h=Math.max(e.y,t.y,i.y,n.y)}e.emplaceBack(t.x,t.y,d,c,p,h,i,n,r)}this.boxEndIndex=e.length}}class Ou{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Nu;if(this.data=e,this.length=this.data.length,this.compare=t,this.length>0)for(let i=(this.length>>1)-1;i>=0;i--)this._down(i)}push(e){this.data.push(e),this.length++,this._up(this.length-1)}pop(){if(0===this.length)return;const e=this.data[0],t=this.data.pop();return this.length--,this.length>0&&(this.data[0]=t,this._down(0)),e}peek(){return this.data[0]}_up(e){const{data:t,compare:i}=this,n=t[e];for(;e>0;){const r=e-1>>1,a=t[r];if(i(n,a)>=0)break;t[e]=a,e=r}t[e]=n}_down(e){const{data:t,compare:i}=this,n=this.length>>1,r=t[e];for(;e<n;){let n=1+(e<<1),a=t[n];const s=n+1;if(s<this.length&&i(t[s],a)<0&&(n=s,a=t[s]),i(a,r)>=0)break;t[e]=a,e=n}t[e]=r}}function Nu(e,t){return e<t?-1:e>t?1:0}function Vu(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=1/0,r=1/0,s=-1/0,o=-1/0;const l=e[0];for(let a=0;a<l.length;a++){const e=l[a];(!a||e.x<n)&&(n=e.x),(!a||e.y<r)&&(r=e.y),(!a||e.x>s)&&(s=e.x),(!a||e.y>o)&&(o=e.y)}const c=Math.min(s-n,o-r);let u=c/2;const h=new Ou([],ju);if(0===c)return new a(n,r);for(let a=n;a<s;a+=c)for(let t=r;t<o;t+=c)h.push(new Uu(a+u,t+u,u,e));let d=function(e){let t=0,i=0,n=0;const r=e[0];for(let a=0,s=r.length,o=s-1;a<s;o=a++){const e=r[a],s=r[o],l=e.x*s.y-s.x*e.y;i+=(e.x+s.x)*l,n+=(e.y+s.y)*l,t+=3*l}return new Uu(i/t,n/t,0,e)}(e),p=h.length;for(;h.length;){const n=h.pop();(n.d>d.d||!d.d)&&(d=n,i&&console.log("found best %d after %d probes",Math.round(1e4*n.d)/1e4,p)),n.max-d.d<=t||(u=n.h/2,h.push(new Uu(n.p.x-u,n.p.y-u,u,e)),h.push(new Uu(n.p.x+u,n.p.y-u,u,e)),h.push(new Uu(n.p.x-u,n.p.y+u,u,e)),h.push(new Uu(n.p.x+u,n.p.y+u,u,e)),p+=4)}return i&&(console.log(`num probes: ${p}`),console.log(`best distance: ${d.d}`)),d.p}function ju(e,t){return t.max-e.max}function Uu(e,t,i,n){this.p=new a(e,t),this.h=i,this.d=function(e,t){let i=!1,n=1/0;for(let r=0;r<t.length;r++){const a=t[r];for(let t=0,r=a.length,s=r-1;t<r;s=t++){const r=a[t],o=a[s];r.y>e.y!=o.y>e.y&&e.x<(o.x-r.x)*(e.y-r.y)/(o.y-r.y)+r.x&&(i=!i),n=Math.min(n,gs(e,r,o))}}return(i?1:-1)*Math.sqrt(n)}(this.p,n),this.max=this.d+this.h*Math.SQRT2}var $u;e.aq=void 0,($u=e.aq||(e.aq={}))[$u.center=1]="center",$u[$u.left=2]="left",$u[$u.right=3]="right",$u[$u.top=4]="top",$u[$u.bottom=5]="bottom",$u[$u["top-left"]=6]="top-left",$u[$u["top-right"]=7]="top-right",$u[$u["bottom-left"]=8]="bottom-left",$u[$u["bottom-right"]=9]="bottom-right";const qu=7,Zu=Number.POSITIVE_INFINITY;function Gu(e,t){return t[1]!==Zu?function(e,t,i){let n=0,r=0;switch(t=Math.abs(t),i=Math.abs(i),e){case"top-right":case"top-left":case"top":r=i-qu;break;case"bottom-right":case"bottom-left":case"bottom":r=-i+qu}switch(e){case"top-right":case"bottom-right":case"right":n=-t;break;case"top-left":case"bottom-left":case"left":n=t}return[n,r]}(e,t[0],t[1]):function(e,t){let i=0,n=0;t<0&&(t=0);const r=t/Math.SQRT2;switch(e){case"top-right":case"top-left":n=r-qu;break;case"bottom-right":case"bottom-left":n=-r+qu;break;case"bottom":n=-t+qu;break;case"top":n=t-qu}switch(e){case"top-right":case"bottom-right":i=-r;break;case"top-left":case"bottom-left":i=r;break;case"left":i=t;break;case"right":i=-t}return[i,n]}(e,t[0])}function Wu(e,t,i){var n;const r=e.layout,a=null===(n=r.get("text-variable-anchor-offset"))||void 0===n?void 0:n.evaluate(t,{},i);if(a){const e=a.values,t=[];for(let i=0;i<e.length;i+=2){const n=t[i]=e[i],r=e[i+1].map((e=>e*zl));n.startsWith("top")?r[1]-=qu:n.startsWith("bottom")&&(r[1]+=qu),t[i+1]=r}return new it(t)}const s=r.get("text-variable-anchor");if(s){let n;n=void 0!==e._unevaluatedLayout.getValue("text-radial-offset")?[r.get("text-radial-offset").evaluate(t,{},i)*zl,Zu]:r.get("text-offset").evaluate(t,{},i).map((e=>e*zl));const a=[];for(const e of s)a.push(e,Gu(e,n));return new it(a)}return null}function Hu(e){switch(e){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Xu(t,i,n,r,a,s,o,l,c,u,h){let d=s.textMaxSize.evaluate(i,{});void 0===d&&(d=o);const p=t.layers[0].layout,f=p.get("icon-offset").evaluate(i,{},h),m=Yu(n.horizontal),g=o/24,y=t.tilePixelRatio*g,_=t.tilePixelRatio*d/24,v=t.tilePixelRatio*l,x=t.tilePixelRatio*p.get("symbol-spacing"),b=p.get("text-padding")*t.tilePixelRatio,w=function(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;const r=e.get("icon-padding").evaluate(t,{},i),a=r&&r.values;return[a[0]*n,a[1]*n,a[2]*n,a[3]*n]}(p,i,h,t.tilePixelRatio),T=p.get("text-max-angle")/180*Math.PI,k="viewport"!==p.get("text-rotation-alignment")&&"point"!==p.get("symbol-placement"),E="map"===p.get("icon-rotation-alignment")&&"point"!==p.get("symbol-placement"),P=p.get("symbol-placement"),C=x/2,I=p.get("icon-text-fit");let A;r&&"none"!==I&&(t.allowVerticalPlacement&&n.vertical&&(A=Pc(r,n.vertical,I,p.get("icon-text-fit-padding"),f,g)),m&&(r=Pc(r,m,I,p.get("icon-text-fit-padding"),f,g)));const M=(l,d)=>{d.x<0||d.x>=is||d.y<0||d.y>=is||function(t,i,n,r,a,s,o,l,c,u,h,d,p,f,m,g,y,_,v,x,b,w,T,k,E){const P=t.addToLineVertexArray(i,n);let C,I,A,M,z=0,D=0,L=0,R=0,F=-1,B=-1;const O={};let N=Fa("");if(t.allowVerticalPlacement&&r.vertical){const e=l.layout.get("text-rotate").evaluate(b,{},k)+90;A=new Bu(c,i,u,h,d,r.vertical,p,f,m,e),o&&(M=new Bu(c,i,u,h,d,o,y,_,m,e))}if(a){const n=l.layout.get("icon-rotate").evaluate(b,{}),r="none"!==l.layout.get("icon-text-fit"),s=zu(a,n,T,r),p=o?zu(o,n,T,r):void 0;I=new Bu(c,i,u,h,d,a,y,_,!1,n),z=4*s.length;const f=t.iconSizeData;let m=null;"source"===f.kind?(m=[Ic*l.layout.get("icon-size").evaluate(b,{})],m[0]>Ac&&S(`${t.layerIds[0]}: Value for "icon-size" is >= ${Cc}. Reduce your "icon-size".`)):"composite"===f.kind&&(m=[Ic*w.compositeIconSizes[0].evaluate(b,{},k),Ic*w.compositeIconSizes[1].evaluate(b,{},k)],(m[0]>Ac||m[1]>Ac)&&S(`${t.layerIds[0]}: Value for "icon-size" is >= ${Cc}. Reduce your "icon-size".`)),t.addSymbols(t.icon,s,m,x,v,b,e.ai.none,i,P.lineStartIndex,P.lineLength,-1,k),F=t.icon.placedSymbolArray.length-1,p&&(D=4*p.length,t.addSymbols(t.icon,p,m,x,v,b,e.ai.vertical,i,P.lineStartIndex,P.lineLength,-1,k),B=t.icon.placedSymbolArray.length-1)}const V=Object.keys(r.horizontal);for(const S of V){const n=r.horizontal[S];if(!C){N=Fa(n.text);const e=l.layout.get("text-rotate").evaluate(b,{},k);C=new Bu(c,i,u,h,d,n,p,f,m,e)}const a=1===n.positionedLines.length;if(L+=Ku(t,i,n,s,l,m,b,g,P,r.vertical?e.ai.horizontal:e.ai.horizontalOnly,a?V:[S],O,F,w,k),a)break}r.vertical&&(R+=Ku(t,i,r.vertical,s,l,m,b,g,P,e.ai.vertical,["vertical"],O,B,w,k));const j=C?C.boxStartIndex:t.collisionBoxArray.length,U=C?C.boxEndIndex:t.collisionBoxArray.length,$=A?A.boxStartIndex:t.collisionBoxArray.length,q=A?A.boxEndIndex:t.collisionBoxArray.length,Z=I?I.boxStartIndex:t.collisionBoxArray.length,G=I?I.boxEndIndex:t.collisionBoxArray.length,W=M?M.boxStartIndex:t.collisionBoxArray.length,H=M?M.boxEndIndex:t.collisionBoxArray.length;let X=-1;const K=(e,t)=>e&&e.circleDiameter?Math.max(e.circleDiameter,t):t;X=K(C,X),X=K(A,X),X=K(I,X),X=K(M,X);const Y=X>-1?1:0;Y&&(X*=E/zl),t.glyphOffsetArray.length>=Vc.MAX_GLYPHS&&S("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),void 0!==b.sortKey&&t.addToSortKeyRanges(t.symbolInstances.length,b.sortKey);const J=Wu(l,b,k),[Q,ee]=function(t,i){const n=t.length,r=null==i?void 0:i.values;if((null==r?void 0:r.length)>0)for(let a=0;a<r.length;a+=2){const i=r[a+1];t.emplaceBack(e.aq[r[a]],i[0],i[1])}return[n,t.length]}(t.textAnchorOffsets,J);t.symbolInstances.emplaceBack(i.x,i.y,O.right>=0?O.right:-1,O.center>=0?O.center:-1,O.left>=0?O.left:-1,O.vertical||-1,F,B,N,j,U,$,q,Z,G,W,H,u,L,R,z,D,Y,0,p,X,Q,ee)}(t,d,l,n,r,a,A,t.layers[0],t.collisionBoxArray,i.index,i.sourceLayerIndex,t.index,y,[b,b,b,b],k,c,v,w,E,f,i,s,u,h,o)};if("line"===P)for(const e of wu(i.geometry,0,0,is,is)){const i=Iu(e,x,T,n.vertical||m,r,24,_,t.overscaling,is);for(const n of i)m&&Ju(t,m.text,C,n)||M(e,n)}else if("line-center"===P){for(const e of i.geometry)if(e.length>1){const t=Cu(e,T,n.vertical||m,r,24,_);t&&M(e,t)}}else if("Polygon"===i.type)for(const e of Io(i.geometry,0)){const t=Vu(e,16);M(e[0],new Su(t.x,t.y,0))}else if("LineString"===i.type)for(const e of i.geometry)M(e,new Su(e[0].x,e[0].y,0));else if("Point"===i.type)for(const e of i.geometry)for(const t of e)M([t],new Su(t.x,t.y,0))}function Ku(e,t,i,n,r,s,o,l,c,u,h,d,p,f,m){const g=function(e,t,i,n,r,s,o,l){const c=n.layout.get("text-rotate").evaluate(s,{})*Math.PI/180,u=[];for(const h of t.positionedLines)for(const e of h.positionedGlyphs){if(!e.rect)continue;const n=e.rect||{};let s=sc+1,d=!0,p=1,f=0;const m=(r||l)&&e.vertical,g=e.metrics.advance*e.scale/2;if(l&&t.verticalizable&&(f=h.lineOffset/2-(e.imageName?-(zl-e.metrics.width*e.scale)/2:(e.scale-1)*zl)),e.imageName){const t=o[e.imageName];d=t.sdf,p=t.pixelRatio,s=lc/p}const y=r?[e.x+g,e.y]:[0,0];let _=r?[0,0]:[e.x+g+i[0],e.y+i[1]-f],v=[0,0];m&&(v=_,_=[0,0]);const x=e.metrics.isDoubleResolution?2:1,b=(e.metrics.left-s)*e.scale-g+_[0],w=(-e.metrics.top-s)*e.scale+_[1],S=b+n.w/x*e.scale/p,T=w+n.h/x*e.scale/p,k=new a(b,w),E=new a(S,w),P=new a(b,T),C=new a(S,T);if(m){const t=new a(-g,g-dc),i=-Math.PI/2,n=zl/2-g,r=new a(5-dc-n,-(e.imageName?n:0)),s=new a(...v);k._rotateAround(i,t)._add(r)._add(s),E._rotateAround(i,t)._add(r)._add(s),P._rotateAround(i,t)._add(r)._add(s),C._rotateAround(i,t)._add(r)._add(s)}if(c){const e=Math.sin(c),t=Math.cos(c),i=[t,-e,e,t];k._matMult(i),E._matMult(i),P._matMult(i),C._matMult(i)}const I=new a(0,0),A=new a(0,0);u.push({tl:k,tr:E,bl:P,br:C,tex:n,writingMode:t.writingMode,glyphOffset:y,sectionIndex:e.sectionIndex,isSDF:d,pixelOffsetTL:I,pixelOffsetBR:A,minFontScaleX:0,minFontScaleY:0})}return u}(0,i,l,r,s,o,n,e.allowVerticalPlacement),y=e.textSizeData;let _=null;"source"===y.kind?(_=[Ic*r.layout.get("text-size").evaluate(o,{})],_[0]>Ac&&S(`${e.layerIds[0]}: Value for "text-size" is >= ${Cc}. Reduce your "text-size".`)):"composite"===y.kind&&(_=[Ic*f.compositeTextSizes[0].evaluate(o,{},m),Ic*f.compositeTextSizes[1].evaluate(o,{},m)],(_[0]>Ac||_[1]>Ac)&&S(`${e.layerIds[0]}: Value for "text-size" is >= ${Cc}. Reduce your "text-size".`)),e.addSymbols(e.text,g,_,l,s,o,u,t,c.lineStartIndex,c.lineLength,p,m);for(const a of h)d[a]=e.text.placedSymbolArray.length-1;return 4*g.length}function Yu(e){for(const t in e)return e[t];return null}function Ju(e,t,i,n){const r=e.compareText;if(t in r){const e=r[t];for(let t=e.length-1;t>=0;t--)if(n.dist(e[t])<i)return!0}else r[t]=[];return r[t].push(n),!1}const Qu=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class eh{static from(e){if(!(e instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[t,i]=new Uint8Array(e,0,2);if(219!==t)throw new Error("Data does not appear to be in a KDBush format.");const n=i>>4;if(1!==n)throw new Error(`Got v${n} data when expected v1.`);const r=Qu[15&i];if(!r)throw new Error("Unrecognized array type.");const[a]=new Uint16Array(e,2,1),[s]=new Uint32Array(e,4,1);return new eh(s,a,r,e)}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:64,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Float64Array,n=arguments.length>3?arguments[3]:void 0;if(isNaN(e)||e<0)throw new Error(`Unpexpected numItems value: ${e}.`);this.numItems=+e,this.nodeSize=Math.min(Math.max(+t,2),65535),this.ArrayType=i,this.IndexArrayType=e<65536?Uint16Array:Uint32Array;const r=Qu.indexOf(this.ArrayType),a=2*e*this.ArrayType.BYTES_PER_ELEMENT,s=e*this.IndexArrayType.BYTES_PER_ELEMENT,o=(8-s%8)%8;if(r<0)throw new Error(`Unexpected typed array class: ${i}.`);n&&n instanceof ArrayBuffer?(this.data=n,this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+s+o,2*e),this._pos=2*e,this._finished=!0):(this.data=new ArrayBuffer(8+a+s+o),this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+s+o,2*e),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+r]),new Uint16Array(this.data,2,1)[0]=t,new Uint32Array(this.data,4,1)[0]=e)}add(e,t){const i=this._pos>>1;return this.ids[i]=i,this.coords[this._pos++]=e,this.coords[this._pos++]=t,i}finish(){const e=this._pos>>1;if(e!==this.numItems)throw new Error(`Added ${e} items when expected ${this.numItems}.`);return th(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(e,t,i,n){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:r,coords:a,nodeSize:s}=this,o=[0,r.length-1,0],l=[];for(;o.length;){const c=o.pop()||0,u=o.pop()||0,h=o.pop()||0;if(u-h<=s){for(let s=h;s<=u;s++){const o=a[2*s],c=a[2*s+1];o>=e&&o<=i&&c>=t&&c<=n&&l.push(r[s])}continue}const d=h+u>>1,p=a[2*d],f=a[2*d+1];p>=e&&p<=i&&f>=t&&f<=n&&l.push(r[d]),(0===c?e<=p:t<=f)&&(o.push(h),o.push(d-1),o.push(1-c)),(0===c?i>=p:n>=f)&&(o.push(d+1),o.push(u),o.push(1-c))}return l}within(e,t,i){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:n,coords:r,nodeSize:a}=this,s=[0,n.length-1,0],o=[],l=i*i;for(;s.length;){const c=s.pop()||0,u=s.pop()||0,h=s.pop()||0;if(u-h<=a){for(let i=h;i<=u;i++)ah(r[2*i],r[2*i+1],e,t)<=l&&o.push(n[i]);continue}const d=h+u>>1,p=r[2*d],f=r[2*d+1];ah(p,f,e,t)<=l&&o.push(n[d]),(0===c?e-i<=p:t-i<=f)&&(s.push(h),s.push(d-1),s.push(1-c)),(0===c?e+i>=p:t+i>=f)&&(s.push(d+1),s.push(u),s.push(1-c))}return o}}function th(e,t,i,n,r,a){if(r-n<=i)return;const s=n+r>>1;ih(e,t,s,n,r,a),th(e,t,i,n,s-1,1-a),th(e,t,i,s+1,r,1-a)}function ih(e,t,i,n,r,a){for(;r>n;){if(r-n>600){const s=r-n+1,o=i-n+1,l=Math.log(s),c=.5*Math.exp(2*l/3),u=.5*Math.sqrt(l*c*(s-c)/s)*(o-s/2<0?-1:1);ih(e,t,i,Math.max(n,Math.floor(i-o*c/s+u)),Math.min(r,Math.floor(i+(s-o)*c/s+u)),a)}const s=t[2*i+a];let o=n,l=r;for(nh(e,t,n,i),t[2*r+a]>s&&nh(e,t,n,r);o<l;){for(nh(e,t,o,l),o++,l--;t[2*o+a]<s;)o++;for(;t[2*l+a]>s;)l--}t[2*n+a]===s?nh(e,t,n,l):(l++,nh(e,t,l,r)),l<=i&&(n=l+1),i<=l&&(r=l-1)}}function nh(e,t,i,n){rh(e,i,n),rh(t,2*i,2*n),rh(t,2*i+1,2*n+1)}function rh(e,t,i){const n=e[t];e[t]=e[i],e[i]=n}function ah(e,t,i,n){const r=e-i,a=t-n;return r*r+a*a}var sh;e.bh=void 0,(sh=e.bh||(e.bh={})).create="create",sh.load="load",sh.fullLoad="fullLoad";let oh=null,lh=[];const ch=1e3/60,uh="loadTime",hh="fullLoadTime",dh={mark(e){performance.mark(e)},frame(e){const t=e;null!=oh&&lh.push(t-oh),oh=t},clearMetrics(){oh=null,lh=[],performance.clearMeasures(uh),performance.clearMeasures(hh);for(const t in e.bh)performance.clearMarks(e.bh[t])},getPerformanceMetrics(){performance.measure(uh,e.bh.create,e.bh.load),performance.measure(hh,e.bh.create,e.bh.fullLoad);const t=performance.getEntriesByName(uh)[0].duration,i=performance.getEntriesByName(hh)[0].duration,n=lh.length,r=1/(lh.reduce(((e,t)=>e+t),0)/n/1e3),a=lh.filter((e=>e>ch)).reduce(((e,t)=>e+(t-ch)/ch),0);return{loadTime:t,fullLoadTime:i,fps:r,percentDroppedFrames:a/(n+a)*100,totalFrames:n}}};e.$=function(e,t,i){var n,r,a,s,o,l,c,u,h,d,p,f,m=i[0],g=i[1],y=i[2];return t===e?(e[12]=t[0]*m+t[4]*g+t[8]*y+t[12],e[13]=t[1]*m+t[5]*g+t[9]*y+t[13],e[14]=t[2]*m+t[6]*g+t[10]*y+t[14],e[15]=t[3]*m+t[7]*g+t[11]*y+t[15]):(r=t[1],a=t[2],s=t[3],o=t[4],l=t[5],c=t[6],u=t[7],h=t[8],d=t[9],p=t[10],f=t[11],e[0]=n=t[0],e[1]=r,e[2]=a,e[3]=s,e[4]=o,e[5]=l,e[6]=c,e[7]=u,e[8]=h,e[9]=d,e[10]=p,e[11]=f,e[12]=n*m+o*g+h*y+t[12],e[13]=r*m+l*g+d*y+t[13],e[14]=a*m+c*g+p*y+t[14],e[15]=s*m+u*g+f*y+t[15]),e},e.A=Ps,e.B=Zt,e.C=class{constructor(e,t,i){this.receive=e=>{const t=e.data,i=t.id;if(i&&(!t.targetMapId||this.mapId===t.targetMapId))if("<cancel>"===t.type){delete this.tasks[i];const e=this.cancelCallbacks[i];delete this.cancelCallbacks[i],e&&e()}else E()||t.mustQueue?(this.tasks[i]=t,this.taskQueue.push(i),this.invoker.trigger()):this.processTask(i,t)},this.process=()=>{if(!this.taskQueue.length)return;const e=this.taskQueue.shift(),t=this.tasks[e];delete this.tasks[e],this.taskQueue.length&&this.invoker.trigger(),t&&this.processTask(e,t)},this.target=e,this.parent=t,this.mapId=i,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},this.invoker=new Qc(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=E()?e:window}send(e,t,i,n){let r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];const a=Math.round(1e18*Math.random()).toString(36).substring(0,10);i&&(this.callbacks[a]=i);const s=[],o={id:a,type:e,hasCallback:!!i,targetMapId:n,mustQueue:r,sourceMapId:this.mapId,data:On(t,s)};return this.target.postMessage(o,{transfer:s}),{cancel:()=>{i&&delete this.callbacks[a],this.target.postMessage({id:a,type:"<cancel>",targetMapId:n,sourceMapId:this.mapId})}}}processTask(e,t){if("<response>"===t.type){const i=this.callbacks[e];delete this.callbacks[e],i&&(t.error?i(Nn(t.error)):i(null,Nn(t.data)))}else{let i=!1;const n=[],r=t.hasCallback?(t,r)=>{i=!0,delete this.cancelCallbacks[e];const a={id:e,type:"<response>",sourceMapId:this.mapId,error:t?On(t):null,data:On(r,n)};this.target.postMessage(a,{transfer:n})}:e=>{i=!0};let a=null;const s=Nn(t.data);if(this.parent[t.type])a=this.parent[t.type](t.sourceMapId,s,r);else if("getWorkerSource"in this.parent){const e=t.type.split(".");a=this.parent.getWorkerSource(t.sourceMapId,e[0],s.source)[e[1]](s,r)}else r(new Error(`Could not find function ${t.type}`));!i&&a&&a.cancel&&(this.cancelCallbacks[e]=a.cancel)}}remove(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)}},e.D=yr,e.E=H,e.F=function(e,t){const i={};for(let n=0;n<t.length;n++){const r=t[n];r in e&&(i[r]=e[r])}return i},e.G=ru,e.H=au,e.I=cc,e.J=h,e.K=d,e.L=tu,e.M=A,e.N=is,e.O=pu,e.P=a,e.Q=Cr,e.R=Us,e.S=Pa,e.T=hr,e.U=cu,e.V=class extends zr{},e.W=hu,e.X=function(e,t){const i=window.document.createElement("video");i.muted=!0,i.onloadstart=function(){t(null,i)};for(let n=0;n<e.length;n++){const t=window.document.createElement("source");$(e[n])||(i.crossOrigin="Anonymous"),t.src=e[n],i.appendChild(t)}return{cancel:()=>{}}},e.Y=oe,e.Z=function(){var e=new Ps(16);return Ps!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e},e._=t,e.a=C,e.a$=class extends Yr{},e.a0=function(e,t,i){var n=i[0],r=i[1],a=i[2];return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*r,e[5]=t[5]*r,e[6]=t[6]*r,e[7]=t[7]*r,e[8]=t[8]*a,e[9]=t[9]*a,e[10]=t[10]*a,e[11]=t[11]*a,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},e.a1=Is,e.a2=function(){return _++},e.a3=ea,e.a4=Vc,e.a5=function(){or.isLoading()||or.isLoaded()||"deferred"!==ar()||sr()},e.a6=qi,e.a7=ss,e.a8=lr,e.a9=yu,e.aA=ir,e.aB=function(e){e=e.slice();const t=Object.create(null);for(let i=0;i<e.length;i++)t[e[i].id]=e[i];for(let i=0;i<e.length;i++)"ref"in e[i]&&(e[i]=Y(e[i],t[e[i].ref]));return e},e.aC=function(e){if("custom"===e.type)return new Jc(e);switch(e.type){case"background":return new Hc(e);case"circle":return new Ds(e);case"fill":return new Bo(e);case"fill-extrusion":return new ol(e);case"heatmap":return new qs(e);case"hillshade":return new Ws(e);case"line":return new Sl(e);case"raster":return new Yc(e);case"symbol":return new Zc(e)}},e.aD=b,e.aE=function(e,t){if(!e)return[{command:Q.setStyle,args:[t]}];let i=[];try{if(!J(e.version,t.version))return[{command:Q.setStyle,args:[t]}];J(e.center,t.center)||i.push({command:Q.setCenter,args:[t.center]}),J(e.zoom,t.zoom)||i.push({command:Q.setZoom,args:[t.zoom]}),J(e.bearing,t.bearing)||i.push({command:Q.setBearing,args:[t.bearing]}),J(e.pitch,t.pitch)||i.push({command:Q.setPitch,args:[t.pitch]}),J(e.sprite,t.sprite)||i.push({command:Q.setSprite,args:[t.sprite]}),J(e.glyphs,t.glyphs)||i.push({command:Q.setGlyphs,args:[t.glyphs]}),J(e.transition,t.transition)||i.push({command:Q.setTransition,args:[t.transition]}),J(e.light,t.light)||i.push({command:Q.setLight,args:[t.light]});const n={},r=[];!function(e,t,i,n){let r;for(r in t=t||{},e=e||{})Object.prototype.hasOwnProperty.call(e,r)&&(Object.prototype.hasOwnProperty.call(t,r)||te(r,i,n));for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&(Object.prototype.hasOwnProperty.call(e,r)?J(e[r],t[r])||("geojson"===e[r].type&&"geojson"===t[r].type&&ne(e,t,r)?i.push({command:Q.setGeoJSONSourceData,args:[r,t[r].data]}):ie(r,t,i,n)):ee(r,t,i))}(e.sources,t.sources,r,n);const a=[];e.layers&&e.layers.forEach((e=>{n[e.source]?i.push({command:Q.removeLayer,args:[e.id]}):a.push(e)})),i=i.concat(r),function(e,t,i){t=t||[];const n=(e=e||[]).map(ae),r=t.map(ae),a=e.reduce(se,{}),s=t.reduce(se,{}),o=n.slice(),l=Object.create(null);let c,u,h,d,p,f,m;for(c=0,u=0;c<n.length;c++)h=n[c],Object.prototype.hasOwnProperty.call(s,h)?u++:(i.push({command:Q.removeLayer,args:[h]}),o.splice(o.indexOf(h,u),1));for(c=0,u=0;c<r.length;c++)h=r[r.length-1-c],o[o.length-1-c]!==h&&(Object.prototype.hasOwnProperty.call(a,h)?(i.push({command:Q.removeLayer,args:[h]}),o.splice(o.lastIndexOf(h,o.length-u),1)):u++,f=o[o.length-c],i.push({command:Q.addLayer,args:[s[h],f]}),o.splice(o.length-c,0,h),l[h]=!0);for(c=0;c<r.length;c++)if(h=r[c],d=a[h],p=s[h],!l[h]&&!J(d,p))if(J(d.source,p.source)&&J(d["source-layer"],p["source-layer"])&&J(d.type,p.type)){for(m in re(d.layout,p.layout,i,h,null,Q.setLayoutProperty),re(d.paint,p.paint,i,h,null,Q.setPaintProperty),J(d.filter,p.filter)||i.push({command:Q.setFilter,args:[h,p.filter]}),J(d.minzoom,p.minzoom)&&J(d.maxzoom,p.maxzoom)||i.push({command:Q.setLayerZoomRange,args:[h,p.minzoom,p.maxzoom]}),d)Object.prototype.hasOwnProperty.call(d,m)&&"layout"!==m&&"paint"!==m&&"filter"!==m&&"metadata"!==m&&"minzoom"!==m&&"maxzoom"!==m&&(0===m.indexOf("paint.")?re(d[m],p[m],i,h,m.slice(6),Q.setPaintProperty):J(d[m],p[m])||i.push({command:Q.setLayerProperty,args:[h,m,p[m]]}));for(m in p)Object.prototype.hasOwnProperty.call(p,m)&&!Object.prototype.hasOwnProperty.call(d,m)&&"layout"!==m&&"paint"!==m&&"filter"!==m&&"metadata"!==m&&"minzoom"!==m&&"maxzoom"!==m&&(0===m.indexOf("paint.")?re(d[m],p[m],i,h,m.slice(6),Q.setPaintProperty):J(d[m],p[m])||i.push({command:Q.setLayerProperty,args:[h,m,p[m]]}))}else i.push({command:Q.removeLayer,args:[h]}),f=o[o.lastIndexOf(h)+1],i.push({command:Q.addLayer,args:[p,f]})}(a,t.layers,i)}catch(e){console.warn("Unable to compute style diff:",e),i=[{command:Q.setStyle,args:[t]}]}return i},e.aF=function(e){const t=[],i=e.id;return void 0===i&&t.push({message:`layers.${i}: missing required property "id"`}),void 0===e.render&&t.push({message:`layers.${i}: missing required method "render"`}),e.renderingMode&&"2d"!==e.renderingMode&&"3d"!==e.renderingMode&&t.push({message:`layers.${i}: property "renderingMode" must be either "2d" or "3d"`}),t},e.aG=function e(t,i){if(Array.isArray(t)){if(!Array.isArray(i)||t.length!==i.length)return!1;for(let n=0;n<t.length;n++)if(!e(t[n],i[n]))return!1;return!0}if("object"==typeof t&&null!==t&&null!==i){if("object"!=typeof i)return!1;if(Object.keys(t).length!==Object.keys(i).length)return!1;for(const n in t)if(!e(t[n],i[n]))return!1;return!0}return t===i},e.aH=v,e.aI=x,e.aJ=rr,e.aK=function(e){return e({pluginStatus:er,pluginURL:tr}),rr.on("pluginStateChange",e),e},e.aL=class extends ja{constructor(e,t){super(e,t),this.current=0}set(e){this.current!==e&&(this.current=e,this.gl.uniform1i(this.location,e))}},e.aM=Ua,e.aN=class extends ja{constructor(e,t){super(e,t),this.current=Za}set(e){if(e[12]!==this.current[12]||e[0]!==this.current[0])return this.current=e,void this.gl.uniformMatrix4fv(this.location,!1,e);for(let t=1;t<16;t++)if(e[t]!==this.current[t]){this.current=e,this.gl.uniformMatrix4fv(this.location,!1,e);break}}},e.aO=$a,e.aP=class extends ja{constructor(e,t){super(e,t),this.current=[0,0,0]}set(e){e[0]===this.current[0]&&e[1]===this.current[1]&&e[2]===this.current[2]||(this.current=e,this.gl.uniform3f(this.location,e[0],e[1],e[2]))}},e.aQ=class extends ja{constructor(e,t){super(e,t),this.current=[0,0]}set(e){e[0]===this.current[0]&&e[1]===this.current[1]||(this.current=e,this.gl.uniform2f(this.location,e[0],e[1]))}},e.aR=qa,e.aS=function(e,t,i,n,r,a,s){var o=1/(t-i),l=1/(n-r),c=1/(a-s);return e[0]=-2*o,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*l,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*c,e[11]=0,e[12]=(t+i)*o,e[13]=(r+n)*l,e[14]=(s+a)*c,e[15]=1,e},e.aT=Ke,e.aU=Ms,e.aV=class extends Ur{},e.aW=Il,e.aX=class extends qr{},e.aY=function(e){return e<=1?1:Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))},e.aZ=$s,e.a_=ha,e.aa=function(e){const t={};if(e.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,((e,i,n,r)=>{const a=n||r;return t[i]=!a||a.toLowerCase(),""})),t["max-age"]){const e=parseInt(t["max-age"],10);isNaN(e)?delete t["max-age"]:t["max-age"]=e}return t},e.ab=function(e,t){const i=[];for(const n in e)n in t||i.push(n);return i},e.ac=function(e){if(null==P){const t=e.navigator?e.navigator.userAgent:null;P=!!e.safari||!(!t||!(/\b(iPad|iPhone|iPod)\b/.test(t)||t.match("Safari")&&!t.match("Chrome")))}return P},e.ad=m,e.ae=function(e,t,i){var n=Math.sin(i),r=Math.cos(i),a=t[0],s=t[1],o=t[2],l=t[3],c=t[4],u=t[5],h=t[6],d=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=a*r+c*n,e[1]=s*r+u*n,e[2]=o*r+h*n,e[3]=l*r+d*n,e[4]=c*r-a*n,e[5]=u*r-s*n,e[6]=h*r-o*n,e[7]=d*r-l*n,e},e.af=function(e){var t=new Ps(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},e.ag=zs,e.ah=function(e,t){let i=0,n=0;if("constant"===e.kind)n=e.layoutSize;else if("source"!==e.kind){const{interpolationType:r,minZoom:a,maxZoom:s}=e,o=r?m(Gt.interpolationFactor(r,t,a,s),0,1):0;"camera"===e.kind?n=Zt.number(e.minSize,e.maxSize,o):i=o}return{uSizeT:i,uSize:n}},e.aj=function(e,t,i){let{uSize:n,uSizeT:r}=t,{lowerSize:a,upperSize:s}=i;return"source"===e.kind?a/Ic:"composite"===e.kind?Zt.number(a/Ic,s/Ic,r):n},e.ak=Fc,e.al=function(e,t,i,n){const r=t.y-e.y,s=t.x-e.x,o=n.y-i.y,l=n.x-i.x,c=o*s-l*r;if(0===c)return null;const u=(l*(e.y-i.y)-o*(e.x-i.x))/c;return new a(e.x+u*s,e.y+u*r)},e.am=wu,e.an=cs,e.ao=Cs,e.ap=zl,e.ar=zc,e.as=function(e,t){var i=t[0],n=t[1],r=t[2],a=t[3],s=t[4],o=t[5],l=t[6],c=t[7],u=t[8],h=t[9],d=t[10],p=t[11],f=t[12],m=t[13],g=t[14],y=t[15],_=i*o-n*s,v=i*l-r*s,x=i*c-a*s,b=n*l-r*o,w=n*c-a*o,S=r*c-a*l,T=u*m-h*f,k=u*g-d*f,E=u*y-p*f,P=h*g-d*m,C=h*y-p*m,I=d*y-p*g,A=_*I-v*C+x*P+b*E-w*k+S*T;return A?(e[0]=(o*I-l*C+c*P)*(A=1/A),e[1]=(r*C-n*I-a*P)*A,e[2]=(m*S-g*w+y*b)*A,e[3]=(d*w-h*S-p*b)*A,e[4]=(l*E-s*I-c*k)*A,e[5]=(i*I-r*E+a*k)*A,e[6]=(g*x-f*S-y*v)*A,e[7]=(u*S-d*x+p*v)*A,e[8]=(s*C-o*E+c*T)*A,e[9]=(n*E-i*C-a*T)*A,e[10]=(f*w-m*x+y*_)*A,e[11]=(h*x-u*w-p*_)*A,e[12]=(o*k-s*P-l*T)*A,e[13]=(i*P-n*k+r*T)*A,e[14]=(m*v-f*b-g*_)*A,e[15]=(u*b-h*v+d*_)*A,e):null},e.at=Hu,e.au=Tc,e.av=eh,e.aw=function(){const e={},t=X.$version;for(const i in X.$root){const n=X.$root[i];if(n.required){let r=null;r="version"===i?t:"array"===n.type?[]:{},null!=r&&(e[i]=r)}}return e},e.ax=Q,e.ay=Vn,e.az=O,e.b=function(e,t){const i=new Blob([new Uint8Array(e)],{type:"image/png"});createImageBitmap(i).then((e=>{t(null,e)})).catch((e=>{t(new Error(`Could not load image because of ${e.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))}))},e.b0=Sa,e.b1=function(e,t){var i=e[0],n=e[1],r=e[2],a=e[3],s=e[4],o=e[5],l=e[6],c=e[7],u=e[8],h=e[9],d=e[10],p=e[11],f=e[12],m=e[13],g=e[14],y=e[15],_=t[0],v=t[1],x=t[2],b=t[3],w=t[4],S=t[5],T=t[6],k=t[7],E=t[8],P=t[9],C=t[10],I=t[11],A=t[12],M=t[13],z=t[14],D=t[15];return Math.abs(i-_)<=Es*Math.max(1,Math.abs(i),Math.abs(_))&&Math.abs(n-v)<=Es*Math.max(1,Math.abs(n),Math.abs(v))&&Math.abs(r-x)<=Es*Math.max(1,Math.abs(r),Math.abs(x))&&Math.abs(a-b)<=Es*Math.max(1,Math.abs(a),Math.abs(b))&&Math.abs(s-w)<=Es*Math.max(1,Math.abs(s),Math.abs(w))&&Math.abs(o-S)<=Es*Math.max(1,Math.abs(o),Math.abs(S))&&Math.abs(l-T)<=Es*Math.max(1,Math.abs(l),Math.abs(T))&&Math.abs(c-k)<=Es*Math.max(1,Math.abs(c),Math.abs(k))&&Math.abs(u-E)<=Es*Math.max(1,Math.abs(u),Math.abs(E))&&Math.abs(h-P)<=Es*Math.max(1,Math.abs(h),Math.abs(P))&&Math.abs(d-C)<=Es*Math.max(1,Math.abs(d),Math.abs(C))&&Math.abs(p-I)<=Es*Math.max(1,Math.abs(p),Math.abs(I))&&Math.abs(f-A)<=Es*Math.max(1,Math.abs(f),Math.abs(A))&&Math.abs(m-M)<=Es*Math.max(1,Math.abs(m),Math.abs(M))&&Math.abs(g-z)<=Es*Math.max(1,Math.abs(g),Math.abs(z))&&Math.abs(y-D)<=Es*Math.max(1,Math.abs(y),Math.abs(D))},e.b2=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},e.b3=function(e,t,i){return e[0]=t[0]*i[0],e[1]=t[1]*i[1],e[2]=t[2]*i[2],e[3]=t[3]*i[3],e},e.b4=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]},e.b5=g,e.b6=du,e.b7=su,e.b8=function(e,t,i,n,r){var a,s=1/Math.tan(t/2);return e[0]=s/i,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=s,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,null!=r&&r!==1/0?(e[10]=(r+n)*(a=1/(n-r)),e[14]=2*r*n*a):(e[10]=-1,e[14]=-2*n),e},e.b9=function(e,t,i){var n=Math.sin(i),r=Math.cos(i),a=t[4],s=t[5],o=t[6],l=t[7],c=t[8],u=t[9],h=t[10],d=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=a*r+c*n,e[5]=s*r+u*n,e[6]=o*r+h*n,e[7]=l*r+d*n,e[8]=c*r-a*n,e[9]=u*r-s*n,e[10]=h*r-o*n,e[11]=d*r-l*n,e},e.bA=n,e.bB=Dl,e.bC=Fi,e.bD=or,e.ba=p,e.bb=f,e.bc=function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},e.bd=class extends Mr{},e.be=eu,e.bf=ou,e.bg=dh,e.bi=B,e.bj=function(e,t){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(er===Kn||er===Yn||er===Jn)throw new Error("setRTLTextPlugin cannot be called multiple times.");tr=R.resolveURL(e),er=Kn,Qn=t,nr(),i||sr()},e.bk=ar,e.bl=function(e,t){const i={};for(let r=0;r<e.length;r++){const n=t&&t[e[r].id]||Qi(e[r]);t&&(t[e[r].id]=n);let a=i[n];a||(a=i[n]=[]),a.push(e[r])}const n=[];for(const r in i)n.push(i[r]);return n},e.bm=Fn,e.bn=gu,e.bo=_u,e.bp=uc,e.bq=function(t){t.bucket.createArrays(),t.bucket.tilePixelRatio=is/(512*t.bucket.overscaling),t.bucket.compareText={},t.bucket.iconsNeedLinear=!1;const i=t.bucket.layers[0],n=i.layout,r=i._unevaluatedLayout._values,a={layoutIconSize:r["icon-size"].possiblyEvaluate(new lr(t.bucket.zoom+1),t.canonical),layoutTextSize:r["text-size"].possiblyEvaluate(new lr(t.bucket.zoom+1),t.canonical),textMaxSize:r["text-size"].possiblyEvaluate(new lr(18))};if("composite"===t.bucket.textSizeData.kind){const{minZoom:e,maxZoom:i}=t.bucket.textSizeData;a.compositeTextSizes=[r["text-size"].possiblyEvaluate(new lr(e),t.canonical),r["text-size"].possiblyEvaluate(new lr(i),t.canonical)]}if("composite"===t.bucket.iconSizeData.kind){const{minZoom:e,maxZoom:i}=t.bucket.iconSizeData;a.compositeIconSizes=[r["icon-size"].possiblyEvaluate(new lr(e),t.canonical),r["icon-size"].possiblyEvaluate(new lr(i),t.canonical)]}const s=n.get("text-line-height")*zl,o="viewport"!==n.get("text-rotation-alignment")&&"point"!==n.get("symbol-placement"),l=n.get("text-keep-upright"),c=n.get("text-size");for(const u of t.bucket.features){const r=n.get("text-font").evaluate(u,{},t.canonical).join(","),h=c.evaluate(u,{},t.canonical),d=a.layoutTextSize.evaluate(u,{},t.canonical),p=a.layoutIconSize.evaluate(u,{},t.canonical),f={horizontal:{},vertical:void 0},m=u.text;let g,y=[0,0];if(m){const a=m.toString(),c=n.get("text-letter-spacing").evaluate(u,{},t.canonical)*zl,p=$n(a)?c:0,g=n.get("text-anchor").evaluate(u,{},t.canonical),_=Wu(i,u,t.canonical);if(!_){const e=n.get("text-radial-offset").evaluate(u,{},t.canonical);y=e?Gu(g,[e*zl,Zu]):n.get("text-offset").evaluate(u,{},t.canonical).map((e=>e*zl))}let v=o?"center":n.get("text-justify").evaluate(u,{},t.canonical);const x=n.get("symbol-placement"),b="point"===x?n.get("text-max-width").evaluate(u,{},t.canonical)*zl:0,w=()=>{t.bucket.allowVerticalPlacement&&Un(a)&&(f.vertical=mc(m,t.glyphMap,t.glyphPositions,t.imagePositions,r,b,s,g,"left",p,y,e.ai.vertical,!0,x,d,h))};if(!o&&_){const i=new Set;if("auto"===v)for(let e=0;e<_.values.length;e+=2)i.add(Hu(_.values[e]));else i.add(v);let n=!1;for(const a of i)if(!f.horizontal[a])if(n)f.horizontal[a]=f.horizontal[0];else{const i=mc(m,t.glyphMap,t.glyphPositions,t.imagePositions,r,b,s,"center",a,p,y,e.ai.horizontal,!1,x,d,h);i&&(f.horizontal[a]=i,n=1===i.positionedLines.length)}w()}else{"auto"===v&&(v=Hu(g));const i=mc(m,t.glyphMap,t.glyphPositions,t.imagePositions,r,b,s,g,v,p,y,e.ai.horizontal,!1,x,d,h);i&&(f.horizontal[v]=i),w(),Un(a)&&o&&l&&(f.vertical=mc(m,t.glyphMap,t.glyphPositions,t.imagePositions,r,b,s,g,v,p,y,e.ai.vertical,!1,x,d,h))}}let _=!1;if(u.icon&&u.icon.name){const e=t.imageMap[u.icon.name];e&&(g=Ec(t.imagePositions[u.icon.name],n.get("icon-offset").evaluate(u,{},t.canonical),n.get("icon-anchor").evaluate(u,{},t.canonical)),_=!!e.sdf,void 0===t.bucket.sdfIcons?t.bucket.sdfIcons=_:t.bucket.sdfIcons!==_&&S("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(e.pixelRatio!==t.bucket.pixelRatio||0!==n.get("icon-rotate").constantOr(1))&&(t.bucket.iconsNeedLinear=!0))}const v=Yu(f.horizontal)||f.vertical;t.bucket.iconsInText=!!v&&v.iconsInText,(v||g)&&Xu(t.bucket,u,f,g,t.imageMap,a,d,p,y,_,t.canonical)}t.showCollisionBoxes&&t.bucket.generateCollisionDebugBuffers()},e.br=yl,e.bs=Do,e.bt=il,e.bu=class{constructor(e){this._marks={start:[e.url,"start"].join("#"),end:[e.url,"end"].join("#"),measure:e.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let e=performance.getEntriesByName(this._marks.measure);return 0===e.length&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),e=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),e}},e.bv=tc,e.bw=jo,e.bx=function(e,i,n,r,a){return t(this,void 0,void 0,(function*(){if(d())try{return yield A(e,i,n,r,a)}catch(e){}return function(e,t,i,n,r){const a=e.width,s=e.height;M&&z||(M=new OffscreenCanvas(a,s),z=M.getContext("2d",{willReadFrequently:!0})),M.width=a,M.height=s,z.drawImage(e,0,0,a,s);const o=z.getImageData(t,i,n,r);return z.clearRect(0,0,a,s),o.data}(e,i,n,r,a)}))},e.by=mu,e.bz=i,e.c=F,e.d=function(e,t){const i=new Image;i.onload=()=>{t(null,i),URL.revokeObjectURL(i.src),i.onload=null,window.requestAnimationFrame((()=>{i.src=I}))},i.onerror=()=>t(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const n=new Blob([new Uint8Array(e)],{type:"image/png"});i.src=e.byteLength?URL.createObjectURL(n):I},e.e=y,e.f=function(e,t){return j(y(e,{type:"json"}),t)},e.g=N,e.h=R,e.i=E,e.j=W,e.k=G,e.l=U,e.m=j,e.n=function(e){return new tc(e).readFields(nc,[])},e.o=function(e,t,i){if(!e.length)return i(null,[]);let n=e.length;const r=new Array(e.length);let a=null;e.forEach(((e,s)=>{t(e,((e,t)=>{e&&(a=e),r[s]=t,0==--n&&i(a,r)}))}))},e.p=oc,e.q=js,e.r=wr,e.s=$,e.t=An,e.u=jn,e.v=X,e.w=S,e.x=Dn,e.y=In,e.z=function(e){let[t,i,n]=e;return i+=90,i*=Math.PI/180,n*=Math.PI/180,{x:t*Math.cos(i)*Math.sin(n),y:t*Math.sin(i)*Math.sin(n),z:t*Math.cos(n)}}})),n(["./shared"],(function(e){class t{constructor(e){this.keyCache={},e&&this.replace(e)}replace(e){this._layerConfigs={},this._layers={},this.update(e,[])}update(t,i){for(const r of t){this._layerConfigs[r.id]=r;const t=this._layers[r.id]=e.aC(r);t._featureFilter=e.a6(t.filter),this.keyCache[r.id]&&delete this.keyCache[r.id]}for(const e of i)delete this.keyCache[e],delete this._layerConfigs[e],delete this._layers[e];this.familiesBySource={};const n=e.bl(Object.values(this._layerConfigs),this.keyCache);for(const e of n){const t=e.map((e=>this._layers[e.id])),i=t[0];if("none"===i.visibility)continue;const n=i.source||"";let r=this.familiesBySource[n];r||(r=this.familiesBySource[n]={});const a=i.sourceLayer||"_geojsonTileLayer";let s=r[a];s||(s=r[a]=[]),s.push(t)}}}class i{constructor(t){const i={},n=[];for(const e in t){const r=t[e],a=i[e]={};for(const e in r){const t=r[+e];if(!t||0===t.bitmap.width||0===t.bitmap.height)continue;const i={x:0,y:0,w:t.bitmap.width+2,h:t.bitmap.height+2};n.push(i),a[e]={rect:i,metrics:t.metrics}}}const{w:r,h:a}=e.p(n),s=new e.q({width:r||1,height:a||1});for(const o in t){const n=t[o];for(const t in n){const r=n[+t];if(!r||0===r.bitmap.width||0===r.bitmap.height)continue;const a=i[o][t].rect;e.q.copy(r.bitmap,s,{x:0,y:0},{x:a.x+1,y:a.y+1},r.bitmap)}}this.image=s,this.positions=i}}e.bm("GlyphAtlas",i);class n{constructor(t){this.tileID=new e.O(t.tileID.overscaledZ,t.tileID.wrap,t.tileID.canonical.z,t.tileID.canonical.x,t.tileID.canonical.y),this.uid=t.uid,this.zoom=t.zoom,this.pixelRatio=t.pixelRatio,this.tileSize=t.tileSize,this.source=t.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=t.showCollisionBoxes,this.collectResourceTiming=!!t.collectResourceTiming,this.returnDependencies=!!t.returnDependencies,this.promoteId=t.promoteId,this.inFlightDependencies=[],this.dependencySentinel=-1}parse(t,n,a,s,o){this.status="parsing",this.data=t,this.collisionBoxArray=new e.a3;const l=new e.bn(Object.keys(t.layers).sort()),c=new e.bo(this.tileID,this.promoteId);c.bucketLayerIDs=[];const u={},h={featureIndex:c,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:a},d=n.familiesBySource[this.source];for(const i in d){const n=t.layers[i];if(!n)continue;1===n.version&&e.w(`Vector tile source "${this.source}" layer "${i}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const s=l.encode(i),o=[];for(let e=0;e<n.length;e++){const t=n.feature(e),r=c.getId(t,i);o.push({feature:t,id:r,index:e,sourceLayerIndex:s})}for(const t of d[i]){const i=t[0];i.source!==this.source&&e.w(`layer.source = ${i.source} does not equal this.source = ${this.source}`),i.minzoom&&this.zoom<Math.floor(i.minzoom)||i.maxzoom&&this.zoom>=i.maxzoom||"none"!==i.visibility&&(r(t,this.zoom,a),(u[i.id]=i.createBucket({index:c.bucketLayerIDs.length,layers:t,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:s,sourceID:this.source})).populate(o,h,this.tileID.canonical),c.bucketLayerIDs.push(t.map((e=>e.id))))}}let p,f,m,g;const y=e.aH(h.glyphDependencies,(e=>Object.keys(e).map(Number)));this.inFlightDependencies.forEach((e=>null==e?void 0:e.cancel())),this.inFlightDependencies=[];const _=++this.dependencySentinel;Object.keys(y).length?this.inFlightDependencies.push(s.send("getGlyphs",{uid:this.uid,stacks:y,source:this.source,tileID:this.tileID,type:"glyphs"},((e,t)=>{_===this.dependencySentinel&&(p||(p=e,f=t,b.call(this)))}))):f={};const v=Object.keys(h.iconDependencies);v.length?this.inFlightDependencies.push(s.send("getImages",{icons:v,source:this.source,tileID:this.tileID,type:"icons"},((e,t)=>{_===this.dependencySentinel&&(p||(p=e,m=t,b.call(this)))}))):m={};const x=Object.keys(h.patternDependencies);function b(){if(p)return o(p);if(f&&m&&g){const t=new i(f),n=new e.bp(m,g);for(const i in u){const s=u[i];s instanceof e.a4?(r(s.layers,this.zoom,a),e.bq({bucket:s,glyphMap:f,glyphPositions:t.positions,imageMap:m,imagePositions:n.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical})):s.hasPattern&&(s instanceof e.br||s instanceof e.bs||s instanceof e.bt)&&(r(s.layers,this.zoom,a),s.addFeatures(h,this.tileID.canonical,n.patternPositions))}this.status="done",o(null,{buckets:Object.values(u).filter((e=>!e.isEmpty())),featureIndex:c,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:t.image,imageAtlas:n,glyphMap:this.returnDependencies?f:null,iconMap:this.returnDependencies?m:null,glyphPositions:this.returnDependencies?t.positions:null})}}x.length?this.inFlightDependencies.push(s.send("getImages",{icons:x,source:this.source,tileID:this.tileID,type:"patterns"},((e,t)=>{_===this.dependencySentinel&&(p||(p=e,g=t,b.call(this)))}))):g={},b.call(this)}}function r(t,i,n){const r=new e.a8(i);for(const e of t)e.recalculate(r,n)}function a(t,i){const n=e.l(t.request,((n,r,a,s)=>{if(n)i(n);else if(r)try{const t=new e.bw.VectorTile(new e.bv(r));i(null,{vectorTile:t,rawData:r,cacheControl:a,expires:s})}catch(e){const a=new Uint8Array(r);let s=`Unable to parse the tile at ${t.request.url}, `;s+=31===a[0]&&139===a[1]?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${e.messge}`,i(new Error(s))}}));return()=>{n.cancel(),i()}}class s{constructor(e,t,i,n){this.actor=e,this.layerIndex=t,this.availableImages=i,this.loadVectorData=n||a,this.fetching={},this.loading={},this.loaded={}}loadTile(t,i){const r=t.uid;this.loading||(this.loading={});const a=!!(t&&t.request&&t.request.collectResourceTiming)&&new e.bu(t.request),s=this.loading[r]=new n(t);s.abort=this.loadVectorData(t,((t,n)=>{if(delete this.loading[r],t||!n)return s.status="done",this.loaded[r]=s,i(t);const o=n.rawData,l={};n.expires&&(l.expires=n.expires),n.cacheControl&&(l.cacheControl=n.cacheControl);const c={};if(a){const e=a.finish();e&&(c.resourceTiming=JSON.parse(JSON.stringify(e)))}s.vectorTile=n.vectorTile,s.parse(n.vectorTile,this.layerIndex,this.availableImages,this.actor,((t,n)=>{if(delete this.fetching[r],t||!n)return i(t);i(null,e.e({rawTileData:o.slice(0)},n,l,c))})),this.loaded=this.loaded||{},this.loaded[r]=s,this.fetching[r]={rawTileData:o,cacheControl:l,resourceTiming:c}}))}reloadTile(t,i){const n=this.loaded,r=t.uid;if(n&&n[r]){const a=n[r];a.showCollisionBoxes=t.showCollisionBoxes,"parsing"===a.status?a.parse(a.vectorTile,this.layerIndex,this.availableImages,this.actor,((t,n)=>{if(t||!n)return i(t,n);let a;if(this.fetching[r]){const{rawTileData:t,cacheControl:i,resourceTiming:s}=this.fetching[r];delete this.fetching[r],a=e.e({rawTileData:t.slice(0)},n,i,s)}else a=n;i(null,a)})):"done"===a.status&&(a.vectorTile?a.parse(a.vectorTile,this.layerIndex,this.availableImages,this.actor,i):i())}}abortTile(e,t){const i=this.loading,n=e.uid;i&&i[n]&&i[n].abort&&(i[n].abort(),delete i[n]),t()}removeTile(e,t){const i=this.loaded,n=e.uid;i&&i[n]&&delete i[n],t()}}class o{constructor(){this.loaded={}}loadTile(t,i){return e._(this,void 0,void 0,(function*(){const{uid:n,encoding:r,rawImageData:a,redFactor:s,greenFactor:o,blueFactor:l,baseShift:c}=t,u=a.width+2,h=a.height+2,d=e.a(a)?new e.R({width:u,height:h},yield e.bx(a,-1,-1,u,h)):a,p=new e.by(n,d,r,s,o,l,c);this.loaded=this.loaded||{},this.loaded[n]=p,i(null,p)}))}removeTile(e){const t=this.loaded,i=e.uid;t&&t[i]&&delete t[i]}}function l(e,t){if(0!==e.length){c(e[0],t);for(var i=1;i<e.length;i++)c(e[i],!t)}}function c(e,t){for(var i=0,n=0,r=0,a=e.length,s=a-1;r<a;s=r++){var o=(e[r][0]-e[s][0])*(e[s][1]+e[r][1]),l=i+o;n+=Math.abs(i)>=Math.abs(o)?i-l+o:o-l+i,i=l}i+n>=0!=!!t&&e.reverse()}var u=e.bz((function e(t,i){var n,r=t&&t.type;if("FeatureCollection"===r)for(n=0;n<t.features.length;n++)e(t.features[n],i);else if("GeometryCollection"===r)for(n=0;n<t.geometries.length;n++)e(t.geometries[n],i);else if("Feature"===r)e(t.geometry,i);else if("Polygon"===r)l(t.coordinates,i);else if("MultiPolygon"===r)for(n=0;n<t.coordinates.length;n++)l(t.coordinates[n],i);return t}));const h=e.bw.VectorTileFeature.prototype.toGeoJSON;var d={exports:{}},p=e.bA,f=e.bw.VectorTileFeature,m=g;function g(e,t){this.options=t||{},this.features=e,this.length=e.length}function y(e,t){this.id="number"==typeof e.id?e.id:void 0,this.type=e.type,this.rawGeometry=1===e.type?[e.geometry]:e.geometry,this.properties=e.tags,this.extent=t||4096}g.prototype.feature=function(e){return new y(this.features[e],this.options.extent)},y.prototype.loadGeometry=function(){var e=this.rawGeometry;this.geometry=[];for(var t=0;t<e.length;t++){for(var i=e[t],n=[],r=0;r<i.length;r++)n.push(new p(i[r][0],i[r][1]));this.geometry.push(n)}return this.geometry},y.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var e=this.geometry,t=1/0,i=-1/0,n=1/0,r=-1/0,a=0;a<e.length;a++)for(var s=e[a],o=0;o<s.length;o++){var l=s[o];t=Math.min(t,l.x),i=Math.max(i,l.x),n=Math.min(n,l.y),r=Math.max(r,l.y)}return[t,n,i,r]},y.prototype.toGeoJSON=f.prototype.toGeoJSON;var _=e.bB,v=m;function x(e){var t=new _;return function(e,t){for(var i in e.layers)t.writeMessage(3,b,e.layers[i])}(e,t),t.finish()}function b(e,t){var i;t.writeVarintField(15,e.version||1),t.writeStringField(1,e.name||""),t.writeVarintField(5,e.extent||4096);var n={keys:[],values:[],keycache:{},valuecache:{}};for(i=0;i<e.length;i++)n.feature=e.feature(i),t.writeMessage(2,w,n);var r=n.keys;for(i=0;i<r.length;i++)t.writeStringField(3,r[i]);var a=n.values;for(i=0;i<a.length;i++)t.writeMessage(4,P,a[i])}function w(e,t){var i=e.feature;void 0!==i.id&&t.writeVarintField(1,i.id),t.writeMessage(2,S,e),t.writeVarintField(3,i.type),t.writeMessage(4,E,i)}function S(e,t){var i=e.feature,n=e.keys,r=e.values,a=e.keycache,s=e.valuecache;for(var o in i.properties){var l=i.properties[o],c=a[o];if(null!==l){void 0===c&&(n.push(o),a[o]=c=n.length-1),t.writeVarint(c);var u=typeof l;"string"!==u&&"boolean"!==u&&"number"!==u&&(l=JSON.stringify(l));var h=u+":"+l,d=s[h];void 0===d&&(r.push(l),s[h]=d=r.length-1),t.writeVarint(d)}}}function T(e,t){return(t<<3)+(7&e)}function k(e){return e<<1^e>>31}function E(e,t){for(var i=e.loadGeometry(),n=e.type,r=0,a=0,s=i.length,o=0;o<s;o++){var l=i[o],c=1;1===n&&(c=l.length),t.writeVarint(T(1,c));for(var u=3===n?l.length-1:l.length,h=0;h<u;h++){1===h&&1!==n&&t.writeVarint(T(2,u-1));var d=l[h].x-r,p=l[h].y-a;t.writeVarint(k(d)),t.writeVarint(k(p)),r+=d,a+=p}3===n&&t.writeVarint(T(7,1))}}function P(e,t){var i=typeof e;"string"===i?t.writeStringField(1,e):"boolean"===i?t.writeBooleanField(7,e):"number"===i&&(e%1!=0?t.writeDoubleField(3,e):e<0?t.writeSVarintField(6,e):t.writeVarintField(5,e))}d.exports=x,d.exports.fromVectorTileJs=x,d.exports.fromGeojsonVt=function(e,t){t=t||{};var i={};for(var n in e)i[n]=new v(e[n].features,t),i[n].name=n,i[n].version=t.version,i[n].extent=t.extent;return x({layers:i})},d.exports.GeoJSONWrapper=v;var C=e.bz(d.exports);const I={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:e=>e},A=Math.fround||(M=new Float32Array(1),e=>(M[0]=+e,M[0]));var M;const z=3,D=5,L=6;class R{constructor(e){this.options=Object.assign(Object.create(I),e),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(e){const{log:t,minZoom:i,maxZoom:n}=this.options;t&&console.time("total time");const r=`prepare ${e.length} points`;t&&console.time(r),this.points=e;const a=[];for(let o=0;o<e.length;o++){const t=e[o];if(!t.geometry)continue;const[i,n]=t.geometry.coordinates,r=A(O(i)),s=A(N(n));a.push(r,s,1/0,o,-1,1),this.options.reduce&&a.push(0)}let s=this.trees[n+1]=this._createTree(a);t&&console.timeEnd(r);for(let o=n;o>=i;o--){const e=+Date.now();s=this.trees[o]=this._createTree(this._cluster(s,o)),t&&console.log("z%d: %d clusters in %dms",o,s.numItems,+Date.now()-e)}return t&&console.timeEnd("total time"),this}getClusters(e,t){let i=((e[0]+180)%360+360)%360-180;const n=Math.max(-90,Math.min(90,e[1]));let r=180===e[2]?180:((e[2]+180)%360+360)%360-180;const a=Math.max(-90,Math.min(90,e[3]));if(e[2]-e[0]>=360)i=-180,r=180;else if(i>r){const e=this.getClusters([i,n,180,a],t),s=this.getClusters([-180,n,r,a],t);return e.concat(s)}const s=this.trees[this._limitZoom(t)],o=s.range(O(i),N(a),O(r),N(n)),l=s.data,c=[];for(const u of o){const e=this.stride*u;c.push(l[e+D]>1?F(l,e,this.clusterProps):this.points[l[e+z]])}return c}getChildren(e){const t=this._getOriginId(e),i=this._getOriginZoom(e),n="No cluster with the specified id.",r=this.trees[i];if(!r)throw new Error(n);const a=r.data;if(t*this.stride>=a.length)throw new Error(n);const s=this.options.radius/(this.options.extent*Math.pow(2,i-1)),o=r.within(a[t*this.stride],a[t*this.stride+1],s),l=[];for(const c of o){const t=c*this.stride;a[t+4]===e&&l.push(a[t+D]>1?F(a,t,this.clusterProps):this.points[a[t+z]])}if(0===l.length)throw new Error(n);return l}getLeaves(e,t,i){const n=[];return this._appendLeaves(n,e,t=t||10,i=i||0,0),n}getTile(e,t,i){const n=this.trees[this._limitZoom(e)],r=Math.pow(2,e),{extent:a,radius:s}=this.options,o=s/a,l=(i-o)/r,c=(i+1+o)/r,u={features:[]};return this._addTileFeatures(n.range((t-o)/r,l,(t+1+o)/r,c),n.data,t,i,r,u),0===t&&this._addTileFeatures(n.range(1-o/r,l,1,c),n.data,r,i,r,u),t===r-1&&this._addTileFeatures(n.range(0,l,o/r,c),n.data,-1,i,r,u),u.features.length?u:null}getClusterExpansionZoom(e){let t=this._getOriginZoom(e)-1;for(;t<=this.options.maxZoom;){const i=this.getChildren(e);if(t++,1!==i.length)break;e=i[0].properties.cluster_id}return t}_appendLeaves(e,t,i,n,r){const a=this.getChildren(t);for(const s of a){const t=s.properties;if(t&&t.cluster?r+t.point_count<=n?r+=t.point_count:r=this._appendLeaves(e,t.cluster_id,i,n,r):r<n?r++:e.push(s),e.length===i)break}return r}_createTree(t){const i=new e.av(t.length/this.stride|0,this.options.nodeSize,Float32Array);for(let e=0;e<t.length;e+=this.stride)i.add(t[e],t[e+1]);return i.finish(),i.data=t,i}_addTileFeatures(e,t,i,n,r,a){for(const s of e){const e=s*this.stride,o=t[e+D]>1;let l,c,u;if(o)l=B(t,e,this.clusterProps),c=t[e],u=t[e+1];else{const i=this.points[t[e+z]];l=i.properties;const[n,r]=i.geometry.coordinates;c=O(n),u=N(r)}const h={type:1,geometry:[[Math.round(this.options.extent*(c*r-i)),Math.round(this.options.extent*(u*r-n))]],tags:l};let d;d=o||this.options.generateId?t[e+z]:this.points[t[e+z]].id,void 0!==d&&(h.id=d),a.features.push(h)}}_limitZoom(e){return Math.max(this.options.minZoom,Math.min(Math.floor(+e),this.options.maxZoom+1))}_cluster(e,t){const{radius:i,extent:n,reduce:r,minPoints:a}=this.options,s=i/(n*Math.pow(2,t)),o=e.data,l=[],c=this.stride;for(let u=0;u<o.length;u+=c){if(o[u+2]<=t)continue;o[u+2]=t;const i=o[u],n=o[u+1],h=e.within(o[u],o[u+1],s),d=o[u+D];let p=d;for(const e of h){const i=e*c;o[i+2]>t&&(p+=o[i+D])}if(p>d&&p>=a){let e,a=i*d,s=n*d,f=-1;const m=(u/c<<5)+(t+1)+this.points.length;for(const i of h){const n=i*c;if(o[n+2]<=t)continue;o[n+2]=t;const l=o[n+D];a+=o[n]*l,s+=o[n+1]*l,o[n+4]=m,r&&(e||(e=this._map(o,u,!0),f=this.clusterProps.length,this.clusterProps.push(e)),r(e,this._map(o,n)))}o[u+4]=m,l.push(a/p,s/p,1/0,m,-1,p),r&&l.push(f)}else{for(let e=0;e<c;e++)l.push(o[u+e]);if(p>1)for(const e of h){const i=e*c;if(!(o[i+2]<=t)){o[i+2]=t;for(let e=0;e<c;e++)l.push(o[i+e])}}}}return l}_getOriginId(e){return e-this.points.length>>5}_getOriginZoom(e){return(e-this.points.length)%32}_map(e,t,i){if(e[t+D]>1){const n=this.clusterProps[e[t+L]];return i?Object.assign({},n):n}const n=this.points[e[t+z]].properties,r=this.options.map(n);return i&&r===n?Object.assign({},r):r}}function F(e,t,i){return{type:"Feature",id:e[t+z],properties:B(e,t,i),geometry:{type:"Point",coordinates:[(n=e[t],360*(n-.5)),V(e[t+1])]}};var n}function B(e,t,i){const n=e[t+D],r=n>=1e4?`${Math.round(n/1e3)}k`:n>=1e3?Math.round(n/100)/10+"k":n,a=e[t+L],s=-1===a?{}:Object.assign({},i[a]);return Object.assign(s,{cluster:!0,cluster_id:e[t+z],point_count:n,point_count_abbreviated:r})}function O(e){return e/360+.5}function N(e){const t=Math.sin(e*Math.PI/180),i=.5-.25*Math.log((1+t)/(1-t))/Math.PI;return i<0?0:i>1?1:i}function V(e){const t=(180-360*e)*Math.PI/180;return 360*Math.atan(Math.exp(t))/Math.PI-90}function j(e,t,i,n){for(var r,a=n,s=i-t>>1,o=i-t,l=e[t],c=e[t+1],u=e[i],h=e[i+1],d=t+3;d<i;d+=3){var p=U(e[d],e[d+1],l,c,u,h);if(p>a)r=d,a=p;else if(p===a){var f=Math.abs(d-s);f<o&&(r=d,o=f)}}a>n&&(r-t>3&&j(e,t,r,n),e[r+2]=a,i-r>3&&j(e,r,i,n))}function U(e,t,i,n,r,a){var s=r-i,o=a-n;if(0!==s||0!==o){var l=((e-i)*s+(t-n)*o)/(s*s+o*o);l>1?(i=r,n=a):l>0&&(i+=s*l,n+=o*l)}return(s=e-i)*s+(o=t-n)*o}function $(e,t,i,n){var r={id:void 0===e?null:e,type:t,geometry:i,tags:n,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(e){var t=e.geometry,i=e.type;if("Point"===i||"MultiPoint"===i||"LineString"===i)q(e,t);else if("Polygon"===i||"MultiLineString"===i)for(var n=0;n<t.length;n++)q(e,t[n]);else if("MultiPolygon"===i)for(n=0;n<t.length;n++)for(var r=0;r<t[n].length;r++)q(e,t[n][r])}(r),r}function q(e,t){for(var i=0;i<t.length;i+=3)e.minX=Math.min(e.minX,t[i]),e.minY=Math.min(e.minY,t[i+1]),e.maxX=Math.max(e.maxX,t[i]),e.maxY=Math.max(e.maxY,t[i+1])}function Z(e,t,i,n){if(t.geometry){var r=t.geometry.coordinates,a=t.geometry.type,s=Math.pow(i.tolerance/((1<<i.maxZoom)*i.extent),2),o=[],l=t.id;if(i.promoteId?l=t.properties[i.promoteId]:i.generateId&&(l=n||0),"Point"===a)G(r,o);else if("MultiPoint"===a)for(var c=0;c<r.length;c++)G(r[c],o);else if("LineString"===a)W(r,o,s,!1);else if("MultiLineString"===a){if(i.lineMetrics){for(c=0;c<r.length;c++)W(r[c],o=[],s,!1),e.push($(l,"LineString",o,t.properties));return}H(r,o,s,!1)}else if("Polygon"===a)H(r,o,s,!0);else{if("MultiPolygon"!==a){if("GeometryCollection"===a){for(c=0;c<t.geometry.geometries.length;c++)Z(e,{id:l,geometry:t.geometry.geometries[c],properties:t.properties},i,n);return}throw new Error("Input data is not a valid GeoJSON object.")}for(c=0;c<r.length;c++){var u=[];H(r[c],u,s,!0),o.push(u)}}e.push($(l,a,o,t.properties))}}function G(e,t){t.push(X(e[0])),t.push(K(e[1])),t.push(0)}function W(e,t,i,n){for(var r,a,s=0,o=0;o<e.length;o++){var l=X(e[o][0]),c=K(e[o][1]);t.push(l),t.push(c),t.push(0),o>0&&(s+=n?(r*c-l*a)/2:Math.sqrt(Math.pow(l-r,2)+Math.pow(c-a,2))),r=l,a=c}var u=t.length-3;t[2]=1,j(t,0,u,i),t[u+2]=1,t.size=Math.abs(s),t.start=0,t.end=t.size}function H(e,t,i,n){for(var r=0;r<e.length;r++){var a=[];W(e[r],a,i,n),t.push(a)}}function X(e){return e/360+.5}function K(e){var t=Math.sin(e*Math.PI/180),i=.5-.25*Math.log((1+t)/(1-t))/Math.PI;return i<0?0:i>1?1:i}function Y(e,t,i,n,r,a,s,o){if(n/=t,a>=(i/=t)&&s<n)return e;if(s<i||a>=n)return null;for(var l=[],c=0;c<e.length;c++){var u=e[c],h=u.geometry,d=u.type,p=0===r?u.minX:u.minY,f=0===r?u.maxX:u.maxY;if(p>=i&&f<n)l.push(u);else if(!(f<i||p>=n)){var m=[];if("Point"===d||"MultiPoint"===d)J(h,m,i,n,r);else if("LineString"===d)Q(h,m,i,n,r,!1,o.lineMetrics);else if("MultiLineString"===d)te(h,m,i,n,r,!1);else if("Polygon"===d)te(h,m,i,n,r,!0);else if("MultiPolygon"===d)for(var g=0;g<h.length;g++){var y=[];te(h[g],y,i,n,r,!0),y.length&&m.push(y)}if(m.length){if(o.lineMetrics&&"LineString"===d){for(g=0;g<m.length;g++)l.push($(u.id,d,m[g],u.tags));continue}"LineString"!==d&&"MultiLineString"!==d||(1===m.length?(d="LineString",m=m[0]):d="MultiLineString"),"Point"!==d&&"MultiPoint"!==d||(d=3===m.length?"Point":"MultiPoint"),l.push($(u.id,d,m,u.tags))}}}return l.length?l:null}function J(e,t,i,n,r){for(var a=0;a<e.length;a+=3){var s=e[a+r];s>=i&&s<=n&&(t.push(e[a]),t.push(e[a+1]),t.push(e[a+2]))}}function Q(e,t,i,n,r,a,s){for(var o,l,c=ee(e),u=0===r?ne:re,h=e.start,d=0;d<e.length-3;d+=3){var p=e[d],f=e[d+1],m=e[d+2],g=e[d+3],y=e[d+4],_=0===r?p:f,v=0===r?g:y,x=!1;s&&(o=Math.sqrt(Math.pow(p-g,2)+Math.pow(f-y,2))),_<i?v>i&&(l=u(c,p,f,g,y,i),s&&(c.start=h+o*l)):_>n?v<n&&(l=u(c,p,f,g,y,n),s&&(c.start=h+o*l)):ie(c,p,f,m),v<i&&_>=i&&(l=u(c,p,f,g,y,i),x=!0),v>n&&_<=n&&(l=u(c,p,f,g,y,n),x=!0),!a&&x&&(s&&(c.end=h+o*l),t.push(c),c=ee(e)),s&&(h+=o)}var b=e.length-3;p=e[b],f=e[b+1],m=e[b+2],(_=0===r?p:f)>=i&&_<=n&&ie(c,p,f,m),b=c.length-3,a&&b>=3&&(c[b]!==c[0]||c[b+1]!==c[1])&&ie(c,c[0],c[1],c[2]),c.length&&t.push(c)}function ee(e){var t=[];return t.size=e.size,t.start=e.start,t.end=e.end,t}function te(e,t,i,n,r,a){for(var s=0;s<e.length;s++)Q(e[s],t,i,n,r,a,!1)}function ie(e,t,i,n){e.push(t),e.push(i),e.push(n)}function ne(e,t,i,n,r,a){var s=(a-t)/(n-t);return e.push(a),e.push(i+(r-i)*s),e.push(1),s}function re(e,t,i,n,r,a){var s=(a-i)/(r-i);return e.push(t+(n-t)*s),e.push(a),e.push(1),s}function ae(e,t){for(var i=[],n=0;n<e.length;n++){var r,a=e[n],s=a.type;if("Point"===s||"MultiPoint"===s||"LineString"===s)r=se(a.geometry,t);else if("MultiLineString"===s||"Polygon"===s){r=[];for(var o=0;o<a.geometry.length;o++)r.push(se(a.geometry[o],t))}else if("MultiPolygon"===s)for(r=[],o=0;o<a.geometry.length;o++){for(var l=[],c=0;c<a.geometry[o].length;c++)l.push(se(a.geometry[o][c],t));r.push(l)}i.push($(a.id,s,r,a.tags))}return i}function se(e,t){var i=[];i.size=e.size,void 0!==e.start&&(i.start=e.start,i.end=e.end);for(var n=0;n<e.length;n+=3)i.push(e[n]+t,e[n+1],e[n+2]);return i}function oe(e,t){if(e.transformed)return e;var i,n,r,a=1<<e.z,s=e.x,o=e.y;for(i=0;i<e.features.length;i++){var l=e.features[i],c=l.geometry,u=l.type;if(l.geometry=[],1===u)for(n=0;n<c.length;n+=2)l.geometry.push(le(c[n],c[n+1],t,a,s,o));else for(n=0;n<c.length;n++){var h=[];for(r=0;r<c[n].length;r+=2)h.push(le(c[n][r],c[n][r+1],t,a,s,o));l.geometry.push(h)}}return e.transformed=!0,e}function le(e,t,i,n,r,a){return[Math.round(i*(e*n-r)),Math.round(i*(t*n-a))]}function ce(e,t,i,n,r){for(var a=t===r.maxZoom?0:r.tolerance/((1<<t)*r.extent),s={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:i,y:n,z:t,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},o=0;o<e.length;o++){s.numFeatures++,ue(s,e[o],a,r);var l=e[o].minX,c=e[o].minY,u=e[o].maxX,h=e[o].maxY;l<s.minX&&(s.minX=l),c<s.minY&&(s.minY=c),u>s.maxX&&(s.maxX=u),h>s.maxY&&(s.maxY=h)}return s}function ue(e,t,i,n){var r=t.geometry,a=t.type,s=[];if("Point"===a||"MultiPoint"===a)for(var o=0;o<r.length;o+=3)s.push(r[o]),s.push(r[o+1]),e.numPoints++,e.numSimplified++;else if("LineString"===a)he(s,r,e,i,!1,!1);else if("MultiLineString"===a||"Polygon"===a)for(o=0;o<r.length;o++)he(s,r[o],e,i,"Polygon"===a,0===o);else if("MultiPolygon"===a)for(var l=0;l<r.length;l++){var c=r[l];for(o=0;o<c.length;o++)he(s,c[o],e,i,!0,0===o)}if(s.length){var u=t.tags||null;if("LineString"===a&&n.lineMetrics){for(var h in u={},t.tags)u[h]=t.tags[h];u.mapbox_clip_start=r.start/r.size,u.mapbox_clip_end=r.end/r.size}var d={geometry:s,type:"Polygon"===a||"MultiPolygon"===a?3:"LineString"===a||"MultiLineString"===a?2:1,tags:u};null!==t.id&&(d.id=t.id),e.features.push(d)}}function he(e,t,i,n,r,a){var s=n*n;if(n>0&&t.size<(r?s:n))i.numPoints+=t.length/3;else{for(var o=[],l=0;l<t.length;l+=3)(0===n||t[l+2]>s)&&(i.numSimplified++,o.push(t[l]),o.push(t[l+1])),i.numPoints++;r&&function(e,t){for(var i=0,n=0,r=e.length,a=r-2;n<r;a=n,n+=2)i+=(e[n]-e[a])*(e[n+1]+e[a+1]);if(i>0===t)for(n=0,r=e.length;n<r/2;n+=2){var s=e[n],o=e[n+1];e[n]=e[r-2-n],e[n+1]=e[r-1-n],e[r-2-n]=s,e[r-1-n]=o}}(o,a),e.push(o)}}function de(e,t){var i=(t=this.options=function(e,t){for(var i in t)e[i]=t[i];return e}(Object.create(this.options),t)).debug;if(i&&console.time("preprocess data"),t.maxZoom<0||t.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(t.promoteId&&t.generateId)throw new Error("promoteId and generateId cannot be used together.");var n=function(e,t){var i=[];if("FeatureCollection"===e.type)for(var n=0;n<e.features.length;n++)Z(i,e.features[n],t,n);else Z(i,"Feature"===e.type?e:{geometry:e},t);return i}(e,t);this.tiles={},this.tileCoords=[],i&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",t.indexMaxZoom,t.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),n=function(e,t){var i=t.buffer/t.extent,n=e,r=Y(e,1,-1-i,i,0,-1,2,t),a=Y(e,1,1-i,2+i,0,-1,2,t);return(r||a)&&(n=Y(e,1,-i,1+i,0,-1,2,t)||[],r&&(n=ae(r,1).concat(n)),a&&(n=n.concat(ae(a,-1)))),n}(n,t),n.length&&this.splitTile(n,0,0,0),i&&(n.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function pe(e,t,i){return 32*((1<<e)*i+t)+e}function fe(e,t){return t?e.properties[t]:e.id}function me(e,t){if(null==e)return!0;if("Feature"===e.type)return null!=fe(e,t);if("FeatureCollection"===e.type){const i=new Set;for(const n of e.features){const e=fe(n,t);if(null==e)return!1;if(i.has(e))return!1;i.add(e)}return!0}return!1}function ge(e,t){const i=new Map;if(null==e);else if("Feature"===e.type)i.set(fe(e,t),e);else for(const n of e.features)i.set(fe(n,t),n);return i}de.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},de.prototype.splitTile=function(e,t,i,n,r,a,s){for(var o=[e,t,i,n],l=this.options,c=l.debug;o.length;){n=o.pop(),i=o.pop(),t=o.pop(),e=o.pop();var u=1<<t,h=pe(t,i,n),d=this.tiles[h];if(!d&&(c>1&&console.time("creation"),d=this.tiles[h]=ce(e,t,i,n,l),this.tileCoords.push({z:t,x:i,y:n}),c)){c>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",t,i,n,d.numFeatures,d.numPoints,d.numSimplified),console.timeEnd("creation"));var p="z"+t;this.stats[p]=(this.stats[p]||0)+1,this.total++}if(d.source=e,r){if(t===l.maxZoom||t===r)continue;var f=1<<r-t;if(i!==Math.floor(a/f)||n!==Math.floor(s/f))continue}else if(t===l.indexMaxZoom||d.numPoints<=l.indexMaxPoints)continue;if(d.source=null,0!==e.length){c>1&&console.time("clipping");var m,g,y,_,v,x,b=.5*l.buffer/l.extent,w=.5-b,S=.5+b,T=1+b;m=g=y=_=null,v=Y(e,u,i-b,i+S,0,d.minX,d.maxX,l),x=Y(e,u,i+w,i+T,0,d.minX,d.maxX,l),e=null,v&&(m=Y(v,u,n-b,n+S,1,d.minY,d.maxY,l),g=Y(v,u,n+w,n+T,1,d.minY,d.maxY,l),v=null),x&&(y=Y(x,u,n-b,n+S,1,d.minY,d.maxY,l),_=Y(x,u,n+w,n+T,1,d.minY,d.maxY,l),x=null),c>1&&console.timeEnd("clipping"),o.push(m||[],t+1,2*i,2*n),o.push(g||[],t+1,2*i,2*n+1),o.push(y||[],t+1,2*i+1,2*n),o.push(_||[],t+1,2*i+1,2*n+1)}}},de.prototype.getTile=function(e,t,i){var n=this.options,r=n.extent,a=n.debug;if(e<0||e>24)return null;var s=1<<e,o=pe(e,t=(t%s+s)%s,i);if(this.tiles[o])return oe(this.tiles[o],r);a>1&&console.log("drilling down to z%d-%d-%d",e,t,i);for(var l,c=e,u=t,h=i;!l&&c>0;)c--,u=Math.floor(u/2),h=Math.floor(h/2),l=this.tiles[pe(c,u,h)];return l&&l.source?(a>1&&console.log("found parent tile z%d-%d-%d",c,u,h),a>1&&console.time("drilling down"),this.splitTile(l.source,c,u,h,e,t,i),a>1&&console.timeEnd("drilling down"),this.tiles[o]?oe(this.tiles[o],r):null):null};class ye extends s{constructor(t,i,n,r){super(t,i,n),this._dataUpdateable=new Map,this.loadGeoJSON=(t,i)=>{const{promoteId:n}=t;if(t.request)return e.f(t.request,((e,t,r,a)=>{this._dataUpdateable=me(t,n)?ge(t,n):void 0,i(e,t,r,a)}));if("string"==typeof t.data)try{const e=JSON.parse(t.data);this._dataUpdateable=me(e,n)?ge(e,n):void 0,i(null,e)}catch(e){i(new Error(`Input data given to '${t.source}' is not a valid GeoJSON object.`))}else t.dataDiff?this._dataUpdateable?(function(e,t,i){var n,r,a,s;if(t.removeAll&&e.clear(),t.remove)for(const o of t.remove)e.delete(o);if(t.add)for(const o of t.add){const t=fe(o,i);null!=t&&e.set(t,o)}if(t.update)for(const o of t.update){let t=e.get(o.id);if(null==t)continue;const i=!o.removeAllProperties&&((null===(n=o.removeProperties)||void 0===n?void 0:n.length)>0||(null===(r=o.addOrUpdateProperties)||void 0===r?void 0:r.length)>0);if((o.newGeometry||o.removeAllProperties||i)&&(t=Object.assign({},t),e.set(o.id,t),i&&(t.properties=Object.assign({},t.properties))),o.newGeometry&&(t.geometry=o.newGeometry),o.removeAllProperties)t.properties={};else if((null===(a=o.removeProperties)||void 0===a?void 0:a.length)>0)for(const e of o.removeProperties)Object.prototype.hasOwnProperty.call(t.properties,e)&&delete t.properties[e];if((null===(s=o.addOrUpdateProperties)||void 0===s?void 0:s.length)>0)for(const{key:e,value:n}of o.addOrUpdateProperties)t.properties[e]=n}}(this._dataUpdateable,t.dataDiff,n),i(null,{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())})):i(new Error(`Cannot update existing geojson data in ${t.source}`)):i(new Error(`Input data given to '${t.source}' is not a valid GeoJSON object.`));return{cancel:()=>{}}},this.loadVectorData=this.loadGeoJSONTile,r&&(this.loadGeoJSON=r)}loadGeoJSONTile(t,i){const n=t.tileID.canonical;if(!this._geoJSONIndex)return i(null,null);const r=this._geoJSONIndex.getTile(n.z,n.x,n.y);if(!r)return i(null,null);const a=new class{constructor(t){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=e.N,this.length=t.length,this._features=t}feature(t){return new class{constructor(t){this._feature=t,this.extent=e.N,this.type=t.type,this.properties=t.tags,"id"in t&&!isNaN(t.id)&&(this.id=parseInt(t.id,10))}loadGeometry(){if(1===this._feature.type){const t=[];for(const i of this._feature.geometry)t.push([new e.P(i[0],i[1])]);return t}{const t=[];for(const i of this._feature.geometry){const n=[];for(const t of i)n.push(new e.P(t[0],t[1]));t.push(n)}return t}}toGeoJSON(e,t,i){return h.call(this,e,t,i)}}(this._features[t])}}(r.features);let s=C(a);0===s.byteOffset&&s.byteLength===s.buffer.byteLength||(s=new Uint8Array(s)),i(null,{vectorTile:a,rawData:s.buffer})}loadData(t,i){var n;null===(n=this._pendingRequest)||void 0===n||n.cancel(),this._pendingCallback&&this._pendingCallback(null,{abandoned:!0});const r=!!(t&&t.request&&t.request.collectResourceTiming)&&new e.bu(t.request);this._pendingCallback=i,this._pendingRequest=this.loadGeoJSON(t,((n,a)=>{if(delete this._pendingCallback,delete this._pendingRequest,n||!a)return i(n);if("object"!=typeof a)return i(new Error(`Input data given to '${t.source}' is not a valid GeoJSON object.`));{u(a,!0);try{if(t.filter){const i=e.bC(t.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if("error"===i.result)throw new Error(i.value.map((e=>`${e.key}: ${e.message}`)).join(", "));const n=a.features.filter((e=>i.value.evaluate({zoom:0},e)));a={type:"FeatureCollection",features:n}}this._geoJSONIndex=t.cluster?new R(function(t){let{superclusterOptions:i,clusterProperties:n}=t;if(!n||!i)return i;const r={},a={},s={accumulated:null,zoom:0},o={properties:null},l=Object.keys(n);for(const c of l){const[t,i]=n[c],s=e.bC(i),o=e.bC("string"==typeof t?[t,["accumulated"],["get",c]]:t);r[c]=s.value,a[c]=o.value}return i.map=e=>{o.properties=e;const t={};for(const i of l)t[i]=r[i].evaluate(s,o);return t},i.reduce=(e,t)=>{o.properties=t;for(const i of l)s.accumulated=e[i],e[i]=a[i].evaluate(s,o)},i}(t)).load(a.features):function(e,t){return new de(e,t)}(a,t.geojsonVtOptions)}catch(n){return i(n)}this.loaded={};const s={};if(r){const e=r.finish();e&&(s.resourceTiming={},s.resourceTiming[t.source]=JSON.parse(JSON.stringify(e)))}i(null,s)}}))}reloadTile(e,t){const i=this.loaded;return i&&i[e.uid]?super.reloadTile(e,t):this.loadTile(e,t)}removeSource(e,t){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),t()}getClusterExpansionZoom(e,t){try{t(null,this._geoJSONIndex.getClusterExpansionZoom(e.clusterId))}catch(e){t(e)}}getClusterChildren(e,t){try{t(null,this._geoJSONIndex.getChildren(e.clusterId))}catch(e){t(e)}}getClusterLeaves(e,t){try{t(null,this._geoJSONIndex.getLeaves(e.clusterId,e.limit,e.offset))}catch(e){t(e)}}}class _e{constructor(t){this.self=t,this.actor=new e.C(t,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:s,geojson:ye},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(e,t)=>{if(this.workerSourceTypes[e])throw new Error(`Worker source with name "${e}" already registered.`);this.workerSourceTypes[e]=t},this.self.registerRTLTextPlugin=t=>{if(e.bD.isParsed())throw new Error("RTL text plugin already registered.");e.bD.applyArabicShaping=t.applyArabicShaping,e.bD.processBidirectionalText=t.processBidirectionalText,e.bD.processStyledBidirectionalText=t.processStyledBidirectionalText}}setReferrer(e,t){this.referrer=t}setImages(e,t,i){this.availableImages[e]=t;for(const n in this.workerSources[e]){const i=this.workerSources[e][n];for(const e in i)i[e].availableImages=t}i()}setLayers(e,t,i){this.getLayerIndex(e).replace(t),i()}updateLayers(e,t,i){this.getLayerIndex(e).update(t.layers,t.removedIds),i()}loadTile(e,t,i){this.getWorkerSource(e,t.type,t.source).loadTile(t,i)}loadDEMTile(e,t,i){this.getDEMWorkerSource(e,t.source).loadTile(t,i)}reloadTile(e,t,i){this.getWorkerSource(e,t.type,t.source).reloadTile(t,i)}abortTile(e,t,i){this.getWorkerSource(e,t.type,t.source).abortTile(t,i)}removeTile(e,t,i){this.getWorkerSource(e,t.type,t.source).removeTile(t,i)}removeDEMTile(e,t){this.getDEMWorkerSource(e,t.source).removeTile(t)}removeSource(e,t,i){if(!this.workerSources[e]||!this.workerSources[e][t.type]||!this.workerSources[e][t.type][t.source])return;const n=this.workerSources[e][t.type][t.source];delete this.workerSources[e][t.type][t.source],void 0!==n.removeSource?n.removeSource(t,i):i()}loadWorkerSource(e,t,i){try{this.self.importScripts(t.url),i()}catch(e){i(e.toString())}}syncRTLPluginState(t,i,n){try{e.bD.setState(i);const t=e.bD.getPluginURL();if(e.bD.isLoaded()&&!e.bD.isParsed()&&null!=t){this.self.importScripts(t);const i=e.bD.isParsed();n(i?void 0:new Error(`RTL Text Plugin failed to import scripts from ${t}`),i)}}catch(e){n(e.toString())}}getAvailableImages(e){let t=this.availableImages[e];return t||(t=[]),t}getLayerIndex(e){let i=this.layerIndexes[e];return i||(i=this.layerIndexes[e]=new t),i}getWorkerSource(e,t,i){return this.workerSources[e]||(this.workerSources[e]={}),this.workerSources[e][t]||(this.workerSources[e][t]={}),this.workerSources[e][t][i]||(this.workerSources[e][t][i]=new this.workerSourceTypes[t]({send:(t,i,n)=>{this.actor.send(t,i,n,e)}},this.getLayerIndex(e),this.getAvailableImages(e))),this.workerSources[e][t][i]}getDEMWorkerSource(e,t){return this.demWorkerSources[e]||(this.demWorkerSources[e]={}),this.demWorkerSources[e][t]||(this.demWorkerSources[e][t]=new o),this.demWorkerSources[e][t]}}return e.i()&&(self.worker=new _e(self)),_e})),n(["./shared"],(function(e){var t="3.6.2";class i{static testProp(e){if(!i.docStyle)return e[0];for(let t=0;t<e.length;t++)if(e[t]in i.docStyle)return e[t];return e[0]}static create(e,t,i){const n=window.document.createElement(e);return void 0!==t&&(n.className=t),i&&i.appendChild(n),n}static createNS(e,t){return window.document.createElementNS(e,t)}static disableDrag(){i.docStyle&&i.selectProp&&(i.userSelect=i.docStyle[i.selectProp],i.docStyle[i.selectProp]="none")}static enableDrag(){i.docStyle&&i.selectProp&&(i.docStyle[i.selectProp]=i.userSelect)}static setTransform(e,t){e.style[i.transformProp]=t}static addEventListener(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};e.addEventListener(t,i,"passive"in n?n:n.capture)}static removeEventListener(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};e.removeEventListener(t,i,"passive"in n?n:n.capture)}static suppressClickInternal(e){e.preventDefault(),e.stopPropagation(),window.removeEventListener("click",i.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",i.suppressClickInternal,!0),window.setTimeout((()=>{window.removeEventListener("click",i.suppressClickInternal,!0)}),0)}static mousePos(t,i){const n=t.getBoundingClientRect();return new e.P(i.clientX-n.left-t.clientLeft,i.clientY-n.top-t.clientTop)}static touchPos(t,i){const n=t.getBoundingClientRect(),r=[];for(let a=0;a<i.length;a++)r.push(new e.P(i[a].clientX-n.left-t.clientLeft,i[a].clientY-n.top-t.clientTop));return r}static mouseButton(e){return e.button}static remove(e){e.parentNode&&e.parentNode.removeChild(e)}}i.docStyle="undefined"!=typeof window&&window.document&&window.document.documentElement.style,i.selectProp=i.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),i.transformProp=i.testProp(["transform","WebkitTransform"]);const n={supported:!1,testSupport:function(e){!s&&a&&(o?l(e):r=e)}};let r,a,s=!1,o=!1;function l(e){const t=e.createTexture();e.bindTexture(e.TEXTURE_2D,t);try{if(e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,a),e.isContextLost())return;n.supported=!0}catch(e){}e.deleteTexture(t),s=!0}var c,u;"undefined"!=typeof document&&(a=document.createElement("img"),a.onload=function(){r&&l(r),r=null,o=!0},a.onerror=function(){s=!0,r=null},a.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(t){let i,r,a,s;t.resetRequestQueue=()=>{i=[],r=0,a=0,s={}},t.addThrottleControl=e=>{const t=a++;return s[t]=e,t},t.removeThrottleControl=e=>{delete s[e],c()},t.getImage=function(e,t){let a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];n.supported&&(e.headers||(e.headers={}),e.headers.accept="image/webp,*/*");const s={requestParameters:e,supportImageRefresh:a,callback:t,cancelled:!1,completed:!1,cancel:()=>{s.completed||s.cancelled||(s.cancelled=!0,s.innerRequest&&(s.innerRequest.cancel(),r--),c())}};return i.push(s),c(),s};const o=t=>{const{requestParameters:i,supportImageRefresh:n,callback:r}=t;return e.e(i,{type:"image"}),(!1!==n||e.i()||e.g(i.url)||i.headers&&!Object.keys(i.headers).reduce(((e,t)=>e&&"accept"===t),!0)?e.m:u)(i,((e,i,n,a)=>{l(t,r,e,i,n,a)}))},l=(t,i,n,a,s,o)=>{n?i(n):a instanceof HTMLImageElement||e.a(a)?i(null,a):a&&((t,i)=>{"function"==typeof createImageBitmap?e.b(t,i):e.d(t,i)})(a,((e,t)=>{null!=e?i(e):null!=t&&i(null,t,{cacheControl:s,expires:o})})),t.cancelled||(t.completed=!0,r--,c())},c=()=>{const t=(()=>{const e=Object.keys(s);let t=!1;if(e.length>0)for(const i of e)if(t=s[i](),t)break;return t})()?e.c.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:e.c.MAX_PARALLEL_IMAGE_REQUESTS;for(let e=r;e<t&&i.length>0;e++){const t=i.shift();if(t.cancelled){e--;continue}const n=o(t);r++,t.innerRequest=n}},u=(t,i)=>{const n=new Image,r=t.url;let a=!1;const s=t.credentials;return s&&"include"===s?n.crossOrigin="use-credentials":(s&&"same-origin"===s||!e.s(r))&&(n.crossOrigin="anonymous"),n.fetchPriority="high",n.onload=()=>{i(null,n),n.onerror=n.onload=null},n.onerror=()=>{a||i(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.")),n.onerror=n.onload=null},n.src=r,{cancel:()=>{a=!0,n.src=""}}}}(c||(c={})),c.resetRequestQueue(),function(e){e.Glyphs="Glyphs",e.Image="Image",e.Source="Source",e.SpriteImage="SpriteImage",e.SpriteJSON="SpriteJSON",e.Style="Style",e.Tile="Tile",e.Unknown="Unknown"}(u||(u={}));class h{constructor(e){this._transformRequestFn=e}transformRequest(e,t){return this._transformRequestFn&&this._transformRequestFn(e,t)||{url:e}}normalizeSpriteURL(e,t,i){const n=function(e){const t=e.match(d);if(!t)throw new Error(`Unable to parse URL "${e}"`);return{protocol:t[1],authority:t[2],path:t[3]||"/",params:t[4]?t[4].split("&"):[]}}(e);return n.path+=`${t}${i}`,function(e){const t=e.params.length?`?${e.params.join("&")}`:"";return`${e.protocol}://${e.authority}${e.path}${t}`}(n)}setTransformRequest(e){this._transformRequestFn=e}}const d=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function p(t){var i=new e.A(3);return i[0]=t[0],i[1]=t[1],i[2]=t[2],i}var f,m=function(e,t,i){return e[0]=t[0]-i[0],e[1]=t[1]-i[1],e[2]=t[2]-i[2],e};f=new e.A(3),e.A!=Float32Array&&(f[0]=0,f[1]=0,f[2]=0);var g=function(e){var t=e[0],i=e[1];return t*t+i*i};function y(e){const t=[];if("string"==typeof e)t.push({id:"default",url:e});else if(e&&e.length>0){const i=[];for(const{id:n,url:r}of e){const e=`${n}${r}`;-1===i.indexOf(e)&&(i.push(e),t.push({id:n,url:r}))}}return t}function _(t,i,n,r,a){if(r)return void t(r);if(a!==Object.values(i).length||a!==Object.values(n).length)return;const s={};for(const o in i){s[o]={};const t=e.h.getImageCanvasContext(n[o]),r=i[o];for(const e in r){const{width:i,height:n,x:a,y:l,sdf:c,pixelRatio:u,stretchX:h,stretchY:d,content:p}=r[e];s[o][e]={data:null,pixelRatio:u,sdf:c,stretchX:h,stretchY:d,content:p,spriteData:{width:i,height:n,x:a,y:l,context:t}}}}t(null,s)}!function(){var t=new e.A(2);e.A!=Float32Array&&(t[0]=0,t[1]=0)}();class v{constructor(e,t,i,n){this.context=e,this.format=i,this.texture=e.gl.createTexture(),this.update(t,n)}update(t,i,n){const{width:r,height:a}=t,s=!(this.size&&this.size[0]===r&&this.size[1]===a||n),{context:o}=this,{gl:l}=o;if(this.useMipmap=Boolean(i&&i.useMipmap),l.bindTexture(l.TEXTURE_2D,this.texture),o.pixelStoreUnpackFlipY.set(!1),o.pixelStoreUnpack.set(1),o.pixelStoreUnpackPremultiplyAlpha.set(this.format===l.RGBA&&(!i||!1!==i.premultiply)),s)this.size=[r,a],t instanceof HTMLImageElement||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement||t instanceof ImageData||e.a(t)?l.texImage2D(l.TEXTURE_2D,0,this.format,this.format,l.UNSIGNED_BYTE,t):l.texImage2D(l.TEXTURE_2D,0,this.format,r,a,0,this.format,l.UNSIGNED_BYTE,t.data);else{const{x:i,y:s}=n||{x:0,y:0};t instanceof HTMLImageElement||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement||t instanceof ImageData||e.a(t)?l.texSubImage2D(l.TEXTURE_2D,0,i,s,l.RGBA,l.UNSIGNED_BYTE,t):l.texSubImage2D(l.TEXTURE_2D,0,i,s,r,a,l.RGBA,l.UNSIGNED_BYTE,t.data)}this.useMipmap&&this.isSizePowerOfTwo()&&l.generateMipmap(l.TEXTURE_2D)}bind(e,t,i){const{context:n}=this,{gl:r}=n;r.bindTexture(r.TEXTURE_2D,this.texture),i!==r.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(i=r.LINEAR),e!==this.filter&&(r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,e),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,i||e),this.filter=e),t!==this.wrap&&(r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,t),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,t),this.wrap=t)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:e}=this.context;e.deleteTexture(this.texture),this.texture=null}}function x(e){const{userImage:t}=e;return!!(t&&t.render&&t.render())&&(e.data.replace(new Uint8Array(t.data.buffer)),!0)}class b extends e.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new e.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(e){if(this.loaded!==e&&(this.loaded=e,e)){for(const{ids:e,callback:t}of this.requestors)this._notify(e,t);this.requestors=[]}}getImage(t){const i=this.images[t];if(i&&!i.data&&i.spriteData){const t=i.spriteData;i.data=new e.R({width:t.width,height:t.height},t.context.getImageData(t.x,t.y,t.width,t.height).data),i.spriteData=null}return i}addImage(e,t){if(this.images[e])throw new Error(`Image id ${e} already exist, use updateImage instead`);this._validate(e,t)&&(this.images[e]=t)}_validate(t,i){let n=!0;const r=i.data||i.spriteData;return this._validateStretch(i.stretchX,r&&r.width)||(this.fire(new e.j(new Error(`Image "${t}" has invalid "stretchX" value`))),n=!1),this._validateStretch(i.stretchY,r&&r.height)||(this.fire(new e.j(new Error(`Image "${t}" has invalid "stretchY" value`))),n=!1),this._validateContent(i.content,i)||(this.fire(new e.j(new Error(`Image "${t}" has invalid "content" value`))),n=!1),n}_validateStretch(e,t){if(!e)return!0;let i=0;for(const n of e){if(n[0]<i||n[1]<n[0]||t<n[1])return!1;i=n[1]}return!0}_validateContent(e,t){if(!e)return!0;if(4!==e.length)return!1;const i=t.spriteData,n=i&&i.width||t.data.width,r=i&&i.height||t.data.height;return!(e[0]<0||n<e[0]||e[1]<0||r<e[1]||e[2]<0||n<e[2]||e[3]<0||r<e[3]||e[2]<e[0]||e[3]<e[1])}updateImage(e,t){let i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const n=this.getImage(e);if(i&&(n.data.width!==t.data.width||n.data.height!==t.data.height))throw new Error(`size mismatch between old image (${n.data.width}x${n.data.height}) and new image (${t.data.width}x${t.data.height}).`);t.version=n.version+1,this.images[e]=t,this.updatedImages[e]=!0}removeImage(e){const t=this.images[e];delete this.images[e],delete this.patterns[e],t.userImage&&t.userImage.onRemove&&t.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(e,t){let i=!0;if(!this.isLoaded())for(const n of e)this.images[n]||(i=!1);this.isLoaded()||i?this._notify(e,t):this.requestors.push({ids:e,callback:t})}_notify(t,i){const n={};for(const r of t){let t=this.getImage(r);t||(this.fire(new e.k("styleimagemissing",{id:r})),t=this.getImage(r)),t?n[r]={data:t.data.clone(),pixelRatio:t.pixelRatio,sdf:t.sdf,version:t.version,stretchX:t.stretchX,stretchY:t.stretchY,content:t.content,hasRenderCallback:Boolean(t.userImage&&t.userImage.render)}:e.w(`Image "${r}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}i(null,n)}getPixelSize(){const{width:e,height:t}=this.atlasImage;return{width:e,height:t}}getPattern(t){const i=this.patterns[t],n=this.getImage(t);if(!n)return null;if(i&&i.position.version===n.version)return i.position;if(i)i.position.version=n.version;else{const i={w:n.data.width+2,h:n.data.height+2,x:0,y:0},r=new e.I(i,n);this.patterns[t]={bin:i,position:r}}return this._updatePatternAtlas(),this.patterns[t].position}bind(e){const t=e.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new v(e,this.atlasImage,t.RGBA),this.atlasTexture.bind(t.LINEAR,t.CLAMP_TO_EDGE)}_updatePatternAtlas(){const t=[];for(const e in this.patterns)t.push(this.patterns[e].bin);const{w:i,h:n}=e.p(t),r=this.atlasImage;r.resize({width:i||1,height:n||1});for(const a in this.patterns){const{bin:t}=this.patterns[a],i=t.x+1,n=t.y+1,s=this.getImage(a).data,o=s.width,l=s.height;e.R.copy(s,r,{x:0,y:0},{x:i,y:n},{width:o,height:l}),e.R.copy(s,r,{x:0,y:l-1},{x:i,y:n-1},{width:o,height:1}),e.R.copy(s,r,{x:0,y:0},{x:i,y:n+l},{width:o,height:1}),e.R.copy(s,r,{x:o-1,y:0},{x:i-1,y:n},{width:1,height:l}),e.R.copy(s,r,{x:0,y:0},{x:i+o,y:n},{width:1,height:l})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(t){for(const i of t){if(this.callbackDispatchedThisFrame[i])continue;this.callbackDispatchedThisFrame[i]=!0;const t=this.getImage(i);t||e.w(`Image with ID: "${i}" was not found`),x(t)&&this.updateImage(i,t)}}}const w=1e20;function S(e,t,i,n,r,a,s,o,l){for(let c=t;c<t+n;c++)T(e,i*a+c,a,r,s,o,l);for(let c=i;c<i+r;c++)T(e,c*a+t,1,n,s,o,l)}function T(e,t,i,n,r,a,s){a[0]=0,s[0]=-w,s[1]=w,r[0]=e[t];for(let o=1,l=0,c=0;o<n;o++){r[o]=e[t+o*i];const n=o*o;do{const e=a[l];c=(r[o]-r[e]+n-e*e)/(o-e)/2}while(c<=s[l]&&--l>-1);l++,a[l]=o,s[l]=c,s[l+1]=w}for(let o=0,l=0;o<n;o++){for(;s[l+1]<o;)l++;const n=a[l],c=o-n;e[t+o*i]=r[n]+c*c}}class k{constructor(e,t){this.requestManager=e,this.localIdeographFontFamily=t,this.entries={}}setURL(e){this.url=e}getGlyphs(t,i){const n=[];for(const e in t)for(const i of t[e])n.push({stack:e,id:i});e.o(n,((e,t)=>{let{stack:i,id:n}=e,r=this.entries[i];r||(r=this.entries[i]={glyphs:{},requests:{},ranges:{}});let a=r.glyphs[n];if(void 0!==a)return void t(null,{stack:i,id:n,glyph:a});if(a=this._tinySDF(r,i,n),a)return r.glyphs[n]=a,void t(null,{stack:i,id:n,glyph:a});const s=Math.floor(n/256);if(256*s>65535)return void t(new Error("glyphs > 65535 not supported"));if(r.ranges[s])return void t(null,{stack:i,id:n,glyph:a});if(!this.url)return void t(new Error("glyphsUrl is not set"));let o=r.requests[s];o||(o=r.requests[s]=[],k.loadGlyphRange(i,s,this.url,this.requestManager,((e,t)=>{if(t){for(const e in t)this._doesCharSupportLocalGlyph(+e)||(r.glyphs[+e]=t[+e]);r.ranges[s]=!0}for(const i of o)i(e,t);delete r.requests[s]}))),o.push(((e,r)=>{e?t(e):r&&t(null,{stack:i,id:n,glyph:r[n]||null})}))}),((e,t)=>{if(e)i(e);else if(t){const e={};for(const{stack:i,id:n,glyph:r}of t)(e[i]||(e[i]={}))[n]=r&&{id:r.id,bitmap:r.bitmap.clone(),metrics:r.metrics};i(null,e)}}))}_doesCharSupportLocalGlyph(t){return!!this.localIdeographFontFamily&&(e.u["CJK Unified Ideographs"](t)||e.u["Hangul Syllables"](t)||e.u.Hiragana(t)||e.u.Katakana(t))}_tinySDF(t,i,n){const r=this.localIdeographFontFamily;if(!r)return;if(!this._doesCharSupportLocalGlyph(n))return;let a=t.tinySDF;if(!a){let e="400";/bold/i.test(i)?e="900":/medium/i.test(i)?e="500":/light/i.test(i)&&(e="200"),a=t.tinySDF=new k.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:r,fontWeight:e})}const s=a.draw(String.fromCharCode(n));return{id:n,bitmap:new e.q({width:s.width||60,height:s.height||60},s.data),metrics:{width:s.glyphWidth/2||24,height:s.glyphHeight/2||24,left:s.glyphLeft/2+.5||0,top:s.glyphTop/2-27.5||-8,advance:s.glyphAdvance/2||24,isDoubleResolution:!0}}}}k.loadGlyphRange=function(t,i,n,r,a){const s=256*i,o=s+255,l=r.transformRequest(n.replace("{fontstack}",t).replace("{range}",`${s}-${o}`),u.Glyphs);e.l(l,((t,i)=>{if(t)a(t);else if(i){const t={};for(const n of e.n(i))t[n.id]=n;a(null,t)}}))},k.TinySDF=class{constructor(){let{fontSize:e=24,buffer:t=3,radius:i=8,cutoff:n=.25,fontFamily:r="sans-serif",fontWeight:a="normal",fontStyle:s="normal"}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.buffer=t,this.cutoff=n,this.radius=i;const o=this.size=e+4*t,l=this._createCanvas(o),c=this.ctx=l.getContext("2d",{willReadFrequently:!0});c.font=`${s} ${a} ${e}px ${r}`,c.textBaseline="alphabetic",c.textAlign="left",c.fillStyle="black",this.gridOuter=new Float64Array(o*o),this.gridInner=new Float64Array(o*o),this.f=new Float64Array(o),this.z=new Float64Array(o+1),this.v=new Uint16Array(o)}_createCanvas(e){const t=document.createElement("canvas");return t.width=t.height=e,t}draw(e){const{width:t,actualBoundingBoxAscent:i,actualBoundingBoxDescent:n,actualBoundingBoxLeft:r,actualBoundingBoxRight:a}=this.ctx.measureText(e),s=Math.ceil(i),o=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(a-r))),l=Math.min(this.size-this.buffer,s+Math.ceil(n)),c=o+2*this.buffer,u=l+2*this.buffer,h=Math.max(c*u,0),d=new Uint8ClampedArray(h),p={data:d,width:c,height:u,glyphWidth:o,glyphHeight:l,glyphTop:s,glyphLeft:0,glyphAdvance:t};if(0===o||0===l)return p;const{ctx:f,buffer:m,gridInner:g,gridOuter:y}=this;f.clearRect(m,m,o,l),f.fillText(e,m,m+s);const _=f.getImageData(m,m,o,l);y.fill(w,0,h),g.fill(0,0,h);for(let v=0;v<l;v++)for(let e=0;e<o;e++){const t=_.data[4*(v*o+e)+3]/255;if(0===t)continue;const i=(v+m)*c+e+m;if(1===t)y[i]=0,g[i]=w;else{const e=.5-t;y[i]=e>0?e*e:0,g[i]=e<0?e*e:0}}S(y,0,0,c,u,c,this.f,this.v,this.z),S(g,m,m,o,l,c,this.f,this.v,this.z);for(let v=0;v<h;v++){const e=Math.sqrt(y[v])-Math.sqrt(g[v]);d[v]=Math.round(255-255*(e/this.radius+this.cutoff))}return p}};class E{constructor(){this.specification=e.v.light.position}possiblyEvaluate(t,i){return e.z(t.expression.evaluate(i))}interpolate(t,i,n){return{x:e.B.number(t.x,i.x,n),y:e.B.number(t.y,i.y,n),z:e.B.number(t.z,i.z,n)}}}let P;class C extends e.E{constructor(t){super(),P=P||new e.r({anchor:new e.D(e.v.light.anchor),position:new E,color:new e.D(e.v.light.color),intensity:new e.D(e.v.light.intensity)}),this._transitionable=new e.T(P),this.setLight(t),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(t){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!this._validate(e.t,t,i))for(const e in t){const i=t[e];e.endsWith("-transition")?this._transitionable.setTransition(e.slice(0,-11),i):this._transitionable.setValue(e,i)}}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}_validate(t,i,n){return(!n||!1!==n.validate)&&e.x(this,t.call(e.y,e.e({value:i,style:{glyphs:!0,sprite:!0},styleSpec:e.v})))}}class I{constructor(e,t){this.width=e,this.height=t,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(e,t){const i=e.join(",")+String(t);return this.dashEntry[i]||(this.dashEntry[i]=this.addDash(e,t)),this.dashEntry[i]}getDashRanges(e,t,i){const n=[];let r=e.length%2==1?-e[e.length-1]*i:0,a=e[0]*i,s=!0;n.push({left:r,right:a,isDash:s,zeroLength:0===e[0]});let o=e[0];for(let l=1;l<e.length;l++){s=!s;const t=e[l];r=o*i,o+=t,a=o*i,n.push({left:r,right:a,isDash:s,zeroLength:0===t})}return n}addRoundDash(e,t,i){const n=t/2;for(let r=-i;r<=i;r++){const t=this.width*(this.nextRow+i+r);let a=0,s=e[a];for(let o=0;o<this.width;o++){o/s.right>1&&(s=e[++a]);const l=Math.abs(o-s.left),c=Math.abs(o-s.right),u=Math.min(l,c);let h;const d=r/i*(n+1);if(s.isDash){const e=n-Math.abs(d);h=Math.sqrt(u*u+e*e)}else h=n-Math.sqrt(u*u+d*d);this.data[t+o]=Math.max(0,Math.min(255,h+128))}}}addRegularDash(e){for(let s=e.length-1;s>=0;--s){const t=e[s],i=e[s+1];t.zeroLength?e.splice(s,1):i&&i.isDash===t.isDash&&(i.left=t.left,e.splice(s,1))}const t=e[0],i=e[e.length-1];t.isDash===i.isDash&&(t.left=i.left-this.width,i.right=t.right+this.width);const n=this.width*this.nextRow;let r=0,a=e[r];for(let s=0;s<this.width;s++){s/a.right>1&&(a=e[++r]);const t=Math.abs(s-a.left),i=Math.abs(s-a.right),o=Math.min(t,i);this.data[n+s]=Math.max(0,Math.min(255,(a.isDash?o:-o)+128))}}addDash(t,i){const n=i?7:0,r=2*n+1;if(this.nextRow+r>this.height)return e.w("LineAtlas out of space"),null;let a=0;for(let e=0;e<t.length;e++)a+=t[e];if(0!==a){const e=this.width/a,r=this.getDashRanges(t,this.width,e);i?this.addRoundDash(r,e,n):this.addRegularDash(r)}const s={y:(this.nextRow+n+.5)/this.height,height:2*n/this.height,width:a};return this.nextRow+=r,this.dirty=!0,s}bind(e){const t=e.gl;this.texture?(t.bindTexture(t.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,t.texSubImage2D(t.TEXTURE_2D,0,0,0,this.width,this.height,t.ALPHA,t.UNSIGNED_BYTE,this.data))):(this.texture=t.createTexture(),t.bindTexture(t.TEXTURE_2D,this.texture),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.REPEAT),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.REPEAT),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texImage2D(t.TEXTURE_2D,0,t.ALPHA,this.width,this.height,0,t.ALPHA,t.UNSIGNED_BYTE,this.data))}}class A{constructor(t,i,n){this.workerPool=t,this.actors=[],this.currentActor=0,this.id=n;const r=this.workerPool.acquire(n);for(let a=0;a<r.length;a++){const t=new e.C(r[a],i,n);t.name=`Worker ${a}`,this.actors.push(t)}if(!this.actors.length)throw new Error("No actors found")}broadcast(t,i,n){e.o(this.actors,((e,n)=>{e.send(t,i,n)}),n=n||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.actors.forEach((e=>{e.remove()})),this.actors=[],e&&this.workerPool.release(this.id)}}function M(t,i,n){const r=function(i,r){if(i)return n(i);if(r){const i=e.F(e.e(r,t),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);r.vector_layers&&(i.vectorLayers=r.vector_layers,i.vectorLayerIds=i.vectorLayers.map((e=>e.id))),n(null,i)}};return t.url?e.f(i.transformRequest(t.url,u.Source),r):e.h.frame((()=>r(null,t)))}class z{constructor(e,t){e&&(t?this.setSouthWest(e).setNorthEast(t):Array.isArray(e)&&(4===e.length?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1])))}setNorthEast(t){return this._ne=t instanceof e.L?new e.L(t.lng,t.lat):e.L.convert(t),this}setSouthWest(t){return this._sw=t instanceof e.L?new e.L(t.lng,t.lat):e.L.convert(t),this}extend(t){const i=this._sw,n=this._ne;let r,a;if(t instanceof e.L)r=t,a=t;else{if(!(t instanceof z))return Array.isArray(t)?4===t.length||t.every(Array.isArray)?this.extend(z.convert(t)):this.extend(e.L.convert(t)):t&&("lng"in t||"lon"in t)&&"lat"in t?this.extend(e.L.convert(t)):this;if(r=t._sw,a=t._ne,!r||!a)return this}return i||n?(i.lng=Math.min(r.lng,i.lng),i.lat=Math.min(r.lat,i.lat),n.lng=Math.max(a.lng,n.lng),n.lat=Math.max(a.lat,n.lat)):(this._sw=new e.L(r.lng,r.lat),this._ne=new e.L(a.lng,a.lat)),this}getCenter(){return new e.L((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new e.L(this.getWest(),this.getNorth())}getSouthEast(){return new e.L(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(t){const{lng:i,lat:n}=e.L.convert(t);let r=this._sw.lng<=i&&i<=this._ne.lng;return this._sw.lng>this._ne.lng&&(r=this._sw.lng>=i&&i>=this._ne.lng),this._sw.lat<=n&&n<=this._ne.lat&&r}static convert(e){return e instanceof z?e:e?new z(e):e}static fromLngLat(t){const i=360*(arguments.length>1&&void 0!==arguments[1]?arguments[1]:0)/40075017,n=i/Math.cos(Math.PI/180*t.lat);return new z(new e.L(t.lng-n,t.lat-i),new e.L(t.lng+n,t.lat+i))}}class D{constructor(e,t,i){this.bounds=z.convert(this.validateBounds(e)),this.minzoom=t||0,this.maxzoom=i||24}validateBounds(e){return Array.isArray(e)&&4===e.length?[Math.max(-180,e[0]),Math.max(-90,e[1]),Math.min(180,e[2]),Math.min(90,e[3])]:[-180,-90,180,90]}contains(t){const i=Math.pow(2,t.z),n=Math.floor(e.G(this.bounds.getWest())*i),r=Math.floor(e.H(this.bounds.getNorth())*i),a=Math.ceil(e.G(this.bounds.getEast())*i),s=Math.ceil(e.H(this.bounds.getSouth())*i);return t.x>=n&&t.x<a&&t.y>=r&&t.y<s}}class L extends e.E{constructor(t,i,n,r){if(super(),this.load=()=>{this._loaded=!1,this.fire(new e.k("dataloading",{dataType:"source"})),this._tileJSONRequest=M(this._options,this.map._requestManager,((t,i)=>{this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),t?this.fire(new e.j(t)):i&&(e.e(this,i),i.bounds&&(this.tileBounds=new D(i.bounds,this.minzoom,this.maxzoom)),this.fire(new e.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new e.k("data",{dataType:"source",sourceDataType:"content"})))}))},this.serialize=()=>e.e({},this._options),this.id=t,this.dispatcher=n,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,e.e(this,e.F(i,["url","scheme","tileSize","promoteId"])),this._options=e.e({type:"vector"},i),this._collectResourceTiming=i.collectResourceTiming,512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(r)}loaded(){return this._loaded}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}onAdd(e){this.map=e,this.load()}setSourceProperty(e){this._tileJSONRequest&&this._tileJSONRequest.cancel(),e(),this.load()}setTiles(e){return this.setSourceProperty((()=>{this._options.tiles=e})),this}setUrl(e){return this.setSourceProperty((()=>{this.url=e,this._options.url=e})),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}loadTile(e,t){const i=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),n={request:this.map._requestManager.transformRequest(i,u.Tile),uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,tileSize:this.tileSize*e.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function r(i,n){return delete e.request,e.aborted?t(null):i&&404!==i.status?t(i):(n&&n.resourceTiming&&(e.resourceTiming=n.resourceTiming),this.map._refreshExpiredTiles&&n&&e.setExpiryData(n),e.loadVectorData(n,this.map.painter),t(null),void(e.reloadCallback&&(this.loadTile(e,e.reloadCallback),e.reloadCallback=null)))}n.request.collectResourceTiming=this._collectResourceTiming,e.actor&&"expired"!==e.state?"loading"===e.state?e.reloadCallback=t:e.request=e.actor.send("reloadTile",n,r.bind(this)):(e.actor=this.dispatcher.getActor(),e.request=e.actor.send("loadTile",n,r.bind(this)))}abortTile(e){e.request&&(e.request.cancel(),delete e.request),e.actor&&e.actor.send("abortTile",{uid:e.uid,type:this.type,source:this.id},void 0)}unloadTile(e){e.unloadVectorData(),e.actor&&e.actor.send("removeTile",{uid:e.uid,type:this.type,source:this.id},void 0)}hasTransition(){return!1}}class R extends e.E{constructor(t,i,n,r){super(),this.id=t,this.dispatcher=n,this.setEventedParent(r),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=e.e({type:"raster"},i),e.e(this,e.F(i,["url","scheme","tileSize"]))}load(){this._loaded=!1,this.fire(new e.k("dataloading",{dataType:"source"})),this._tileJSONRequest=M(this._options,this.map._requestManager,((t,i)=>{this._tileJSONRequest=null,this._loaded=!0,t?this.fire(new e.j(t)):i&&(e.e(this,i),i.bounds&&(this.tileBounds=new D(i.bounds,this.minzoom,this.maxzoom)),this.fire(new e.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new e.k("data",{dataType:"source",sourceDataType:"content"})))}))}loaded(){return this._loaded}onAdd(e){this.map=e,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}setSourceProperty(e){this._tileJSONRequest&&this._tileJSONRequest.cancel(),e(),this.load()}setTiles(e){return this.setSourceProperty((()=>{this._options.tiles=e})),this}serialize(){return e.e({},this._options)}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}loadTile(e,t){const i=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);e.request=c.getImage(this.map._requestManager.transformRequest(i,u.Tile),((i,n,r)=>{if(delete e.request,e.aborted)e.state="unloaded",t(null);else if(i)e.state="errored",t(i);else if(n){this.map._refreshExpiredTiles&&r&&e.setExpiryData(r);const i=this.map.painter.context,a=i.gl;e.texture=this.map.painter.getTileTexture(n.width),e.texture?e.texture.update(n,{useMipmap:!0}):(e.texture=new v(i,n,a.RGBA,{useMipmap:!0}),e.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE,a.LINEAR_MIPMAP_NEAREST),i.extTextureFilterAnisotropic&&a.texParameterf(a.TEXTURE_2D,i.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,i.extTextureFilterAnisotropicMax)),e.state="loaded",t(null)}}),this.map._refreshExpiredTiles)}abortTile(e,t){e.request&&(e.request.cancel(),delete e.request),t()}unloadTile(e,t){e.texture&&this.map.painter.saveTileTexture(e.texture),t()}hasTransition(){return!1}}class F extends R{constructor(t,i,n,r){super(t,i,n,r),this.type="raster-dem",this.maxzoom=22,this._options=e.e({type:"raster-dem"},i),this.encoding=i.encoding||"mapbox",this.redFactor=i.redFactor,this.greenFactor=i.greenFactor,this.blueFactor=i.blueFactor,this.baseShift=i.baseShift}loadTile(t,i){const n=t.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),r=this.map._requestManager.transformRequest(n,u.Tile);function a(e,n){e&&(t.state="errored",i(e)),n&&(t.dem=n,t.needsHillshadePrepare=!0,t.needsTerrainPrepare=!0,t.state="loaded",i(null))}t.neighboringTiles=this._getNeighboringTiles(t.tileID),t.request=c.getImage(r,((n,r,s)=>e._(this,void 0,void 0,(function*(){if(delete t.request,t.aborted)t.state="unloaded",i(null);else if(n)t.state="errored",i(n);else if(r){this.map._refreshExpiredTiles&&t.setExpiryData(s);const i=e.a(r)&&e.J()?r:yield function(t){return e._(this,void 0,void 0,(function*(){if("undefined"!=typeof VideoFrame&&e.K()){const i=t.width+2,n=t.height+2;try{return new e.R({width:i,height:n},yield e.M(t,-1,-1,i,n))}catch(e){}}return e.h.getImageData(t,1)}))}(r),n={uid:t.uid,coord:t.tileID,source:this.id,rawImageData:i,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};t.actor&&"expired"!==t.state||(t.actor=this.dispatcher.getActor(),t.actor.send("loadDEMTile",n,a))}}))),this.map._refreshExpiredTiles)}_getNeighboringTiles(t){const i=t.canonical,n=Math.pow(2,i.z),r=(i.x-1+n)%n,a=0===i.x?t.wrap-1:t.wrap,s=(i.x+1+n)%n,o=i.x+1===n?t.wrap+1:t.wrap,l={};return l[new e.O(t.overscaledZ,a,i.z,r,i.y).key]={backfilled:!1},l[new e.O(t.overscaledZ,o,i.z,s,i.y).key]={backfilled:!1},i.y>0&&(l[new e.O(t.overscaledZ,a,i.z,r,i.y-1).key]={backfilled:!1},l[new e.O(t.overscaledZ,t.wrap,i.z,i.x,i.y-1).key]={backfilled:!1},l[new e.O(t.overscaledZ,o,i.z,s,i.y-1).key]={backfilled:!1}),i.y+1<n&&(l[new e.O(t.overscaledZ,a,i.z,r,i.y+1).key]={backfilled:!1},l[new e.O(t.overscaledZ,t.wrap,i.z,i.x,i.y+1).key]={backfilled:!1},l[new e.O(t.overscaledZ,o,i.z,s,i.y+1).key]={backfilled:!1}),l}unloadTile(e){e.demTexture&&this.map.painter.saveTileTexture(e.demTexture),e.fbo&&(e.fbo.destroy(),delete e.fbo),e.dem&&delete e.dem,delete e.neighboringTiles,e.state="unloaded",e.actor&&e.actor.send("removeDEMTile",{uid:e.uid,source:this.id})}}class B extends e.E{constructor(t,i,n,r){super(),this.load=()=>{this._updateWorkerData()},this.serialize=()=>e.e({},this._options,{type:this.type,data:this._data}),this.id=t,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=n.getActor(),this.setEventedParent(r),this._data=i.data,this._options=e.e({},i),this._collectResourceTiming=i.collectResourceTiming,void 0!==i.maxzoom&&(this.maxzoom=i.maxzoom),i.type&&(this.type=i.type),i.attribution&&(this.attribution=i.attribution),this.promoteId=i.promoteId;const a=e.N/this.tileSize;this.workerOptions=e.e({source:this.id,cluster:i.cluster||!1,geojsonVtOptions:{buffer:(void 0!==i.buffer?i.buffer:128)*a,tolerance:(void 0!==i.tolerance?i.tolerance:.375)*a,extent:e.N,maxZoom:this.maxzoom,lineMetrics:i.lineMetrics||!1,generateId:i.generateId||!1},superclusterOptions:{maxZoom:void 0!==i.clusterMaxZoom?i.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,i.clusterMinPoints||2),extent:e.N,radius:(i.clusterRadius||50)*a,log:!1,generateId:i.generateId||!1},clusterProperties:i.clusterProperties,filter:i.filter},i.workerOptions),"string"==typeof this.promoteId&&(this.workerOptions.promoteId=this.promoteId)}onAdd(e){this.map=e,this.load()}setData(e){return this._data=e,this._updateWorkerData(),this}updateData(e){return this._updateWorkerData(e),this}setClusterOptions(e){return this.workerOptions.cluster=e.cluster,e&&(void 0!==e.clusterRadius&&(this.workerOptions.superclusterOptions.radius=e.clusterRadius),void 0!==e.clusterMaxZoom&&(this.workerOptions.superclusterOptions.maxZoom=e.clusterMaxZoom)),this._updateWorkerData(),this}getClusterExpansionZoom(e,t){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:e,source:this.id},t),this}getClusterChildren(e,t){return this.actor.send("geojson.getClusterChildren",{clusterId:e,source:this.id},t),this}getClusterLeaves(e,t,i,n){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:e,limit:t,offset:i},n),this}_updateWorkerData(t){const i=e.e({},this.workerOptions);t?i.dataDiff=t:"string"==typeof this._data?(i.request=this.map._requestManager.transformRequest(e.h.resolveURL(this._data),u.Source),i.request.collectResourceTiming=this._collectResourceTiming):i.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new e.k("dataloading",{dataType:"source"})),this.actor.send(`${this.type}.loadData`,i,((t,i)=>{if(this._pendingLoads--,this._removed||i&&i.abandoned)return void this.fire(new e.k("dataabort",{dataType:"source"}));let n=null;if(i&&i.resourceTiming&&i.resourceTiming[this.id]&&(n=i.resourceTiming[this.id].slice(0)),t)return void this.fire(new e.j(t));const r={dataType:"source"};this._collectResourceTiming&&n&&n.length>0&&e.e(r,{resourceTiming:n}),this.fire(new e.k("data",Object.assign(Object.assign({},r),{sourceDataType:"metadata"}))),this.fire(new e.k("data",Object.assign(Object.assign({},r),{sourceDataType:"content"})))}))}loaded(){return 0===this._pendingLoads}loadTile(e,t){const i=e.actor?"reloadTile":"loadTile";e.actor=this.actor;const n={type:this.type,uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};e.request=this.actor.send(i,n,((n,r)=>(delete e.request,e.unloadVectorData(),e.aborted?t(null):n?t(n):(e.loadVectorData(r,this.map.painter,"reloadTile"===i),t(null)))))}abortTile(e){e.request&&(e.request.cancel(),delete e.request),e.aborted=!0}unloadTile(e){e.unloadVectorData(),this.actor.send("removeTile",{uid:e.uid,type:this.type,source:this.id})}onRemove(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})}hasTransition(){return!1}}var O=e.Q([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class N extends e.E{constructor(t,i,n,r){super(),this.load=(t,i)=>{this._loaded=!1,this.fire(new e.k("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=c.getImage(this.map._requestManager.transformRequest(this.url,u.Image),((n,r)=>{this._request=null,this._loaded=!0,n?this.fire(new e.j(n)):r&&(this.image=r,t&&(this.coordinates=t),i&&i(),this._finishLoading())}))},this.prepare=()=>{if(0===Object.keys(this.tiles).length||!this.image)return;const t=this.map.painter.context,i=t.gl;this.boundsBuffer||(this.boundsBuffer=t.createVertexBuffer(this._boundsArray,O.members)),this.boundsSegments||(this.boundsSegments=e.S.simpleSegment(0,0,4,2)),this.texture||(this.texture=new v(t,this.image,i.RGBA),this.texture.bind(i.LINEAR,i.CLAMP_TO_EDGE));let n=!1;for(const e in this.tiles){const t=this.tiles[e];"loaded"!==t.state&&(t.state="loaded",t.texture=this.texture,n=!0)}n&&this.fire(new e.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))},this.serialize=()=>({type:"image",url:this.options.url,coordinates:this.coordinates}),this.id=t,this.dispatcher=n,this.coordinates=i.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(r),this.options=i}loaded(){return this._loaded}updateImage(e){return e.url?(this._request&&(this._request.cancel(),this._request=null),this.options.url=e.url,this.load(e.coordinates,(()=>{this.texture=null})),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new e.k("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(e){this.map=e,this.load()}onRemove(){this._request&&(this._request.cancel(),this._request=null)}setCoordinates(t){this.coordinates=t;const i=t.map(e.U.fromLngLat);this.tileID=function(t){let i=1/0,n=1/0,r=-1/0,a=-1/0;for(const e of t)i=Math.min(i,e.x),n=Math.min(n,e.y),r=Math.max(r,e.x),a=Math.max(a,e.y);const s=Math.max(r-i,a-n),o=Math.max(0,Math.floor(-Math.log(s)/Math.LN2)),l=Math.pow(2,o);return new e.W(o,Math.floor((i+r)/2*l),Math.floor((n+a)/2*l))}(i),this.minzoom=this.maxzoom=this.tileID.z;const n=i.map((e=>this.tileID.getTilePoint(e)._round()));return this._boundsArray=new e.V,this._boundsArray.emplaceBack(n[0].x,n[0].y,0,0),this._boundsArray.emplaceBack(n[1].x,n[1].y,e.N,0),this._boundsArray.emplaceBack(n[3].x,n[3].y,0,e.N),this._boundsArray.emplaceBack(n[2].x,n[2].y,e.N,e.N),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new e.k("data",{dataType:"source",sourceDataType:"content"})),this}loadTile(e,t){this.tileID&&this.tileID.equals(e.tileID.canonical)?(this.tiles[String(e.tileID.wrap)]=e,e.buckets={},t(null)):(e.state="errored",t(null))}hasTransition(){return!1}}class V extends N{constructor(t,i,n,r){super(t,i,n,r),this.load=()=>{this._loaded=!1;const t=this.options;this.urls=[];for(const e of t.urls)this.urls.push(this.map._requestManager.transformRequest(e,u.Source).url);e.X(this.urls,((t,i)=>{this._loaded=!0,t?this.fire(new e.j(t)):i&&(this.video=i,this.video.loop=!0,this.video.addEventListener("playing",(()=>{this.map.triggerRepaint()})),this.map&&this.video.play(),this._finishLoading())}))},this.prepare=()=>{if(0===Object.keys(this.tiles).length||this.video.readyState<2)return;const t=this.map.painter.context,i=t.gl;this.boundsBuffer||(this.boundsBuffer=t.createVertexBuffer(this._boundsArray,O.members)),this.boundsSegments||(this.boundsSegments=e.S.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(i.LINEAR,i.CLAMP_TO_EDGE),i.texSubImage2D(i.TEXTURE_2D,0,0,0,i.RGBA,i.UNSIGNED_BYTE,this.video)):(this.texture=new v(t,this.video,i.RGBA),this.texture.bind(i.LINEAR,i.CLAMP_TO_EDGE));let n=!1;for(const e in this.tiles){const t=this.tiles[e];"loaded"!==t.state&&(t.state="loaded",t.texture=this.texture,n=!0)}n&&this.fire(new e.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))},this.serialize=()=>({type:"video",urls:this.urls,coordinates:this.coordinates}),this.roundZoom=!0,this.type="video",this.options=i}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(t){if(this.video){const i=this.video.seekable;t<i.start(0)||t>i.end(0)?this.fire(new e.j(new e.Y(`sources.${this.id}`,null,`Playback for this video can be set only between the ${i.start(0)} and ${i.end(0)}-second mark.`))):this.video.currentTime=t}}getVideo(){return this.video}onAdd(e){this.map||(this.map=e,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}hasTransition(){return this.video&&!this.video.paused}}class j extends N{constructor(t,i,n,r){super(t,i,n,r),this.load=()=>{this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new e.j(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},this.prepare=()=>{let t=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,t=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,t=!0),this._hasInvalidDimensions())return;if(0===Object.keys(this.tiles).length)return;const i=this.map.painter.context,n=i.gl;this.boundsBuffer||(this.boundsBuffer=i.createVertexBuffer(this._boundsArray,O.members)),this.boundsSegments||(this.boundsSegments=e.S.simpleSegment(0,0,4,2)),this.texture?(t||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new v(i,this.canvas,n.RGBA,{premultiply:!0});let r=!1;for(const e in this.tiles){const t=this.tiles[e];"loaded"!==t.state&&(t.state="loaded",t.texture=this.texture,r=!0)}r&&this.fire(new e.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))},this.serialize=()=>({type:"canvas",coordinates:this.coordinates}),i.coordinates?Array.isArray(i.coordinates)&&4===i.coordinates.length&&!i.coordinates.some((e=>!Array.isArray(e)||2!==e.length||e.some((e=>"number"!=typeof e))))||this.fire(new e.j(new e.Y(`sources.${t}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new e.j(new e.Y(`sources.${t}`,null,'missing required property "coordinates"'))),i.animate&&"boolean"!=typeof i.animate&&this.fire(new e.j(new e.Y(`sources.${t}`,null,'optional "animate" property must be a boolean value'))),i.canvas?"string"==typeof i.canvas||i.canvas instanceof HTMLCanvasElement||this.fire(new e.j(new e.Y(`sources.${t}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new e.j(new e.Y(`sources.${t}`,null,'missing required property "canvas"'))),this.options=i,this.animate=void 0===i.animate||i.animate}getCanvas(){return this.canvas}onAdd(e){this.map=e,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const e of[this.canvas.width,this.canvas.height])if(isNaN(e)||e<=0)return!0;return!1}}const U={},$=e=>{switch(e){case"geojson":return B;case"image":return N;case"raster":return R;case"raster-dem":return F;case"vector":return L;case"video":return V;case"canvas":return j}return U[e]};function q(t,i){const n=e.Z();return e.$(n,n,[1,1,0]),e.a0(n,n,[.5*t.width,.5*t.height,1]),e.a1(n,n,t.calculatePosMatrix(i.toUnwrapped()))}function Z(e,t,i,n,r,a){const s=function(e,t,i){if(e)for(const n of e){const e=t[n];if(e&&e.source===i&&"fill-extrusion"===e.type)return!0}else for(const n in t){const e=t[n];if(e.source===i&&"fill-extrusion"===e.type)return!0}return!1}(r&&r.layers,t,e.id),o=a.maxPitchScaleFactor(),l=e.tilesIn(n,o,s);l.sort(G);const c=[];for(const h of l)c.push({wrappedTileID:h.tileID.wrapped().key,queryResults:h.tile.queryRenderedFeatures(t,i,e._state,h.queryGeometry,h.cameraQueryGeometry,h.scale,r,a,o,q(e.transform,h.tileID))});const u=function(e){const t={},i={};for(const n of e){const e=n.queryResults,r=n.wrappedTileID,a=i[r]=i[r]||{};for(const i in e){const n=e[i],r=a[i]=a[i]||{},s=t[i]=t[i]||[];for(const e of n)r[e.featureIndex]||(r[e.featureIndex]=!0,s.push(e))}}return t}(c);for(const h in u)u[h].forEach((t=>{const i=t.feature,n=e.getFeatureState(i.layer["source-layer"],i.id);i.source=i.layer.source,i.layer["source-layer"]&&(i.sourceLayer=i.layer["source-layer"]),i.state=n}));return u}function G(e,t){const i=e.tileID,n=t.tileID;return i.overscaledZ-n.overscaledZ||i.canonical.y-n.canonical.y||i.wrap-n.wrap||i.canonical.x-n.canonical.x}class W{constructor(t,i){this.timeAdded=0,this.fadeEndTime=0,this.tileID=t,this.uid=e.a2(),this.uses=0,this.tileSize=i,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(e){const t=e+this.timeAdded;t<this.fadeEndTime||(this.fadeEndTime=t)}wasRequested(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state}clearTextures(e){this.demTexture&&e.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(t,i,n){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",t){t.featureIndex&&(this.latestFeatureIndex=t.featureIndex,t.rawTileData?(this.latestRawTileData=t.rawTileData,this.latestFeatureIndex.rawTileData=t.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=t.collisionBoxArray,this.buckets=function(e,t){const i={};if(!t)return i;for(const n of e){const e=n.layerIds.map((e=>t.getLayer(e))).filter(Boolean);if(0!==e.length){n.layers=e,n.stateDependentLayerIds&&(n.stateDependentLayers=n.stateDependentLayerIds.map((t=>e.filter((e=>e.id===t))[0])));for(const t of e)i[t.id]=n}}return i}(t.buckets,i.style),this.hasSymbolBuckets=!1;for(const t in this.buckets){const i=this.buckets[t];if(i instanceof e.a4){if(this.hasSymbolBuckets=!0,!n)break;i.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const t in this.buckets){const i=this.buckets[t];if(i instanceof e.a4&&i.hasRTLText){this.hasRTLText=!0,e.a5();break}}this.queryPadding=0;for(const e in this.buckets){const t=this.buckets[e];this.queryPadding=Math.max(this.queryPadding,i.style.getLayer(e).queryRadius(t))}t.imageAtlas&&(this.imageAtlas=t.imageAtlas),t.glyphAtlasImage&&(this.glyphAtlasImage=t.glyphAtlasImage)}else this.collisionBoxArray=new e.a3}unloadVectorData(){for(const e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(e){return this.buckets[e.id]}upload(e){for(const i in this.buckets){const t=this.buckets[i];t.uploadPending()&&t.upload(e)}const t=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new v(e,this.imageAtlas.image,t.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new v(e,this.glyphAtlasImage,t.ALPHA),this.glyphAtlasImage=null)}prepare(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)}queryRenderedFeatures(e,t,i,n,r,a,s,o,l,c){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:n,cameraQueryGeometry:r,scale:a,tileSize:this.tileSize,pixelPosMatrix:c,transform:o,params:s,queryPadding:this.queryPadding*l},e,t,i):{}}querySourceFeatures(t,i){const n=this.latestFeatureIndex;if(!n||!n.rawTileData)return;const r=n.loadVTLayers(),a=i&&i.sourceLayer?i.sourceLayer:"",s=r._geojsonTileLayer||r[a];if(!s)return;const o=e.a6(i&&i.filter),{z:l,x:c,y:u}=this.tileID.canonical,h={z:l,x:c,y:u};for(let d=0;d<s.length;d++){const i=s.feature(d);if(o.needGeometry){const t=e.a7(i,!0);if(!o.filter(new e.a8(this.tileID.overscaledZ),t,this.tileID.canonical))continue}else if(!o.filter(new e.a8(this.tileID.overscaledZ),i))continue;const r=n.getId(i,a),p=new e.a9(i,l,c,u,r);p.tile=h,t.push(p)}}hasData(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(t){const i=this.expirationTime;if(t.cacheControl){const i=e.aa(t.cacheControl);i["max-age"]&&(this.expirationTime=Date.now()+1e3*i["max-age"])}else t.expires&&(this.expirationTime=new Date(t.expires).getTime());if(this.expirationTime){const e=Date.now();let t=!1;if(this.expirationTime>e)t=!1;else if(i)if(this.expirationTime<i)t=!0;else{const n=this.expirationTime-i;n?this.expirationTime=e+Math.max(n,3e4):t=!0}else t=!0;t?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)}setFeatureState(e,t){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||0===Object.keys(e).length)return;const i=this.latestFeatureIndex.loadVTLayers();for(const n in this.buckets){if(!t.style.hasLayer(n))continue;const r=this.buckets[n],a=r.layers[0].sourceLayer||"_geojsonTileLayer",s=i[a],o=e[a];if(!s||!o||0===Object.keys(o).length)continue;r.update(o,s,this.imageAtlas&&this.imageAtlas.patternPositions||{});const l=t&&t.style&&t.style.getLayer(n);l&&(this.queryPadding=Math.max(this.queryPadding,l.queryRadius(r)))}}holdingForFade(){return void 0!==this.symbolFadeHoldUntil}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<e.h.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(t){this.symbolFadeHoldUntil=e.h.now()+t}setDependencies(e,t){const i={};for(const n of t)i[n]=!0;this.dependencies[e]=i}hasDependency(e,t){for(const i of e){const e=this.dependencies[i];if(e)for(const i of t)if(e[i])return!0}return!1}}class H{constructor(e,t){this.max=e,this.onRemove=t,this.reset()}reset(){for(const e in this.data)for(const t of this.data[e])t.timeout&&clearTimeout(t.timeout),this.onRemove(t.value);return this.data={},this.order=[],this}add(e,t,i){const n=e.wrapped().key;void 0===this.data[n]&&(this.data[n]=[]);const r={value:t,timeout:void 0};if(void 0!==i&&(r.timeout=setTimeout((()=>{this.remove(e,r)}),i)),this.data[n].push(r),this.order.push(n),this.order.length>this.max){const e=this._getAndRemoveByKey(this.order[0]);e&&this.onRemove(e)}return this}has(e){return e.wrapped().key in this.data}getAndRemove(e){return this.has(e)?this._getAndRemoveByKey(e.wrapped().key):null}_getAndRemoveByKey(e){const t=this.data[e].shift();return t.timeout&&clearTimeout(t.timeout),0===this.data[e].length&&delete this.data[e],this.order.splice(this.order.indexOf(e),1),t.value}getByKey(e){const t=this.data[e];return t?t[0].value:null}get(e){return this.has(e)?this.data[e.wrapped().key][0].value:null}remove(e,t){if(!this.has(e))return this;const i=e.wrapped().key,n=void 0===t?0:this.data[i].indexOf(t),r=this.data[i][n];return this.data[i].splice(n,1),r.timeout&&clearTimeout(r.timeout),0===this.data[i].length&&delete this.data[i],this.onRemove(r.value),this.order.splice(this.order.indexOf(i),1),this}setMaxSize(e){for(this.max=e;this.order.length>this.max;){const e=this._getAndRemoveByKey(this.order[0]);e&&this.onRemove(e)}return this}filter(e){const t=[];for(const i in this.data)for(const n of this.data[i])e(n.value)||t.push(n);for(const i of t)this.remove(i.value.tileID,i)}}class X{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(t,i,n){const r=String(i);if(this.stateChanges[t]=this.stateChanges[t]||{},this.stateChanges[t][r]=this.stateChanges[t][r]||{},e.e(this.stateChanges[t][r],n),null===this.deletedStates[t]){this.deletedStates[t]={};for(const e in this.state[t])e!==r&&(this.deletedStates[t][e]=null)}else if(this.deletedStates[t]&&null===this.deletedStates[t][r]){this.deletedStates[t][r]={};for(const e in this.state[t][r])n[e]||(this.deletedStates[t][r][e]=null)}else for(const e in n)this.deletedStates[t]&&this.deletedStates[t][r]&&null===this.deletedStates[t][r][e]&&delete this.deletedStates[t][r][e]}removeFeatureState(e,t,i){if(null===this.deletedStates[e])return;const n=String(t);if(this.deletedStates[e]=this.deletedStates[e]||{},i&&void 0!==t)null!==this.deletedStates[e][n]&&(this.deletedStates[e][n]=this.deletedStates[e][n]||{},this.deletedStates[e][n][i]=null);else if(void 0!==t)if(this.stateChanges[e]&&this.stateChanges[e][n])for(i in this.deletedStates[e][n]={},this.stateChanges[e][n])this.deletedStates[e][n][i]=null;else this.deletedStates[e][n]=null;else this.deletedStates[e]=null}getState(t,i){const n=String(i),r=e.e({},(this.state[t]||{})[n],(this.stateChanges[t]||{})[n]);if(null===this.deletedStates[t])return{};if(this.deletedStates[t]){const e=this.deletedStates[t][i];if(null===e)return{};for(const t in e)delete r[t]}return r}initializeTileState(e,t){e.setFeatureState(this.state,t)}coalesceChanges(t,i){const n={};for(const r in this.stateChanges){this.state[r]=this.state[r]||{};const t={};for(const i in this.stateChanges[r])this.state[r][i]||(this.state[r][i]={}),e.e(this.state[r][i],this.stateChanges[r][i]),t[i]=this.state[r][i];n[r]=t}for(const r in this.deletedStates){this.state[r]=this.state[r]||{};const t={};if(null===this.deletedStates[r])for(const e in this.state[r])t[e]={},this.state[r][e]={};else for(const e in this.deletedStates[r]){if(null===this.deletedStates[r][e])this.state[r][e]={};else for(const t of Object.keys(this.deletedStates[r][e]))delete this.state[r][e][t];t[e]=this.state[r][e]}n[r]=n[r]||{},e.e(n[r],t)}if(this.stateChanges={},this.deletedStates={},0!==Object.keys(n).length)for(const e in t)t[e].setFeatureState(n,i)}}class K extends e.E{constructor(e,t,i){super(),this.id=e,this.dispatcher=i,this.on("data",(e=>{"source"===e.dataType&&"metadata"===e.sourceDataType&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&"source"===e.dataType&&"content"===e.sourceDataType&&(this.reload(),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)})),this.on("dataloading",(()=>{this._sourceErrored=!1})),this.on("error",(()=>{this._sourceErrored=this._source.loaded()})),this._source=((e,t,i,n)=>{const r=new($(t.type))(e,t,i,n);if(r.id!==e)throw new Error(`Expected Source id to be ${e} instead of ${r.id}`);return r})(e,t,i,this),this._tiles={},this._cache=new H(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new X,this._didEmitContent=!1,this._updated=!1}onAdd(e){this.map=e,this._maxTileCacheSize=e?e._maxTileCacheSize:null,this._maxTileCacheZoomLevels=e?e._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(e)}onRemove(e){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(e)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded)return!1;if(!this._source.loaded())return!1;if(!(void 0===this.used&&void 0===this.usedForTerrain||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const e in this._tiles){const t=this._tiles[e];if("loaded"!==t.state&&"errored"!==t.state)return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const e=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,e&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(e,t){return this._source.loadTile(e,t)}_unloadTile(e){if(this._source.unloadTile)return this._source.unloadTile(e,(()=>{}))}_abortTile(t){this._source.abortTile&&this._source.abortTile(t,(()=>{})),this._source.fire(new e.k("dataabort",{tile:t,coord:t.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(e){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const t in this._tiles){const i=this._tiles[t];i.upload(e),i.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map((e=>e.tileID)).sort(Y).map((e=>e.key))}getRenderableIds(t){const i=[];for(const e in this._tiles)this._isIdRenderable(e,t)&&i.push(this._tiles[e]);return t?i.sort(((t,i)=>{const n=t.tileID,r=i.tileID,a=new e.P(n.canonical.x,n.canonical.y)._rotate(this.transform.angle),s=new e.P(r.canonical.x,r.canonical.y)._rotate(this.transform.angle);return n.overscaledZ-r.overscaledZ||s.y-a.y||s.x-a.x})).map((e=>e.tileID.key)):i.map((e=>e.tileID)).sort(Y).map((e=>e.key))}hasRenderableParent(e){const t=this.findLoadedParent(e,0);return!!t&&this._isIdRenderable(t.tileID.key)}_isIdRenderable(e,t){return this._tiles[e]&&this._tiles[e].hasData()&&!this._coveredTiles[e]&&(t||!this._tiles[e].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const e in this._tiles)"errored"!==this._tiles[e].state&&this._reloadTile(e,"reloading")}}_reloadTile(e,t){const i=this._tiles[e];i&&("loading"!==i.state&&(i.state=t),this._loadTile(i,this._tileLoaded.bind(this,i,e,t)))}_tileLoaded(t,i,n,r){if(r)return t.state="errored",void(404!==r.status?this._source.fire(new e.j(r,{tile:t})):this.update(this.transform,this.terrain));t.timeAdded=e.h.now(),"expired"===n&&(t.refreshedUponExpiration=!0),this._setTileReloadTimer(i,t),"raster-dem"===this.getSource().type&&t.dem&&this._backfillDEM(t),this._state.initializeTileState(t,this.map?this.map.painter:null),t.aborted||this._source.fire(new e.k("data",{dataType:"source",tile:t,coord:t.tileID}))}_backfillDEM(e){const t=this.getRenderableIds();for(let n=0;n<t.length;n++){const r=t[n];if(e.neighboringTiles&&e.neighboringTiles[r]){const t=this.getTileByID(r);i(e,t),i(t,e)}}function i(e,t){e.needsHillshadePrepare=!0,e.needsTerrainPrepare=!0;let i=t.tileID.canonical.x-e.tileID.canonical.x;const n=t.tileID.canonical.y-e.tileID.canonical.y,r=Math.pow(2,e.tileID.canonical.z),a=t.tileID.key;0===i&&0===n||Math.abs(n)>1||(Math.abs(i)>1&&(1===Math.abs(i+r)?i+=r:1===Math.abs(i-r)&&(i-=r)),t.dem&&e.dem&&(e.dem.backfillBorder(t.dem,i,n),e.neighboringTiles&&e.neighboringTiles[a]&&(e.neighboringTiles[a].backfilled=!0)))}}getTile(e){return this.getTileByID(e.key)}getTileByID(e){return this._tiles[e]}_retainLoadedChildren(e,t,i,n){for(const r in this._tiles){let a=this._tiles[r];if(n[r]||!a.hasData()||a.tileID.overscaledZ<=t||a.tileID.overscaledZ>i)continue;let s=a.tileID;for(;a&&a.tileID.overscaledZ>t+1;){const e=a.tileID.scaledTo(a.tileID.overscaledZ-1);a=this._tiles[e.key],a&&a.hasData()&&(s=e)}let o=s;for(;o.overscaledZ>t;)if(o=o.scaledTo(o.overscaledZ-1),e[o.key]){n[s.key]=s;break}}}findLoadedParent(e,t){if(e.key in this._loadedParentTiles){const i=this._loadedParentTiles[e.key];return i&&i.tileID.overscaledZ>=t?i:null}for(let i=e.overscaledZ-1;i>=t;i--){const t=e.scaledTo(i),n=this._getLoadedTile(t);if(n)return n}}_getLoadedTile(e){const t=this._tiles[e.key];return t&&t.hasData()?t:this._cache.getByKey(e.wrapped().key)}updateCacheSize(t){const i=Math.ceil(t.width/this._source.tileSize)+1,n=Math.ceil(t.height/this._source.tileSize)+1,r=Math.floor(i*n*(null===this._maxTileCacheZoomLevels?e.c.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),a="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,r):r;this._cache.setMaxSize(a)}handleWrapJump(e){const t=Math.round((e-(void 0===this._prevLng?e:this._prevLng))/360);if(this._prevLng=e,t){const e={};for(const i in this._tiles){const n=this._tiles[i];n.tileID=n.tileID.unwrapTo(n.tileID.wrap+t),e[n.tileID.key]=n}this._tiles=e;for(const t in this._timers)clearTimeout(this._timers[t]),delete this._timers[t];for(const t in this._tiles)this._setTileReloadTimer(t,this._tiles[t])}}update(t,i){if(this.transform=t,this.terrain=i,!this._sourceLoaded||this._paused)return;let n;this.updateCacheSize(t),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?n=t.getVisibleUnwrappedCoordinates(this._source.tileID).map((t=>new e.O(t.canonical.z,t.wrap,t.canonical.z,t.canonical.x,t.canonical.y))):(n=t.coveringTiles({tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:i}),this._source.hasTile&&(n=n.filter((e=>this._source.hasTile(e))))):n=[];const r=t.coveringZoomLevel(this._source),a=Math.max(r-K.maxOverzooming,this._source.minzoom),s=Math.max(r+K.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const e={};for(const t of n)if(t.canonical.z>this._source.minzoom){const i=t.scaledTo(t.canonical.z-1);e[i.key]=i;const n=t.scaledTo(Math.max(this._source.minzoom,Math.min(t.canonical.z,5)));e[n.key]=n}n=n.concat(Object.values(e))}const o=0===n.length&&!this._updated&&this._didEmitContent;this._updated=!0,o&&this.fire(new e.k("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const l=this._updateRetainedTiles(n,r);if(J(this._source.type)){const t={},o={},c=Object.keys(l),u=e.h.now();for(const e of c){const i=l[e],n=this._tiles[e];if(!n||0!==n.fadeEndTime&&n.fadeEndTime<=u)continue;const r=this.findLoadedParent(i,a);r&&(this._addTile(r.tileID),t[r.tileID.key]=r.tileID),o[e]=i}this._retainLoadedChildren(o,r,s,l);for(const e in t)l[e]||(this._coveredTiles[e]=!0,l[e]=t[e]);if(i){const e={},t={};for(const i of n)this._tiles[i.key].hasData()?e[i.key]=i:t[i.key]=i;for(const i in t){const n=t[i].children(this._source.maxzoom);this._tiles[n[0].key]&&this._tiles[n[1].key]&&this._tiles[n[2].key]&&this._tiles[n[3].key]&&(e[n[0].key]=l[n[0].key]=n[0],e[n[1].key]=l[n[1].key]=n[1],e[n[2].key]=l[n[2].key]=n[2],e[n[3].key]=l[n[3].key]=n[3],delete t[i])}for(const i in t){const n=this.findLoadedParent(t[i],this._source.minzoom);if(n){e[n.tileID.key]=l[n.tileID.key]=n.tileID;for(const t in e)e[t].isChildOf(n.tileID)&&delete e[t]}}for(const i in this._tiles)e[i]||(this._coveredTiles[i]=!0)}}for(const e in l)this._tiles[e].clearFadeHold();const c=e.ab(this._tiles,l);for(const e of c){const t=this._tiles[e];t.hasSymbolBuckets&&!t.holdingForFade()?t.setHoldDuration(this.map._fadeDuration):t.hasSymbolBuckets&&!t.symbolFadeFinished()||this._removeTile(e)}this._updateLoadedParentTileCache()}releaseSymbolFadeTiles(){for(const e in this._tiles)this._tiles[e].holdingForFade()&&this._removeTile(e)}_updateRetainedTiles(e,t){const i={},n={},r=Math.max(t-K.maxOverzooming,this._source.minzoom),a=Math.max(t+K.maxUnderzooming,this._source.minzoom),s={};for(const o of e){const e=this._addTile(o);i[o.key]=o,e.hasData()||t<this._source.maxzoom&&(s[o.key]=o)}this._retainLoadedChildren(s,t,a,i);for(const o of e){let e=this._tiles[o.key];if(e.hasData())continue;if(t+1>this._source.maxzoom){const e=o.children(this._source.maxzoom)[0],t=this.getTile(e);if(t&&t.hasData()){i[e.key]=e;continue}}else{const e=o.children(this._source.maxzoom);if(i[e[0].key]&&i[e[1].key]&&i[e[2].key]&&i[e[3].key])continue}let a=e.wasRequested();for(let t=o.overscaledZ-1;t>=r;--t){const r=o.scaledTo(t);if(n[r.key])break;if(n[r.key]=!0,e=this.getTile(r),!e&&a&&(e=this._addTile(r)),e){const t=e.hasData();if((a||t)&&(i[r.key]=r),a=e.wasRequested(),t)break}}}return i}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const e in this._tiles){const t=[];let i,n=this._tiles[e].tileID;for(;n.overscaledZ>0;){if(n.key in this._loadedParentTiles){i=this._loadedParentTiles[n.key];break}t.push(n.key);const e=n.scaledTo(n.overscaledZ-1);if(i=this._getLoadedTile(e),i)break;n=e}for(const e of t)this._loadedParentTiles[e]=i}}_addTile(t){let i=this._tiles[t.key];if(i)return i;i=this._cache.getAndRemove(t),i&&(this._setTileReloadTimer(t.key,i),i.tileID=t,this._state.initializeTileState(i,this.map?this.map.painter:null),this._cacheTimers[t.key]&&(clearTimeout(this._cacheTimers[t.key]),delete this._cacheTimers[t.key],this._setTileReloadTimer(t.key,i)));const n=i;return i||(i=new W(t,this._source.tileSize*t.overscaleFactor()),this._loadTile(i,this._tileLoaded.bind(this,i,t.key,i.state))),i.uses++,this._tiles[t.key]=i,n||this._source.fire(new e.k("dataloading",{tile:i,coord:i.tileID,dataType:"source"})),i}_setTileReloadTimer(e,t){e in this._timers&&(clearTimeout(this._timers[e]),delete this._timers[e]);const i=t.getExpiryTimeout();i&&(this._timers[e]=setTimeout((()=>{this._reloadTile(e,"expired"),delete this._timers[e]}),i))}_removeTile(e){const t=this._tiles[e];t&&(t.uses--,delete this._tiles[e],this._timers[e]&&(clearTimeout(this._timers[e]),delete this._timers[e]),t.uses>0||(t.hasData()&&"reloading"!==t.state?this._cache.add(t.tileID,t,t.getExpiryTimeout()):(t.aborted=!0,this._abortTile(t),this._unloadTile(t))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const e in this._tiles)this._removeTile(e);this._cache.reset()}tilesIn(t,i,n){const r=[],a=this.transform;if(!a)return r;const s=n?a.getCameraQueryGeometry(t):t,o=t.map((e=>a.pointCoordinate(e,this.terrain))),l=s.map((e=>a.pointCoordinate(e,this.terrain))),c=this.getIds();let u=1/0,h=1/0,d=-1/0,p=-1/0;for(const e of l)u=Math.min(u,e.x),h=Math.min(h,e.y),d=Math.max(d,e.x),p=Math.max(p,e.y);for(let f=0;f<c.length;f++){const t=this._tiles[c[f]];if(t.holdingForFade())continue;const n=t.tileID,s=Math.pow(2,a.zoom-t.tileID.overscaledZ),m=i*t.queryPadding*e.N/t.tileSize/s,g=[n.getTilePoint(new e.U(u,h)),n.getTilePoint(new e.U(d,p))];if(g[0].x-m<e.N&&g[0].y-m<e.N&&g[1].x+m>=0&&g[1].y+m>=0){const e=o.map((e=>n.getTilePoint(e))),i=l.map((e=>n.getTilePoint(e)));r.push({tile:t,tileID:n,queryGeometry:e,cameraQueryGeometry:i,scale:s})}}return r}getVisibleCoordinates(e){const t=this.getRenderableIds(e).map((e=>this._tiles[e].tileID));for(const i of t)i.posMatrix=this.transform.calculatePosMatrix(i.toUnwrapped());return t}hasTransition(){if(this._source.hasTransition())return!0;if(J(this._source.type)){const t=e.h.now();for(const e in this._tiles)if(this._tiles[e].fadeEndTime>=t)return!0}return!1}setFeatureState(e,t,i){this._state.updateState(e=e||"_geojsonTileLayer",t,i)}removeFeatureState(e,t,i){this._state.removeFeatureState(e=e||"_geojsonTileLayer",t,i)}getFeatureState(e,t){return this._state.getState(e=e||"_geojsonTileLayer",t)}setDependencies(e,t,i){const n=this._tiles[e];n&&n.setDependencies(t,i)}reloadTilesForDependencies(e,t){for(const i in this._tiles)this._tiles[i].hasDependency(e,t)&&this._reloadTile(i,"reloading");this._cache.filter((i=>!i.hasDependency(e,t)))}}function Y(e,t){const i=Math.abs(2*e.wrap)-+(e.wrap<0),n=Math.abs(2*t.wrap)-+(t.wrap<0);return e.overscaledZ-t.overscaledZ||n-i||t.canonical.y-e.canonical.y||t.canonical.x-e.canonical.x}function J(e){return"raster"===e||"image"===e||"video"===e}K.maxOverzooming=10,K.maxUnderzooming=3;const Q="mapboxgl_preloaded_worker_pool";class ee{constructor(){this.active={}}acquire(t){if(!this.workers)for(this.workers=[];this.workers.length<ee.workerCount;)this.workers.push(new Worker(e.c.WORKER_URL));return this.active[t]=!0,this.workers.slice()}release(e){delete this.active[e],0===this.numActive()&&(this.workers.forEach((e=>{e.terminate()})),this.workers=null)}isPreloaded(){return!!this.active[Q]}numActive(){return Object.keys(this.active).length}}const te=Math.floor(e.h.hardwareConcurrency/2);let ie;function ne(){return ie||(ie=new ee),ie}ee.workerCount=e.ac(globalThis)?Math.max(Math.min(te,3),1):1;class re{constructor(e,t){this.reset(e,t)}reset(e,t){this.points=e||[],this._distances=[0];for(let i=1;i<this.points.length;i++)this._distances[i]=this._distances[i-1]+this.points[i].dist(this.points[i-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(t||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(t){if(1===this.points.length)return this.points[0];t=e.ad(t,0,1);let i=1,n=this._distances[i];const r=t*this.paddedLength+this.padding;for(;n<r&&i<this._distances.length;)n=this._distances[++i];const a=i-1,s=this._distances[a],o=n-s,l=o>0?(r-s)/o:0;return this.points[a].mult(1-l).add(this.points[i].mult(l))}}function ae(e,t){let i=!0;return"always"===e||"never"!==e&&"never"!==t||(i=!1),i}class se{constructor(e,t,i){const n=this.boxCells=[],r=this.circleCells=[];this.xCellCount=Math.ceil(e/i),this.yCellCount=Math.ceil(t/i);for(let a=0;a<this.xCellCount*this.yCellCount;a++)n.push([]),r.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=e,this.height=t,this.xScale=this.xCellCount/e,this.yScale=this.yCellCount/t,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(e,t,i,n,r){this._forEachCell(t,i,n,r,this._insertBoxCell,this.boxUid++),this.boxKeys.push(e),this.bboxes.push(t),this.bboxes.push(i),this.bboxes.push(n),this.bboxes.push(r)}insertCircle(e,t,i,n){this._forEachCell(t-n,i-n,t+n,i+n,this._insertCircleCell,this.circleUid++),this.circleKeys.push(e),this.circles.push(t),this.circles.push(i),this.circles.push(n)}_insertBoxCell(e,t,i,n,r,a){this.boxCells[r].push(a)}_insertCircleCell(e,t,i,n,r,a){this.circleCells[r].push(a)}_query(e,t,i,n,r,a,s){if(i<0||e>this.width||n<0||t>this.height)return[];const o=[];if(e<=0&&t<=0&&this.width<=i&&this.height<=n){if(r)return[{key:null,x1:e,y1:t,x2:i,y2:n}];for(let e=0;e<this.boxKeys.length;e++)o.push({key:this.boxKeys[e],x1:this.bboxes[4*e],y1:this.bboxes[4*e+1],x2:this.bboxes[4*e+2],y2:this.bboxes[4*e+3]});for(let e=0;e<this.circleKeys.length;e++){const t=this.circles[3*e],i=this.circles[3*e+1],n=this.circles[3*e+2];o.push({key:this.circleKeys[e],x1:t-n,y1:i-n,x2:t+n,y2:i+n})}}else this._forEachCell(e,t,i,n,this._queryCell,o,{hitTest:r,overlapMode:a,seenUids:{box:{},circle:{}}},s);return o}query(e,t,i,n){return this._query(e,t,i,n,!1,null)}hitTest(e,t,i,n,r,a){return this._query(e,t,i,n,!0,r,a).length>0}hitTestCircle(e,t,i,n,r){const a=e-i,s=e+i,o=t-i,l=t+i;if(s<0||a>this.width||l<0||o>this.height)return!1;const c=[];return this._forEachCell(a,o,s,l,this._queryCellCircle,c,{hitTest:!0,overlapMode:n,circle:{x:e,y:t,radius:i},seenUids:{box:{},circle:{}}},r),c.length>0}_queryCell(e,t,i,n,r,a,s,o){const{seenUids:l,hitTest:c,overlapMode:u}=s,h=this.boxCells[r];if(null!==h){const r=this.bboxes;for(const s of h)if(!l.box[s]){l.box[s]=!0;const h=4*s,d=this.boxKeys[s];if(e<=r[h+2]&&t<=r[h+3]&&i>=r[h+0]&&n>=r[h+1]&&(!o||o(d))&&(!c||!ae(u,d.overlapMode))&&(a.push({key:d,x1:r[h],y1:r[h+1],x2:r[h+2],y2:r[h+3]}),c))return!0}}const d=this.circleCells[r];if(null!==d){const r=this.circles;for(const s of d)if(!l.circle[s]){l.circle[s]=!0;const h=3*s,d=this.circleKeys[s];if(this._circleAndRectCollide(r[h],r[h+1],r[h+2],e,t,i,n)&&(!o||o(d))&&(!c||!ae(u,d.overlapMode))){const e=r[h],t=r[h+1],i=r[h+2];if(a.push({key:d,x1:e-i,y1:t-i,x2:e+i,y2:t+i}),c)return!0}}}return!1}_queryCellCircle(e,t,i,n,r,a,s,o){const{circle:l,seenUids:c,overlapMode:u}=s,h=this.boxCells[r];if(null!==h){const e=this.bboxes;for(const t of h)if(!c.box[t]){c.box[t]=!0;const i=4*t,n=this.boxKeys[t];if(this._circleAndRectCollide(l.x,l.y,l.radius,e[i+0],e[i+1],e[i+2],e[i+3])&&(!o||o(n))&&!ae(u,n.overlapMode))return a.push(!0),!0}}const d=this.circleCells[r];if(null!==d){const e=this.circles;for(const t of d)if(!c.circle[t]){c.circle[t]=!0;const i=3*t,n=this.circleKeys[t];if(this._circlesCollide(e[i],e[i+1],e[i+2],l.x,l.y,l.radius)&&(!o||o(n))&&!ae(u,n.overlapMode))return a.push(!0),!0}}}_forEachCell(e,t,i,n,r,a,s,o){const l=this._convertToXCellCoord(e),c=this._convertToYCellCoord(t),u=this._convertToXCellCoord(i),h=this._convertToYCellCoord(n);for(let d=l;d<=u;d++)for(let l=c;l<=h;l++)if(r.call(this,e,t,i,n,this.xCellCount*l+d,a,s,o))return}_convertToXCellCoord(e){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(e*this.xScale)))}_convertToYCellCoord(e){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(e*this.yScale)))}_circlesCollide(e,t,i,n,r,a){const s=n-e,o=r-t,l=i+a;return l*l>s*s+o*o}_circleAndRectCollide(e,t,i,n,r,a,s){const o=(a-n)/2,l=Math.abs(e-(n+o));if(l>o+i)return!1;const c=(s-r)/2,u=Math.abs(t-(r+c));if(u>c+i)return!1;if(l<=o||u<=c)return!0;const h=l-o,d=u-c;return h*h+d*d<=i*i}}function oe(t,i,n,r,a){const s=e.Z();return i?(e.a0(s,s,[1/a,1/a,1]),n||e.ae(s,s,r.angle)):e.a1(s,r.labelPlaneMatrix,t),s}function le(t,i,n,r,a){if(i){const i=e.af(t);return e.a0(i,i,[a,a,1]),n||e.ae(i,i,-r.angle),i}return r.glCoordMatrix}function ce(t,i,n){let r;n?(r=[t.x,t.y,n(t.x,t.y),1],e.ag(r,r,i)):(r=[t.x,t.y,0,1],Se(r,r,i));const a=r[3];return{point:new e.P(r[0]/a,r[1]/a),signedDistanceFromCamera:a}}function ue(e,t){return.5+e/t*.5}function he(e,t){const i=e[0]/e[3],n=e[1]/e[3];return i>=-t[0]&&i<=t[0]&&n>=-t[1]&&n<=t[1]}function de(t,i,n,r,a,s,o,l,c,u){const h=r?t.textSizeData:t.iconSizeData,d=e.ah(h,n.transform.zoom),p=[256/n.width*2+1,256/n.height*2+1],f=r?t.text.dynamicLayoutVertexArray:t.icon.dynamicLayoutVertexArray;f.clear();const m=t.lineVertexArray,g=r?t.text.placedSymbolArray:t.icon.placedSymbolArray,y=n.transform.width/n.transform.height;let _=!1;for(let v=0;v<g.length;v++){const r=g.get(v);if(r.hidden||r.writingMode===e.ai.vertical&&!_){we(r.numGlyphs,f);continue}let x;if(_=!1,u?(x=[r.anchorX,r.anchorY,u(r.anchorX,r.anchorY),1],e.ag(x,x,i)):(x=[r.anchorX,r.anchorY,0,1],Se(x,x,i)),!he(x,p)){we(r.numGlyphs,f);continue}const b=ue(n.transform.cameraToCenterDistance,x[3]),w=e.aj(h,d,r),S=o?w/b:w*b,T=new e.P(r.anchorX,r.anchorY),k=ce(T,a,u).point,E={projections:{},offsets:{}},P=me(r,S,!1,l,i,a,s,t.glyphOffsetArray,m,f,k,T,E,y,c,u);_=P.useVertical,(P.notEnoughRoom||_||P.needsFlipping&&me(r,S,!0,l,i,a,s,t.glyphOffsetArray,m,f,k,T,E,y,c,u).notEnoughRoom)&&we(r.numGlyphs,f)}r?t.text.dynamicLayoutVertexBuffer.updateData(f):t.icon.dynamicLayoutVertexBuffer.updateData(f)}function pe(e,t,i,n,r,a,s,o,l,c,u,h,d){const p=o.glyphStartIndex+o.numGlyphs,f=o.lineStartIndex,m=o.lineStartIndex+o.lineLength,g=t.getoffsetX(o.glyphStartIndex),y=t.getoffsetX(p-1),_=xe(e*g,i,n,r,a,s,o.segment,f,m,l,c,u,h,d);if(!_)return null;const v=xe(e*y,i,n,r,a,s,o.segment,f,m,l,c,u,h,d);return v?{first:_,last:v}:null}function fe(t,i,n,r){return t===e.ai.horizontal&&Math.abs(n.y-i.y)>Math.abs(n.x-i.x)*r?{useVertical:!0}:(t===e.ai.vertical?i.y<n.y:i.x>n.x)?{needsFlipping:!0}:null}function me(t,i,n,r,a,s,o,l,c,u,h,d,p,f,m,g){const y=i/24,_=t.lineOffsetX*y,v=t.lineOffsetY*y;let x;if(t.numGlyphs>1){const e=t.glyphStartIndex+t.numGlyphs,i=t.lineStartIndex,a=t.lineStartIndex+t.lineLength,u=pe(y,l,_,v,n,h,d,t,c,s,p,m,g);if(!u)return{notEnoughRoom:!0};const b=ce(u.first.point,o,g).point,w=ce(u.last.point,o,g).point;if(r&&!n){const e=fe(t.writingMode,b,w,f);if(e)return e}x=[u.first];for(let r=t.glyphStartIndex+1;r<e-1;r++)x.push(xe(y*l.getoffsetX(r),_,v,n,h,d,t.segment,i,a,c,s,p,m,g));x.push(u.last)}else{if(r&&!n){const i=ce(d,a,g).point,n=t.lineStartIndex+t.segment+1,r=new e.P(c.getx(n),c.gety(n)),s=ce(r,a,g),o=s.signedDistanceFromCamera>0?s.point:ge(d,r,i,1,a,g),l=fe(t.writingMode,i,o,f);if(l)return l}const i=xe(y*l.getoffsetX(t.glyphStartIndex),_,v,n,h,d,t.segment,t.lineStartIndex,t.lineStartIndex+t.lineLength,c,s,p,m,g);if(!i)return{notEnoughRoom:!0};x=[i]}for(const b of x)e.ak(u,b.point,b.angle);return{}}function ge(e,t,i,n,r,a){const s=ce(e.add(e.sub(t)._unit()),r,a).point,o=i.sub(s);return i.add(o._mult(n/o.mag()))}function ye(t,i){const{projectionCache:n,lineVertexArray:r,labelPlaneMatrix:a,tileAnchorPoint:s,distanceFromAnchor:o,getElevation:l,previousVertex:c,direction:u,absOffsetX:h}=i;if(n.projections[t])return n.projections[t];const d=new e.P(r.getx(t),r.gety(t)),p=ce(d,a,l);if(p.signedDistanceFromCamera>0)return n.projections[t]=p.point,p.point;const f=t-u;return ge(0===o?s:new e.P(r.getx(f),r.gety(f)),d,c,h-o+1,a,l)}function _e(e,t,i){return e._unit()._perp()._mult(t*i)}function ve(t,i,n,r,a,s,o,l){const{projectionCache:c,direction:u}=l;if(c.offsets[t])return c.offsets[t];const h=n.add(i);if(t+u<r||t+u>=a)return c.offsets[t]=h,h;const d=ye(t+u,l),p=_e(d.sub(n),o,u),f=n.add(p),m=d.add(p);return c.offsets[t]=e.al(s,h,f,m)||h,c.offsets[t]}function xe(e,t,i,n,r,a,s,o,l,c,u,h,d,p){const f=n?e-t:e+t;let m=f>0?1:-1,g=0;n&&(m*=-1,g=Math.PI),m<0&&(g+=Math.PI);let y,_,v=m>0?o+s:o+s+1,x=r,b=r,w=0,S=0;const T=Math.abs(f),k=[];let E;for(;w+S<=T;){if(v+=m,v<o||v>=l)return null;w+=S,b=x,_=y;const e={projectionCache:h,lineVertexArray:c,labelPlaneMatrix:u,tileAnchorPoint:a,distanceFromAnchor:w,getElevation:p,previousVertex:b,direction:m,absOffsetX:T};if(x=ye(v,e),0===i)k.push(b),E=x.sub(b);else{let t;const n=x.sub(b);t=0===n.mag()?_e(ye(v+m,e).sub(x),i,m):_e(n,i,m),_||(_=b.add(t)),y=ve(v,t,x,o,l,_,i,e),k.push(_),E=y.sub(_)}S=E.mag()}const P=E._mult((T-w)/S)._add(_||b),C=g+Math.atan2(x.y-b.y,x.x-b.x);return k.push(P),{point:P,angle:d?C:0,path:k}}const be=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function we(e,t){for(let i=0;i<e;i++){const e=t.length;t.resize(e+4),t.float32.set(be,3*e)}}function Se(e,t,i){const n=t[0],r=t[1];return e[0]=i[0]*n+i[4]*r+i[12],e[1]=i[1]*n+i[5]*r+i[13],e[3]=i[3]*n+i[7]*r+i[15],e}const Te=100;class ke{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new se(e.width+200,e.height+200,25),i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new se(e.width+200,e.height+200,25);this.transform=e,this.grid=t,this.ignoredGrid=i,this.pitchfactor=Math.cos(e._pitch)*e.cameraToCenterDistance,this.screenRightBoundary=e.width+Te,this.screenBottomBoundary=e.height+Te,this.gridRightBoundary=e.width+200,this.gridBottomBoundary=e.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(e,t,i,n,r,a){const s=this.projectAndGetPerspectiveRatio(n,e.anchorPointX,e.anchorPointY,a),o=i*s.perspectiveRatio,l=e.x1*o+s.point.x,c=e.y1*o+s.point.y,u=e.x2*o+s.point.x,h=e.y2*o+s.point.y;return!this.isInsideGrid(l,c,u,h)||"always"!==t&&this.grid.hitTest(l,c,u,h,t,r)||s.perspectiveRatio<this.perspectiveRatioCutoff?{box:[],offscreen:!1}:{box:[l,c,u,h],offscreen:this.isOffscreen(l,c,u,h)}}placeCollisionCircles(t,i,n,r,a,s,o,l,c,u,h,d,p,f){const m=[],g=new e.P(i.anchorX,i.anchorY),y=ce(g,s,f),_=ue(this.transform.cameraToCenterDistance,y.signedDistanceFromCamera),v=(u?a/_:a*_)/e.ap,x=ce(g,o,f).point,b=pe(v,r,i.lineOffsetX*v,i.lineOffsetY*v,!1,x,g,i,n,o,{projections:{},offsets:{}},!1,f);let w=!1,S=!1,T=!0;if(b){const i=.5*d*_+p,n=new e.P(-100,-100),r=new e.P(this.screenRightBoundary,this.screenBottomBoundary),a=new re,s=b.first,o=b.last;let u=[];for(let e=s.path.length-1;e>=1;e--)u.push(s.path[e]);for(let e=1;e<o.path.length;e++)u.push(o.path[e]);const g=2.5*i;if(l){const e=u.map((e=>ce(e,l,f)));u=e.some((e=>e.signedDistanceFromCamera<=0))?[]:e.map((e=>e.point))}let y=[];if(u.length>0){const t=u[0].clone(),i=u[0].clone();for(let e=1;e<u.length;e++)t.x=Math.min(t.x,u[e].x),t.y=Math.min(t.y,u[e].y),i.x=Math.max(i.x,u[e].x),i.y=Math.max(i.y,u[e].y);y=t.x>=n.x&&i.x<=r.x&&t.y>=n.y&&i.y<=r.y?[u]:i.x<n.x||t.x>r.x||i.y<n.y||t.y>r.y?[]:e.am([u],n.x,n.y,r.x,r.y)}for(const e of y){a.reset(e,.25*i);let n=0;n=a.length<=.5*i?1:Math.ceil(a.paddedLength/g)+1;for(let e=0;e<n;e++){const r=e/Math.max(n-1,1),s=a.lerp(r),o=s.x+Te,l=s.y+Te;m.push(o,l,i,0);const u=o-i,d=l-i,p=o+i,f=l+i;if(T=T&&this.isOffscreen(u,d,p,f),S=S||this.isInsideGrid(u,d,p,f),"always"!==t&&this.grid.hitTestCircle(o,l,i,t,h)&&(w=!0,!c))return{circles:[],offscreen:!1,collisionDetected:w}}}}return{circles:!c&&w||!S||_<this.perspectiveRatioCutoff?[]:m,offscreen:T,collisionDetected:w}}queryRenderedSymbols(t){if(0===t.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};const i=[];let n=1/0,r=1/0,a=-1/0,s=-1/0;for(const u of t){const t=new e.P(u.x+Te,u.y+Te);n=Math.min(n,t.x),r=Math.min(r,t.y),a=Math.max(a,t.x),s=Math.max(s,t.y),i.push(t)}const o=this.grid.query(n,r,a,s).concat(this.ignoredGrid.query(n,r,a,s)),l={},c={};for(const u of o){const t=u.key;if(void 0===l[t.bucketInstanceId]&&(l[t.bucketInstanceId]={}),l[t.bucketInstanceId][t.featureIndex])continue;const n=[new e.P(u.x1,u.y1),new e.P(u.x2,u.y1),new e.P(u.x2,u.y2),new e.P(u.x1,u.y2)];e.an(i,n)&&(l[t.bucketInstanceId][t.featureIndex]=!0,void 0===c[t.bucketInstanceId]&&(c[t.bucketInstanceId]=[]),c[t.bucketInstanceId].push(t.featureIndex))}return c}insertCollisionBox(e,t,i,n,r,a){(i?this.ignoredGrid:this.grid).insert({bucketInstanceId:n,featureIndex:r,collisionGroupID:a,overlapMode:t},e[0],e[1],e[2],e[3])}insertCollisionCircles(e,t,i,n,r,a){const s=i?this.ignoredGrid:this.grid,o={bucketInstanceId:n,featureIndex:r,collisionGroupID:a,overlapMode:t};for(let l=0;l<e.length;l+=4)s.insertCircle(o,e[l],e[l+1],e[l+2])}projectAndGetPerspectiveRatio(t,i,n,r){let a;return r?(a=[i,n,r(i,n),1],e.ag(a,a,t)):(a=[i,n,0,1],Se(a,a,t)),{point:new e.P((a[0]/a[3]+1)/2*this.transform.width+Te,(-a[1]/a[3]+1)/2*this.transform.height+Te),perspectiveRatio:.5+this.transform.cameraToCenterDistance/a[3]*.5}}isOffscreen(e,t,i,n){return i<Te||e>=this.screenRightBoundary||n<Te||t>this.screenBottomBoundary}isInsideGrid(e,t,i,n){return i>=0&&e<this.gridRightBoundary&&n>=0&&t<this.gridBottomBoundary}getViewportMatrix(){const t=e.ao([]);return e.$(t,t,[-100,-100,0]),t}}function Ee(t,i,n){return i*(e.N/(t.tileSize*Math.pow(2,n-t.tileID.overscaledZ)))}class Pe{constructor(e,t,i,n){this.opacity=e?Math.max(0,Math.min(1,e.opacity+(e.placed?t:-t))):n&&i?1:0,this.placed=i}isHidden(){return 0===this.opacity&&!this.placed}}class Ce{constructor(e,t,i,n,r){this.text=new Pe(e?e.text:null,t,i,r),this.icon=new Pe(e?e.icon:null,t,n,r)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Ie{constructor(e,t,i){this.text=e,this.icon=t,this.skipFade=i}}class Ae{constructor(){this.invProjMatrix=e.Z(),this.viewportMatrix=e.Z(),this.circles=[]}}class Me{constructor(e,t,i,n,r){this.bucketInstanceId=e,this.featureIndex=t,this.sourceLayerIndex=i,this.bucketIndex=n,this.tileID=r}}class ze{constructor(e){this.crossSourceCollisions=e,this.maxGroupID=0,this.collisionGroups={}}get(e){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[e]){const t=++this.maxGroupID;this.collisionGroups[e]={ID:t,predicate:e=>e.collisionGroupID===t}}return this.collisionGroups[e]}}function De(t,i,n,r,a){const{horizontalAlign:s,verticalAlign:o}=e.au(t);return new e.P(-(s-.5)*i+r[0]*a,-(o-.5)*n+r[1]*a)}function Le(t,i,n,r,a,s){const{x1:o,x2:l,y1:c,y2:u,anchorPointX:h,anchorPointY:d}=t,p=new e.P(i,n);return r&&p._rotate(a?s:-s),{x1:o+p.x,y1:c+p.y,x2:l+p.x,y2:u+p.y,anchorPointX:h,anchorPointY:d}}class Re{constructor(e,t,i,n,r){this.transform=e.clone(),this.terrain=t,this.collisionIndex=new ke(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=i,this.retainedQueryData={},this.collisionGroups=new ze(n),this.collisionCircleArrays={},this.prevPlacement=r,r&&(r.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(t,i,n,r){const a=n.getBucket(i),s=n.latestFeatureIndex;if(!a||!s||i.id!==a.layerIds[0])return;const o=n.collisionBoxArray,l=a.layers[0].layout,c=Math.pow(2,this.transform.zoom-n.tileID.overscaledZ),u=n.tileSize/e.N,h=this.transform.calculatePosMatrix(n.tileID.toUnwrapped()),d="map"===l.get("text-pitch-alignment"),p="map"===l.get("text-rotation-alignment"),f=Ee(n,1,this.transform.zoom),m=oe(h,d,p,this.transform,f);let g=null;if(d){const t=le(h,d,p,this.transform,f);g=e.a1([],this.transform.labelPlaneMatrix,t)}this.retainedQueryData[a.bucketInstanceId]=new Me(a.bucketInstanceId,s,a.sourceLayerIndex,a.index,n.tileID);const y={bucket:a,layout:l,posMatrix:h,textLabelPlaneMatrix:m,labelToScreenMatrix:g,scale:c,textPixelRatio:u,holdingForFade:n.holdingForFade(),collisionBoxArray:o,partiallyEvaluatedTextSize:e.ah(a.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(a.sourceID)};if(r)for(const e of a.sortKeyRanges){const{sortKey:i,symbolInstanceStart:n,symbolInstanceEnd:r}=e;t.push({sortKey:i,symbolInstanceStart:n,symbolInstanceEnd:r,parameters:y})}else t.push({symbolInstanceStart:0,symbolInstanceEnd:a.symbolInstances.length,parameters:y})}attemptAnchorPlacement(t,i,n,r,a,s,o,l,c,u,h,d,p,f,m,g){const y=e.aq[t.textAnchor],_=[t.textOffset0,t.textOffset1],v=De(y,n,r,_,a),x=this.collisionIndex.placeCollisionBox(Le(i,v.x,v.y,s,o,this.transform.angle),h,l,c,u.predicate,g);if((!m||0!==this.collisionIndex.placeCollisionBox(Le(m,v.x,v.y,s,o,this.transform.angle),h,l,c,u.predicate,g).box.length)&&x.box.length>0){let e;if(this.prevPlacement&&this.prevPlacement.variableOffsets[d.crossTileID]&&this.prevPlacement.placements[d.crossTileID]&&this.prevPlacement.placements[d.crossTileID].text&&(e=this.prevPlacement.variableOffsets[d.crossTileID].anchor),0===d.crossTileID)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[d.crossTileID]={textOffset:_,width:n,height:r,anchor:y,textBoxScale:a,prevAnchor:e},this.markUsedJustification(p,y,d,f),p.allowVerticalPlacement&&(this.markUsedOrientation(p,f,d),this.placedOrientations[d.crossTileID]=f),{shift:v,placedGlyphBoxes:x}}}placeLayerBucketPart(t,i,n){const{bucket:r,layout:a,posMatrix:s,textLabelPlaneMatrix:o,labelToScreenMatrix:l,textPixelRatio:c,holdingForFade:u,collisionBoxArray:h,partiallyEvaluatedTextSize:d,collisionGroup:p}=t.parameters,f=a.get("text-optional"),m=a.get("icon-optional"),g=e.ar(a,"text-overlap","text-allow-overlap"),y="always"===g,_=e.ar(a,"icon-overlap","icon-allow-overlap"),v="always"===_,x="map"===a.get("text-rotation-alignment"),b="map"===a.get("text-pitch-alignment"),w="none"!==a.get("icon-text-fit"),S="viewport-y"===a.get("symbol-z-order"),T=y&&(v||!r.hasIconData()||m),k=v&&(y||!r.hasTextData()||f);!r.collisionArrays&&h&&r.deserializeCollisionBoxes(h);const E=this.retainedQueryData[r.bucketInstanceId].tileID,P=this.terrain?(e,t)=>this.terrain.getElevation(E,e,t):null,C=(t,h)=>{var v,S;if(i[t.crossTileID])return;if(u)return void(this.placements[t.crossTileID]=new Ie(!1,!1,!1));let E=!1,C=!1,I=!0,A=null,M={box:null,offscreen:null},z={box:null,offscreen:null},D=null,L=null,R=null,F=0,B=0,O=0;h.textFeatureIndex?F=h.textFeatureIndex:t.useRuntimeCollisionCircles&&(F=t.featureIndex),h.verticalTextFeatureIndex&&(B=h.verticalTextFeatureIndex);const N=h.textBox;if(N){const i=i=>{let n=e.ai.horizontal;if(r.allowVerticalPlacement&&!i&&this.prevPlacement){const e=this.prevPlacement.placedOrientations[t.crossTileID];e&&(this.placedOrientations[t.crossTileID]=e,n=e,this.markUsedOrientation(r,n,t))}return n},n=(i,n)=>{if(r.allowVerticalPlacement&&t.numVerticalGlyphVertices>0&&h.verticalTextBox){for(const t of r.writingModes)if(t===e.ai.vertical?(M=n(),z=M):M=i(),M&&M.box&&M.box.length)break}else M=i()},a=t.textAnchorOffsetStartIndex,o=t.textAnchorOffsetEndIndex;if(o===a){const a=(e,i)=>{const n=this.collisionIndex.placeCollisionBox(e,g,c,s,p.predicate,P);return n&&n.box&&n.box.length&&(this.markUsedOrientation(r,i,t),this.placedOrientations[t.crossTileID]=i),n};n((()=>a(N,e.ai.horizontal)),(()=>{const i=h.verticalTextBox;return r.allowVerticalPlacement&&t.numVerticalGlyphVertices>0&&i?a(i,e.ai.vertical):{box:null,offscreen:null}})),i(M&&M.box&&M.box.length)}else{let l=e.aq[null===(S=null===(v=this.prevPlacement)||void 0===v?void 0:v.variableOffsets[t.crossTileID])||void 0===S?void 0:S.anchor];const u=(e,i,n)=>{const u=e.x2-e.x1,h=e.y2-e.y1,d=t.textBoxScale,f=w&&"never"===_?i:null;let m={box:[],offscreen:!1},y="never"===g?1:2,v="never";l&&y++;for(let _=0;_<y;_++){for(let i=a;i<o;i++){const a=r.textAnchorOffsets.get(i);if(l&&a.textAnchor!==l)continue;const o=this.attemptAnchorPlacement(a,e,u,h,d,x,b,c,s,p,v,t,r,n,f,P);if(o&&(m=o.placedGlyphBoxes,m&&m.box&&m.box.length))return E=!0,A=o.shift,m}l?l=null:v=g}return m};n((()=>u(N,h.iconBox,e.ai.horizontal)),(()=>{const i=h.verticalTextBox;return r.allowVerticalPlacement&&!(M&&M.box&&M.box.length)&&t.numVerticalGlyphVertices>0&&i?u(i,h.verticalIconBox,e.ai.vertical):{box:null,offscreen:null}})),M&&(E=M.box,I=M.offscreen);const d=i(M&&M.box);if(!E&&this.prevPlacement){const e=this.prevPlacement.variableOffsets[t.crossTileID];e&&(this.variableOffsets[t.crossTileID]=e,this.markUsedJustification(r,e.anchor,t,d))}}}if(D=M,E=D&&D.box&&D.box.length>0,I=D&&D.offscreen,t.useRuntimeCollisionCircles){const i=r.text.placedSymbolArray.get(t.centerJustifiedTextSymbolIndex),c=e.aj(r.textSizeData,d,i),u=a.get("text-padding");L=this.collisionIndex.placeCollisionCircles(g,i,r.lineVertexArray,r.glyphOffsetArray,c,s,o,l,n,b,p.predicate,t.collisionCircleDiameter,u,P),L.circles.length&&L.collisionDetected&&!n&&e.w("Collisions detected, but collision boxes are not shown"),E=y||L.circles.length>0&&!L.collisionDetected,I=I&&L.offscreen}if(h.iconFeatureIndex&&(O=h.iconFeatureIndex),h.iconBox){const e=e=>{const t=w&&A?Le(e,A.x,A.y,x,b,this.transform.angle):e;return this.collisionIndex.placeCollisionBox(t,_,c,s,p.predicate,P)};z&&z.box&&z.box.length&&h.verticalIconBox?(R=e(h.verticalIconBox),C=R.box.length>0):(R=e(h.iconBox),C=R.box.length>0),I=I&&R.offscreen}const V=f||0===t.numHorizontalGlyphVertices&&0===t.numVerticalGlyphVertices,j=m||0===t.numIconVertices;if(V||j?j?V||(C=C&&E):E=C&&E:C=E=C&&E,E&&D&&D.box&&this.collisionIndex.insertCollisionBox(D.box,g,a.get("text-ignore-placement"),r.bucketInstanceId,z&&z.box&&B?B:F,p.ID),C&&R&&this.collisionIndex.insertCollisionBox(R.box,_,a.get("icon-ignore-placement"),r.bucketInstanceId,O,p.ID),L&&(E&&this.collisionIndex.insertCollisionCircles(L.circles,g,a.get("text-ignore-placement"),r.bucketInstanceId,F,p.ID),n)){const e=r.bucketInstanceId;let t=this.collisionCircleArrays[e];void 0===t&&(t=this.collisionCircleArrays[e]=new Ae);for(let i=0;i<L.circles.length;i+=4)t.circles.push(L.circles[i+0]),t.circles.push(L.circles[i+1]),t.circles.push(L.circles[i+2]),t.circles.push(L.collisionDetected?1:0)}if(0===t.crossTileID)throw new Error("symbolInstance.crossTileID can't be 0");if(0===r.bucketInstanceId)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[t.crossTileID]=new Ie(E||T,C||k,I||r.justReloaded),i[t.crossTileID]=!0};if(S){if(0!==t.symbolInstanceStart)throw new Error("bucket.bucketInstanceId should be 0");const e=r.getSortedSymbolIndexes(this.transform.angle);for(let t=e.length-1;t>=0;--t){const i=e[t];C(r.symbolInstances.get(i),r.collisionArrays[i])}}else for(let e=t.symbolInstanceStart;e<t.symbolInstanceEnd;e++)C(r.symbolInstances.get(e),r.collisionArrays[e]);if(n&&r.bucketInstanceId in this.collisionCircleArrays){const t=this.collisionCircleArrays[r.bucketInstanceId];e.as(t.invProjMatrix,s),t.viewportMatrix=this.collisionIndex.getViewportMatrix()}r.justReloaded=!1}markUsedJustification(t,i,n,r){let a;a=r===e.ai.vertical?n.verticalPlacedTextSymbolIndex:{left:n.leftJustifiedTextSymbolIndex,center:n.centerJustifiedTextSymbolIndex,right:n.rightJustifiedTextSymbolIndex}[e.at(i)];const s=[n.leftJustifiedTextSymbolIndex,n.centerJustifiedTextSymbolIndex,n.rightJustifiedTextSymbolIndex,n.verticalPlacedTextSymbolIndex];for(const e of s)e>=0&&(t.text.placedSymbolArray.get(e).crossTileID=a>=0&&e!==a?0:n.crossTileID)}markUsedOrientation(t,i,n){const r=i===e.ai.horizontal||i===e.ai.horizontalOnly?i:0,a=i===e.ai.vertical?i:0,s=[n.leftJustifiedTextSymbolIndex,n.centerJustifiedTextSymbolIndex,n.rightJustifiedTextSymbolIndex];for(const e of s)t.text.placedSymbolArray.get(e).placedOrientation=r;n.verticalPlacedTextSymbolIndex&&(t.text.placedSymbolArray.get(n.verticalPlacedTextSymbolIndex).placedOrientation=a)}commit(e){this.commitTime=e,this.zoomAtLastRecencyCheck=this.transform.zoom;const t=this.prevPlacement;let i=!1;this.prevZoomAdjustment=t?t.zoomAdjustment(this.transform.zoom):0;const n=t?t.symbolFadeChange(e):1,r=t?t.opacities:{},a=t?t.variableOffsets:{},s=t?t.placedOrientations:{};for(const o in this.placements){const e=this.placements[o],t=r[o];t?(this.opacities[o]=new Ce(t,n,e.text,e.icon),i=i||e.text!==t.text.placed||e.icon!==t.icon.placed):(this.opacities[o]=new Ce(null,n,e.text,e.icon,e.skipFade),i=i||e.text||e.icon)}for(const o in r){const e=r[o];if(!this.opacities[o]){const t=new Ce(e,n,!1,!1);t.isHidden()||(this.opacities[o]=t,i=i||e.text.placed||e.icon.placed)}}for(const o in a)this.variableOffsets[o]||!this.opacities[o]||this.opacities[o].isHidden()||(this.variableOffsets[o]=a[o]);for(const o in s)this.placedOrientations[o]||!this.opacities[o]||this.opacities[o].isHidden()||(this.placedOrientations[o]=s[o]);if(t&&void 0===t.lastPlacementChangeTime)throw new Error("Last placement time for previous placement is not defined");i?this.lastPlacementChangeTime=e:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=t?t.lastPlacementChangeTime:e)}updateLayerOpacities(e,t){const i={};for(const n of t){const t=n.getBucket(e);t&&n.latestFeatureIndex&&e.id===t.layerIds[0]&&this.updateBucketOpacities(t,i,n.collisionBoxArray)}}updateBucketOpacities(t,i,n){t.hasTextData()&&(t.text.opacityVertexArray.clear(),t.text.hasVisibleVertices=!1),t.hasIconData()&&(t.icon.opacityVertexArray.clear(),t.icon.hasVisibleVertices=!1),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexArray.clear(),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexArray.clear();const r=t.layers[0],a=r.layout,s=new Ce(null,0,!1,!1,!0),o=a.get("text-allow-overlap"),l=a.get("icon-allow-overlap"),c=r._unevaluatedLayout.hasValue("text-variable-anchor")||r._unevaluatedLayout.hasValue("text-variable-anchor-offset"),u="map"===a.get("text-rotation-alignment"),h="map"===a.get("text-pitch-alignment"),d="none"!==a.get("icon-text-fit"),p=new Ce(null,0,o&&(l||!t.hasIconData()||a.get("icon-optional")),l&&(o||!t.hasTextData()||a.get("text-optional")),!0);!t.collisionArrays&&n&&(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData())&&t.deserializeCollisionBoxes(n);const f=(e,t,i)=>{for(let n=0;n<t/4;n++)e.opacityVertexArray.emplaceBack(i);e.hasVisibleVertices=e.hasVisibleVertices||i!==Ze};for(let m=0;m<t.symbolInstances.length;m++){const n=t.symbolInstances.get(m),{numHorizontalGlyphVertices:r,numVerticalGlyphVertices:a,crossTileID:o}=n;let l=this.opacities[o];i[o]?l=s:l||(l=p,this.opacities[o]=l),i[o]=!0;const g=n.numIconVertices>0,y=this.placedOrientations[n.crossTileID],_=y===e.ai.vertical,v=y===e.ai.horizontal||y===e.ai.horizontalOnly;if(r>0||a>0){const e=qe(l.text);f(t.text,r,_?Ze:e),f(t.text,a,v?Ze:e);const i=l.text.isHidden();[n.rightJustifiedTextSymbolIndex,n.centerJustifiedTextSymbolIndex,n.leftJustifiedTextSymbolIndex].forEach((e=>{e>=0&&(t.text.placedSymbolArray.get(e).hidden=i||_?1:0)})),n.verticalPlacedTextSymbolIndex>=0&&(t.text.placedSymbolArray.get(n.verticalPlacedTextSymbolIndex).hidden=i||v?1:0);const s=this.variableOffsets[n.crossTileID];s&&this.markUsedJustification(t,s.anchor,n,y);const o=this.placedOrientations[n.crossTileID];o&&(this.markUsedJustification(t,"left",n,o),this.markUsedOrientation(t,o,n))}if(g){const e=qe(l.icon),i=!(d&&n.verticalPlacedIconSymbolIndex&&_);n.placedIconSymbolIndex>=0&&(f(t.icon,n.numIconVertices,i?e:Ze),t.icon.placedSymbolArray.get(n.placedIconSymbolIndex).hidden=l.icon.isHidden()),n.verticalPlacedIconSymbolIndex>=0&&(f(t.icon,n.numVerticalIconVertices,i?Ze:e),t.icon.placedSymbolArray.get(n.verticalPlacedIconSymbolIndex).hidden=l.icon.isHidden())}if(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData()){const i=t.collisionArrays[m];if(i){let n=new e.P(0,0);if(i.textBox||i.verticalTextBox){let e=!0;if(c){const t=this.variableOffsets[o];t?(n=De(t.anchor,t.width,t.height,t.textOffset,t.textBoxScale),u&&n._rotate(h?this.transform.angle:-this.transform.angle)):e=!1}i.textBox&&Fe(t.textCollisionBox.collisionVertexArray,l.text.placed,!e||_,n.x,n.y),i.verticalTextBox&&Fe(t.textCollisionBox.collisionVertexArray,l.text.placed,!e||v,n.x,n.y)}const r=Boolean(!v&&i.verticalIconBox);i.iconBox&&Fe(t.iconCollisionBox.collisionVertexArray,l.icon.placed,r,d?n.x:0,d?n.y:0),i.verticalIconBox&&Fe(t.iconCollisionBox.collisionVertexArray,l.icon.placed,!r,d?n.x:0,d?n.y:0)}}}if(t.sortFeatures(this.transform.angle),this.retainedQueryData[t.bucketInstanceId]&&(this.retainedQueryData[t.bucketInstanceId].featureSortOrder=t.featureSortOrder),t.hasTextData()&&t.text.opacityVertexBuffer&&t.text.opacityVertexBuffer.updateData(t.text.opacityVertexArray),t.hasIconData()&&t.icon.opacityVertexBuffer&&t.icon.opacityVertexBuffer.updateData(t.icon.opacityVertexArray),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexBuffer&&t.iconCollisionBox.collisionVertexBuffer.updateData(t.iconCollisionBox.collisionVertexArray),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexBuffer&&t.textCollisionBox.collisionVertexBuffer.updateData(t.textCollisionBox.collisionVertexArray),t.text.opacityVertexArray.length!==t.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${t.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${t.text.layoutVertexArray.length}) / 4`);if(t.icon.opacityVertexArray.length!==t.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${t.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${t.icon.layoutVertexArray.length}) / 4`);if(t.bucketInstanceId in this.collisionCircleArrays){const e=this.collisionCircleArrays[t.bucketInstanceId];t.placementInvProjMatrix=e.invProjMatrix,t.placementViewportMatrix=e.viewportMatrix,t.collisionCircleArray=e.circles,delete this.collisionCircleArrays[t.bucketInstanceId]}}symbolFadeChange(e){return 0===this.fadeDuration?1:(e-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(e){return Math.max(0,(this.transform.zoom-e)/1.5)}hasTransitions(e){return this.stale||e-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(e,t){const i=this.zoomAtLastRecencyCheck===t?1-this.zoomAdjustment(t):1;return this.zoomAtLastRecencyCheck=t,this.commitTime+this.fadeDuration*i>e}setStale(){this.stale=!0}}function Fe(e,t,i,n,r){e.emplaceBack(t?1:0,i?1:0,n||0,r||0),e.emplaceBack(t?1:0,i?1:0,n||0,r||0),e.emplaceBack(t?1:0,i?1:0,n||0,r||0),e.emplaceBack(t?1:0,i?1:0,n||0,r||0)}const Be=Math.pow(2,25),Oe=Math.pow(2,24),Ne=Math.pow(2,17),Ve=Math.pow(2,16),je=Math.pow(2,9),Ue=Math.pow(2,8),$e=Math.pow(2,1);function qe(e){if(0===e.opacity&&!e.placed)return 0;if(1===e.opacity&&e.placed)return 4294967295;const t=e.placed?1:0,i=Math.floor(127*e.opacity);return i*Be+t*Oe+i*Ne+t*Ve+i*je+t*Ue+i*$e+t}const Ze=0;class Ge{constructor(e){this._sortAcrossTiles="viewport-y"!==e.layout.get("symbol-z-order")&&!e.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(e,t,i,n,r){const a=this._bucketParts;for(;this._currentTileIndex<e.length;)if(t.getBucketParts(a,n,e[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,r())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,a.sort(((e,t)=>e.sortKey-t.sortKey)));this._currentPartIndex<a.length;)if(t.placeLayerBucketPart(a[this._currentPartIndex],this._seenCrossTileIDs,i),this._currentPartIndex++,r())return!0;return!1}}class We{constructor(e,t,i,n,r,a,s,o){this.placement=new Re(e,t,a,s,o),this._currentPlacementIndex=i.length-1,this._forceFullPlacement=n,this._showCollisionBoxes=r,this._done=!1}isDone(){return this._done}continuePlacement(t,i,n){const r=e.h.now(),a=()=>!this._forceFullPlacement&&e.h.now()-r>2;for(;this._currentPlacementIndex>=0;){const e=i[t[this._currentPlacementIndex]],r=this.placement.collisionIndex.transform.zoom;if("symbol"===e.type&&(!e.minzoom||e.minzoom<=r)&&(!e.maxzoom||e.maxzoom>r)){if(this._inProgressLayer||(this._inProgressLayer=new Ge(e)),this._inProgressLayer.continuePlacement(n[e.source],this.placement,this._showCollisionBoxes,e,a))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(e){return this.placement.commit(e),this.placement}}const He=512/e.N/2;class Xe{constructor(t,i,n){this.tileID=t,this.bucketInstanceId=n,this._symbolsByKey={};const r=new Map;for(let e=0;e<i.length;e++){const t=i.get(e),n=t.key,a=r.get(n);a?a.push(t):r.set(n,[t])}for(const[a,s]of r){const t={positions:s.map((e=>({x:Math.floor(e.anchorX*He),y:Math.floor(e.anchorY*He)}))),crossTileIDs:s.map((e=>e.crossTileID))};if(t.positions.length>128){const i=new e.av(t.positions.length,16,Uint16Array);for(const{x:e,y:n}of t.positions)i.add(e,n);i.finish(),delete t.positions,t.index=i}this._symbolsByKey[a]=t}}getScaledCoordinates(t,i){const{x:n,y:r,z:a}=this.tileID.canonical,{x:s,y:o,z:l}=i.canonical,c=He/Math.pow(2,l-a),u=(o*e.N+t.anchorY)*c,h=r*e.N*He;return{x:Math.floor((s*e.N+t.anchorX)*c-n*e.N*He),y:Math.floor(u-h)}}findMatches(e,t,i){const n=this.tileID.canonical.z<t.canonical.z?1:Math.pow(2,this.tileID.canonical.z-t.canonical.z);for(let r=0;r<e.length;r++){const a=e.get(r);if(a.crossTileID)continue;const s=this._symbolsByKey[a.key];if(!s)continue;const o=this.getScaledCoordinates(a,t);if(s.index){const e=s.index.range(o.x-n,o.y-n,o.x+n,o.y+n).sort();for(const t of e){const e=s.crossTileIDs[t];if(!i[e]){i[e]=!0,a.crossTileID=e;break}}}else if(s.positions)for(let e=0;e<s.positions.length;e++){const t=s.positions[e],r=s.crossTileIDs[e];if(Math.abs(t.x-o.x)<=n&&Math.abs(t.y-o.y)<=n&&!i[r]){i[r]=!0,a.crossTileID=r;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map((e=>{let{crossTileIDs:t}=e;return t}))}}class Ke{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Ye{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(e){const t=Math.round((e-this.lng)/360);if(0!==t)for(const i in this.indexes){const e=this.indexes[i],n={};for(const i in e){const r=e[i];r.tileID=r.tileID.unwrapTo(r.tileID.wrap+t),n[r.tileID.key]=r}this.indexes[i]=n}this.lng=e}addBucket(e,t,i){if(this.indexes[e.overscaledZ]&&this.indexes[e.overscaledZ][e.key]){if(this.indexes[e.overscaledZ][e.key].bucketInstanceId===t.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(e.overscaledZ,this.indexes[e.overscaledZ][e.key])}for(let r=0;r<t.symbolInstances.length;r++)t.symbolInstances.get(r).crossTileID=0;this.usedCrossTileIDs[e.overscaledZ]||(this.usedCrossTileIDs[e.overscaledZ]={});const n=this.usedCrossTileIDs[e.overscaledZ];for(const r in this.indexes){const i=this.indexes[r];if(Number(r)>e.overscaledZ)for(const r in i){const a=i[r];a.tileID.isChildOf(e)&&a.findMatches(t.symbolInstances,e,n)}else{const a=i[e.scaledTo(Number(r)).key];a&&a.findMatches(t.symbolInstances,e,n)}}for(let r=0;r<t.symbolInstances.length;r++){const e=t.symbolInstances.get(r);e.crossTileID||(e.crossTileID=i.generate(),n[e.crossTileID]=!0)}return void 0===this.indexes[e.overscaledZ]&&(this.indexes[e.overscaledZ]={}),this.indexes[e.overscaledZ][e.key]=new Xe(e,t.symbolInstances,t.bucketInstanceId),!0}removeBucketCrossTileIDs(e,t){for(const i of t.getCrossTileIDsLists())for(const t of i)delete this.usedCrossTileIDs[e][t]}removeStaleBuckets(e){let t=!1;for(const i in this.indexes){const n=this.indexes[i];for(const r in n)e[n[r].bucketInstanceId]||(this.removeBucketCrossTileIDs(i,n[r]),delete n[r],t=!0)}return t}}class Je{constructor(){this.layerIndexes={},this.crossTileIDs=new Ke,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(e,t,i){let n=this.layerIndexes[e.id];void 0===n&&(n=this.layerIndexes[e.id]=new Ye);let r=!1;const a={};n.handleWrapJump(i);for(const s of t){const t=s.getBucket(e);t&&e.id===t.layerIds[0]&&(t.bucketInstanceId||(t.bucketInstanceId=++this.maxBucketInstanceId),n.addBucket(s.tileID,t,this.crossTileIDs)&&(r=!0),a[t.bucketInstanceId]=!0)}return n.removeStaleBuckets(a)&&(r=!0),r}pruneUnusedLayers(e){const t={};e.forEach((e=>{t[e]=!0}));for(const i in this.layerIndexes)t[i]||delete this.layerIndexes[i]}}const Qe=(t,i)=>e.x(t,i&&i.filter((e=>"source.canvas"!==e.identifier))),et=e.F(e.ax,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setGlyphs","setSprite"]),tt=e.F(e.ax,["setCenter","setZoom","setBearing","setPitch"]),it=e.aw();class nt extends e.E{constructor(t){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(),this.map=t,this.dispatcher=new A(ne(),this,t._getMapId()),this.imageManager=new b,this.imageManager.setEventedParent(this),this.glyphManager=new k(t._requestManager,i.localIdeographFontFamily),this.lineAtlas=new I(256,512),this.crossTileSymbolIndex=new Je,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new e.ay,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",e.az());const n=this;this._rtlTextPluginCallback=nt.registerForPluginStateChange((t=>{n.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:t.pluginStatus,pluginURL:t.pluginURL},((t,i)=>{if(e.aA(t),i&&i.every((e=>e)))for(const e in n.sourceCaches){const t=n.sourceCaches[e].getSource().type;"vector"!==t&&"geojson"!==t||n.sourceCaches[e].reload()}}))})),this.on("data",(e=>{if("source"!==e.dataType||"metadata"!==e.sourceDataType)return;const t=this.sourceCaches[e.sourceId];if(!t)return;const i=t.getSource();if(i&&i.vectorLayerIds)for(const n in this._layers){const e=this._layers[n];e.source===i.id&&this._validateLayer(e)}}))}loadURL(t){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;this.fire(new e.k("dataloading",{dataType:"style"})),i.validate="boolean"!=typeof i.validate||i.validate;const r=this.map._requestManager.transformRequest(t,u.Style);this._request=e.f(r,((t,r)=>{this._request=null,t?this.fire(new e.j(t)):r&&this._load(r,i,n)}))}loadJSON(t){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;this.fire(new e.k("dataloading",{dataType:"style"})),this._request=e.h.frame((()=>{this._request=null,i.validate=!1!==i.validate,this._load(t,i,n)}))}loadEmpty(){this.fire(new e.k("dataloading",{dataType:"style"})),this._load(it,{validate:!1})}_load(t,i,n){var r;const a=i.transformStyle?i.transformStyle(n,t):t;if(!i.validate||!Qe(this,e.y(a))){this._loaded=!0,this.stylesheet=a;for(const e in a.sources)this.addSource(e,a.sources[e],{validate:!1});a.sprite?this._loadSprite(a.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(a.glyphs),this._createLayers(),this.light=new C(this.stylesheet.light),this.map.setTerrain(null!==(r=this.stylesheet.terrain)&&void 0!==r?r:null),this.fire(new e.k("data",{dataType:"style"})),this.fire(new e.k("style.load"))}}_createLayers(){const t=e.aB(this.stylesheet.layers);this.dispatcher.broadcast("setLayers",t),this._order=t.map((e=>e.id)),this._layers={},this._serializedLayers=null;for(const i of t){const t=e.aC(i);t.setEventedParent(this,{layer:{id:i.id}}),this._layers[i.id]=t}}_loadSprite(t){let i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;this.imageManager.setLoaded(!1),this._spriteRequest=function(t,i,n,r){const a=y(t),s=a.length,o=n>1?"@2x":"",l={},h={},d={};for(const{id:p,url:f}of a){const t=i.transformRequest(i.normalizeSpriteURL(f,o,".json"),u.SpriteJSON),n=`${p}_${t.url}`;l[n]=e.f(t,((e,t)=>{delete l[n],h[p]=t,_(r,h,d,e,s)}));const a=i.transformRequest(i.normalizeSpriteURL(f,o,".png"),u.SpriteImage),m=`${p}_${a.url}`;l[m]=c.getImage(a,((e,t)=>{delete l[m],d[p]=t,_(r,h,d,e,s)}))}return{cancel(){for(const e of Object.values(l))e.cancel()}}}(t,this.map._requestManager,this.map.getPixelRatio(),((t,r)=>{if(this._spriteRequest=null,t)this.fire(new e.j(t));else if(r)for(const e in r){this._spritesImagesIds[e]=[];const t=this._spritesImagesIds[e]?this._spritesImagesIds[e].filter((e=>!(e in r))):[];for(const e of t)this.imageManager.removeImage(e),this._changedImages[e]=!0;for(const n in r[e]){const t="default"===e?n:`${e}:${n}`;this._spritesImagesIds[e].push(t),t in this.imageManager.images?this.imageManager.updateImage(t,r[e][n],!1):this.imageManager.addImage(t,r[e][n]),i&&(this._changedImages[t]=!0)}}this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),i&&(this._changed=!0),this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new e.k("data",{dataType:"style"})),n&&n(t)}))}_unloadSprite(){for(const e of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(e),this._changedImages[e]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new e.k("data",{dataType:"style"}))}_validateLayer(t){const i=this.sourceCaches[t.source];if(!i)return;const n=t.sourceLayer;if(!n)return;const r=i.getSource();("geojson"===r.type||r.vectorLayerIds&&-1===r.vectorLayerIds.indexOf(n))&&this.fire(new e.j(new Error(`Source layer "${n}" does not exist on source "${r.id}" as specified by style layer "${t.id}".`)))}loaded(){if(!this._loaded)return!1;if(Object.keys(this._updatedSources).length)return!1;for(const e in this.sourceCaches)if(!this.sourceCaches[e].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(e){const t=this._serializedAllLayers();if(!e||0===e.length)return Object.values(t);const i=[];for(const n of e)t[n]&&i.push(t[n]);return i}_serializedAllLayers(){let e=this._serializedLayers;if(e)return e;e=this._serializedLayers={};const t=Object.keys(this._layers);for(const i of t){const t=this._layers[i];"custom"!==t.type&&(e[i]=t.serialize())}return e}hasTransitions(){if(this.light&&this.light.hasTransition())return!0;for(const e in this.sourceCaches)if(this.sourceCaches[e].hasTransition())return!0;for(const e in this._layers)if(this._layers[e].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(t){if(!this._loaded)return;const i=this._changed;if(this._changed){const e=Object.keys(this._updatedLayers),i=Object.keys(this._removedLayers);(e.length||i.length)&&this._updateWorkerLayers(e,i);for(const t in this._updatedSources){const e=this._updatedSources[t];if("reload"===e)this._reloadSource(t);else{if("clear"!==e)throw new Error(`Invalid action ${e}`);this._clearSource(t)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const n in this._updatedPaintProps)this._layers[n].updateTransitions(t);this.light.updateTransitions(t),this._resetUpdates()}const n={};for(const e in this.sourceCaches){const t=this.sourceCaches[e];n[e]=t.used,t.used=!1}for(const e of this._order){const i=this._layers[e];i.recalculate(t,this._availableImages),!i.isHidden(t.zoom)&&i.source&&(this.sourceCaches[i.source].used=!0)}for(const r in n){const t=this.sourceCaches[r];n[r]!==t.used&&t.fire(new e.k("data",{sourceDataType:"visibility",dataType:"source",sourceId:r}))}this.light.recalculate(t),this.z=t.zoom,i&&this.fire(new e.k("data",{dataType:"style"}))}_updateTilesForChangedImages(){const e=Object.keys(this._changedImages);if(e.length){for(const t in this.sourceCaches)this.sourceCaches[t].reloadTilesForDependencies(["icons","patterns"],e);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const e in this.sourceCaches)this.sourceCaches[e].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(e,t){this.dispatcher.broadcast("updateLayers",{layers:this._serializeByIds(e),removedIds:t})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(t){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._checkLoaded();const n=this.serialize();if(t=i.transformStyle?i.transformStyle(n,t):t,Qe(this,e.y(t)))return!1;(t=e.aD(t)).layers=e.aB(t.layers);const r=e.aE(n,t).filter((e=>!(e.command in tt)));if(0===r.length)return!1;const a=r.filter((e=>!(e.command in et)));if(a.length>0)throw new Error(`Unimplemented: ${a.map((e=>e.command)).join(", ")}.`);for(const e of r)"setTransition"!==e.command&&this[e.command].apply(this,e.args);return this.stylesheet=t,this._serializedLayers=null,!0}addImage(t,i){if(this.getImage(t))return this.fire(new e.j(new Error(`An image named "${t}" already exists.`)));this.imageManager.addImage(t,i),this._afterImageUpdated(t)}updateImage(e,t){this.imageManager.updateImage(e,t)}getImage(e){return this.imageManager.getImage(e)}removeImage(t){if(!this.getImage(t))return this.fire(new e.j(new Error(`An image named "${t}" does not exist.`)));this.imageManager.removeImage(t),this._afterImageUpdated(t)}_afterImageUpdated(t){this._availableImages=this.imageManager.listImages(),this._changedImages[t]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new e.k("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(t,i){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(this._checkLoaded(),void 0!==this.sourceCaches[t])throw new Error(`Source "${t}" already exists.`);if(!i.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(i).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(i.type)>=0&&this._validate(e.y.source,`sources.${t}`,i,null,n))return;this.map&&this.map._collectResourceTiming&&(i.collectResourceTiming=!0);const r=this.sourceCaches[t]=new K(t,i,this.dispatcher);r.style=this,r.setEventedParent(this,(()=>({isSourceLoaded:r.loaded(),source:r.serialize(),sourceId:t}))),r.onAdd(this.map),this._changed=!0}removeSource(t){if(this._checkLoaded(),void 0===this.sourceCaches[t])throw new Error("There is no source with this ID");for(const n in this._layers)if(this._layers[n].source===t)return this.fire(new e.j(new Error(`Source "${t}" cannot be removed while layer "${n}" is using it.`)));const i=this.sourceCaches[t];delete this.sourceCaches[t],delete this._updatedSources[t],i.fire(new e.k("data",{sourceDataType:"metadata",dataType:"source",sourceId:t})),i.setEventedParent(null),i.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(e,t){if(this._checkLoaded(),void 0===this.sourceCaches[e])throw new Error(`There is no source with this ID=${e}`);const i=this.sourceCaches[e].getSource();if("geojson"!==i.type)throw new Error(`geojsonSource.type is ${i.type}, which is !== 'geojson`);i.setData(t),this._changed=!0}getSource(e){return this.sourceCaches[e]&&this.sourceCaches[e].getSource()}addLayer(t,i){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this._checkLoaded();const r=t.id;if(this.getLayer(r))return void this.fire(new e.j(new Error(`Layer "${r}" already exists on this map.`)));let a;if("custom"===t.type){if(Qe(this,e.aF(t)))return;a=e.aC(t)}else{if("source"in t&&"object"==typeof t.source&&(this.addSource(r,t.source),t=e.aD(t),t=e.e(t,{source:r})),this._validate(e.y.layer,`layers.${r}`,t,{arrayIndex:-1},n))return;a=e.aC(t),this._validateLayer(a),a.setEventedParent(this,{layer:{id:r}})}const s=i?this._order.indexOf(i):this._order.length;if(i&&-1===s)this.fire(new e.j(new Error(`Cannot add layer "${r}" before non-existing layer "${i}".`)));else{if(this._order.splice(s,0,r),this._layerOrderChanged=!0,this._layers[r]=a,this._removedLayers[r]&&a.source&&"custom"!==a.type){const e=this._removedLayers[r];delete this._removedLayers[r],e.type!==a.type?this._updatedSources[a.source]="clear":(this._updatedSources[a.source]="reload",this.sourceCaches[a.source].pause())}this._updateLayer(a),a.onAdd&&a.onAdd(this.map)}}moveLayer(t,i){if(this._checkLoaded(),this._changed=!0,!this._layers[t])return void this.fire(new e.j(new Error(`The layer '${t}' does not exist in the map's style and cannot be moved.`)));if(t===i)return;const n=this._order.indexOf(t);this._order.splice(n,1);const r=i?this._order.indexOf(i):this._order.length;i&&-1===r?this.fire(new e.j(new Error(`Cannot move layer "${t}" before non-existing layer "${i}".`))):(this._order.splice(r,0,t),this._layerOrderChanged=!0)}removeLayer(t){this._checkLoaded();const i=this._layers[t];if(!i)return void this.fire(new e.j(new Error(`Cannot remove non-existing layer "${t}".`)));i.setEventedParent(null);const n=this._order.indexOf(t);this._order.splice(n,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[t]=i,delete this._layers[t],this._serializedLayers&&delete this._serializedLayers[t],delete this._updatedLayers[t],delete this._updatedPaintProps[t],i.onRemove&&i.onRemove(this.map)}getLayer(e){return this._layers[e]}getLayersOrder(){return[...this._order]}hasLayer(e){return e in this._layers}setLayerZoomRange(t,i,n){this._checkLoaded();const r=this.getLayer(t);r?r.minzoom===i&&r.maxzoom===n||(null!=i&&(r.minzoom=i),null!=n&&(r.maxzoom=n),this._updateLayer(r)):this.fire(new e.j(new Error(`Cannot set the zoom range of non-existing layer "${t}".`)))}setFilter(t,i){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this._checkLoaded();const r=this.getLayer(t);if(r){if(!e.aG(r.filter,i))return null==i?(r.filter=void 0,void this._updateLayer(r)):void(this._validate(e.y.filter,`layers.${r.id}.filter`,i,null,n)||(r.filter=e.aD(i),this._updateLayer(r)))}else this.fire(new e.j(new Error(`Cannot filter non-existing layer "${t}".`)))}getFilter(t){return e.aD(this.getLayer(t).filter)}setLayoutProperty(t,i,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};this._checkLoaded();const a=this.getLayer(t);a?e.aG(a.getLayoutProperty(i),n)||(a.setLayoutProperty(i,n,r),this._updateLayer(a)):this.fire(new e.j(new Error(`Cannot style non-existing layer "${t}".`)))}getLayoutProperty(t,i){const n=this.getLayer(t);if(n)return n.getLayoutProperty(i);this.fire(new e.j(new Error(`Cannot get style of non-existing layer "${t}".`)))}setPaintProperty(t,i,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};this._checkLoaded();const a=this.getLayer(t);a?e.aG(a.getPaintProperty(i),n)||(a.setPaintProperty(i,n,r)&&this._updateLayer(a),this._changed=!0,this._updatedPaintProps[t]=!0):this.fire(new e.j(new Error(`Cannot style non-existing layer "${t}".`)))}getPaintProperty(e,t){return this.getLayer(e).getPaintProperty(t)}setFeatureState(t,i){this._checkLoaded();const n=t.source,r=t.sourceLayer,a=this.sourceCaches[n];if(void 0===a)return void this.fire(new e.j(new Error(`The source '${n}' does not exist in the map's style.`)));const s=a.getSource().type;"geojson"===s&&r?this.fire(new e.j(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):"vector"!==s||r?(void 0===t.id&&this.fire(new e.j(new Error("The feature id parameter must be provided."))),a.setFeatureState(r,t.id,i)):this.fire(new e.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(t,i){this._checkLoaded();const n=t.source,r=this.sourceCaches[n];if(void 0===r)return void this.fire(new e.j(new Error(`The source '${n}' does not exist in the map's style.`)));const a=r.getSource().type,s="vector"===a?t.sourceLayer:void 0;"vector"!==a||s?i&&"string"!=typeof t.id&&"number"!=typeof t.id?this.fire(new e.j(new Error("A feature id is required to remove its specific state property."))):r.removeFeatureState(s,t.id,i):this.fire(new e.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(t){this._checkLoaded();const i=t.source,n=t.sourceLayer,r=this.sourceCaches[i];if(void 0!==r)return"vector"!==r.getSource().type||n?(void 0===t.id&&this.fire(new e.j(new Error("The feature id parameter must be provided."))),r.getFeatureState(n,t.id)):void this.fire(new e.j(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new e.j(new Error(`The source '${i}' does not exist in the map's style.`)))}getTransition(){return e.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const t=e.aH(this.sourceCaches,(e=>e.serialize())),i=this._serializeByIds(this._order),n=this.map.getTerrain()||void 0,r=this.stylesheet;return e.aI({version:r.version,name:r.name,metadata:r.metadata,light:r.light,center:r.center,zoom:r.zoom,bearing:r.bearing,pitch:r.pitch,sprite:r.sprite,glyphs:r.glyphs,transition:r.transition,sources:t,layers:i,terrain:n},(e=>void 0!==e))}_updateLayer(e){this._updatedLayers[e.id]=!0,e.source&&!this._updatedSources[e.source]&&"raster"!==this.sourceCaches[e.source].getSource().type&&(this._updatedSources[e.source]="reload",this.sourceCaches[e.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(e){const t=e=>"fill-extrusion"===this._layers[e].type,i={},n=[];for(let a=this._order.length-1;a>=0;a--){const r=this._order[a];if(t(r)){i[r]=a;for(const t of e){const e=t[r];if(e)for(const t of e)n.push(t)}}}n.sort(((e,t)=>t.intersectionZ-e.intersectionZ));const r=[];for(let a=this._order.length-1;a>=0;a--){const s=this._order[a];if(t(s))for(let e=n.length-1;e>=0;e--){const t=n[e].feature;if(i[t.layer.id]<a)break;r.push(t),n.pop()}else for(const t of e){const e=t[s];if(e)for(const t of e)r.push(t.feature)}}return r}queryRenderedFeatures(t,i,n){i&&i.filter&&this._validate(e.y.filter,"queryRenderedFeatures.filter",i.filter,null,i);const r={};if(i&&i.layers){if(!Array.isArray(i.layers))return this.fire(new e.j(new Error("parameters.layers must be an Array."))),[];for(const t of i.layers){const i=this._layers[t];if(!i)return this.fire(new e.j(new Error(`The layer '${t}' does not exist in the map's style and cannot be queried for features.`))),[];r[i.source]=!0}}const a=[];i.availableImages=this._availableImages;const s=this._serializedAllLayers();for(const e in this.sourceCaches)i.layers&&!r[e]||a.push(Z(this.sourceCaches[e],this._layers,s,t,i,n));return this.placement&&a.push(function(e,t,i,n,r,a,s){const o={},l=a.queryRenderedSymbols(n),c=[];for(const u of Object.keys(l).map(Number))c.push(s[u]);c.sort(G);for(const u of c){const i=u.featureIndex.lookupSymbolFeatures(l[u.bucketInstanceId],t,u.bucketIndex,u.sourceLayerIndex,r.filter,r.layers,r.availableImages,e);for(const e in i){const t=o[e]=o[e]||[],n=i[e];n.sort(((e,t)=>{const i=u.featureSortOrder;if(i){const n=i.indexOf(e.featureIndex);return i.indexOf(t.featureIndex)-n}return t.featureIndex-e.featureIndex}));for(const e of n)t.push(e)}}for(const u in o)o[u].forEach((t=>{const n=t.feature,r=i[e[u].source].getFeatureState(n.layer["source-layer"],n.id);n.source=n.layer.source,n.layer["source-layer"]&&(n.sourceLayer=n.layer["source-layer"]),n.state=r}));return o}(this._layers,s,this.sourceCaches,t,i,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(a)}querySourceFeatures(t,i){i&&i.filter&&this._validate(e.y.filter,"querySourceFeatures.filter",i.filter,null,i);const n=this.sourceCaches[t];return n?function(e,t){const i=e.getRenderableIds().map((t=>e.getTileByID(t))),n=[],r={};for(let a=0;a<i.length;a++){const e=i[a],s=e.tileID.canonical.key;r[s]||(r[s]=!0,e.querySourceFeatures(n,t))}return n}(n,i):[]}addSourceType(e,t,i){return $(e)?i(new Error(`A source type called "${e}" already exists.`)):(((e,t)=>{U[e]=t})(e,t),t.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:e,url:t.workerSourceURL},i):i(null,null))}getLight(){return this.light.getLight()}setLight(t){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._checkLoaded();const n=this.light.getLight();let r=!1;for(const s in t)if(!e.aG(t[s],n[s])){r=!0;break}if(!r)return;const a={now:e.h.now(),transition:e.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(t,i),this.light.updateTransitions(a)}_validate(t,i,n,r){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};return(!a||!1!==a.validate)&&Qe(this,t.call(e.y,e.e({key:i,style:this.serialize(),value:n,styleSpec:e.v},r)))}_remove(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),e.aJ.off("pluginStateChange",this._rtlTextPluginCallback);for(const e in this._layers)this._layers[e].setEventedParent(null);for(const e in this.sourceCaches){const t=this.sourceCaches[e];t.setEventedParent(null),t.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove(t)}_clearSource(e){this.sourceCaches[e].clearTiles()}_reloadSource(e){this.sourceCaches[e].resume(),this.sourceCaches[e].reload()}_updateSources(e){for(const t in this.sourceCaches)this.sourceCaches[t].update(e,this.map.terrain)}_generateCollisionBoxes(){for(const e in this.sourceCaches)this._reloadSource(e)}_updatePlacement(t,i,n,r){let a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=!1,o=!1;const l={};for(const e of this._order){const i=this._layers[e];if("symbol"!==i.type)continue;if(!l[i.source]){const e=this.sourceCaches[i.source];l[i.source]=e.getRenderableIds(!0).map((t=>e.getTileByID(t))).sort(((e,t)=>t.tileID.overscaledZ-e.tileID.overscaledZ||(e.tileID.isLessThan(t.tileID)?-1:1)))}const n=this.crossTileSymbolIndex.addLayer(i,l[i.source],t.center.lng);s=s||n}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((a=a||this._layerOrderChanged||0===n)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(e.h.now(),t.zoom))&&(this.pauseablePlacement=new We(t,this.map.terrain,this._order,a,i,n,r,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,l),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(e.h.now()),o=!0),s&&this.pauseablePlacement.placement.setStale()),o||s)for(const e of this._order){const t=this._layers[e];"symbol"===t.type&&this.placement.updateLayerOpacities(t,l[t.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(e.h.now())}_releaseSymbolFadeTiles(){for(const e in this.sourceCaches)this.sourceCaches[e].releaseSymbolFadeTiles()}getImages(e,t,i){this.imageManager.getImages(t.icons,i),this._updateTilesForChangedImages();const n=this.sourceCaches[t.source];n&&n.setDependencies(t.tileID.key,t.type,t.icons)}getGlyphs(e,t,i){this.glyphManager.getGlyphs(t.stacks,i);const n=this.sourceCaches[t.source];n&&n.setDependencies(t.tileID.key,t.type,[""])}getResource(t,i,n){return e.m(i,n)}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(t){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._checkLoaded(),t&&this._validate(e.y.glyphs,"glyphs",t,null,i)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=t,this.glyphManager.entries={},this.glyphManager.setURL(t))}addSprite(t,i){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3?arguments[3]:void 0;this._checkLoaded();const a=[{id:t,url:i}],s=[...y(this.stylesheet.sprite),...a];this._validate(e.y.sprite,"sprite",s,null,n)||(this.stylesheet.sprite=s,this._loadSprite(a,!0,r))}removeSprite(t){this._checkLoaded();const i=y(this.stylesheet.sprite);if(i.find((e=>e.id===t))){if(this._spritesImagesIds[t])for(const e of this._spritesImagesIds[t])this.imageManager.removeImage(e),this._changedImages[e]=!0;i.splice(i.findIndex((e=>e.id===t)),1),this.stylesheet.sprite=i.length>0?i:void 0,delete this._spritesImagesIds[t],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new e.k("data",{dataType:"style"}))}else this.fire(new e.j(new Error(`Sprite "${t}" doesn't exists on this map.`)))}getSprite(){return y(this.stylesheet.sprite)}setSprite(t){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;this._checkLoaded(),t&&this._validate(e.y.sprite,"sprite",t,null,i)||(this.stylesheet.sprite=t,t?this._loadSprite(t,!0,n):(this._unloadSprite(),n&&n(null)))}}nt.registerForPluginStateChange=e.aK;var rt=e.Q([{name:"a_pos",type:"Int16",components:2}]),at="attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;varying float v_depth;void main() {float extent=8192.0;float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/extent;gl_Position=u_matrix*vec4(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta,1.0);v_depth=gl_Position.z/gl_Position.w;}";const st={prelude:ot("#ifdef GL_ES\nprecision mediump float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif\n","#ifdef GL_ES\nprecision highp float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}\n#ifdef TERRAIN3D\nuniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;\n#endif\nconst highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {\n#ifdef TERRAIN3D\nhighp float d=unpack(texture2D(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));\n#else\nreturn 1.0;\n#endif\n}float calculate_visibility(vec4 pos) {\n#ifdef TERRAIN3D\nvec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;\n#else\nreturn 1.0;\n#endif\n}float ele(vec2 pos) {\n#ifdef TERRAIN3D\nvec4 rgb=(texture2D(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;\n#else\nreturn 0.0;\n#endif\n}float get_elevation(vec2 pos) {\n#ifdef TERRAIN3D\nvec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;\n#else\nreturn 0.0;\n#endif\n}"),background:ot("uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),backgroundPattern:ot("uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:ot("varying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float ele=get_elevation(circle_center);v_visibility=calculate_visibility(u_matrix*vec4(circle_center,ele,1.0));if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,ele,1);} else {gl_Position=u_matrix*vec4(circle_center,ele,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}"),clippingMask:ot("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:ot("uniform highp float u_intensity;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}"),heatmapTexture:ot("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(0.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:ot("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,get_elevation(a_pos),1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:ot("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:ot("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,get_elevation(a_pos),1);}"),fill:ot("#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_FragColor=color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);}"),fillOutline:ot("varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),fillOutlinePattern:ot("uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),fillPattern:ot("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}"),fillExtrusion:ot("varying vec4 v_color;void main() {gl_FragColor=v_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;\n#ifdef TERRAIN3D\nattribute vec2 a_centroid;\n#endif\nvarying vec4 v_color;\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\nvec3 normal=a_normal_ed.xyz;\n#ifdef TERRAIN3D\nfloat height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);\n#else\nfloat height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;\n#endif\nbase=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}"),fillExtrusionPattern:ot("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;\n#ifdef TERRAIN3D\nattribute vec2 a_centroid;\n#endif\nvarying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;\n#ifdef TERRAIN3D\nfloat height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);\n#else\nfloat height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;\n#endif\nbase=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0\n? a_pos\n: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}"),hillshadePrepare:ot("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:ot("uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;\n#define PI 3.141592653589793\nvoid main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),line:ot("uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;\n#ifdef TERRAIN3D\nv_gamma_scale=1.0;\n#else\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#endif\nv_width2=vec2(outset,inset);}"),lineGradient:ot("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;\n#ifdef TERRAIN3D\nv_gamma_scale=1.0;\n#else\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#endif\nv_width2=vec2(outset,inset);}"),linePattern:ot("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;\n#ifdef TERRAIN3D\nv_gamma_scale=1.0;\n#else\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#endif\nv_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}"),lineSDF:ot("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;\n#ifdef TERRAIN3D\nv_gamma_scale=1.0;\n#else\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#endif\nv_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}"),raster:ot("uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:ot("uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nlowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),z,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}"),symbolSDF:ot("#define SDF_PX 8.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}"),symbolTextAndIcon:ot("#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\nreturn;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}"),terrain:ot("uniform sampler2D u_texture;varying vec2 v_texture_pos;void main() {gl_FragColor=texture2D(u_texture,v_texture_pos);}",at),terrainDepth:ot("varying float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {gl_FragColor=pack(v_depth);}",at),terrainCoords:ot("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;varying vec2 v_texture_pos;void main() {vec4 rgba=texture2D(u_texture,v_texture_pos);gl_FragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}",at)};function ot(e,t){const i=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,n=t.match(/attribute ([\w]+) ([\w]+)/g),r=e.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),a=t.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),s=a?a.concat(r):r,o={};return{fragmentSource:e=e.replace(i,((e,t,i,n,r)=>(o[r]=!0,"define"===t?`\n#ifndef HAS_UNIFORM_u_${r}\nvarying ${i} ${n} ${r};\n#else\nuniform ${i} ${n} u_${r};\n#endif\n`:`\n#ifdef HAS_UNIFORM_u_${r}\n    ${i} ${n} ${r} = u_${r};\n#endif\n`))),vertexSource:t=t.replace(i,((e,t,i,n,r)=>{const a="float"===n?"vec2":"vec4",s=r.match(/color/)?"color":a;return o[r]?"define"===t?`\n#ifndef HAS_UNIFORM_u_${r}\nuniform lowp float u_${r}_t;\nattribute ${i} ${a} a_${r};\nvarying ${i} ${n} ${r};\n#else\nuniform ${i} ${n} u_${r};\n#endif\n`:"vec4"===s?`\n#ifndef HAS_UNIFORM_u_${r}\n    ${r} = a_${r};\n#else\n    ${i} ${n} ${r} = u_${r};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${r}\n    ${r} = unpack_mix_${s}(a_${r}, u_${r}_t);\n#else\n    ${i} ${n} ${r} = u_${r};\n#endif\n`:"define"===t?`\n#ifndef HAS_UNIFORM_u_${r}\nuniform lowp float u_${r}_t;\nattribute ${i} ${a} a_${r};\n#else\nuniform ${i} ${n} u_${r};\n#endif\n`:"vec4"===s?`\n#ifndef HAS_UNIFORM_u_${r}\n    ${i} ${n} ${r} = a_${r};\n#else\n    ${i} ${n} ${r} = u_${r};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${r}\n    ${i} ${n} ${r} = unpack_mix_${s}(a_${r}, u_${r}_t);\n#else\n    ${i} ${n} ${r} = u_${r};\n#endif\n`})),staticAttributes:n,staticUniforms:s}}class lt{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(e,t,i,n,r,a,s,o,l){this.context=e;let c=this.boundPaintVertexBuffers.length!==n.length;for(let u=0;!c&&u<n.length;u++)this.boundPaintVertexBuffers[u]!==n[u]&&(c=!0);!this.vao||this.boundProgram!==t||this.boundLayoutVertexBuffer!==i||c||this.boundIndexBuffer!==r||this.boundVertexOffset!==a||this.boundDynamicVertexBuffer!==s||this.boundDynamicVertexBuffer2!==o||this.boundDynamicVertexBuffer3!==l?this.freshBind(t,i,n,r,a,s,o,l):(e.bindVertexArray.set(this.vao),s&&s.bind(),r&&r.dynamicDraw&&r.bind(),o&&o.bind(),l&&l.bind())}freshBind(e,t,i,n,r,a,s,o){const l=e.numAttributes,c=this.context,u=c.gl;this.vao&&this.destroy(),this.vao=c.createVertexArray(),c.bindVertexArray.set(this.vao),this.boundProgram=e,this.boundLayoutVertexBuffer=t,this.boundPaintVertexBuffers=i,this.boundIndexBuffer=n,this.boundVertexOffset=r,this.boundDynamicVertexBuffer=a,this.boundDynamicVertexBuffer2=s,this.boundDynamicVertexBuffer3=o,t.enableAttributes(u,e);for(const h of i)h.enableAttributes(u,e);a&&a.enableAttributes(u,e),s&&s.enableAttributes(u,e),o&&o.enableAttributes(u,e),t.bind(),t.setVertexAttribPointers(u,e,r);for(const h of i)h.bind(),h.setVertexAttribPointers(u,e,r);a&&(a.bind(),a.setVertexAttribPointers(u,e,r)),n&&n.bind(),s&&(s.bind(),s.setVertexAttribPointers(u,e,r)),o&&(o.bind(),o.setVertexAttribPointers(u,e,r)),c.currentNumAttributes=l}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}function ct(e){const t=[];for(let i=0;i<e.length;i++){if(null===e[i])continue;const n=e[i].split(" ");t.push(n.pop())}return t}class ut{constructor(t,i,n,r,a,s){const o=t.gl;this.program=o.createProgram();const l=ct(i.staticAttributes),c=n?n.getBinderAttributes():[],u=l.concat(c),h=st.prelude.staticUniforms?ct(st.prelude.staticUniforms):[],d=i.staticUniforms?ct(i.staticUniforms):[],p=n?n.getBinderUniforms():[],f=h.concat(d).concat(p),m=[];for(const e of f)m.indexOf(e)<0&&m.push(e);const g=n?n.defines():[];a&&g.push("#define OVERDRAW_INSPECTOR;"),s&&g.push("#define TERRAIN3D;");const y=g.concat(st.prelude.fragmentSource,i.fragmentSource).join("\n"),_=g.concat(st.prelude.vertexSource,i.vertexSource).join("\n"),v=o.createShader(o.FRAGMENT_SHADER);if(o.isContextLost())return void(this.failedToCreate=!0);if(o.shaderSource(v,y),o.compileShader(v),!o.getShaderParameter(v,o.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${o.getShaderInfoLog(v)}`);o.attachShader(this.program,v);const x=o.createShader(o.VERTEX_SHADER);if(o.isContextLost())return void(this.failedToCreate=!0);if(o.shaderSource(x,_),o.compileShader(x),!o.getShaderParameter(x,o.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${o.getShaderInfoLog(x)}`);o.attachShader(this.program,x),this.attributes={};const b={};this.numAttributes=u.length;for(let e=0;e<this.numAttributes;e++)u[e]&&(o.bindAttribLocation(this.program,e,u[e]),this.attributes[u[e]]=e);if(o.linkProgram(this.program),!o.getProgramParameter(this.program,o.LINK_STATUS))throw new Error(`Program failed to link: ${o.getProgramInfoLog(this.program)}`);o.deleteShader(x),o.deleteShader(v);for(let e=0;e<m.length;e++){const t=m[e];if(t&&!b[t]){const e=o.getUniformLocation(this.program,t);e&&(b[t]=e)}}this.fixedUniforms=r(t,b),this.terrainUniforms=((t,i)=>({u_depth:new e.aL(t,i.u_depth),u_terrain:new e.aL(t,i.u_terrain),u_terrain_dim:new e.aM(t,i.u_terrain_dim),u_terrain_matrix:new e.aN(t,i.u_terrain_matrix),u_terrain_unpack:new e.aO(t,i.u_terrain_unpack),u_terrain_exaggeration:new e.aM(t,i.u_terrain_exaggeration)}))(t,b),this.binderUniforms=n?n.getUniforms(t,b):[]}draw(e,t,i,n,r,a,s,o,l,c,u,h,d,p,f,m,g,y){const _=e.gl;if(this.failedToCreate)return;if(e.program.set(this.program),e.setDepthMode(i),e.setStencilMode(n),e.setColorMode(r),e.setCullFace(a),o){e.activeTexture.set(_.TEXTURE2),_.bindTexture(_.TEXTURE_2D,o.depthTexture),e.activeTexture.set(_.TEXTURE3),_.bindTexture(_.TEXTURE_2D,o.texture);for(const e in this.terrainUniforms)this.terrainUniforms[e].set(o[e])}for(const x in this.fixedUniforms)this.fixedUniforms[x].set(s[x]);f&&f.setUniforms(e,this.binderUniforms,d,{zoom:p});let v=0;switch(t){case _.LINES:v=2;break;case _.TRIANGLES:v=3;break;case _.LINE_STRIP:v=1}for(const x of h.get()){const i=x.vaos||(x.vaos={});(i[l]||(i[l]=new lt)).bind(e,this,c,f?f.getPaintVertexBuffers():[],u,x.vertexOffset,m,g,y),_.drawElements(t,x.primitiveLength*v,_.UNSIGNED_SHORT,x.primitiveOffset*v*2)}}}function ht(e,t,i){const n=1/Ee(i,1,t.transform.tileZoom),r=Math.pow(2,i.tileID.overscaledZ),a=i.tileSize*Math.pow(2,t.transform.tileZoom)/r,s=a*(i.tileID.canonical.x+i.tileID.wrap*r),o=a*i.tileID.canonical.y;return{u_image:0,u_texsize:i.imageAtlasTexture.size,u_scale:[n,e.fromScale,e.toScale],u_fade:e.t,u_pixel_coord_upper:[s>>16,o>>16],u_pixel_coord_lower:[65535&s,65535&o]}}const dt=(t,i,n,r)=>{const a=i.style.light,s=a.properties.get("position"),o=[s.x,s.y,s.z],l=function(){var t=new e.A(9);return e.A!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}();"viewport"===a.properties.get("anchor")&&function(e,t){var i=Math.sin(t),n=Math.cos(t);e[0]=n,e[1]=i,e[2]=0,e[3]=-i,e[4]=n,e[5]=0,e[6]=0,e[7]=0,e[8]=1}(l,-i.transform.angle),function(e,t,i){var n=t[0],r=t[1],a=t[2];e[0]=n*i[0]+r*i[3]+a*i[6],e[1]=n*i[1]+r*i[4]+a*i[7],e[2]=n*i[2]+r*i[5]+a*i[8]}(o,o,l);const c=a.properties.get("color");return{u_matrix:t,u_lightpos:o,u_lightintensity:a.properties.get("intensity"),u_lightcolor:[c.r,c.g,c.b],u_vertical_gradient:+n,u_opacity:r}},pt=(t,i,n,r,a,s,o)=>e.e(dt(t,i,n,r),ht(s,i,o),{u_height_factor:-Math.pow(2,a.overscaledZ)/o.tileSize/8}),ft=e=>({u_matrix:e}),mt=(t,i,n,r)=>e.e(ft(t),ht(n,i,r)),gt=(e,t)=>({u_matrix:e,u_world:t}),yt=(t,i,n,r,a)=>e.e(mt(t,i,n,r),{u_world:a}),_t=(e,t,i,n)=>{const r=e.transform;let a,s;if("map"===n.paint.get("circle-pitch-alignment")){const e=Ee(i,1,r.zoom);a=!0,s=[e,e]}else a=!1,s=r.pixelsToGLUnits;return{u_camera_to_center_distance:r.cameraToCenterDistance,u_scale_with_map:+("map"===n.paint.get("circle-pitch-scale")),u_matrix:e.translatePosMatrix(t.posMatrix,i,n.paint.get("circle-translate"),n.paint.get("circle-translate-anchor")),u_pitch_with_map:+a,u_device_pixel_ratio:e.pixelRatio,u_extrude_scale:s}},vt=(e,t,i)=>{const n=Ee(i,1,t.zoom),r=Math.pow(2,t.zoom-i.tileID.overscaledZ),a=i.tileID.overscaleFactor();return{u_matrix:e,u_camera_to_center_distance:t.cameraToCenterDistance,u_pixels_to_tile_units:n,u_extrude_scale:[t.pixelsToGLUnits[0]/(n*r),t.pixelsToGLUnits[1]/(n*r)],u_overscale_factor:a}},xt=function(e,t){return{u_matrix:e,u_color:t,u_overlay:0,u_overlay_scale:arguments.length>2&&void 0!==arguments[2]?arguments[2]:1}},bt=e=>({u_matrix:e}),wt=(e,t,i,n)=>({u_matrix:e,u_extrude_scale:Ee(t,1,i),u_intensity:n});function St(t,i){const n=Math.pow(2,i.canonical.z),r=i.canonical.y;return[new e.U(0,r/n).toLngLat().lat,new e.U(0,(r+1)/n).toLngLat().lat]}const Tt=(e,t,i,n)=>{const r=e.transform;return{u_matrix:It(e,t,i,n),u_ratio:1/Ee(t,1,r.zoom),u_device_pixel_ratio:e.pixelRatio,u_units_to_pixels:[1/r.pixelsToGLUnits[0],1/r.pixelsToGLUnits[1]]}},kt=(t,i,n,r,a)=>e.e(Tt(t,i,n,a),{u_image:0,u_image_height:r}),Et=(e,t,i,n,r)=>{const a=e.transform,s=Ct(t,a);return{u_matrix:It(e,t,i,r),u_texsize:t.imageAtlasTexture.size,u_ratio:1/Ee(t,1,a.zoom),u_device_pixel_ratio:e.pixelRatio,u_image:0,u_scale:[s,n.fromScale,n.toScale],u_fade:n.t,u_units_to_pixels:[1/a.pixelsToGLUnits[0],1/a.pixelsToGLUnits[1]]}},Pt=(t,i,n,r,a,s)=>{const o=t.lineAtlas,l=Ct(i,t.transform),c="round"===n.layout.get("line-cap"),u=o.getDash(r.from,c),h=o.getDash(r.to,c),d=u.width*a.fromScale,p=h.width*a.toScale;return e.e(Tt(t,i,n,s),{u_patternscale_a:[l/d,-u.height/2],u_patternscale_b:[l/p,-h.height/2],u_sdfgamma:o.width/(256*Math.min(d,p)*t.pixelRatio)/2,u_image:0,u_tex_y_a:u.y,u_tex_y_b:h.y,u_mix:a.t})};function Ct(e,t){return 1/Ee(e,1,t.tileZoom)}function It(e,t,i,n){return e.translatePosMatrix(n?n.posMatrix:t.tileID.posMatrix,t,i.paint.get("line-translate"),i.paint.get("line-translate-anchor"))}const At=(e,t,i,n,r)=>{return{u_matrix:e,u_tl_parent:t,u_scale_parent:i,u_buffer_scale:1,u_fade_t:n.mix,u_opacity:n.opacity*r.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:r.paint.get("raster-brightness-min"),u_brightness_high:r.paint.get("raster-brightness-max"),u_saturation_factor:(s=r.paint.get("raster-saturation"),s>0?1-1/(1.001-s):-s),u_contrast_factor:(a=r.paint.get("raster-contrast"),a>0?1/(1-a):1+a),u_spin_weights:Mt(r.paint.get("raster-hue-rotate"))};var a,s};function Mt(e){e*=Math.PI/180;const t=Math.sin(e),i=Math.cos(e);return[(2*i+1)/3,(-Math.sqrt(3)*t-i+1)/3,(Math.sqrt(3)*t-i+1)/3]}const zt=(e,t,i,n,r,a,s,o,l,c)=>{const u=r.transform;return{u_is_size_zoom_constant:+("constant"===e||"source"===e),u_is_size_feature_constant:+("constant"===e||"camera"===e),u_size_t:t?t.uSizeT:0,u_size:t?t.uSize:0,u_camera_to_center_distance:u.cameraToCenterDistance,u_pitch:u.pitch/360*2*Math.PI,u_rotate_symbol:+i,u_aspect_ratio:u.width/u.height,u_fade_change:r.options.fadeDuration?r.symbolFadeChange:1,u_matrix:a,u_label_plane_matrix:s,u_coord_matrix:o,u_is_text:+l,u_pitch_with_map:+n,u_texsize:c,u_texture:0}},Dt=(t,i,n,r,a,s,o,l,c,u,h)=>{const d=a.transform;return e.e(zt(t,i,n,r,a,s,o,l,c,u),{u_gamma_scale:r?Math.cos(d._pitch)*d.cameraToCenterDistance:1,u_device_pixel_ratio:a.pixelRatio,u_is_halo:+h})},Lt=(t,i,n,r,a,s,o,l,c,u)=>e.e(Dt(t,i,n,r,a,s,o,l,!0,c,!0),{u_texsize_icon:u,u_texture_icon:1}),Rt=(e,t,i)=>({u_matrix:e,u_opacity:t,u_color:i}),Ft=(t,i,n,r,a,s)=>e.e(function(e,t,i,n){const r=i.imageManager.getPattern(e.from.toString()),a=i.imageManager.getPattern(e.to.toString()),{width:s,height:o}=i.imageManager.getPixelSize(),l=Math.pow(2,n.tileID.overscaledZ),c=n.tileSize*Math.pow(2,i.transform.tileZoom)/l,u=c*(n.tileID.canonical.x+n.tileID.wrap*l),h=c*n.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:r.tl,u_pattern_br_a:r.br,u_pattern_tl_b:a.tl,u_pattern_br_b:a.br,u_texsize:[s,o],u_mix:t.t,u_pattern_size_a:r.displaySize,u_pattern_size_b:a.displaySize,u_scale_a:t.fromScale,u_scale_b:t.toScale,u_tile_units_to_pixels:1/Ee(n,1,i.transform.tileZoom),u_pixel_coord_upper:[u>>16,h>>16],u_pixel_coord_lower:[65535&u,65535&h]}}(r,s,n,a),{u_matrix:t,u_opacity:i}),Bt={fillExtrusion:(t,i)=>({u_matrix:new e.aN(t,i.u_matrix),u_lightpos:new e.aP(t,i.u_lightpos),u_lightintensity:new e.aM(t,i.u_lightintensity),u_lightcolor:new e.aP(t,i.u_lightcolor),u_vertical_gradient:new e.aM(t,i.u_vertical_gradient),u_opacity:new e.aM(t,i.u_opacity)}),fillExtrusionPattern:(t,i)=>({u_matrix:new e.aN(t,i.u_matrix),u_lightpos:new e.aP(t,i.u_lightpos),u_lightintensity:new e.aM(t,i.u_lightintensity),u_lightcolor:new e.aP(t,i.u_lightcolor),u_vertical_gradient:new e.aM(t,i.u_vertical_gradient),u_height_factor:new e.aM(t,i.u_height_factor),u_image:new e.aL(t,i.u_image),u_texsize:new e.aQ(t,i.u_texsize),u_pixel_coord_upper:new e.aQ(t,i.u_pixel_coord_upper),u_pixel_coord_lower:new e.aQ(t,i.u_pixel_coord_lower),u_scale:new e.aP(t,i.u_scale),u_fade:new e.aM(t,i.u_fade),u_opacity:new e.aM(t,i.u_opacity)}),fill:(t,i)=>({u_matrix:new e.aN(t,i.u_matrix)}),fillPattern:(t,i)=>({u_matrix:new e.aN(t,i.u_matrix),u_image:new e.aL(t,i.u_image),u_texsize:new e.aQ(t,i.u_texsize),u_pixel_coord_upper:new e.aQ(t,i.u_pixel_coord_upper),u_pixel_coord_lower:new e.aQ(t,i.u_pixel_coord_lower),u_scale:new e.aP(t,i.u_scale),u_fade:new e.aM(t,i.u_fade)}),fillOutline:(t,i)=>({u_matrix:new e.aN(t,i.u_matrix),u_world:new e.aQ(t,i.u_world)}),fillOutlinePattern:(t,i)=>({u_matrix:new e.aN(t,i.u_matrix),u_world:new e.aQ(t,i.u_world),u_image:new e.aL(t,i.u_image),u_texsize:new e.aQ(t,i.u_texsize),u_pixel_coord_upper:new e.aQ(t,i.u_pixel_coord_upper),u_pixel_coord_lower:new e.aQ(t,i.u_pixel_coord_lower),u_scale:new e.aP(t,i.u_scale),u_fade:new e.aM(t,i.u_fade)}),circle:(t,i)=>({u_camera_to_center_distance:new e.aM(t,i.u_camera_to_center_distance),u_scale_with_map:new e.aL(t,i.u_scale_with_map),u_pitch_with_map:new e.aL(t,i.u_pitch_with_map),u_extrude_scale:new e.aQ(t,i.u_extrude_scale),u_device_pixel_ratio:new e.aM(t,i.u_device_pixel_ratio),u_matrix:new e.aN(t,i.u_matrix)}),collisionBox:(t,i)=>({u_matrix:new e.aN(t,i.u_matrix),u_camera_to_center_distance:new e.aM(t,i.u_camera_to_center_distance),u_pixels_to_tile_units:new e.aM(t,i.u_pixels_to_tile_units),u_extrude_scale:new e.aQ(t,i.u_extrude_scale),u_overscale_factor:new e.aM(t,i.u_overscale_factor)}),collisionCircle:(t,i)=>({u_matrix:new e.aN(t,i.u_matrix),u_inv_matrix:new e.aN(t,i.u_inv_matrix),u_camera_to_center_distance:new e.aM(t,i.u_camera_to_center_distance),u_viewport_size:new e.aQ(t,i.u_viewport_size)}),debug:(t,i)=>({u_color:new e.aR(t,i.u_color),u_matrix:new e.aN(t,i.u_matrix),u_overlay:new e.aL(t,i.u_overlay),u_overlay_scale:new e.aM(t,i.u_overlay_scale)}),clippingMask:(t,i)=>({u_matrix:new e.aN(t,i.u_matrix)}),heatmap:(t,i)=>({u_extrude_scale:new e.aM(t,i.u_extrude_scale),u_intensity:new e.aM(t,i.u_intensity),u_matrix:new e.aN(t,i.u_matrix)}),heatmapTexture:(t,i)=>({u_matrix:new e.aN(t,i.u_matrix),u_world:new e.aQ(t,i.u_world),u_image:new e.aL(t,i.u_image),u_color_ramp:new e.aL(t,i.u_color_ramp),u_opacity:new e.aM(t,i.u_opacity)}),hillshade:(t,i)=>({u_matrix:new e.aN(t,i.u_matrix),u_image:new e.aL(t,i.u_image),u_latrange:new e.aQ(t,i.u_latrange),u_light:new e.aQ(t,i.u_light),u_shadow:new e.aR(t,i.u_shadow),u_highlight:new e.aR(t,i.u_highlight),u_accent:new e.aR(t,i.u_accent)}),hillshadePrepare:(t,i)=>({u_matrix:new e.aN(t,i.u_matrix),u_image:new e.aL(t,i.u_image),u_dimension:new e.aQ(t,i.u_dimension),u_zoom:new e.aM(t,i.u_zoom),u_unpack:new e.aO(t,i.u_unpack)}),line:(t,i)=>({u_matrix:new e.aN(t,i.u_matrix),u_ratio:new e.aM(t,i.u_ratio),u_device_pixel_ratio:new e.aM(t,i.u_device_pixel_ratio),u_units_to_pixels:new e.aQ(t,i.u_units_to_pixels)}),lineGradient:(t,i)=>({u_matrix:new e.aN(t,i.u_matrix),u_ratio:new e.aM(t,i.u_ratio),u_device_pixel_ratio:new e.aM(t,i.u_device_pixel_ratio),u_units_to_pixels:new e.aQ(t,i.u_units_to_pixels),u_image:new e.aL(t,i.u_image),u_image_height:new e.aM(t,i.u_image_height)}),linePattern:(t,i)=>({u_matrix:new e.aN(t,i.u_matrix),u_texsize:new e.aQ(t,i.u_texsize),u_ratio:new e.aM(t,i.u_ratio),u_device_pixel_ratio:new e.aM(t,i.u_device_pixel_ratio),u_image:new e.aL(t,i.u_image),u_units_to_pixels:new e.aQ(t,i.u_units_to_pixels),u_scale:new e.aP(t,i.u_scale),u_fade:new e.aM(t,i.u_fade)}),lineSDF:(t,i)=>({u_matrix:new e.aN(t,i.u_matrix),u_ratio:new e.aM(t,i.u_ratio),u_device_pixel_ratio:new e.aM(t,i.u_device_pixel_ratio),u_units_to_pixels:new e.aQ(t,i.u_units_to_pixels),u_patternscale_a:new e.aQ(t,i.u_patternscale_a),u_patternscale_b:new e.aQ(t,i.u_patternscale_b),u_sdfgamma:new e.aM(t,i.u_sdfgamma),u_image:new e.aL(t,i.u_image),u_tex_y_a:new e.aM(t,i.u_tex_y_a),u_tex_y_b:new e.aM(t,i.u_tex_y_b),u_mix:new e.aM(t,i.u_mix)}),raster:(t,i)=>({u_matrix:new e.aN(t,i.u_matrix),u_tl_parent:new e.aQ(t,i.u_tl_parent),u_scale_parent:new e.aM(t,i.u_scale_parent),u_buffer_scale:new e.aM(t,i.u_buffer_scale),u_fade_t:new e.aM(t,i.u_fade_t),u_opacity:new e.aM(t,i.u_opacity),u_image0:new e.aL(t,i.u_image0),u_image1:new e.aL(t,i.u_image1),u_brightness_low:new e.aM(t,i.u_brightness_low),u_brightness_high:new e.aM(t,i.u_brightness_high),u_saturation_factor:new e.aM(t,i.u_saturation_factor),u_contrast_factor:new e.aM(t,i.u_contrast_factor),u_spin_weights:new e.aP(t,i.u_spin_weights)}),symbolIcon:(t,i)=>({u_is_size_zoom_constant:new e.aL(t,i.u_is_size_zoom_constant),u_is_size_feature_constant:new e.aL(t,i.u_is_size_feature_constant),u_size_t:new e.aM(t,i.u_size_t),u_size:new e.aM(t,i.u_size),u_camera_to_center_distance:new e.aM(t,i.u_camera_to_center_distance),u_pitch:new e.aM(t,i.u_pitch),u_rotate_symbol:new e.aL(t,i.u_rotate_symbol),u_aspect_ratio:new e.aM(t,i.u_aspect_ratio),u_fade_change:new e.aM(t,i.u_fade_change),u_matrix:new e.aN(t,i.u_matrix),u_label_plane_matrix:new e.aN(t,i.u_label_plane_matrix),u_coord_matrix:new e.aN(t,i.u_coord_matrix),u_is_text:new e.aL(t,i.u_is_text),u_pitch_with_map:new e.aL(t,i.u_pitch_with_map),u_texsize:new e.aQ(t,i.u_texsize),u_texture:new e.aL(t,i.u_texture)}),symbolSDF:(t,i)=>({u_is_size_zoom_constant:new e.aL(t,i.u_is_size_zoom_constant),u_is_size_feature_constant:new e.aL(t,i.u_is_size_feature_constant),u_size_t:new e.aM(t,i.u_size_t),u_size:new e.aM(t,i.u_size),u_camera_to_center_distance:new e.aM(t,i.u_camera_to_center_distance),u_pitch:new e.aM(t,i.u_pitch),u_rotate_symbol:new e.aL(t,i.u_rotate_symbol),u_aspect_ratio:new e.aM(t,i.u_aspect_ratio),u_fade_change:new e.aM(t,i.u_fade_change),u_matrix:new e.aN(t,i.u_matrix),u_label_plane_matrix:new e.aN(t,i.u_label_plane_matrix),u_coord_matrix:new e.aN(t,i.u_coord_matrix),u_is_text:new e.aL(t,i.u_is_text),u_pitch_with_map:new e.aL(t,i.u_pitch_with_map),u_texsize:new e.aQ(t,i.u_texsize),u_texture:new e.aL(t,i.u_texture),u_gamma_scale:new e.aM(t,i.u_gamma_scale),u_device_pixel_ratio:new e.aM(t,i.u_device_pixel_ratio),u_is_halo:new e.aL(t,i.u_is_halo)}),symbolTextAndIcon:(t,i)=>({u_is_size_zoom_constant:new e.aL(t,i.u_is_size_zoom_constant),u_is_size_feature_constant:new e.aL(t,i.u_is_size_feature_constant),u_size_t:new e.aM(t,i.u_size_t),u_size:new e.aM(t,i.u_size),u_camera_to_center_distance:new e.aM(t,i.u_camera_to_center_distance),u_pitch:new e.aM(t,i.u_pitch),u_rotate_symbol:new e.aL(t,i.u_rotate_symbol),u_aspect_ratio:new e.aM(t,i.u_aspect_ratio),u_fade_change:new e.aM(t,i.u_fade_change),u_matrix:new e.aN(t,i.u_matrix),u_label_plane_matrix:new e.aN(t,i.u_label_plane_matrix),u_coord_matrix:new e.aN(t,i.u_coord_matrix),u_is_text:new e.aL(t,i.u_is_text),u_pitch_with_map:new e.aL(t,i.u_pitch_with_map),u_texsize:new e.aQ(t,i.u_texsize),u_texsize_icon:new e.aQ(t,i.u_texsize_icon),u_texture:new e.aL(t,i.u_texture),u_texture_icon:new e.aL(t,i.u_texture_icon),u_gamma_scale:new e.aM(t,i.u_gamma_scale),u_device_pixel_ratio:new e.aM(t,i.u_device_pixel_ratio),u_is_halo:new e.aL(t,i.u_is_halo)}),background:(t,i)=>({u_matrix:new e.aN(t,i.u_matrix),u_opacity:new e.aM(t,i.u_opacity),u_color:new e.aR(t,i.u_color)}),backgroundPattern:(t,i)=>({u_matrix:new e.aN(t,i.u_matrix),u_opacity:new e.aM(t,i.u_opacity),u_image:new e.aL(t,i.u_image),u_pattern_tl_a:new e.aQ(t,i.u_pattern_tl_a),u_pattern_br_a:new e.aQ(t,i.u_pattern_br_a),u_pattern_tl_b:new e.aQ(t,i.u_pattern_tl_b),u_pattern_br_b:new e.aQ(t,i.u_pattern_br_b),u_texsize:new e.aQ(t,i.u_texsize),u_mix:new e.aM(t,i.u_mix),u_pattern_size_a:new e.aQ(t,i.u_pattern_size_a),u_pattern_size_b:new e.aQ(t,i.u_pattern_size_b),u_scale_a:new e.aM(t,i.u_scale_a),u_scale_b:new e.aM(t,i.u_scale_b),u_pixel_coord_upper:new e.aQ(t,i.u_pixel_coord_upper),u_pixel_coord_lower:new e.aQ(t,i.u_pixel_coord_lower),u_tile_units_to_pixels:new e.aM(t,i.u_tile_units_to_pixels)}),terrain:(t,i)=>({u_matrix:new e.aN(t,i.u_matrix),u_texture:new e.aL(t,i.u_texture),u_ele_delta:new e.aM(t,i.u_ele_delta)}),terrainDepth:(t,i)=>({u_matrix:new e.aN(t,i.u_matrix),u_ele_delta:new e.aM(t,i.u_ele_delta)}),terrainCoords:(t,i)=>({u_matrix:new e.aN(t,i.u_matrix),u_texture:new e.aL(t,i.u_texture),u_terrain_coords_id:new e.aM(t,i.u_terrain_coords_id),u_ele_delta:new e.aM(t,i.u_ele_delta)})};class Ot{constructor(e,t,i){this.context=e;const n=e.gl;this.buffer=n.createBuffer(),this.dynamicDraw=Boolean(i),this.context.unbindVAO(),e.bindElementBuffer.set(this.buffer),n.bufferData(n.ELEMENT_ARRAY_BUFFER,t.arrayBuffer,this.dynamicDraw?n.DYNAMIC_DRAW:n.STATIC_DRAW),this.dynamicDraw||delete t.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(e){const t=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),t.bufferSubData(t.ELEMENT_ARRAY_BUFFER,0,e.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Nt={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Vt{constructor(e,t,i,n){this.length=t.length,this.attributes=i,this.itemSize=t.bytesPerElement,this.dynamicDraw=n,this.context=e;const r=e.gl;this.buffer=r.createBuffer(),e.bindVertexBuffer.set(this.buffer),r.bufferData(r.ARRAY_BUFFER,t.arrayBuffer,this.dynamicDraw?r.DYNAMIC_DRAW:r.STATIC_DRAW),this.dynamicDraw||delete t.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(e){if(e.length!==this.length)throw new Error(`Length of new data is ${e.length}, which doesn't match current length of ${this.length}`);const t=this.context.gl;this.bind(),t.bufferSubData(t.ARRAY_BUFFER,0,e.arrayBuffer)}enableAttributes(e,t){for(let i=0;i<this.attributes.length;i++){const n=t.attributes[this.attributes[i].name];void 0!==n&&e.enableVertexAttribArray(n)}}setVertexAttribPointers(e,t,i){for(let n=0;n<this.attributes.length;n++){const r=this.attributes[n],a=t.attributes[r.name];void 0!==a&&e.vertexAttribPointer(a,r.components,e[Nt[r.type]],!1,this.itemSize,r.offset+this.itemSize*(i||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const jt=new WeakMap;function Ut(e){var t;if(jt.has(e))return jt.get(e);{const i=null===(t=e.getParameter(e.VERSION))||void 0===t?void 0:t.startsWith("WebGL 2.0");return jt.set(e,i),i}}class $t{constructor(e){this.gl=e.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(e){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class qt extends $t{getDefault(){return e.aT.transparent}set(e){const t=this.current;(e.r!==t.r||e.g!==t.g||e.b!==t.b||e.a!==t.a||this.dirty)&&(this.gl.clearColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}}class Zt extends $t{getDefault(){return 1}set(e){(e!==this.current||this.dirty)&&(this.gl.clearDepth(e),this.current=e,this.dirty=!1)}}class Gt extends $t{getDefault(){return 0}set(e){(e!==this.current||this.dirty)&&(this.gl.clearStencil(e),this.current=e,this.dirty=!1)}}class Wt extends $t{getDefault(){return[!0,!0,!0,!0]}set(e){const t=this.current;(e[0]!==t[0]||e[1]!==t[1]||e[2]!==t[2]||e[3]!==t[3]||this.dirty)&&(this.gl.colorMask(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}class Ht extends $t{getDefault(){return!0}set(e){(e!==this.current||this.dirty)&&(this.gl.depthMask(e),this.current=e,this.dirty=!1)}}class Xt extends $t{getDefault(){return 255}set(e){(e!==this.current||this.dirty)&&(this.gl.stencilMask(e),this.current=e,this.dirty=!1)}}class Kt extends $t{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(e){const t=this.current;(e.func!==t.func||e.ref!==t.ref||e.mask!==t.mask||this.dirty)&&(this.gl.stencilFunc(e.func,e.ref,e.mask),this.current=e,this.dirty=!1)}}class Yt extends $t{getDefault(){const e=this.gl;return[e.KEEP,e.KEEP,e.KEEP]}set(e){const t=this.current;(e[0]!==t[0]||e[1]!==t[1]||e[2]!==t[2]||this.dirty)&&(this.gl.stencilOp(e[0],e[1],e[2]),this.current=e,this.dirty=!1)}}class Jt extends $t{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;e?t.enable(t.STENCIL_TEST):t.disable(t.STENCIL_TEST),this.current=e,this.dirty=!1}}class Qt extends $t{getDefault(){return[0,1]}set(e){const t=this.current;(e[0]!==t[0]||e[1]!==t[1]||this.dirty)&&(this.gl.depthRange(e[0],e[1]),this.current=e,this.dirty=!1)}}class ei extends $t{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;e?t.enable(t.DEPTH_TEST):t.disable(t.DEPTH_TEST),this.current=e,this.dirty=!1}}class ti extends $t{getDefault(){return this.gl.LESS}set(e){(e!==this.current||this.dirty)&&(this.gl.depthFunc(e),this.current=e,this.dirty=!1)}}class ii extends $t{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;e?t.enable(t.BLEND):t.disable(t.BLEND),this.current=e,this.dirty=!1}}class ni extends $t{getDefault(){const e=this.gl;return[e.ONE,e.ZERO]}set(e){const t=this.current;(e[0]!==t[0]||e[1]!==t[1]||this.dirty)&&(this.gl.blendFunc(e[0],e[1]),this.current=e,this.dirty=!1)}}class ri extends $t{getDefault(){return e.aT.transparent}set(e){const t=this.current;(e.r!==t.r||e.g!==t.g||e.b!==t.b||e.a!==t.a||this.dirty)&&(this.gl.blendColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}}class ai extends $t{getDefault(){return this.gl.FUNC_ADD}set(e){(e!==this.current||this.dirty)&&(this.gl.blendEquation(e),this.current=e,this.dirty=!1)}}class si extends $t{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;e?t.enable(t.CULL_FACE):t.disable(t.CULL_FACE),this.current=e,this.dirty=!1}}class oi extends $t{getDefault(){return this.gl.BACK}set(e){(e!==this.current||this.dirty)&&(this.gl.cullFace(e),this.current=e,this.dirty=!1)}}class li extends $t{getDefault(){return this.gl.CCW}set(e){(e!==this.current||this.dirty)&&(this.gl.frontFace(e),this.current=e,this.dirty=!1)}}class ci extends $t{getDefault(){return null}set(e){(e!==this.current||this.dirty)&&(this.gl.useProgram(e),this.current=e,this.dirty=!1)}}class ui extends $t{getDefault(){return this.gl.TEXTURE0}set(e){(e!==this.current||this.dirty)&&(this.gl.activeTexture(e),this.current=e,this.dirty=!1)}}class hi extends $t{getDefault(){const e=this.gl;return[0,0,e.drawingBufferWidth,e.drawingBufferHeight]}set(e){const t=this.current;(e[0]!==t[0]||e[1]!==t[1]||e[2]!==t[2]||e[3]!==t[3]||this.dirty)&&(this.gl.viewport(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}class di extends $t{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;t.bindFramebuffer(t.FRAMEBUFFER,e),this.current=e,this.dirty=!1}}class pi extends $t{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;t.bindRenderbuffer(t.RENDERBUFFER,e),this.current=e,this.dirty=!1}}class fi extends $t{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;t.bindTexture(t.TEXTURE_2D,e),this.current=e,this.dirty=!1}}class mi extends $t{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;t.bindBuffer(t.ARRAY_BUFFER,e),this.current=e,this.dirty=!1}}class gi extends $t{getDefault(){return null}set(e){const t=this.gl;t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,e),this.current=e,this.dirty=!1}}class yi extends $t{getDefault(){return null}set(e){var t;if(e===this.current&&!this.dirty)return;const i=this.gl;Ut(i)?i.bindVertexArray(e):null===(t=i.getExtension("OES_vertex_array_object"))||void 0===t||t.bindVertexArrayOES(e),this.current=e,this.dirty=!1}}class _i extends $t{getDefault(){return 4}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;t.pixelStorei(t.UNPACK_ALIGNMENT,e),this.current=e,this.dirty=!1}}class vi extends $t{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e),this.current=e,this.dirty=!1}}class xi extends $t{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,e),this.current=e,this.dirty=!1}}class bi extends $t{constructor(e,t){super(e),this.context=e,this.parent=t}getDefault(){return null}}class wi extends bi{setDirty(){this.dirty=!0}set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const t=this.gl;t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e,0),this.current=e,this.dirty=!1}}class Si extends bi{set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const t=this.gl;t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.RENDERBUFFER,e),this.current=e,this.dirty=!1}}class Ti extends bi{set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const t=this.gl;t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.RENDERBUFFER,e),this.current=e,this.dirty=!1}}class ki{constructor(e,t,i,n,r){this.context=e,this.width=t,this.height=i;const a=e.gl,s=this.framebuffer=a.createFramebuffer();if(this.colorAttachment=new wi(e,s),n)this.depthAttachment=r?new Ti(e,s):new Si(e,s);else if(r)throw new Error("Stencil cannot be setted without depth");if(a.checkFramebufferStatus(a.FRAMEBUFFER)!==a.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer is not complete")}destroy(){const e=this.context.gl,t=this.colorAttachment.get();if(t&&e.deleteTexture(t),this.depthAttachment){const t=this.depthAttachment.get();t&&e.deleteRenderbuffer(t)}e.deleteFramebuffer(this.framebuffer)}}class Ei{constructor(e,t,i){this.blendFunction=e,this.blendColor=t,this.mask=i}}Ei.Replace=[1,0],Ei.disabled=new Ei(Ei.Replace,e.aT.transparent,[!1,!1,!1,!1]),Ei.unblended=new Ei(Ei.Replace,e.aT.transparent,[!0,!0,!0,!0]),Ei.alphaBlended=new Ei([1,771],e.aT.transparent,[!0,!0,!0,!0]);class Pi{constructor(e){var t,i;if(this.gl=e,this.clearColor=new qt(this),this.clearDepth=new Zt(this),this.clearStencil=new Gt(this),this.colorMask=new Wt(this),this.depthMask=new Ht(this),this.stencilMask=new Xt(this),this.stencilFunc=new Kt(this),this.stencilOp=new Yt(this),this.stencilTest=new Jt(this),this.depthRange=new Qt(this),this.depthTest=new ei(this),this.depthFunc=new ti(this),this.blend=new ii(this),this.blendFunc=new ni(this),this.blendColor=new ri(this),this.blendEquation=new ai(this),this.cullFace=new si(this),this.cullFaceSide=new oi(this),this.frontFace=new li(this),this.program=new ci(this),this.activeTexture=new ui(this),this.viewport=new hi(this),this.bindFramebuffer=new di(this),this.bindRenderbuffer=new pi(this),this.bindTexture=new fi(this),this.bindVertexBuffer=new mi(this),this.bindElementBuffer=new gi(this),this.bindVertexArray=new yi(this),this.pixelStoreUnpack=new _i(this),this.pixelStoreUnpackPremultiplyAlpha=new vi(this),this.pixelStoreUnpackFlipY=new xi(this),this.extTextureFilterAnisotropic=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=e.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=e.getParameter(e.MAX_TEXTURE_SIZE),Ut(e)){this.HALF_FLOAT=e.HALF_FLOAT;const n=e.getExtension("EXT_color_buffer_half_float");this.RGBA16F=null!==(t=e.RGBA16F)&&void 0!==t?t:null==n?void 0:n.RGBA16F_EXT,this.RGB16F=null!==(i=e.RGB16F)&&void 0!==i?i:null==n?void 0:n.RGB16F_EXT,e.getExtension("EXT_color_buffer_float")}else{e.getExtension("EXT_color_buffer_half_float"),e.getExtension("OES_texture_half_float_linear");const t=e.getExtension("OES_texture_half_float");this.HALF_FLOAT=null==t?void 0:t.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(e,t){return new Ot(this,e,t)}createVertexBuffer(e,t,i){return new Vt(this,e,t,i)}createRenderbuffer(e,t,i){const n=this.gl,r=n.createRenderbuffer();return this.bindRenderbuffer.set(r),n.renderbufferStorage(n.RENDERBUFFER,e,t,i),this.bindRenderbuffer.set(null),r}createFramebuffer(e,t,i,n){return new ki(this,e,t,i,n)}clear(e){let{color:t,depth:i,stencil:n}=e;const r=this.gl;let a=0;t&&(a|=r.COLOR_BUFFER_BIT,this.clearColor.set(t),this.colorMask.set([!0,!0,!0,!0])),void 0!==i&&(a|=r.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(i),this.depthMask.set(!0)),void 0!==n&&(a|=r.STENCIL_BUFFER_BIT,this.clearStencil.set(n),this.stencilMask.set(255)),r.clear(a)}setCullFace(e){!1===e.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(e.mode),this.frontFace.set(e.frontFace))}setDepthMode(e){e.func!==this.gl.ALWAYS||e.mask?(this.depthTest.set(!0),this.depthFunc.set(e.func),this.depthMask.set(e.mask),this.depthRange.set(e.range)):this.depthTest.set(!1)}setStencilMode(e){e.test.func!==this.gl.ALWAYS||e.mask?(this.stencilTest.set(!0),this.stencilMask.set(e.mask),this.stencilOp.set([e.fail,e.depthFail,e.pass]),this.stencilFunc.set({func:e.test.func,ref:e.ref,mask:e.test.mask})):this.stencilTest.set(!1)}setColorMode(t){e.aG(t.blendFunction,Ei.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(t.blendFunction),this.blendColor.set(t.blendColor)),this.colorMask.set(t.mask)}createVertexArray(){var e;return Ut(this.gl)?this.gl.createVertexArray():null===(e=this.gl.getExtension("OES_vertex_array_object"))||void 0===e?void 0:e.createVertexArrayOES()}deleteVertexArray(e){var t;return Ut(this.gl)?this.gl.deleteVertexArray(e):null===(t=this.gl.getExtension("OES_vertex_array_object"))||void 0===t?void 0:t.deleteVertexArrayOES(e)}unbindVAO(){this.bindVertexArray.set(null)}}class Ci{constructor(e,t,i){this.func=e,this.mask=t,this.range=i}}Ci.ReadOnly=!1,Ci.ReadWrite=!0,Ci.disabled=new Ci(519,Ci.ReadOnly,[0,1]);const Ii=7680;class Ai{constructor(e,t,i,n,r,a){this.test=e,this.ref=t,this.mask=i,this.fail=n,this.depthFail=r,this.pass=a}}Ai.disabled=new Ai({func:519,mask:0},0,0,Ii,Ii,Ii);class Mi{constructor(e,t,i){this.enable=e,this.mode=t,this.frontFace=i}}let zi;function Di(t,i,n,r,a,s,o){const l=t.context,c=l.gl,u=t.useProgram("collisionBox"),h=[];let d=0,p=0;for(let x=0;x<r.length;x++){const f=r[x],m=i.getTile(f),g=m.getBucket(n);if(!g)continue;let y=f.posMatrix;0===a[0]&&0===a[1]||(y=t.translatePosMatrix(f.posMatrix,m,a,s));const _=o?g.textCollisionBox:g.iconCollisionBox,v=g.collisionCircleArray;if(v.length>0){const i=e.Z(),n=y;e.aU(i,g.placementInvProjMatrix,t.transform.glCoordMatrix),e.aU(i,i,g.placementViewportMatrix),h.push({circleArray:v,circleOffset:p,transform:n,invTransform:i,coord:f}),d+=v.length/4,p=d}_&&u.draw(l,c.LINES,Ci.disabled,Ai.disabled,t.colorModeForRenderPass(),Mi.disabled,vt(y,t.transform,m),t.style.map.terrain&&t.style.map.terrain.getTerrainData(f),n.id,_.layoutVertexBuffer,_.indexBuffer,_.segments,null,t.transform.zoom,null,null,_.collisionVertexBuffer)}if(!o||!h.length)return;const f=t.useProgram("collisionCircle"),m=new e.aV;m.resize(4*d),m._trim();let g=0;for(const e of h)for(let t=0;t<e.circleArray.length/4;t++){const i=4*t,n=e.circleArray[i+0],r=e.circleArray[i+1],a=e.circleArray[i+2],s=e.circleArray[i+3];m.emplace(g++,n,r,a,s,0),m.emplace(g++,n,r,a,s,1),m.emplace(g++,n,r,a,s,2),m.emplace(g++,n,r,a,s,3)}(!zi||zi.length<2*d)&&(zi=function(t){const i=2*t,n=new e.aX;n.resize(i),n._trim();for(let e=0;e<i;e++){const t=6*e;n.uint16[t+0]=4*e+0,n.uint16[t+1]=4*e+1,n.uint16[t+2]=4*e+2,n.uint16[t+3]=4*e+2,n.uint16[t+4]=4*e+3,n.uint16[t+5]=4*e+0}return n}(d));const y=l.createIndexBuffer(zi,!0),_=l.createVertexBuffer(m,e.aW.members,!0);for(const x of h){const i={u_matrix:x.transform,u_inv_matrix:x.invTransform,u_camera_to_center_distance:(v=t.transform).cameraToCenterDistance,u_viewport_size:[v.width,v.height]};f.draw(l,c.TRIANGLES,Ci.disabled,Ai.disabled,t.colorModeForRenderPass(),Mi.disabled,i,t.style.map.terrain&&t.style.map.terrain.getTerrainData(x.coord),n.id,_,y,e.S.simpleSegment(0,2*x.circleOffset,x.circleArray.length,x.circleArray.length/2),null,t.transform.zoom,null,null,null)}var v;_.destroy(),y.destroy()}Mi.disabled=new Mi(!1,1029,2305),Mi.backCCW=new Mi(!0,1029,2305);const Li=e.ao(new Float32Array(16));function Ri(t,i,n,r,a,s){const{horizontalAlign:o,verticalAlign:l}=e.au(t);return new e.P((-(o-.5)*i/a+r[0])*s,(-(l-.5)*n/a+r[1])*s)}function Fi(t,i,n,r,a,s,o,l,c,u,h){const d=t.text.placedSymbolArray,p=t.text.dynamicLayoutVertexArray,f=t.icon.dynamicLayoutVertexArray,m={};p.clear();for(let g=0;g<d.length;g++){const f=d.get(g),y=f.hidden||!f.crossTileID||t.allowVerticalPlacement&&!f.placedOrientation?null:r[f.crossTileID];if(y){const r=new e.P(f.anchorX,f.anchorY),d=ce(r,n?o:s,h),g=ue(a.cameraToCenterDistance,d.signedDistanceFromCamera);let _=e.aj(t.textSizeData,c,f)*g/e.ap;n&&(_*=t.tilePixelRatio/l);const{width:v,height:x,anchor:b,textOffset:w,textBoxScale:S}=y,T=Ri(b,v,x,w,S,_),k=n?ce(r.add(T),s,h).point:d.point.add(i?T.rotate(-a.angle):T),E=t.allowVerticalPlacement&&f.placedOrientation===e.ai.vertical?Math.PI/2:0;for(let t=0;t<f.numGlyphs;t++)e.ak(p,k,E);u&&f.associatedIconIndex>=0&&(m[f.associatedIconIndex]={shiftedAnchor:k,angle:E})}else we(f.numGlyphs,p)}if(u){f.clear();const i=t.icon.placedSymbolArray;for(let t=0;t<i.length;t++){const n=i.get(t);if(n.hidden)we(n.numGlyphs,f);else{const i=m[t];if(i)for(let t=0;t<n.numGlyphs;t++)e.ak(f,i.shiftedAnchor,i.angle);else we(n.numGlyphs,f)}}t.icon.dynamicLayoutVertexBuffer.updateData(f)}t.text.dynamicLayoutVertexBuffer.updateData(p)}function Bi(e,t,i){return i.iconsInText&&t?"symbolTextAndIcon":e?"symbolSDF":"symbolIcon"}function Oi(t,i,n,r,a,s,o,l,c,u,h,d){const p=t.context,f=p.gl,m=t.transform,g="map"===l,y="map"===c,_="viewport"!==l&&"point"!==n.layout.get("symbol-placement"),v=g&&!y&&!_,x=!n.layout.get("symbol-sort-key").isConstant();let b=!1;const w=t.depthModeForSublayer(0,Ci.ReadOnly),S=n._unevaluatedLayout.hasValue("text-variable-anchor")||n._unevaluatedLayout.hasValue("text-variable-anchor-offset"),T=[];for(const k of r){const r=i.getTile(k),l=r.getBucket(n);if(!l)continue;const c=a?l.text:l.icon;if(!c||!c.segments.get().length||!c.hasVisibleVertices)continue;const h=c.programConfigurations.get(n.id),d=a||l.sdfIcons,p=a?l.textSizeData:l.iconSizeData,w=y||0!==m.pitch,E=t.useProgram(Bi(d,a,l),h),P=e.ah(p,m.zoom),C=t.style.map.terrain&&t.style.map.terrain.getTerrainData(k);let I,A,M,z,D=[0,0],L=null;if(a)A=r.glyphAtlasTexture,M=f.LINEAR,I=r.glyphAtlasTexture.size,l.iconsInText&&(D=r.imageAtlasTexture.size,L=r.imageAtlasTexture,z=w||t.options.rotating||t.options.zooming||"composite"===p.kind||"camera"===p.kind?f.LINEAR:f.NEAREST);else{const e=1!==n.layout.get("icon-size").constantOr(0)||l.iconsNeedLinear;A=r.imageAtlasTexture,M=d||t.options.rotating||t.options.zooming||e||w?f.LINEAR:f.NEAREST,I=r.imageAtlasTexture.size}const R=Ee(r,1,t.transform.zoom),F=oe(k.posMatrix,y,g,t.transform,R),B=le(k.posMatrix,y,g,t.transform,R),O=S&&l.hasTextData(),N="none"!==n.layout.get("icon-text-fit")&&O&&l.hasIconData();if(_){const e=t.style.map.terrain?(e,i)=>t.style.map.terrain.getElevation(k,e,i):null,i="map"===n.layout.get("text-rotation-alignment");de(l,k.posMatrix,t,a,F,B,y,u,i,e)}const V=t.translatePosMatrix(k.posMatrix,r,s,o),j=_||a&&S||N?Li:F,U=t.translatePosMatrix(B,r,s,o,!0),$=d&&0!==n.paint.get(a?"text-halo-width":"icon-halo-width").constantOr(1);let q;q=d?l.iconsInText?Lt(p.kind,P,v,y,t,V,j,U,I,D):Dt(p.kind,P,v,y,t,V,j,U,a,I,!0):zt(p.kind,P,v,y,t,V,j,U,a,I);const Z={program:E,buffers:c,uniformValues:q,atlasTexture:A,atlasTextureIcon:L,atlasInterpolation:M,atlasInterpolationIcon:z,isSDF:d,hasHalo:$};if(x&&l.canOverlap){b=!0;const t=c.segments.get();for(const i of t)T.push({segments:new e.S([i]),sortKey:i.sortKey,state:Z,terrainData:C})}else T.push({segments:c.segments,sortKey:0,state:Z,terrainData:C})}b&&T.sort(((e,t)=>e.sortKey-t.sortKey));for(const e of T){const i=e.state;if(p.activeTexture.set(f.TEXTURE0),i.atlasTexture.bind(i.atlasInterpolation,f.CLAMP_TO_EDGE),i.atlasTextureIcon&&(p.activeTexture.set(f.TEXTURE1),i.atlasTextureIcon&&i.atlasTextureIcon.bind(i.atlasInterpolationIcon,f.CLAMP_TO_EDGE)),i.isSDF){const r=i.uniformValues;i.hasHalo&&(r.u_is_halo=1,Ni(i.buffers,e.segments,n,t,i.program,w,h,d,r,e.terrainData)),r.u_is_halo=0}Ni(i.buffers,e.segments,n,t,i.program,w,h,d,i.uniformValues,e.terrainData)}}function Ni(e,t,i,n,r,a,s,o,l,c){const u=n.context;r.draw(u,u.gl.TRIANGLES,a,s,o,Mi.disabled,l,c,i.id,e.layoutVertexBuffer,e.indexBuffer,t,i.paint,n.transform.zoom,e.programConfigurations.get(i.id),e.dynamicLayoutVertexBuffer,e.opacityVertexBuffer)}function Vi(e,t,i,n,r){if(!i||!n||!n.imageAtlas)return;const a=n.imageAtlas.patternPositions;let s=a[i.to.toString()],o=a[i.from.toString()];if(!s&&o&&(s=o),!o&&s&&(o=s),!s||!o){const e=r.getPaintProperty(t);s=a[e],o=a[e]}s&&o&&e.setConstantPatternPositions(s,o)}function ji(e,t,i,n,r,a,s){const o=e.context.gl,l="fill-pattern",c=i.paint.get(l),u=c&&c.constantOr(1),h=i.getCrossfadeParameters();let d,p,f,m,g;s?(p=u&&!i.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",d=o.LINES):(p=u?"fillPattern":"fill",d=o.TRIANGLES);const y=c.constantOr(null);for(const _ of n){const n=t.getTile(_);if(u&&!n.patternsLoaded())continue;const c=n.getBucket(i);if(!c)continue;const v=c.programConfigurations.get(i.id),x=e.useProgram(p,v),b=e.style.map.terrain&&e.style.map.terrain.getTerrainData(_);u&&(e.context.activeTexture.set(o.TEXTURE0),n.imageAtlasTexture.bind(o.LINEAR,o.CLAMP_TO_EDGE),v.updatePaintBuffers(h)),Vi(v,l,y,n,i);const w=b?_:null,S=e.translatePosMatrix(w?w.posMatrix:_.posMatrix,n,i.paint.get("fill-translate"),i.paint.get("fill-translate-anchor"));if(s){m=c.indexBuffer2,g=c.segments2;const t=[o.drawingBufferWidth,o.drawingBufferHeight];f="fillOutlinePattern"===p&&u?yt(S,e,h,n,t):gt(S,t)}else m=c.indexBuffer,g=c.segments,f=u?mt(S,e,h,n):ft(S);x.draw(e.context,d,r,e.stencilModeForClipping(_),a,Mi.disabled,f,b,i.id,c.layoutVertexBuffer,m,g,i.paint,e.transform.zoom,v)}}function Ui(e,t,i,n,r,a,s){const o=e.context,l=o.gl,c="fill-extrusion-pattern",u=i.paint.get(c),h=u.constantOr(1),d=i.getCrossfadeParameters(),p=i.paint.get("fill-extrusion-opacity"),f=u.constantOr(null);for(const m of n){const n=t.getTile(m),u=n.getBucket(i);if(!u)continue;const g=e.style.map.terrain&&e.style.map.terrain.getTerrainData(m),y=u.programConfigurations.get(i.id),_=e.useProgram(h?"fillExtrusionPattern":"fillExtrusion",y);h&&(e.context.activeTexture.set(l.TEXTURE0),n.imageAtlasTexture.bind(l.LINEAR,l.CLAMP_TO_EDGE),y.updatePaintBuffers(d)),Vi(y,c,f,n,i);const v=e.translatePosMatrix(m.posMatrix,n,i.paint.get("fill-extrusion-translate"),i.paint.get("fill-extrusion-translate-anchor")),x=i.paint.get("fill-extrusion-vertical-gradient"),b=h?pt(v,e,x,p,m,d,n):dt(v,e,x,p);_.draw(o,o.gl.TRIANGLES,r,a,s,Mi.backCCW,b,g,i.id,u.layoutVertexBuffer,u.indexBuffer,u.segments,i.paint,e.transform.zoom,y,e.style.map.terrain&&u.centroidVertexBuffer)}}function $i(e,t,i,n,r,a,s){const o=e.context,l=o.gl,c=i.fbo;if(!c)return;const u=e.useProgram("hillshade"),h=e.style.map.terrain&&e.style.map.terrain.getTerrainData(t);o.activeTexture.set(l.TEXTURE0),l.bindTexture(l.TEXTURE_2D,c.colorAttachment.get()),u.draw(o,l.TRIANGLES,r,a,s,Mi.disabled,((e,t,i,n)=>{const r=i.paint.get("hillshade-shadow-color"),a=i.paint.get("hillshade-highlight-color"),s=i.paint.get("hillshade-accent-color");let o=i.paint.get("hillshade-illumination-direction")*(Math.PI/180);"viewport"===i.paint.get("hillshade-illumination-anchor")&&(o-=e.transform.angle);const l=!e.options.moving;return{u_matrix:n?n.posMatrix:e.transform.calculatePosMatrix(t.tileID.toUnwrapped(),l),u_image:0,u_latrange:St(0,t.tileID),u_light:[i.paint.get("hillshade-exaggeration"),o],u_shadow:r,u_highlight:a,u_accent:s}})(e,i,n,h?t:null),h,n.id,e.rasterBoundsBuffer,e.quadTriangleIndexBuffer,e.rasterBoundsSegments)}function qi(t,i,n,r,a,s){const o=t.context,l=o.gl,c=i.dem;if(c&&c.data){const u=c.dim,h=c.stride,d=c.getPixels();if(o.activeTexture.set(l.TEXTURE1),o.pixelStoreUnpackPremultiplyAlpha.set(!1),i.demTexture=i.demTexture||t.getTileTexture(h),i.demTexture){const e=i.demTexture;e.update(d,{premultiply:!1}),e.bind(l.NEAREST,l.CLAMP_TO_EDGE)}else i.demTexture=new v(o,d,l.RGBA,{premultiply:!1}),i.demTexture.bind(l.NEAREST,l.CLAMP_TO_EDGE);o.activeTexture.set(l.TEXTURE0);let p=i.fbo;if(!p){const e=new v(o,{width:u,height:u,data:null},l.RGBA);e.bind(l.LINEAR,l.CLAMP_TO_EDGE),p=i.fbo=o.createFramebuffer(u,u,!0,!1),p.colorAttachment.set(e.texture)}o.bindFramebuffer.set(p.framebuffer),o.viewport.set([0,0,u,u]),t.useProgram("hillshadePrepare").draw(o,l.TRIANGLES,r,a,s,Mi.disabled,((t,i)=>{const n=i.stride,r=e.Z();return e.aS(r,0,e.N,-e.N,0,0,1),e.$(r,r,[0,-e.N,0]),{u_matrix:r,u_image:1,u_dimension:[n,n],u_zoom:t.overscaledZ,u_unpack:i.getUnpackVector()}})(i.tileID,c),null,n.id,t.rasterBoundsBuffer,t.quadTriangleIndexBuffer,t.rasterBoundsSegments),i.needsHillshadePrepare=!1}}function Zi(t,i,n,r,a,s){const o=r.paint.get("raster-fade-duration");if(!s&&o>0){const r=e.h.now(),s=(r-t.timeAdded)/o,l=i?(r-i.timeAdded)/o:-1,c=n.getSource(),u=a.coveringZoomLevel({tileSize:c.tileSize,roundZoom:c.roundZoom}),h=!i||Math.abs(i.tileID.overscaledZ-u)>Math.abs(t.tileID.overscaledZ-u),d=h&&t.refreshedUponExpiration?1:e.ad(h?s:1-l,0,1);return t.refreshedUponExpiration&&s>=1&&(t.refreshedUponExpiration=!1),i?{opacity:1,mix:1-d}:{opacity:d,mix:0}}return{opacity:1,mix:0}}const Gi=new e.aT(1,0,0,1),Wi=new e.aT(0,1,0,1),Hi=new e.aT(0,0,1,1),Xi=new e.aT(1,0,1,1),Ki=new e.aT(0,1,1,1);function Yi(e,t,i,n){Qi(e,0,t+i/2,e.transform.width,i,n)}function Ji(e,t,i,n){Qi(e,t-i/2,0,i,e.transform.height,n)}function Qi(e,t,i,n,r,a){const s=e.context,o=s.gl;o.enable(o.SCISSOR_TEST),o.scissor(t*e.pixelRatio,i*e.pixelRatio,n*e.pixelRatio,r*e.pixelRatio),s.clear({color:a}),o.disable(o.SCISSOR_TEST)}function en(t,i,n){const r=t.context,a=r.gl,s=n.posMatrix,o=t.useProgram("debug"),l=Ci.disabled,c=Ai.disabled,u=t.colorModeForRenderPass(),h="$debug",d=t.style.map.terrain&&t.style.map.terrain.getTerrainData(n);r.activeTexture.set(a.TEXTURE0);const p=i.getTileByID(n.key).latestRawTileData,f=Math.floor((p&&p.byteLength||0)/1024),m=i.getTile(n).tileSize,g=512/Math.min(m,512)*(n.overscaledZ/t.transform.zoom)*.5;let y=n.canonical.toString();n.overscaledZ!==n.canonical.z&&(y+=` => ${n.overscaledZ}`),function(e,t){e.initDebugOverlayCanvas();const i=e.debugOverlayCanvas,n=e.context.gl,r=e.debugOverlayCanvas.getContext("2d");r.clearRect(0,0,i.width,i.height),r.shadowColor="white",r.shadowBlur=2,r.lineWidth=1.5,r.strokeStyle="white",r.textBaseline="top",r.font="bold 36px Open Sans, sans-serif",r.fillText(t,5,5),r.strokeText(t,5,5),e.debugOverlayTexture.update(i),e.debugOverlayTexture.bind(n.LINEAR,n.CLAMP_TO_EDGE)}(t,`${y} ${f}kB`),o.draw(r,a.TRIANGLES,l,c,Ei.alphaBlended,Mi.disabled,xt(s,e.aT.transparent,g),null,h,t.debugBuffer,t.quadTriangleIndexBuffer,t.debugSegments),o.draw(r,a.LINE_STRIP,l,c,u,Mi.disabled,xt(s,e.aT.red),d,h,t.debugBuffer,t.tileBorderIndexBuffer,t.debugSegments)}function tn(e,t,i){const n=e.context,r=n.gl,a=e.colorModeForRenderPass(),s=new Ci(r.LEQUAL,Ci.ReadWrite,e.depthRangeFor3D),o=e.useProgram("terrain"),l=t.getTerrainMesh();n.bindFramebuffer.set(null),n.viewport.set([0,0,e.width,e.height]);for(const c of i){const i=e.renderToTexture.getTexture(c),u=t.getTerrainData(c.tileID);n.activeTexture.set(r.TEXTURE0),r.bindTexture(r.TEXTURE_2D,i.texture);const h={u_matrix:e.transform.calculatePosMatrix(c.tileID.toUnwrapped()),u_texture:0,u_ele_delta:t.getMeshFrameDelta(e.transform.zoom)};o.draw(n,r.TRIANGLES,s,Ai.disabled,a,Mi.backCCW,h,u,"terrain",l.vertexBuffer,l.indexBuffer,l.segments)}}class nn{constructor(t,i){this.context=new Pi(t),this.transform=i,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:e.Z(),renderTime:0},this.setup(),this.numSublayers=K.maxUnderzooming+K.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Je}resize(e,t,i){if(this.width=Math.floor(e*i),this.height=Math.floor(t*i),this.pixelRatio=i,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const n of this.style._order)this.style._layers[n].resize()}setup(){const t=this.context,i=new e.a_;i.emplaceBack(0,0),i.emplaceBack(e.N,0),i.emplaceBack(0,e.N),i.emplaceBack(e.N,e.N),this.tileExtentBuffer=t.createVertexBuffer(i,rt.members),this.tileExtentSegments=e.S.simpleSegment(0,0,4,2);const n=new e.a_;n.emplaceBack(0,0),n.emplaceBack(e.N,0),n.emplaceBack(0,e.N),n.emplaceBack(e.N,e.N),this.debugBuffer=t.createVertexBuffer(n,rt.members),this.debugSegments=e.S.simpleSegment(0,0,4,5);const r=new e.V;r.emplaceBack(0,0,0,0),r.emplaceBack(e.N,0,e.N,0),r.emplaceBack(0,e.N,0,e.N),r.emplaceBack(e.N,e.N,e.N,e.N),this.rasterBoundsBuffer=t.createVertexBuffer(r,O.members),this.rasterBoundsSegments=e.S.simpleSegment(0,0,4,2);const a=new e.a_;a.emplaceBack(0,0),a.emplaceBack(1,0),a.emplaceBack(0,1),a.emplaceBack(1,1),this.viewportBuffer=t.createVertexBuffer(a,rt.members),this.viewportSegments=e.S.simpleSegment(0,0,4,2);const s=new e.a$;s.emplaceBack(0),s.emplaceBack(1),s.emplaceBack(3),s.emplaceBack(2),s.emplaceBack(0),this.tileBorderIndexBuffer=t.createIndexBuffer(s);const o=new e.b0;o.emplaceBack(0,1,2),o.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=t.createIndexBuffer(o);const l=this.context.gl;this.stencilClearMode=new Ai({func:l.ALWAYS,mask:0},0,255,l.ZERO,l.ZERO,l.ZERO)}clearStencil(){const t=this.context,i=t.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const n=e.Z();e.aS(n,0,this.width,this.height,0,0,1),e.a0(n,n,[i.drawingBufferWidth,i.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(t,i.TRIANGLES,Ci.disabled,this.stencilClearMode,Ei.disabled,Mi.disabled,bt(n),null,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(e,t){if(this.currentStencilSource===e.source||!e.isTileClipped()||!t||!t.length)return;this.currentStencilSource=e.source;const i=this.context,n=i.gl;this.nextStencilID+t.length>256&&this.clearStencil(),i.setColorMode(Ei.disabled),i.setDepthMode(Ci.disabled);const r=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const a of t){const e=this._tileClippingMaskIDs[a.key]=this.nextStencilID++,t=this.style.map.terrain&&this.style.map.terrain.getTerrainData(a);r.draw(i,n.TRIANGLES,Ci.disabled,new Ai({func:n.ALWAYS,mask:0},e,255,n.KEEP,n.KEEP,n.REPLACE),Ei.disabled,Mi.disabled,bt(a.posMatrix),t,"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const e=this.nextStencilID++,t=this.context.gl;return new Ai({func:t.NOTEQUAL,mask:255},e,255,t.KEEP,t.KEEP,t.REPLACE)}stencilModeForClipping(e){const t=this.context.gl;return new Ai({func:t.EQUAL,mask:255},this._tileClippingMaskIDs[e.key],0,t.KEEP,t.KEEP,t.REPLACE)}stencilConfigForOverlap(e){const t=this.context.gl,i=e.sort(((e,t)=>t.overscaledZ-e.overscaledZ)),n=i[i.length-1].overscaledZ,r=i[0].overscaledZ-n+1;if(r>1){this.currentStencilSource=void 0,this.nextStencilID+r>256&&this.clearStencil();const e={};for(let i=0;i<r;i++)e[i+n]=new Ai({func:t.GEQUAL,mask:255},i+this.nextStencilID,255,t.KEEP,t.KEEP,t.REPLACE);return this.nextStencilID+=r,[e,i]}return[{[n]:Ai.disabled},i]}colorModeForRenderPass(){const t=this.context.gl;if(this._showOverdrawInspector){const i=1/8;return new Ei([t.CONSTANT_COLOR,t.ONE],new e.aT(i,i,i,0),[!0,!0,!0,!0])}return"opaque"===this.renderPass?Ei.unblended:Ei.alphaBlended}depthModeForSublayer(e,t,i){if(!this.opaquePassEnabledForLayer())return Ci.disabled;const n=1-((1+this.currentLayer)*this.numSublayers+e)*this.depthEpsilon;return new Ci(i||this.context.gl.LEQUAL,t,[n,n])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(t,i){this.style=t,this.options=i,this.lineAtlas=t.lineAtlas,this.imageManager=t.imageManager,this.glyphManager=t.glyphManager,this.symbolFadeChange=t.placement.symbolFadeChange(e.h.now()),this.imageManager.beginFrame();const n=this.style._order,r=this.style.sourceCaches,a={},s={},o={};for(const e in r){const t=r[e];t.used&&t.prepare(this.context),a[e]=t.getVisibleCoordinates(),s[e]=a[e].slice().reverse(),o[e]=t.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let e=0;e<n.length;e++)if(this.style._layers[n[e]].is3D()){this.opaquePassCutoff=e;break}if(this.renderToTexture){this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0;const t=this.style.map.terrain.sourceCache.tilesAfterTime(this.terrainFacilitator.renderTime);(this.terrainFacilitator.dirty||!e.b1(this.terrainFacilitator.matrix,this.transform.projMatrix)||t.length)&&(e.b2(this.terrainFacilitator.matrix,this.transform.projMatrix),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(t,i){const n=t.context,r=n.gl,a=Ei.unblended,s=new Ci(r.LEQUAL,Ci.ReadWrite,[0,1]),o=i.getTerrainMesh(),l=i.sourceCache.getRenderableTiles(),c=t.useProgram("terrainDepth");n.bindFramebuffer.set(i.getFramebuffer("depth").framebuffer),n.viewport.set([0,0,t.width/devicePixelRatio,t.height/devicePixelRatio]),n.clear({color:e.aT.transparent,depth:1});for(const e of l){const l=i.getTerrainData(e.tileID),u={u_matrix:t.transform.calculatePosMatrix(e.tileID.toUnwrapped()),u_ele_delta:i.getMeshFrameDelta(t.transform.zoom)};c.draw(n,r.TRIANGLES,s,Ai.disabled,a,Mi.backCCW,u,l,"terrain",o.vertexBuffer,o.indexBuffer,o.segments)}n.bindFramebuffer.set(null),n.viewport.set([0,0,t.width,t.height])}(this,this.style.map.terrain),function(t,i){const n=t.context,r=n.gl,a=Ei.unblended,s=new Ci(r.LEQUAL,Ci.ReadWrite,[0,1]),o=i.getTerrainMesh(),l=i.getCoordsTexture(),c=i.sourceCache.getRenderableTiles(),u=t.useProgram("terrainCoords");n.bindFramebuffer.set(i.getFramebuffer("coords").framebuffer),n.viewport.set([0,0,t.width/devicePixelRatio,t.height/devicePixelRatio]),n.clear({color:e.aT.transparent,depth:1}),i.coordsIndex=[];for(const e of c){const c=i.getTerrainData(e.tileID);n.activeTexture.set(r.TEXTURE0),r.bindTexture(r.TEXTURE_2D,l.texture);const h={u_matrix:t.transform.calculatePosMatrix(e.tileID.toUnwrapped()),u_terrain_coords_id:(255-i.coordsIndex.length)/255,u_texture:0,u_ele_delta:i.getMeshFrameDelta(t.transform.zoom)};u.draw(n,r.TRIANGLES,s,Ai.disabled,a,Mi.backCCW,h,c,"terrain",o.vertexBuffer,o.indexBuffer,o.segments),i.coordsIndex.push(e.tileID.key)}n.bindFramebuffer.set(null),n.viewport.set([0,0,t.width,t.height])}(this,this.style.map.terrain))}this.renderPass="offscreen";for(const e of n){const t=this.style._layers[e];if(!t.hasOffscreenPass()||t.isHidden(this.transform.zoom))continue;const i=s[t.source];("custom"===t.type||i.length)&&this.renderLayer(this,r[t.source],t,i)}if(this.context.bindFramebuffer.set(null),this.context.clear({color:i.showOverdrawInspector?e.aT.black:e.aT.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=i.showOverdrawInspector,this.depthRangeFor3D=[0,1-(t._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=n.length-1;this.currentLayer>=0;this.currentLayer--){const e=this.style._layers[n[this.currentLayer]],t=r[e.source],i=a[e.source];this._renderTileClippingMasks(e,i),this.renderLayer(this,t,e,i)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<n.length;this.currentLayer++){const e=this.style._layers[n[this.currentLayer]],t=r[e.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(e))continue;const i=("symbol"===e.type?o:s)[e.source];this._renderTileClippingMasks(e,a[e.source]),this.renderLayer(this,t,e,i)}if(this.options.showTileBoundaries){const e=function(e,t){let i=null;const n=Object.values(e._layers).flatMap((i=>i.source&&!i.isHidden(t)?[e.sourceCaches[i.source]]:[])),r=n.filter((e=>"vector"===e.getSource().type)),a=n.filter((e=>"vector"!==e.getSource().type)),s=e=>{(!i||i.getSource().maxzoom<e.getSource().maxzoom)&&(i=e)};return r.forEach((e=>s(e))),i||a.forEach((e=>s(e))),i}(this.style,this.transform.zoom);e&&function(e,t,i){for(let n=0;n<i.length;n++)en(e,t,i[n])}(this,e,e.getVisibleCoordinates())}this.options.showPadding&&function(e){const t=e.transform.padding;Yi(e,e.transform.height-(t.top||0),3,Gi),Yi(e,t.bottom||0,3,Wi),Ji(e,t.left||0,3,Hi),Ji(e,e.transform.width-(t.right||0),3,Xi);const i=e.transform.centerPoint;!function(e,t,i,n){Qi(e,t-1,i-10,2,20,n),Qi(e,t-10,i-1,20,2,n)}(e,i.x,e.transform.height-i.y,Ki)}(this),this.context.setDefault()}renderLayer(t,i,n,r){if(!n.isHidden(this.transform.zoom)&&("background"===n.type||"custom"===n.type||(r||[]).length))switch(this.id=n.id,n.type){case"symbol":!function(t,i,n,r,a){if("translucent"!==t.renderPass)return;const s=Ai.disabled,o=t.colorModeForRenderPass();(n._unevaluatedLayout.hasValue("text-variable-anchor")||n._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(t,i,n,r,a,s,o){const l=i.transform,c="map"===a,u="map"===s;for(const h of t){const t=r.getTile(h),a=t.getBucket(n);if(!a||!a.text||!a.text.segments.get().length)continue;const s=e.ah(a.textSizeData,l.zoom),d=Ee(t,1,i.transform.zoom),p=oe(h.posMatrix,u,c,i.transform,d),f="none"!==n.layout.get("icon-text-fit")&&a.hasIconData();if(s){const e=Math.pow(2,l.zoom-t.tileID.overscaledZ);Fi(a,c,u,o,l,p,h.posMatrix,e,s,f,i.style.map.terrain?(e,t)=>i.style.map.terrain.getElevation(h,e,t):null)}}}(r,t,n,i,n.layout.get("text-rotation-alignment"),n.layout.get("text-pitch-alignment"),a),0!==n.paint.get("icon-opacity").constantOr(1)&&Oi(t,i,n,r,!1,n.paint.get("icon-translate"),n.paint.get("icon-translate-anchor"),n.layout.get("icon-rotation-alignment"),n.layout.get("icon-pitch-alignment"),n.layout.get("icon-keep-upright"),s,o),0!==n.paint.get("text-opacity").constantOr(1)&&Oi(t,i,n,r,!0,n.paint.get("text-translate"),n.paint.get("text-translate-anchor"),n.layout.get("text-rotation-alignment"),n.layout.get("text-pitch-alignment"),n.layout.get("text-keep-upright"),s,o),i.map.showCollisionBoxes&&(Di(t,i,n,r,n.paint.get("text-translate"),n.paint.get("text-translate-anchor"),!0),Di(t,i,n,r,n.paint.get("icon-translate"),n.paint.get("icon-translate-anchor"),!1))}(t,i,n,r,this.style.placement.variableOffsets);break;case"circle":!function(t,i,n,r){if("translucent"!==t.renderPass)return;const a=n.paint.get("circle-opacity"),s=n.paint.get("circle-stroke-width"),o=n.paint.get("circle-stroke-opacity"),l=!n.layout.get("circle-sort-key").isConstant();if(0===a.constantOr(1)&&(0===s.constantOr(1)||0===o.constantOr(1)))return;const c=t.context,u=c.gl,h=t.depthModeForSublayer(0,Ci.ReadOnly),d=Ai.disabled,p=t.colorModeForRenderPass(),f=[];for(let m=0;m<r.length;m++){const a=r[m],s=i.getTile(a),o=s.getBucket(n);if(!o)continue;const c=o.programConfigurations.get(n.id),u=t.useProgram("circle",c),h=o.layoutVertexBuffer,d=o.indexBuffer,p=t.style.map.terrain&&t.style.map.terrain.getTerrainData(a),g={programConfiguration:c,program:u,layoutVertexBuffer:h,indexBuffer:d,uniformValues:_t(t,a,s,n),terrainData:p};if(l){const t=o.segments.get();for(const i of t)f.push({segments:new e.S([i]),sortKey:i.sortKey,state:g})}else f.push({segments:o.segments,sortKey:0,state:g})}l&&f.sort(((e,t)=>e.sortKey-t.sortKey));for(const e of f){const{programConfiguration:i,program:r,layoutVertexBuffer:a,indexBuffer:s,uniformValues:o,terrainData:l}=e.state;r.draw(c,u.TRIANGLES,h,d,p,Mi.disabled,o,l,n.id,a,s,e.segments,n.paint,t.transform.zoom,i)}}(t,i,n,r);break;case"heatmap":!function(t,i,n,r){if(0!==n.paint.get("heatmap-opacity"))if("offscreen"===t.renderPass){const a=t.context,s=a.gl,o=Ai.disabled,l=new Ei([s.ONE,s.ONE],e.aT.transparent,[!0,!0,!0,!0]);!function(e,t,i){const n=e.gl;e.activeTexture.set(n.TEXTURE1),e.viewport.set([0,0,t.width/4,t.height/4]);let r=i.heatmapFbo;if(r)n.bindTexture(n.TEXTURE_2D,r.colorAttachment.get()),e.bindFramebuffer.set(r.framebuffer);else{const a=n.createTexture();n.bindTexture(n.TEXTURE_2D,a),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.LINEAR),r=i.heatmapFbo=e.createFramebuffer(t.width/4,t.height/4,!1,!1),function(e,t,i,n){var r,a;const s=e.gl,o=null!==(r=e.HALF_FLOAT)&&void 0!==r?r:s.UNSIGNED_BYTE,l=null!==(a=e.RGBA16F)&&void 0!==a?a:s.RGBA;s.texImage2D(s.TEXTURE_2D,0,l,t.width/4,t.height/4,0,s.RGBA,o,null),n.colorAttachment.set(i)}(e,t,a,r)}}(a,t,n),a.clear({color:e.aT.transparent});for(let e=0;e<r.length;e++){const c=r[e];if(i.hasRenderableParent(c))continue;const u=i.getTile(c),h=u.getBucket(n);if(!h)continue;const d=h.programConfigurations.get(n.id),p=t.useProgram("heatmap",d),{zoom:f}=t.transform;p.draw(a,s.TRIANGLES,Ci.disabled,o,l,Mi.disabled,wt(c.posMatrix,u,f,n.paint.get("heatmap-intensity")),null,n.id,h.layoutVertexBuffer,h.indexBuffer,h.segments,n.paint,t.transform.zoom,d)}a.viewport.set([0,0,t.width,t.height])}else"translucent"===t.renderPass&&(t.context.setColorMode(t.colorModeForRenderPass()),function(t,i){const n=t.context,r=n.gl,a=i.heatmapFbo;if(!a)return;n.activeTexture.set(r.TEXTURE0),r.bindTexture(r.TEXTURE_2D,a.colorAttachment.get()),n.activeTexture.set(r.TEXTURE1);let s=i.colorRampTexture;s||(s=i.colorRampTexture=new v(n,i.colorRamp,r.RGBA)),s.bind(r.LINEAR,r.CLAMP_TO_EDGE),t.useProgram("heatmapTexture").draw(n,r.TRIANGLES,Ci.disabled,Ai.disabled,t.colorModeForRenderPass(),Mi.disabled,((t,i)=>{const n=e.Z();e.aS(n,0,t.width,t.height,0,0,1);const r=t.context.gl;return{u_matrix:n,u_world:[r.drawingBufferWidth,r.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:i.paint.get("heatmap-opacity")}})(t,i),null,i.id,t.viewportBuffer,t.quadTriangleIndexBuffer,t.viewportSegments,i.paint,t.transform.zoom)}(t,n))}(t,i,n,r);break;case"line":!function(t,i,n,r){if("translucent"!==t.renderPass)return;const a=n.paint.get("line-opacity"),s=n.paint.get("line-width");if(0===a.constantOr(1)||0===s.constantOr(1))return;const o=t.depthModeForSublayer(0,Ci.ReadOnly),l=t.colorModeForRenderPass(),c=n.paint.get("line-dasharray"),u=n.paint.get("line-pattern"),h=u.constantOr(1),d=n.paint.get("line-gradient"),p=n.getCrossfadeParameters(),f=h?"linePattern":c?"lineSDF":d?"lineGradient":"line",m=t.context,g=m.gl;let y=!0;for(const _ of r){const r=i.getTile(_);if(h&&!r.patternsLoaded())continue;const a=r.getBucket(n);if(!a)continue;const s=a.programConfigurations.get(n.id),x=t.context.program.get(),b=t.useProgram(f,s),w=y||b.program!==x,S=t.style.map.terrain&&t.style.map.terrain.getTerrainData(_),T=u.constantOr(null);if(T&&r.imageAtlas){const e=r.imageAtlas,t=e.patternPositions[T.to.toString()],i=e.patternPositions[T.from.toString()];t&&i&&s.setConstantPatternPositions(t,i)}const k=S?_:null,E=h?Et(t,r,n,p,k):c?Pt(t,r,n,c,p,k):d?kt(t,r,n,a.lineClipsArray.length,k):Tt(t,r,n,k);if(h)m.activeTexture.set(g.TEXTURE0),r.imageAtlasTexture.bind(g.LINEAR,g.CLAMP_TO_EDGE),s.updatePaintBuffers(p);else if(c&&(w||t.lineAtlas.dirty))m.activeTexture.set(g.TEXTURE0),t.lineAtlas.bind(m);else if(d){const r=a.gradients[n.id];let s=r.texture;if(n.gradientVersion!==r.version){let o=256;if(n.stepInterpolant){const n=i.getSource().maxzoom,r=_.canonical.z===n?Math.ceil(1<<t.transform.maxZoom-_.canonical.z):1;o=e.ad(e.aY(a.maxLineLength/e.N*1024*r),256,m.maxTextureSize)}r.gradient=e.aZ({expression:n.gradientExpression(),evaluationKey:"lineProgress",resolution:o,image:r.gradient||void 0,clips:a.lineClipsArray}),r.texture?r.texture.update(r.gradient):r.texture=new v(m,r.gradient,g.RGBA),r.version=n.gradientVersion,s=r.texture}m.activeTexture.set(g.TEXTURE0),s.bind(n.stepInterpolant?g.NEAREST:g.LINEAR,g.CLAMP_TO_EDGE)}b.draw(m,g.TRIANGLES,o,t.stencilModeForClipping(_),l,Mi.disabled,E,S,n.id,a.layoutVertexBuffer,a.indexBuffer,a.segments,n.paint,t.transform.zoom,s,a.layoutVertexBuffer2),y=!1}}(t,i,n,r);break;case"fill":!function(t,i,n,r){const a=n.paint.get("fill-color"),s=n.paint.get("fill-opacity");if(0===s.constantOr(1))return;const o=t.colorModeForRenderPass(),l=n.paint.get("fill-pattern"),c=t.opaquePassEnabledForLayer()&&!l.constantOr(1)&&1===a.constantOr(e.aT.transparent).a&&1===s.constantOr(0)?"opaque":"translucent";if(t.renderPass===c){const e=t.depthModeForSublayer(1,"opaque"===t.renderPass?Ci.ReadWrite:Ci.ReadOnly);ji(t,i,n,r,e,o,!1)}if("translucent"===t.renderPass&&n.paint.get("fill-antialias")){const e=t.depthModeForSublayer(n.getPaintProperty("fill-outline-color")?2:0,Ci.ReadOnly);ji(t,i,n,r,e,o,!0)}}(t,i,n,r);break;case"fill-extrusion":!function(e,t,i,n){const r=i.paint.get("fill-extrusion-opacity");if(0!==r&&"translucent"===e.renderPass){const a=new Ci(e.context.gl.LEQUAL,Ci.ReadWrite,e.depthRangeFor3D);if(1!==r||i.paint.get("fill-extrusion-pattern").constantOr(1))Ui(e,t,i,n,a,Ai.disabled,Ei.disabled),Ui(e,t,i,n,a,e.stencilModeFor3D(),e.colorModeForRenderPass());else{const r=e.colorModeForRenderPass();Ui(e,t,i,n,a,Ai.disabled,r)}}}(t,i,n,r);break;case"hillshade":!function(e,t,i,n){if("offscreen"!==e.renderPass&&"translucent"!==e.renderPass)return;const r=e.context,a=e.depthModeForSublayer(0,Ci.ReadOnly),s=e.colorModeForRenderPass(),[o,l]="translucent"===e.renderPass?e.stencilConfigForOverlap(n):[{},n];for(const c of l){const n=t.getTile(c);void 0!==n.needsHillshadePrepare&&n.needsHillshadePrepare&&"offscreen"===e.renderPass?qi(e,n,i,a,Ai.disabled,s):"translucent"===e.renderPass&&$i(e,c,n,i,a,o[c.overscaledZ],s)}r.viewport.set([0,0,e.width,e.height])}(t,i,n,r);break;case"raster":!function(e,t,i,n){if("translucent"!==e.renderPass)return;if(0===i.paint.get("raster-opacity"))return;if(!n.length)return;const r=e.context,a=r.gl,s=t.getSource(),o=e.useProgram("raster"),l=e.colorModeForRenderPass(),[c,u]=s instanceof N?[{},n]:e.stencilConfigForOverlap(n),h=u[u.length-1].overscaledZ,d=!e.options.moving;for(const p of u){const n=e.depthModeForSublayer(p.overscaledZ-h,1===i.paint.get("raster-opacity")?Ci.ReadWrite:Ci.ReadOnly,a.LESS),u=t.getTile(p);u.registerFadeDuration(i.paint.get("raster-fade-duration"));const f=t.findLoadedParent(p,0),m=Zi(u,f,t,i,e.transform,e.style.map.terrain);let g,y;const _="nearest"===i.paint.get("raster-resampling")?a.NEAREST:a.LINEAR;r.activeTexture.set(a.TEXTURE0),u.texture.bind(_,a.CLAMP_TO_EDGE,a.LINEAR_MIPMAP_NEAREST),r.activeTexture.set(a.TEXTURE1),f?(f.texture.bind(_,a.CLAMP_TO_EDGE,a.LINEAR_MIPMAP_NEAREST),g=Math.pow(2,f.tileID.overscaledZ-u.tileID.overscaledZ),y=[u.tileID.canonical.x*g%1,u.tileID.canonical.y*g%1]):u.texture.bind(_,a.CLAMP_TO_EDGE,a.LINEAR_MIPMAP_NEAREST);const v=e.style.map.terrain&&e.style.map.terrain.getTerrainData(p),x=v?p:null,b=x?x.posMatrix:e.transform.calculatePosMatrix(p.toUnwrapped(),d),w=At(b,y||[0,0],g||1,m,i);s instanceof N?o.draw(r,a.TRIANGLES,n,Ai.disabled,l,Mi.disabled,w,v,i.id,s.boundsBuffer,e.quadTriangleIndexBuffer,s.boundsSegments):o.draw(r,a.TRIANGLES,n,c[p.overscaledZ],l,Mi.disabled,w,v,i.id,e.rasterBoundsBuffer,e.quadTriangleIndexBuffer,e.rasterBoundsSegments)}}(t,i,n,r);break;case"background":!function(e,t,i,n){const r=i.paint.get("background-color"),a=i.paint.get("background-opacity");if(0===a)return;const s=e.context,o=s.gl,l=e.transform,c=l.tileSize,u=i.paint.get("background-pattern");if(e.isPatternMissing(u))return;const h=!u&&1===r.a&&1===a&&e.opaquePassEnabledForLayer()?"opaque":"translucent";if(e.renderPass!==h)return;const d=Ai.disabled,p=e.depthModeForSublayer(0,"opaque"===h?Ci.ReadWrite:Ci.ReadOnly),f=e.colorModeForRenderPass(),m=e.useProgram(u?"backgroundPattern":"background"),g=n||l.coveringTiles({tileSize:c,terrain:e.style.map.terrain});u&&(s.activeTexture.set(o.TEXTURE0),e.imageManager.bind(e.context));const y=i.getCrossfadeParameters();for(const _ of g){const t=n?_.posMatrix:e.transform.calculatePosMatrix(_.toUnwrapped()),l=u?Ft(t,a,e,u,{tileID:_,tileSize:c},y):Rt(t,a,r),h=e.style.map.terrain&&e.style.map.terrain.getTerrainData(_);m.draw(s,o.TRIANGLES,p,d,f,Mi.disabled,l,h,i.id,e.tileExtentBuffer,e.quadTriangleIndexBuffer,e.tileExtentSegments)}}(t,0,n,r);break;case"custom":!function(e,t,i){const n=e.context,r=i.implementation;if("offscreen"===e.renderPass){const t=r.prerender;t&&(e.setCustomLayerDefaults(),n.setColorMode(e.colorModeForRenderPass()),t.call(r,n.gl,e.transform.customLayerMatrix()),n.setDirty(),e.setBaseState())}else if("translucent"===e.renderPass){e.setCustomLayerDefaults(),n.setColorMode(e.colorModeForRenderPass()),n.setStencilMode(Ai.disabled);const t="3d"===r.renderingMode?new Ci(e.context.gl.LEQUAL,Ci.ReadWrite,e.depthRangeFor3D):e.depthModeForSublayer(0,Ci.ReadOnly);n.setDepthMode(t),r.render(n.gl,e.transform.customLayerMatrix()),n.setDirty(),e.setBaseState(),n.bindFramebuffer.set(null)}}(t,0,n)}}translatePosMatrix(t,i,n,r,a){if(!n[0]&&!n[1])return t;const s=a?"map"===r?this.transform.angle:0:"viewport"===r?-this.transform.angle:0;if(s){const e=Math.sin(s),t=Math.cos(s);n=[n[0]*t-n[1]*e,n[0]*e+n[1]*t]}const o=[a?n[0]:Ee(i,n[0],this.transform.zoom),a?n[1]:Ee(i,n[1],this.transform.zoom),0],l=new Float32Array(16);return e.$(l,t,o),l}saveTileTexture(e){const t=this._tileTextures[e.size[0]];t?t.push(e):this._tileTextures[e.size[0]]=[e]}getTileTexture(e){const t=this._tileTextures[e];return t&&t.length>0?t.pop():null}isPatternMissing(e){if(!e)return!1;if(!e.from||!e.to)return!0;const t=this.imageManager.getPattern(e.from.toString()),i=this.imageManager.getPattern(e.to.toString());return!t||!i}useProgram(e,t){this.cache=this.cache||{};const i=e+(t?t.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"")+(this.style.map.terrain?"/terrain":"");return this.cache[i]||(this.cache[i]=new ut(this.context,st[e],t,Bt[e],this._showOverdrawInspector,this.style.map.terrain)),this.cache[i]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const e=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(e.FUNC_ADD)}initDebugOverlayCanvas(){null==this.debugOverlayCanvas&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new v(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:e,drawingBufferHeight:t}=this.context.gl;return this.width!==e||this.height!==t}}class rn{constructor(e,t){this.points=e,this.planes=t}static fromInvProjectionMatrix(t,i,n){const r=Math.pow(2,n),a=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map((n=>{const a=1/(n=e.ag([],n,t))[3]/i*r;return e.b3(n,n,[a,a,1/n[3],a])})),s=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map((e=>{const t=function(e,t){var i=t[0],n=t[1],r=t[2],a=i*i+n*n+r*r;return a>0&&(a=1/Math.sqrt(a)),e[0]=t[0]*a,e[1]=t[1]*a,e[2]=t[2]*a,e}([],function(e,t,i){var n=t[0],r=t[1],a=t[2],s=i[0],o=i[1],l=i[2];return e[0]=r*l-a*o,e[1]=a*s-n*l,e[2]=n*o-r*s,e}([],m([],a[e[0]],a[e[1]]),m([],a[e[2]],a[e[1]]))),i=-((n=t)[0]*(r=a[e[1]])[0]+n[1]*r[1]+n[2]*r[2]);var n,r;return t.concat(i)}));return new rn(a,s)}}class an{constructor(e,t){this.min=e,this.max=t,this.center=function(e,t){return e[0]=.5*t[0],e[1]=.5*t[1],e[2]=.5*t[2],e}([],function(e,t,i){return e[0]=t[0]+i[0],e[1]=t[1]+i[1],e[2]=t[2]+i[2],e}([],this.min,this.max))}quadrant(e){const t=[e%2==0,e<2],i=p(this.min),n=p(this.max);for(let r=0;r<t.length;r++)i[r]=t[r]?this.min[r]:this.center[r],n[r]=t[r]?this.center[r]:this.max[r];return n[2]=this.max[2],new an(i,n)}distanceX(e){return Math.max(Math.min(this.max[0],e[0]),this.min[0])-e[0]}distanceY(e){return Math.max(Math.min(this.max[1],e[1]),this.min[1])-e[1]}intersects(t){const i=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]];let n=!0;for(let r=0;r<t.planes.length;r++){const a=t.planes[r];let s=0;for(let t=0;t<i.length;t++)e.b4(a,i[t])>=0&&s++;if(0===s)return 0;s!==i.length&&(n=!1)}if(n)return 2;for(let e=0;e<3;e++){let i=Number.MAX_VALUE,n=-Number.MAX_VALUE;for(let r=0;r<t.points.length;r++){const a=t.points[r][e]-this.min[e];i=Math.min(i,a),n=Math.max(n,a)}if(n<0||i>this.max[e]-this.min[e])return 0}return 1}}class sn{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(isNaN(e)||e<0||isNaN(t)||t<0||isNaN(i)||i<0||isNaN(n)||n<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=e,this.bottom=t,this.left=i,this.right=n}interpolate(t,i,n){return null!=i.top&&null!=t.top&&(this.top=e.B.number(t.top,i.top,n)),null!=i.bottom&&null!=t.bottom&&(this.bottom=e.B.number(t.bottom,i.bottom,n)),null!=i.left&&null!=t.left&&(this.left=e.B.number(t.left,i.left,n)),null!=i.right&&null!=t.right&&(this.right=e.B.number(t.right,i.right,n)),this}getCenter(t,i){const n=e.ad((this.left+t-this.right)/2,0,t),r=e.ad((this.top+i-this.bottom)/2,0,i);return new e.P(n,r)}equals(e){return this.top===e.top&&this.bottom===e.bottom&&this.left===e.left&&this.right===e.right}clone(){return new sn(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}class on{constructor(t,i,n,r,a){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=void 0===a||!!a,this._minZoom=t||0,this._maxZoom=i||22,this._minPitch=null==n?0:n,this._maxPitch=null==r?60:r,this.setMaxBounds(),this.width=0,this.height=0,this._center=new e.L(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new sn,this._posMatrixCache={},this._alignedPosMatrixCache={},this._minEleveationForCurrentTile=0}clone(){const e=new on(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return e.apply(this),e}apply(e){this.tileSize=e.tileSize,this.latRange=e.latRange,this.width=e.width,this.height=e.height,this._center=e._center,this._elevation=e._elevation,this._minEleveationForCurrentTile=e._minEleveationForCurrentTile,this.zoom=e.zoom,this.angle=e.angle,this._fov=e._fov,this._pitch=e._pitch,this._unmodified=e._unmodified,this._edgeInsets=e._edgeInsets.clone(),this._calcMatrices()}get minZoom(){return this._minZoom}set minZoom(e){this._minZoom!==e&&(this._minZoom=e,this.zoom=Math.max(this.zoom,e))}get maxZoom(){return this._maxZoom}set maxZoom(e){this._maxZoom!==e&&(this._maxZoom=e,this.zoom=Math.min(this.zoom,e))}get minPitch(){return this._minPitch}set minPitch(e){this._minPitch!==e&&(this._minPitch=e,this.pitch=Math.max(this.pitch,e))}get maxPitch(){return this._maxPitch}set maxPitch(e){this._maxPitch!==e&&(this._maxPitch=e,this.pitch=Math.min(this.pitch,e))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(e){void 0===e?e=!0:null===e&&(e=!1),this._renderWorldCopies=e}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new e.P(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(t){const i=-e.b5(t,-180,180)*Math.PI/180;this.angle!==i&&(this._unmodified=!1,this.angle=i,this._calcMatrices(),this.rotationMatrix=function(){var t=new e.A(4);return e.A!=Float32Array&&(t[1]=0,t[2]=0),t[0]=1,t[3]=1,t}(),function(e,t,i){var n=t[0],r=t[1],a=t[2],s=t[3],o=Math.sin(i),l=Math.cos(i);e[0]=n*l+a*o,e[1]=r*l+s*o,e[2]=n*-o+a*l,e[3]=r*-o+s*l}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(t){const i=e.ad(t,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==i&&(this._unmodified=!1,this._pitch=i,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(e){e=Math.max(.01,Math.min(60,e)),this._fov!==e&&(this._unmodified=!1,this._fov=e/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(e){const t=Math.min(Math.max(e,this.minZoom),this.maxZoom);this._zoom!==t&&(this._unmodified=!1,this._zoom=t,this.tileZoom=Math.max(0,Math.floor(t)),this.scale=this.zoomScale(t),this._constrain(),this._calcMatrices())}get center(){return this._center}set center(e){e.lat===this._center.lat&&e.lng===this._center.lng||(this._unmodified=!1,this._center=e,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}set elevation(e){e!==this._elevation&&(this._elevation=e,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(e){this._edgeInsets.equals(e)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,e,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(e){return this._edgeInsets.equals(e)}interpolatePadding(e,t,i){this._unmodified=!1,this._edgeInsets.interpolate(e,t,i),this._constrain(),this._calcMatrices()}coveringZoomLevel(e){const t=(e.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/e.tileSize));return Math.max(0,t)}getVisibleUnwrappedCoordinates(t){const i=[new e.b6(0,t)];if(this._renderWorldCopies){const n=this.pointCoordinate(new e.P(0,0)),r=this.pointCoordinate(new e.P(this.width,0)),a=this.pointCoordinate(new e.P(this.width,this.height)),s=this.pointCoordinate(new e.P(0,this.height)),o=Math.floor(Math.min(n.x,r.x,a.x,s.x)),l=Math.floor(Math.max(n.x,r.x,a.x,s.x)),c=1;for(let u=o-c;u<=l+c;u++)0!==u&&i.push(new e.b6(u,t))}return i}coveringTiles(t){var i,n;let r=this.coveringZoomLevel(t);const a=r;if(void 0!==t.minzoom&&r<t.minzoom)return[];void 0!==t.maxzoom&&r>t.maxzoom&&(r=t.maxzoom);const s=this.pointCoordinate(this.getCameraPoint()),o=e.U.fromLngLat(this.center),l=Math.pow(2,r),c=[l*s.x,l*s.y,0],u=[l*o.x,l*o.y,0],h=rn.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,r);let d=t.minzoom||0;!t.terrain&&this.pitch<=60&&this._edgeInsets.top<.1&&(d=r);const p=t.terrain?2/Math.min(this.tileSize,t.tileSize)*this.tileSize:3,f=e=>({aabb:new an([e*l,0,0],[(e+1)*l,l,0]),zoom:0,x:0,y:0,wrap:e,fullyVisible:!1}),m=[],y=[],_=r,v=t.reparseOverscaled?a:r;if(this._renderWorldCopies)for(let e=1;e<=3;e++)m.push(f(-e)),m.push(f(e));for(m.push(f(0));m.length>0;){const r=m.pop(),a=r.x,s=r.y;let o=r.fullyVisible;if(!o){const e=r.aabb.intersects(h);if(0===e)continue;o=2===e}const l=t.terrain?c:u,f=r.aabb.distanceX(l),x=r.aabb.distanceY(l),b=Math.max(Math.abs(f),Math.abs(x));if(r.zoom===_||b>p+(1<<_-r.zoom)-2&&r.zoom>=d){const t=_-r.zoom,i=c[0]-.5-(a<<t),n=c[1]-.5-(s<<t);y.push({tileID:new e.O(r.zoom===_?v:r.zoom,r.wrap,r.zoom,a,s),distanceSq:g([u[0]-.5-a,u[1]-.5-s]),tileDistanceToCamera:Math.sqrt(i*i+n*n)})}else for(let c=0;c<4;c++){const l=(a<<1)+c%2,u=(s<<1)+(c>>1),h=r.zoom+1;let d=r.aabb.quadrant(c);if(t.terrain){const a=new e.O(h,r.wrap,h,l,u),s=t.terrain.getMinMaxElevation(a),o=null!==(i=s.minElevation)&&void 0!==i?i:this.elevation,c=null!==(n=s.maxElevation)&&void 0!==n?n:this.elevation;d=new an([d.min[0],d.min[1],o],[d.max[0],d.max[1],c])}m.push({aabb:d,zoom:h,x:l,y:u,wrap:r.wrap,fullyVisible:o})}}return y.sort(((e,t)=>e.distanceSq-t.distanceSq)).map((e=>e.tileID))}resize(e,t){this.width=e,this.height=t,this.pixelsToGLUnits=[2/e,-2/t],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(e){return Math.pow(2,e)}scaleZoom(e){return Math.log(e)/Math.LN2}project(t){const i=e.ad(t.lat,-this.maxValidLatitude,this.maxValidLatitude);return new e.P(e.G(t.lng)*this.worldSize,e.H(i)*this.worldSize)}unproject(t){return new e.U(t.x/this.worldSize,t.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}getCameraPosition(){return{lngLat:this.pointLocation(this.getCameraPoint()),altitude:Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter+this.elevation}}recalculateZoom(t){const i=this.pointLocation(this.centerPoint,t),n=t.getElevationForLngLatZoom(i,this.tileZoom);if(!(this.elevation-n))return;const r=this.getCameraPosition(),a=e.U.fromLngLat(r.lngLat,r.altitude),s=e.U.fromLngLat(i,n),o=a.x-s.x,l=a.y-s.y,c=a.z-s.z,u=Math.sqrt(o*o+l*l+c*c),h=this.scaleZoom(this.cameraToCenterDistance/u/this.tileSize);this._elevation=n,this._center=i,this.zoom=h}setLocationAtPoint(t,i){const n=this.pointCoordinate(i),r=this.pointCoordinate(this.centerPoint),a=this.locationCoordinate(t),s=new e.U(a.x-(n.x-r.x),a.y-(n.y-r.y));this.center=this.coordinateLocation(s),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(e,t){return t?this.coordinatePoint(this.locationCoordinate(e),t.getElevationForLngLatZoom(e,this.tileZoom),this.pixelMatrix3D):this.coordinatePoint(this.locationCoordinate(e))}pointLocation(e,t){return this.coordinateLocation(this.pointCoordinate(e,t))}locationCoordinate(t){return e.U.fromLngLat(t)}coordinateLocation(e){return e&&e.toLngLat()}pointCoordinate(t,i){if(i){const e=i.pointCoordinate(t);if(null!=e)return e}const n=[t.x,t.y,0,1],r=[t.x,t.y,1,1];e.ag(n,n,this.pixelMatrixInverse),e.ag(r,r,this.pixelMatrixInverse);const a=n[3],s=r[3],o=n[1]/a,l=r[1]/s,c=n[2]/a,u=r[2]/s,h=c===u?0:(0-c)/(u-c);return new e.U(e.B.number(n[0]/a,r[0]/s,h)/this.worldSize,e.B.number(o,l,h)/this.worldSize)}coordinatePoint(t){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.pixelMatrix;const r=[t.x*this.worldSize,t.y*this.worldSize,i,1];return e.ag(r,r,n),new e.P(r[0]/r[3],r[1]/r[3])}getBounds(){const t=Math.max(0,this.height/2-this.getHorizon());return(new z).extend(this.pointLocation(new e.P(0,t))).extend(this.pointLocation(new e.P(this.width,t))).extend(this.pointLocation(new e.P(this.width,this.height))).extend(this.pointLocation(new e.P(0,this.height)))}getMaxBounds(){return this.latRange&&2===this.latRange.length&&this.lngRange&&2===this.lngRange.length?new z([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}getHorizon(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85}setMaxBounds(e){e?(this.lngRange=[e.getWest(),e.getEast()],this.latRange=[e.getSouth(),e.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])}calculatePosMatrix(t){let i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=t.key,r=i?this._alignedPosMatrixCache:this._posMatrixCache;if(r[n])return r[n];const a=t.canonical,s=this.worldSize/this.zoomScale(a.z),o=a.x+Math.pow(2,a.z)*t.wrap,l=e.ao(new Float64Array(16));return e.$(l,l,[o*s,a.y*s,0]),e.a0(l,l,[s/e.N,s/e.N,1]),e.a1(l,i?this.alignedProjMatrix:this.projMatrix,l),r[n]=new Float32Array(l),r[n]}customLayerMatrix(){return this.mercatorMatrix.slice()}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;let t,i,n,r,a=-90,s=90,o=-180,l=180;const c=this.size,u=this._unmodified;if(this.latRange){const i=this.latRange;a=e.H(i[1])*this.worldSize,s=e.H(i[0])*this.worldSize,t=s-a<c.y?c.y/(s-a):0}if(this.lngRange){const t=this.lngRange;o=e.b5(e.G(t[0])*this.worldSize,0,this.worldSize),l=e.b5(e.G(t[1])*this.worldSize,0,this.worldSize),l<o&&(l+=this.worldSize),i=l-o<c.x?c.x/(l-o):0}const h=this.point,d=Math.max(i||0,t||0);if(d)return this.center=this.unproject(new e.P(i?(l+o)/2:h.x,t?(s+a)/2:h.y)),this.zoom+=this.scaleZoom(d),this._unmodified=u,void(this._constraining=!1);if(this.latRange){const e=h.y,t=c.y/2;e-t<a&&(r=a+t),e+t>s&&(r=s-t)}if(this.lngRange){const t=(o+l)/2,i=e.b5(h.x,t-this.worldSize/2,t+this.worldSize/2),r=c.x/2;i-r<o&&(n=o+r),i+r>l&&(n=l-r)}void 0===n&&void 0===r||(this.center=this.unproject(new e.P(void 0!==n?n:h.x,void 0!==r?r:h.y)).wrap()),this._unmodified=u,this._constraining=!1}_calcMatrices(){if(!this.height)return;const t=this.centerOffset,i=this.point.x,n=this.point.y;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height,this._pixelPerMeter=e.b7(1,this.center.lat)*this.worldSize;let r=e.ao(new Float64Array(16));e.a0(r,r,[this.width/2,-this.height/2,1]),e.$(r,r,[1,-1,0]),this.labelPlaneMatrix=r,r=e.ao(new Float64Array(16)),e.a0(r,r,[1,-1,1]),e.$(r,r,[-1,-1,0]),e.a0(r,r,[2/this.width,2/this.height,1]),this.glCoordMatrix=r;const a=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch),s=Math.min(this.elevation,this._minEleveationForCurrentTile),o=a-s*this._pixelPerMeter/Math.cos(this._pitch),l=s<0?o:a,c=Math.PI/2+this._pitch,u=this._fov*(.5+t.y/this.height),h=Math.sin(u)*l/Math.sin(e.ad(Math.PI-c-u,.01,Math.PI-.01)),d=this.getHorizon(),p=2*Math.atan(d/this.cameraToCenterDistance)*(.5+t.y/(2*d)),f=Math.sin(p)*l/Math.sin(e.ad(Math.PI-c-p,.01,Math.PI-.01)),m=Math.min(h,f),g=1.01*(Math.cos(Math.PI/2-this._pitch)*m+l),y=this.height/50;r=new Float64Array(16),e.b8(r,this._fov,this.width/this.height,y,g),r[8]=2*-t.x/this.width,r[9]=2*t.y/this.height,e.a0(r,r,[1,-1,1]),e.$(r,r,[0,0,-this.cameraToCenterDistance]),e.b9(r,r,this._pitch),e.ae(r,r,this.angle),e.$(r,r,[-i,-n,0]),this.mercatorMatrix=e.a0([],r,[this.worldSize,this.worldSize,this.worldSize]),e.a0(r,r,[1,1,this._pixelPerMeter]),this.pixelMatrix=e.a1(new Float64Array(16),this.labelPlaneMatrix,r),e.$(r,r,[0,0,-this.elevation]),this.projMatrix=r,this.invProjMatrix=e.as([],r),this.pixelMatrix3D=e.a1(new Float64Array(16),this.labelPlaneMatrix,r);const _=this.width%2/2,v=this.height%2/2,x=Math.cos(this.angle),b=Math.sin(this.angle),w=i-Math.round(i)+x*_+b*v,S=n-Math.round(n)+x*v+b*_,T=new Float64Array(r);if(e.$(T,T,[w>.5?w-1:w,S>.5?S-1:S,0]),this.alignedProjMatrix=T,r=e.as(new Float64Array(16),this.pixelMatrix),!r)throw new Error("failed to invert matrix");this.pixelMatrixInverse=r,this._posMatrixCache={},this._alignedPosMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;const t=this.pointCoordinate(new e.P(0,0)),i=[t.x*this.worldSize,t.y*this.worldSize,0,1];return e.ag(i,i,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){const t=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new e.P(0,t))}getCameraQueryGeometry(t){const i=this.getCameraPoint();if(1===t.length)return[t[0],i];{let n=i.x,r=i.y,a=i.x,s=i.y;for(const e of t)n=Math.min(n,e.x),r=Math.min(r,e.y),a=Math.max(a,e.x),s=Math.max(s,e.y);return[new e.P(n,r),new e.P(a,r),new e.P(a,s),new e.P(n,s),new e.P(n,r)]}}}function ln(e,t){var i=this;let n,r=!1,a=null,s=null;const o=()=>{a=null,r&&(e.apply(s,n),a=setTimeout(o,t),r=!1)};return function(){for(var e=arguments.length,t=new Array(e),l=0;l<e;l++)t[l]=arguments[l];return r=!0,s=i,n=t,a||o(),a}}class cn{constructor(e){this._getCurrentHash=()=>{const e=window.location.hash.replace("#","");if(this._hashName){let t;return e.split("&").map((e=>e.split("="))).forEach((e=>{e[0]===this._hashName&&(t=e)})),(t&&t[1]||"").split("/")}return e.split("/")},this._onHashChange=()=>{const e=this._getCurrentHash();if(e.length>=3&&!e.some((e=>isNaN(e)))){const t=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(e[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+e[2],+e[1]],zoom:+e[0],bearing:t,pitch:+(e[4]||0)}),!0}return!1},this._updateHashUnthrottled=()=>{const e=window.location.href.replace(/(#.+)?$/,this.getHashString());try{window.history.replaceState(window.history.state,null,e)}catch(e){}},this._updateHash=ln(this._updateHashUnthrottled,300),this._hashName=e&&encodeURIComponent(e)}addTo(e){return this._map=e,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this}getHashString(e){const t=this._map.getCenter(),i=Math.round(100*this._map.getZoom())/100,n=Math.ceil((i*Math.LN2+Math.log(512/360/.5))/Math.LN10),r=Math.pow(10,n),a=Math.round(t.lng*r)/r,s=Math.round(t.lat*r)/r,o=this._map.getBearing(),l=this._map.getPitch();let c="";if(c+=e?`/${a}/${s}/${i}`:`${i}/${s}/${a}`,(o||l)&&(c+="/"+Math.round(10*o)/10),l&&(c+=`/${Math.round(l)}`),this._hashName){const e=this._hashName;let t=!1;const i=window.location.hash.slice(1).split("&").map((i=>{const n=i.split("=")[0];return n===e?(t=!0,`${n}=${c}`):i})).filter((e=>e));return t||i.push(`${e}=${c}`),`#${i.join("&")}`}return`#${c}`}}const un={linearity:.3,easing:e.ba(0,0,.3,1)},hn=e.e({deceleration:2500,maxSpeed:1400},un),dn=e.e({deceleration:20,maxSpeed:1400},un),pn=e.e({deceleration:1e3,maxSpeed:360},un),fn=e.e({deceleration:1e3,maxSpeed:90},un);class mn{constructor(e){this._map=e,this.clear()}clear(){this._inertiaBuffer=[]}record(t){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:e.h.now(),settings:t})}_drainInertiaBuffer(){const t=this._inertiaBuffer,i=e.h.now();for(;t.length>0&&i-t[0].time>160;)t.shift()}_onMoveEnd(t){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const i={zoom:0,bearing:0,pitch:0,pan:new e.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:e}of this._inertiaBuffer)i.zoom+=e.zoomDelta||0,i.bearing+=e.bearingDelta||0,i.pitch+=e.pitchDelta||0,e.panDelta&&i.pan._add(e.panDelta),e.around&&(i.around=e.around),e.pinchAround&&(i.pinchAround=e.pinchAround);const n=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,r={};if(i.pan.mag()){const a=yn(i.pan.mag(),n,e.e({},hn,t||{}));r.offset=i.pan.mult(a.amount/i.pan.mag()),r.center=this._map.transform.center,gn(r,a)}if(i.zoom){const e=yn(i.zoom,n,dn);r.zoom=this._map.transform.zoom+e.amount,gn(r,e)}if(i.bearing){const t=yn(i.bearing,n,pn);r.bearing=this._map.transform.bearing+e.ad(t.amount,-179,179),gn(r,t)}if(i.pitch){const e=yn(i.pitch,n,fn);r.pitch=this._map.transform.pitch+e.amount,gn(r,e)}if(r.zoom||r.bearing){const e=void 0===i.pinchAround?i.around:i.pinchAround;r.around=e?this._map.unproject(e):this._map.getCenter()}return this.clear(),e.e(r,{noMoveStart:!0})}}function gn(e,t){(!e.duration||e.duration<t.duration)&&(e.duration=t.duration,e.easing=t.easing)}function yn(t,i,n){const{maxSpeed:r,linearity:a,deceleration:s}=n,o=e.ad(t*a/(i/1e3),-r,r),l=Math.abs(o)/(s*a);return{easing:n.easing,duration:1e3*l,amount:o*(l/2)}}class _n extends e.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,n,r){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const s=i.mousePos(n.getCanvasContainer(),r),o=n.unproject(s);super(t,e.e({point:s,lngLat:o,originalEvent:r},a)),this._defaultPrevented=!1,this.target=n}}class vn extends e.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,n,r){const a="touchend"===t?r.changedTouches:r.touches,s=i.touchPos(n.getCanvasContainer(),a),o=s.map((e=>n.unproject(e))),l=s.reduce(((e,t,i,n)=>e.add(t.div(n.length))),new e.P(0,0));super(t,{points:s,point:l,lngLats:o,lngLat:n.unproject(l),originalEvent:r}),this._defaultPrevented=!1}}class xn extends e.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,t,i){super(e,{originalEvent:i}),this._defaultPrevented=!1}}class bn{constructor(e,t){this._map=e,this._clickTolerance=t.clickTolerance}reset(){delete this._mousedownPos}wheel(e){return this._firePreventable(new xn(e.type,this._map,e))}mousedown(e,t){return this._mousedownPos=t,this._firePreventable(new _n(e.type,this._map,e))}mouseup(e){this._map.fire(new _n(e.type,this._map,e))}click(e,t){this._mousedownPos&&this._mousedownPos.dist(t)>=this._clickTolerance||this._map.fire(new _n(e.type,this._map,e))}dblclick(e){return this._firePreventable(new _n(e.type,this._map,e))}mouseover(e){this._map.fire(new _n(e.type,this._map,e))}mouseout(e){this._map.fire(new _n(e.type,this._map,e))}touchstart(e){return this._firePreventable(new vn(e.type,this._map,e))}touchmove(e){this._map.fire(new vn(e.type,this._map,e))}touchend(e){this._map.fire(new vn(e.type,this._map,e))}touchcancel(e){this._map.fire(new vn(e.type,this._map,e))}_firePreventable(e){if(this._map.fire(e),e.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class wn{constructor(e){this._map=e}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(e){this._map.fire(new _n(e.type,this._map,e))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new _n("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(e){this._delayContextMenu?this._contextMenuEvent=e:this._ignoreContextMenu||this._map.fire(new _n(e.type,this._map,e)),this._map.listens("contextmenu")&&e.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Sn{constructor(e){this._map=e}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(t){return this.transform.pointLocation(e.P.convert(t),this._map.terrain)}}class Tn{constructor(e,t){this._map=e,this._tr=new Sn(e),this._el=e.getCanvasContainer(),this._container=e.getContainer(),this._clickTolerance=t.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(e,t){this.isEnabled()&&e.shiftKey&&0===e.button&&(i.disableDrag(),this._startPos=this._lastPos=t,this._active=!0)}mousemoveWindow(e,t){if(!this._active)return;const n=t;if(this._lastPos.equals(n)||!this._box&&n.dist(this._startPos)<this._clickTolerance)return;const r=this._startPos;this._lastPos=n,this._box||(this._box=i.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",e));const a=Math.min(r.x,n.x),s=Math.max(r.x,n.x),o=Math.min(r.y,n.y),l=Math.max(r.y,n.y);i.setTransform(this._box,`translate(${a}px,${o}px)`),this._box.style.width=s-a+"px",this._box.style.height=l-o+"px"}mouseupWindow(t,n){if(!this._active)return;if(0!==t.button)return;const r=this._startPos,a=n;if(this.reset(),i.suppressClick(),r.x!==a.x||r.y!==a.y)return this._map.fire(new e.k("boxzoomend",{originalEvent:t})),{cameraAnimation:e=>e.fitScreenCoordinates(r,a,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",t)}keydown(e){this._active&&27===e.keyCode&&(this.reset(),this._fireEvent("boxzoomcancel",e))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(i.remove(this._box),this._box=null),i.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(t,i){return this._map.fire(new e.k(t,{originalEvent:i}))}}function kn(e,t){if(e.length!==t.length)throw new Error(`The number of touches and points are not equal - touches ${e.length}, points ${t.length}`);const i={};for(let n=0;n<e.length;n++)i[e[n].identifier]=t[n];return i}class En{constructor(e){this.reset(),this.numTouches=e.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(t,i,n){(this.centroid||n.length>this.numTouches)&&(this.aborted=!0),this.aborted||(void 0===this.startTime&&(this.startTime=t.timeStamp),n.length===this.numTouches&&(this.centroid=function(t){const i=new e.P(0,0);for(const e of t)i._add(e);return i.div(t.length)}(i),this.touches=kn(n,i)))}touchmove(e,t,i){if(this.aborted||!this.centroid)return;const n=kn(i,t);for(const r in this.touches){const e=n[r];(!e||e.dist(this.touches[r])>30)&&(this.aborted=!0)}}touchend(e,t,i){if((!this.centroid||e.timeStamp-this.startTime>500)&&(this.aborted=!0),0===i.length){const e=!this.aborted&&this.centroid;if(this.reset(),e)return e}}}class Pn{constructor(e){this.singleTap=new En(e),this.numTaps=e.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(e,t,i){this.singleTap.touchstart(e,t,i)}touchmove(e,t,i){this.singleTap.touchmove(e,t,i)}touchend(e,t,i){const n=this.singleTap.touchend(e,t,i);if(n){const t=e.timeStamp-this.lastTime<500,i=!this.lastTap||this.lastTap.dist(n)<30;if(t&&i||this.reset(),this.count++,this.lastTime=e.timeStamp,this.lastTap=n,this.count===this.numTaps)return this.reset(),n}}}class Cn{constructor(e){this._tr=new Sn(e),this._zoomIn=new Pn({numTouches:1,numTaps:2}),this._zoomOut=new Pn({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(e,t,i){this._zoomIn.touchstart(e,t,i),this._zoomOut.touchstart(e,t,i)}touchmove(e,t,i){this._zoomIn.touchmove(e,t,i),this._zoomOut.touchmove(e,t,i)}touchend(e,t,i){const n=this._zoomIn.touchend(e,t,i),r=this._zoomOut.touchend(e,t,i),a=this._tr;return n?(this._active=!0,e.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:t=>t.easeTo({duration:300,zoom:a.zoom+1,around:a.unproject(n)},{originalEvent:e})}):r?(this._active=!0,e.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:t=>t.easeTo({duration:300,zoom:a.zoom-1,around:a.unproject(r)},{originalEvent:e})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class In{constructor(e){this._enabled=!!e.enable,this._moveStateManager=e.moveStateManager,this._clickTolerance=e.clickTolerance||1,this._moveFunction=e.move,this._activateOnStart=!!e.activateOnStart,e.assignEvents(this),this.reset()}reset(e){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(e)}_move(){const e=this._moveFunction(...arguments);if(e.bearingDelta||e.pitchDelta||e.around||e.panDelta)return this._active=!0,e}dragStart(e,t){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(e)&&(this._moveStateManager.startMove(e),this._lastPoint=t.length?t[0]:t,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(e,t){if(!this.isEnabled())return;const i=this._lastPoint;if(!i)return;if(e.preventDefault(),!this._moveStateManager.isValidMoveEvent(e))return void this.reset(e);const n=t.length?t[0]:t;return!this._moved&&n.dist(i)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=n,this._move(i,n))}dragEnd(e){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(e)&&(this._moved&&i.suppressClick(),this.reset(e))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const An={0:1,2:2};class Mn{constructor(e){this._correctEvent=e.checkCorrectEvent}startMove(e){const t=i.mouseButton(e);this._eventButton=t}endMove(e){delete this._eventButton}isValidStartEvent(e){return this._correctEvent(e)}isValidMoveEvent(e){return!function(e,t){const i=An[t];return void 0===e.buttons||(e.buttons&i)!==i}(e,this._eventButton)}isValidEndEvent(e){return i.mouseButton(e)===this._eventButton}}class zn{constructor(){this._firstTouch=void 0}_isOneFingerTouch(e){return 1===e.targetTouches.length}_isSameTouchEvent(e){return e.targetTouches[0].identifier===this._firstTouch}startMove(e){this._firstTouch=e.targetTouches[0].identifier}endMove(e){delete this._firstTouch}isValidStartEvent(e){return this._isOneFingerTouch(e)}isValidMoveEvent(e){return this._isOneFingerTouch(e)&&this._isSameTouchEvent(e)}isValidEndEvent(e){return this._isOneFingerTouch(e)&&this._isSameTouchEvent(e)}}const Dn=e=>{e.mousedown=e.dragStart,e.mousemoveWindow=e.dragMove,e.mouseup=e.dragEnd,e.contextmenu=function(e){e.preventDefault()}},Ln=e=>{let{enable:t,clickTolerance:n,bearingDegreesPerPixelMoved:r=.8}=e;const a=new Mn({checkCorrectEvent:e=>0===i.mouseButton(e)&&e.ctrlKey||2===i.mouseButton(e)});return new In({clickTolerance:n,move:(e,t)=>({bearingDelta:(t.x-e.x)*r}),moveStateManager:a,enable:t,assignEvents:Dn})},Rn=e=>{let{enable:t,clickTolerance:n,pitchDegreesPerPixelMoved:r=-.5}=e;const a=new Mn({checkCorrectEvent:e=>0===i.mouseButton(e)&&e.ctrlKey||2===i.mouseButton(e)});return new In({clickTolerance:n,move:(e,t)=>({pitchDelta:(t.y-e.y)*r}),moveStateManager:a,enable:t,assignEvents:Dn})};class Fn{constructor(e,t){this._minTouches=e.cooperativeGestures?2:1,this._clickTolerance=e.clickTolerance||1,this._map=t,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new e.P(0,0),setTimeout((()=>{this._cancelCooperativeMessage=!1}),200)}touchstart(e,t,i){return this._calculateTransform(e,t,i)}touchmove(e,t,i){if(this._map._cooperativeGestures&&(2===this._minTouches&&i.length<2&&!this._cancelCooperativeMessage?this._map._onCooperativeGesture(e,!1,i.length):this._cancelCooperativeMessage||(this._cancelCooperativeMessage=!0)),this._active&&!(i.length<this._minTouches))return e.preventDefault(),this._calculateTransform(e,t,i)}touchend(e,t,i){this._calculateTransform(e,t,i),this._active&&i.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(t,i,n){n.length>0&&(this._active=!0);const r=kn(n,i),a=new e.P(0,0),s=new e.P(0,0);let o=0;for(const e in r){const t=r[e],i=this._touches[e];i&&(a._add(t),s._add(t.sub(i)),o++,r[e]=t)}if(this._touches=r,o<this._minTouches||!s.mag())return;const l=s.div(o);return this._sum._add(l),this._sum.mag()<this._clickTolerance?void 0:{around:a.div(o),panDelta:l}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Bn{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(e,t,i){this._firstTwoTouches||i.length<2||(this._firstTwoTouches=[i[0].identifier,i[1].identifier],this._start([t[0],t[1]]))}touchmove(e,t,i){if(!this._firstTwoTouches)return;e.preventDefault();const[n,r]=this._firstTwoTouches,a=On(i,t,n),s=On(i,t,r);if(!a||!s)return;const o=this._aroundCenter?null:a.add(s).div(2);return this._move([a,s],o,e)}touchend(e,t,n){if(!this._firstTwoTouches)return;const[r,a]=this._firstTwoTouches,s=On(n,t,r),o=On(n,t,a);s&&o||(this._active&&i.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(e){this._enabled=!0,this._aroundCenter=!!e&&"center"===e.around}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function On(e,t,i){for(let n=0;n<e.length;n++)if(e[n].identifier===i)return t[n]}function Nn(e,t){return Math.log(e/t)/Math.LN2}class Vn extends Bn{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(e){this._startDistance=this._distance=e[0].dist(e[1])}_move(e,t){const i=this._distance;if(this._distance=e[0].dist(e[1]),this._active||!(Math.abs(Nn(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Nn(this._distance,i),pinchAround:t}}}function jn(e,t){return 180*e.angleWith(t)/Math.PI}class Un extends Bn{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(e){this._startVector=this._vector=e[0].sub(e[1]),this._minDiameter=e[0].dist(e[1])}_move(e,t){const i=this._vector;if(this._vector=e[0].sub(e[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:jn(this._vector,i),pinchAround:t}}_isBelowThreshold(e){this._minDiameter=Math.min(this._minDiameter,e.mag());const t=25/(Math.PI*this._minDiameter)*360,i=jn(e,this._startVector);return Math.abs(i)<t}}function $n(e){return Math.abs(e.y)>Math.abs(e.x)}class qn extends Bn{constructor(e){super(),this._map=e}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(e,t,i){super.touchstart(e,t,i),this._currentTouchCount=i.length}_start(e){this._lastPoints=e,$n(e[0].sub(e[1]))&&(this._valid=!1)}_move(e,t,i){if(this._map._cooperativeGestures&&this._currentTouchCount<3)return;const n=e[0].sub(this._lastPoints[0]),r=e[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(n,r,i.timeStamp),this._valid?(this._lastPoints=e,this._active=!0,{pitchDelta:(n.y+r.y)/2*-.5}):void 0}gestureBeginsVertically(e,t,i){if(void 0!==this._valid)return this._valid;const n=e.mag()>=2,r=t.mag()>=2;if(!n&&!r)return;if(!n||!r)return void 0===this._firstMove&&(this._firstMove=i),i-this._firstMove<100&&void 0;const a=e.y>0==t.y>0;return $n(e)&&$n(t)&&a}}const Zn={panStep:100,bearingStep:15,pitchStep:10};class Gn{constructor(e){this._tr=new Sn(e);const t=Zn;this._panStep=t.panStep,this._bearingStep=t.bearingStep,this._pitchStep=t.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(e){if(e.altKey||e.ctrlKey||e.metaKey)return;let t=0,i=0,n=0,r=0,a=0;switch(e.keyCode){case 61:case 107:case 171:case 187:t=1;break;case 189:case 109:case 173:t=-1;break;case 37:e.shiftKey?i=-1:(e.preventDefault(),r=-1);break;case 39:e.shiftKey?i=1:(e.preventDefault(),r=1);break;case 38:e.shiftKey?n=1:(e.preventDefault(),a=-1);break;case 40:e.shiftKey?n=-1:(e.preventDefault(),a=1);break;default:return}return this._rotationDisabled&&(i=0,n=0),{cameraAnimation:s=>{const o=this._tr;s.easeTo({duration:300,easeId:"keyboardHandler",easing:Wn,zoom:t?Math.round(o.zoom)+t*(e.shiftKey?2:1):o.zoom,bearing:o.bearing+i*this._bearingStep,pitch:o.pitch+n*this._pitchStep,offset:[-r*this._panStep,-a*this._panStep],center:o.center},{originalEvent:e})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Wn(e){return e*(2-e)}const Hn=4.000244140625;class Xn{constructor(e,t){this._onTimeout=e=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(e)},this._map=e,this._tr=new Sn(e),this._el=e.getCanvasContainer(),this._triggerRenderFrame=t,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222}setZoomRate(e){this._defaultZoomRate=e}setWheelZoomRate(e){this._wheelZoomRate=e}isEnabled(){return!!this._enabled}isActive(){return!!this._active||void 0!==this._finishTimeout}isZooming(){return!!this._zooming}enable(e){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!e&&"center"===e.around)}disable(){this.isEnabled()&&(this._enabled=!1)}wheel(t){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!t[this._map._metaKey])return;t.preventDefault()}let i=t.deltaMode===WheelEvent.DOM_DELTA_LINE?40*t.deltaY:t.deltaY;const n=e.h.now(),r=n-(this._lastWheelEventTime||0);this._lastWheelEventTime=n,0!==i&&i%Hn==0?this._type="wheel":0!==i&&Math.abs(i)<4?this._type="trackpad":r>400?(this._type=null,this._lastValue=i,this._timeout=setTimeout(this._onTimeout,40,t)):this._type||(this._type=Math.abs(r*i)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,i+=this._lastValue)),t.shiftKey&&i&&(i/=4),this._type&&(this._lastWheelEvent=t,this._delta-=i,this._active||this._start(t)),t.preventDefault()}_start(t){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const n=i.mousePos(this._el,t),r=this._tr;this._around=e.L.convert(this._aroundCenter?r.center:r.unproject(n)),this._aroundPoint=r.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId)return;if(this._frameId=null,!this.isActive())return;const t=this._tr.transform;if(0!==this._delta){const e="wheel"===this._type&&Math.abs(this._delta)>Hn?this._wheelZoomRate:this._defaultZoomRate;let i=2/(1+Math.exp(-Math.abs(this._delta*e)));this._delta<0&&0!==i&&(i=1/i);const n="number"==typeof this._targetZoom?t.zoomScale(this._targetZoom):t.scale;this._targetZoom=Math.min(t.maxZoom,Math.max(t.minZoom,t.scaleZoom(n*i))),"wheel"===this._type&&(this._startZoom=t.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const i="number"==typeof this._targetZoom?this._targetZoom:t.zoom,n=this._startZoom,r=this._easing;let a,s=!1;if("wheel"===this._type&&n&&r){const t=Math.min((e.h.now()-this._lastWheelEventTime)/200,1),o=r(t);a=e.B.number(n,i,o),t<1?this._frameId||(this._frameId=!0):s=!0}else a=i,s=!0;return this._active=!0,s&&(this._active=!1,this._finishTimeout=setTimeout((()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout}),200)),{noInertia:!0,needsRenderFrame:!s,zoomDelta:a-t.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(t){let i=e.bb;if(this._prevEase){const t=this._prevEase,n=(e.h.now()-t.start)/t.duration,r=t.easing(n+.01)-t.easing(n),a=.27/Math.sqrt(r*r+1e-4)*.01,s=Math.sqrt(.0729-a*a);i=e.ba(a,s,.25,1)}return this._prevEase={start:e.h.now(),duration:t,easing:i},i}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class Kn{constructor(e,t){this._clickZoom=e,this._tapZoom=t}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Yn{constructor(e){this._tr=new Sn(e),this.reset()}reset(){this._active=!1}dblclick(e,t){return e.preventDefault(),{cameraAnimation:i=>{i.easeTo({duration:300,zoom:this._tr.zoom+(e.shiftKey?-1:1),around:this._tr.unproject(t)},{originalEvent:e})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Jn{constructor(){this._tap=new Pn({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(e,t,i){if(!this._swipePoint)if(this._tapTime){const n=t[0],r=e.timeStamp-this._tapTime<500,a=this._tapPoint.dist(n)<30;r&&a?i.length>0&&(this._swipePoint=n,this._swipeTouch=i[0].identifier):this.reset()}else this._tap.touchstart(e,t,i)}touchmove(e,t,i){if(this._tapTime){if(this._swipePoint){if(i[0].identifier!==this._swipeTouch)return;const n=t[0],r=n.y-this._swipePoint.y;return this._swipePoint=n,e.preventDefault(),this._active=!0,{zoomDelta:r/128}}}else this._tap.touchmove(e,t,i)}touchend(e,t,i){if(this._tapTime)this._swipePoint&&0===i.length&&this.reset();else{const n=this._tap.touchend(e,t,i);n&&(this._tapTime=e.timeStamp,this._tapPoint=n)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Qn{constructor(e,t,i){this._el=e,this._mousePan=t,this._touchPan=i}enable(e){this._inertiaOptions=e||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class er{constructor(e,t,i){this._pitchWithRotate=e.pitchWithRotate,this._mouseRotate=t,this._mousePitch=i}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class tr{constructor(e,t,i,n){this._el=e,this._touchZoom=t,this._touchRotate=i,this._tapDragZoom=n,this._rotationDisabled=!1,this._enabled=!0}enable(e){this._touchZoom.enable(e),this._rotationDisabled||this._touchRotate.enable(e),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const ir=e=>e.zoom||e.drag||e.pitch||e.rotate;class nr extends e.k{}function rr(e){return e.panDelta&&e.panDelta.mag()||e.zoomDelta||e.bearingDelta||e.pitchDelta}class ar{constructor(e,t){this.handleWindowEvent=e=>{this.handleEvent(e,`${e.type}Window`)},this.handleEvent=(e,t)=>{if("blur"===e.type)return void this.stop(!0);this._updatingCamera=!0;const n="renderFrame"===e.type?void 0:e,r={needsRenderFrame:!1},a={},s={},o=e.touches,l=o?this._getMapTouches(o):void 0,c=l?i.touchPos(this._el,l):i.mousePos(this._el,e);for(const{handlerName:i,handler:d,allowed:p}of this._handlers){if(!d.isEnabled())continue;let o;this._blockedByActive(s,p,i)?d.reset():d[t||e.type]&&(o=d[t||e.type](e,c,l),this.mergeHandlerResult(r,a,o,i,n),o&&o.needsRenderFrame&&this._triggerRenderFrame()),(o||d.isActive())&&(s[i]=d)}const u={};for(const i in this._previousActiveHandlers)s[i]||(u[i]=n);this._previousActiveHandlers=s,(Object.keys(u).length||rr(r))&&(this._changes.push([r,a,u]),this._triggerRenderFrame()),(Object.keys(s).length||rr(r))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:h}=r;h&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],h(this._map))},this._map=e,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new mn(e),this._bearingSnap=t.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(t);const n=this._el;this._listeners=[[n,"touchstart",{passive:!0}],[n,"touchmove",{passive:!1}],[n,"touchend",void 0],[n,"touchcancel",void 0],[n,"mousedown",void 0],[n,"mousemove",void 0],[n,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[n,"mouseover",void 0],[n,"mouseout",void 0],[n,"dblclick",void 0],[n,"click",void 0],[n,"keydown",{capture:!1}],[n,"keyup",void 0],[n,"wheel",{passive:!1}],[n,"contextmenu",void 0],[window,"blur",void 0]];for(const[r,a,s]of this._listeners)i.addEventListener(r,a,r===document?this.handleWindowEvent:this.handleEvent,s)}destroy(){for(const[e,t,n]of this._listeners)i.removeEventListener(e,t,e===document?this.handleWindowEvent:this.handleEvent,n)}_addDefaultHandlers(e){const t=this._map,n=t.getCanvasContainer();this._add("mapEvent",new bn(t,e));const r=t.boxZoom=new Tn(t,e);this._add("boxZoom",r),e.interactive&&e.boxZoom&&r.enable();const a=new Cn(t),s=new Yn(t);t.doubleClickZoom=new Kn(s,a),this._add("tapZoom",a),this._add("clickZoom",s),e.interactive&&e.doubleClickZoom&&t.doubleClickZoom.enable();const o=new Jn;this._add("tapDragZoom",o);const l=t.touchPitch=new qn(t);this._add("touchPitch",l),e.interactive&&e.touchPitch&&t.touchPitch.enable(e.touchPitch);const c=Ln(e),u=Rn(e);t.dragRotate=new er(e,c,u),this._add("mouseRotate",c,["mousePitch"]),this._add("mousePitch",u,["mouseRotate"]),e.interactive&&e.dragRotate&&t.dragRotate.enable();const h=(e=>{let{enable:t,clickTolerance:n}=e;const r=new Mn({checkCorrectEvent:e=>0===i.mouseButton(e)&&!e.ctrlKey});return new In({clickTolerance:n,move:(e,t)=>({around:t,panDelta:t.sub(e)}),activateOnStart:!0,moveStateManager:r,enable:t,assignEvents:Dn})})(e),d=new Fn(e,t);t.dragPan=new Qn(n,h,d),this._add("mousePan",h),this._add("touchPan",d,["touchZoom","touchRotate"]),e.interactive&&e.dragPan&&t.dragPan.enable(e.dragPan);const p=new Un,f=new Vn;t.touchZoomRotate=new tr(n,f,p,o),this._add("touchRotate",p,["touchPan","touchZoom"]),this._add("touchZoom",f,["touchPan","touchRotate"]),e.interactive&&e.touchZoomRotate&&t.touchZoomRotate.enable(e.touchZoomRotate);const m=t.scrollZoom=new Xn(t,(()=>this._triggerRenderFrame()));this._add("scrollZoom",m,["mousePan"]),e.interactive&&e.scrollZoom&&t.scrollZoom.enable(e.scrollZoom);const g=t.keyboard=new Gn(t);this._add("keyboard",g),e.interactive&&e.keyboard&&t.keyboard.enable(),this._add("blockableMapEvent",new wn(t))}_add(e,t,i){this._handlers.push({handlerName:e,handler:t,allowed:i}),this._handlersById[e]=t}stop(e){if(!this._updatingCamera){for(const{handler:e}of this._handlers)e.reset();this._inertia.clear(),this._fireEvents({},{},e),this._changes=[]}}isActive(){for(const{handler:e}of this._handlers)if(e.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return Boolean(ir(this._eventsInProgress))||this.isZooming()}_blockedByActive(e,t,i){for(const n in e)if(n!==i&&(!t||t.indexOf(n)<0))return!0;return!1}_getMapTouches(e){const t=[];for(const i of e)this._el.contains(i.target)&&t.push(i);return t}mergeHandlerResult(t,i,n,r,a){if(!n)return;e.e(t,n);const s={handlerName:r,originalEvent:n.originalEvent||a};void 0!==n.zoomDelta&&(i.zoom=s),void 0!==n.panDelta&&(i.drag=s),void 0!==n.pitchDelta&&(i.pitch=s),void 0!==n.bearingDelta&&(i.rotate=s)}_applyChanges(){const t={},i={},n={};for(const[r,a,s]of this._changes)r.panDelta&&(t.panDelta=(t.panDelta||new e.P(0,0))._add(r.panDelta)),r.zoomDelta&&(t.zoomDelta=(t.zoomDelta||0)+r.zoomDelta),r.bearingDelta&&(t.bearingDelta=(t.bearingDelta||0)+r.bearingDelta),r.pitchDelta&&(t.pitchDelta=(t.pitchDelta||0)+r.pitchDelta),void 0!==r.around&&(t.around=r.around),void 0!==r.pinchAround&&(t.pinchAround=r.pinchAround),r.noInertia&&(t.noInertia=r.noInertia),e.e(i,a),e.e(n,s);this._updateMapTransform(t,i,n),this._changes=[]}_updateMapTransform(e,t,i){const n=this._map,r=n._getTransformForUpdate(),a=n.terrain;if(!(rr(e)||a&&this._terrainMovement))return this._fireEvents(t,i,!0);let{panDelta:s,zoomDelta:o,bearingDelta:l,pitchDelta:c,around:u,pinchAround:h}=e;void 0!==h&&(u=h),n._stop(!0),u=u||n.transform.centerPoint;const d=r.pointLocation(s?u.sub(s):u);l&&(r.bearing+=l),c&&(r.pitch+=c),o&&(r.zoom+=o),a?this._terrainMovement||!t.drag&&!t.zoom?t.drag&&this._terrainMovement?r.center=r.pointLocation(r.centerPoint.sub(s)):r.setLocationAtPoint(d,u):(this._terrainMovement=!0,this._map._elevationFreeze=!0,r.setLocationAtPoint(d,u),this._map.once("moveend",(()=>{this._map._elevationFreeze=!1,this._terrainMovement=!1,r.recalculateZoom(n.terrain)}))):r.setLocationAtPoint(d,u),n._applyUpdatedTransform(r),this._map._update(),e.noInertia||this._inertia.record(e),this._fireEvents(t,i,!0)}_fireEvents(t,i,n){const r=ir(this._eventsInProgress),a=ir(t),s={};for(const e in t){const{originalEvent:i}=t[e];this._eventsInProgress[e]||(s[`${e}start`]=i),this._eventsInProgress[e]=t[e]}!r&&a&&this._fireEvent("movestart",a.originalEvent);for(const e in s)this._fireEvent(e,s[e]);a&&this._fireEvent("move",a.originalEvent);for(const e in t){const{originalEvent:i}=t[e];this._fireEvent(e,i)}const o={};let l;for(const e in this._eventsInProgress){const{handlerName:t,originalEvent:n}=this._eventsInProgress[e];this._handlersById[t].isActive()||(delete this._eventsInProgress[e],l=i[t]||n,o[`${e}end`]=l)}for(const e in o)this._fireEvent(e,o[e]);const c=ir(this._eventsInProgress);if(n&&(r||a)&&!c){this._updatingCamera=!0;const t=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),i=e=>0!==e&&-this._bearingSnap<e&&e<this._bearingSnap;!t||!t.essential&&e.h.prefersReducedMotion?(this._map.fire(new e.k("moveend",{originalEvent:l})),i(this._map.getBearing())&&this._map.resetNorth()):(i(t.bearing||this._map.getBearing())&&(t.bearing=0),t.freezeElevation=!0,this._map.easeTo(t,{originalEvent:l})),this._updatingCamera=!1}}_fireEvent(t,i){this._map.fire(new e.k(t,i?{originalEvent:i}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add((e=>{delete this._frameId,this.handleEvent(new nr("renderFrame",{timeStamp:e})),this._applyChanges()}))}_triggerRenderFrame(){void 0===this._frameId&&(this._frameId=this._requestFrame())}}class sr extends e.E{constructor(t,i){super(),this._renderFrameCallback=()=>{const t=Math.min((e.h.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(t)),t<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=t,this._bearingSnap=i.bearingSnap,this.on("moveend",(()=>{delete this._requestedCameraState}))}getCenter(){return new e.L(this.transform.center.lng,this.transform.center.lat)}setCenter(e,t){return this.jumpTo({center:e},t)}panBy(t,i,n){return t=e.P.convert(t).mult(-1),this.panTo(this.transform.center,e.e({offset:t},i),n)}panTo(t,i,n){return this.easeTo(e.e({center:t},i),n)}getZoom(){return this.transform.zoom}setZoom(e,t){return this.jumpTo({zoom:e},t),this}zoomTo(t,i,n){return this.easeTo(e.e({zoom:t},i),n)}zoomIn(e,t){return this.zoomTo(this.getZoom()+1,e,t),this}zoomOut(e,t){return this.zoomTo(this.getZoom()-1,e,t),this}getBearing(){return this.transform.bearing}setBearing(e,t){return this.jumpTo({bearing:e},t),this}getPadding(){return this.transform.padding}setPadding(e,t){return this.jumpTo({padding:e},t),this}rotateTo(t,i,n){return this.easeTo(e.e({bearing:t},i),n)}resetNorth(t,i){return this.rotateTo(0,e.e({duration:1e3},t),i),this}resetNorthPitch(t,i){return this.easeTo(e.e({bearing:0,pitch:0,duration:1e3},t),i),this}snapToNorth(e,t){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(e,t):this}getPitch(){return this.transform.pitch}setPitch(e,t){return this.jumpTo({pitch:e},t),this}cameraForBounds(e,t){e=z.convert(e);const i=t&&t.bearing||0;return this._cameraForBoxAndBearing(e.getNorthWest(),e.getSouthEast(),i,t)}_cameraForBoxAndBearing(t,i,n,r){const a={top:0,bottom:0,right:0,left:0};if("number"==typeof(r=e.e({padding:a,offset:[0,0],maxZoom:this.transform.maxZoom},r)).padding){const e=r.padding;r.padding={top:e,bottom:e,right:e,left:e}}r.padding=e.e(a,r.padding);const s=this.transform,o=s.padding,l=s.project(e.L.convert(t)),c=s.project(e.L.convert(i)),u=l.rotate(-n*Math.PI/180),h=c.rotate(-n*Math.PI/180),d=new e.P(Math.max(u.x,h.x),Math.max(u.y,h.y)),p=new e.P(Math.min(u.x,h.x),Math.min(u.y,h.y)),f=d.sub(p),m=(s.width-(o.left+o.right+r.padding.left+r.padding.right))/f.x,g=(s.height-(o.top+o.bottom+r.padding.top+r.padding.bottom))/f.y;if(g<0||m<0)return void e.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const y=Math.min(s.scaleZoom(s.scale*Math.min(m,g)),r.maxZoom),_=e.P.convert(r.offset),v=new e.P((r.padding.left-r.padding.right)/2,(r.padding.top-r.padding.bottom)/2).rotate(n*Math.PI/180),x=_.add(v).mult(s.scale/s.zoomScale(y));return{center:s.unproject(l.add(c).div(2).sub(x)),zoom:y,bearing:n}}fitBounds(e,t,i){return this._fitInternal(this.cameraForBounds(e,t),t,i)}fitScreenCoordinates(t,i,n,r,a){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(e.P.convert(t)),this.transform.pointLocation(e.P.convert(i)),n,r),r,a)}_fitInternal(t,i,n){return t?(delete(i=e.e(t,i)).padding,i.linear?this.easeTo(i,n):this.flyTo(i,n)):this}jumpTo(t,i){this.stop();const n=this._getTransformForUpdate();let r=!1,a=!1,s=!1;return"zoom"in t&&n.zoom!==+t.zoom&&(r=!0,n.zoom=+t.zoom),void 0!==t.center&&(n.center=e.L.convert(t.center)),"bearing"in t&&n.bearing!==+t.bearing&&(a=!0,n.bearing=+t.bearing),"pitch"in t&&n.pitch!==+t.pitch&&(s=!0,n.pitch=+t.pitch),null==t.padding||n.isPaddingEqual(t.padding)||(n.padding=t.padding),this._applyUpdatedTransform(n),this.fire(new e.k("movestart",i)).fire(new e.k("move",i)),r&&this.fire(new e.k("zoomstart",i)).fire(new e.k("zoom",i)).fire(new e.k("zoomend",i)),a&&this.fire(new e.k("rotatestart",i)).fire(new e.k("rotate",i)).fire(new e.k("rotateend",i)),s&&this.fire(new e.k("pitchstart",i)).fire(new e.k("pitch",i)).fire(new e.k("pitchend",i)),this.fire(new e.k("moveend",i))}calculateCameraOptionsFromTo(t,i,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;const a=e.U.fromLngLat(t,i),s=e.U.fromLngLat(n,r),o=s.x-a.x,l=s.y-a.y,c=s.z-a.z,u=Math.hypot(o,l,c);if(0===u)throw new Error("Can't calculate camera options with same From and To");const h=Math.hypot(o,l),d=this.transform.scaleZoom(this.transform.cameraToCenterDistance/u/this.transform.tileSize),p=180*Math.atan2(o,-l)/Math.PI;let f=180*Math.acos(h/u)/Math.PI;return f=c<0?90-f:90+f,{center:s.toLngLat(),zoom:d,pitch:f,bearing:p}}easeTo(t,i){this._stop(!1,t.easeId),(!1===(t=e.e({offset:[0,0],duration:500,easing:e.bb},t)).animate||!t.essential&&e.h.prefersReducedMotion)&&(t.duration=0);const n=this._getTransformForUpdate(),r=this.getZoom(),a=this.getBearing(),s=this.getPitch(),o=this.getPadding(),l="zoom"in t?+t.zoom:r,c="bearing"in t?this._normalizeBearing(t.bearing,a):a,u="pitch"in t?+t.pitch:s,h="padding"in t?t.padding:n.padding,d=e.P.convert(t.offset);let p=n.centerPoint.add(d);const f=n.pointLocation(p),m=e.L.convert(t.center||f);this._normalizeCenter(m);const g=n.project(f),y=n.project(m).sub(g),_=n.zoomScale(l-r);let v,x;t.around&&(v=e.L.convert(t.around),x=n.locationPoint(v));const b={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||l!==r,this._rotating=this._rotating||a!==c,this._pitching=this._pitching||u!==s,this._padding=!n.isPaddingEqual(h),this._easeId=t.easeId,this._prepareEase(i,t.noMoveStart,b),this.terrain&&this._prepareElevation(m),this._ease((f=>{if(this._zooming&&(n.zoom=e.B.number(r,l,f)),this._rotating&&(n.bearing=e.B.number(a,c,f)),this._pitching&&(n.pitch=e.B.number(s,u,f)),this._padding&&(n.interpolatePadding(o,h,f),p=n.centerPoint.add(d)),this.terrain&&!t.freezeElevation&&this._updateElevation(f),v)n.setLocationAtPoint(v,x);else{const e=n.zoomScale(n.zoom-r),t=l>r?Math.min(2,_):Math.max(.5,_),i=Math.pow(t,1-f),a=n.unproject(g.add(y.mult(f*i)).mult(e));n.setLocationAtPoint(n.renderWorldCopies?a.wrap():a,p)}this._applyUpdatedTransform(n),this._fireMoveEvents(i)}),(e=>{this.terrain&&this._finalizeElevation(),this._afterEase(i,e)}),t),this}_prepareEase(t,i){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this._moving=!0,i||n.moving||this.fire(new e.k("movestart",t)),this._zooming&&!n.zooming&&this.fire(new e.k("zoomstart",t)),this._rotating&&!n.rotating&&this.fire(new e.k("rotatestart",t)),this._pitching&&!n.pitching&&this.fire(new e.k("pitchstart",t))}_prepareElevation(e){this._elevationCenter=e,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(e,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(t){this.transform._minEleveationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);const i=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(t<1&&i!==this._elevationTarget){const e=this._elevationTarget-this._elevationStart;this._elevationStart+=t*(e-(i-(e*t+this._elevationStart))/(1-t)),this._elevationTarget=i}this.transform.elevation=e.B.number(this._elevationStart,this._elevationTarget,t)}_finalizeElevation(){this._elevationFreeze=!1,this.transform.recalculateZoom(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_applyUpdatedTransform(e){if(!this.transformCameraUpdate)return;const t=e.clone(),{center:i,zoom:n,pitch:r,bearing:a,elevation:s}=this.transformCameraUpdate(t);i&&(t.center=i),void 0!==n&&(t.zoom=n),void 0!==r&&(t.pitch=r),void 0!==a&&(t.bearing=a),void 0!==s&&(t.elevation=s),this.transform.apply(t)}_fireMoveEvents(t){this.fire(new e.k("move",t)),this._zooming&&this.fire(new e.k("zoom",t)),this._rotating&&this.fire(new e.k("rotate",t)),this._pitching&&this.fire(new e.k("pitch",t))}_afterEase(t,i){if(this._easeId&&i&&this._easeId===i)return;delete this._easeId;const n=this._zooming,r=this._rotating,a=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,n&&this.fire(new e.k("zoomend",t)),r&&this.fire(new e.k("rotateend",t)),a&&this.fire(new e.k("pitchend",t)),this.fire(new e.k("moveend",t))}flyTo(t,i){if(!t.essential&&e.h.prefersReducedMotion){const n=e.F(t,["center","zoom","bearing","pitch","around"]);return this.jumpTo(n,i)}this.stop(),t=e.e({offset:[0,0],speed:1.2,curve:1.42,easing:e.bb},t);const n=this._getTransformForUpdate(),r=this.getZoom(),a=this.getBearing(),s=this.getPitch(),o=this.getPadding(),l="zoom"in t?e.ad(+t.zoom,n.minZoom,n.maxZoom):r,c="bearing"in t?this._normalizeBearing(t.bearing,a):a,u="pitch"in t?+t.pitch:s,h="padding"in t?t.padding:n.padding,d=n.zoomScale(l-r),p=e.P.convert(t.offset);let f=n.centerPoint.add(p);const m=n.pointLocation(f),g=e.L.convert(t.center||m);this._normalizeCenter(g);const y=n.project(m),_=n.project(g).sub(y);let v=t.curve;const x=Math.max(n.width,n.height),b=x/d,w=_.mag();if("minZoom"in t){const i=e.ad(Math.min(t.minZoom,r,l),n.minZoom,n.maxZoom),a=x/n.zoomScale(i-r);v=Math.sqrt(a/w*2)}const S=v*v;function T(e){const t=(b*b-x*x+(e?-1:1)*S*S*w*w)/(2*(e?b:x)*S*w);return Math.log(Math.sqrt(t*t+1)-t)}function k(e){return(Math.exp(e)-Math.exp(-e))/2}function E(e){return(Math.exp(e)+Math.exp(-e))/2}const P=T(!1);let C=function(e){return E(P)/E(P+v*e)},I=function(e){return x*((E(P)*(k(t=P+v*e)/E(t))-k(P))/S)/w;var t},A=(T(!0)-P)/v;if(Math.abs(w)<1e-6||!isFinite(A)){if(Math.abs(x-b)<1e-6)return this.easeTo(t,i);const e=b<x?-1:1;A=Math.abs(Math.log(b/x))/v,I=function(){return 0},C=function(t){return Math.exp(e*v*t)}}return t.duration="duration"in t?+t.duration:1e3*A/("screenSpeed"in t?+t.screenSpeed/v:+t.speed),t.maxDuration&&t.duration>t.maxDuration&&(t.duration=0),this._zooming=!0,this._rotating=a!==c,this._pitching=u!==s,this._padding=!n.isPaddingEqual(h),this._prepareEase(i,!1),this.terrain&&this._prepareElevation(g),this._ease((d=>{const m=d*A,v=1/C(m);n.zoom=1===d?l:r+n.scaleZoom(v),this._rotating&&(n.bearing=e.B.number(a,c,d)),this._pitching&&(n.pitch=e.B.number(s,u,d)),this._padding&&(n.interpolatePadding(o,h,d),f=n.centerPoint.add(p)),this.terrain&&!t.freezeElevation&&this._updateElevation(d);const x=1===d?g:n.unproject(y.add(_.mult(I(m))).mult(v));n.setLocationAtPoint(n.renderWorldCopies?x.wrap():x,f),this._applyUpdatedTransform(n),this._fireMoveEvents(i)}),(()=>{this.terrain&&this._finalizeElevation(),this._afterEase(i)}),t),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(e,t){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const e=this._onEaseEnd;delete this._onEaseEnd,e.call(this,t)}if(!e){const e=this.handlers;e&&e.stop(!1)}return this}_ease(t,i,n){!1===n.animate||0===n.duration?(t(1),i()):(this._easeStart=e.h.now(),this._easeOptions=n,this._onEaseFrame=t,this._onEaseEnd=i,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(t,i){t=e.b5(t,-180,180);const n=Math.abs(t-i);return Math.abs(t-360-i)<n&&(t-=360),Math.abs(t+360-i)<n&&(t+=360),t}_normalizeCenter(e){const t=this.transform;if(!t.renderWorldCopies||t.lngRange)return;const i=e.lng-t.center.lng;e.lng+=i>180?-360:i<-180?360:0}queryTerrainElevation(t){return this.terrain?this.terrain.getElevationForLngLatZoom(e.L.convert(t),this.transform.tileZoom)-this.transform.elevation:null}}class or{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=e=>{!e||"metadata"!==e.sourceDataType&&"visibility"!==e.sourceDataType&&"style"!==e.dataType&&"terrain"!==e.type||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?!1===this._compact?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=e}getDefaultPosition(){return"bottom-right"}onAdd(e){return this._map=e,this._compact=this.options&&this.options.compact,this._container=i.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=i.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=i.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){i.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(e,t){const i=this._map._getUIString(`AttributionControl.${t}`);e.title=i,e.setAttribute("aria-label",i)}_updateAttributions(){if(!this._map.style)return;let e=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?e=e.concat(this.options.customAttribution.map((e=>"string"!=typeof e?"":e))):"string"==typeof this.options.customAttribution&&e.push(this.options.customAttribution)),this._map.style.stylesheet){const e=this._map.style.stylesheet;this.styleOwner=e.owner,this.styleId=e.id}const t=this._map.style.sourceCaches;for(const n in t){const i=t[n];if(i.used||i.usedForTerrain){const t=i.getSource();t.attribution&&e.indexOf(t.attribution)<0&&e.push(t.attribution)}}e=e.filter((e=>String(e).trim())),e.sort(((e,t)=>e.length-t.length)),e=e.filter(((t,i)=>{for(let n=i+1;n<e.length;n++)if(e[n].indexOf(t)>=0)return!1;return!0}));const i=e.join(" | ");i!==this._attribHTML&&(this._attribHTML=i,e.length?(this._innerContainer.innerHTML=i,this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class lr{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._updateCompact=()=>{const e=this._container.children;if(e.length){const t=e[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?!1!==this._compact&&t.classList.add("maplibregl-compact"):t.classList.remove("maplibregl-compact")}},this.options=e}getDefaultPosition(){return"bottom-left"}onAdd(e){this._map=e,this._compact=this.options&&this.options.compact,this._container=i.create("div","maplibregl-ctrl");const t=i.create("a","maplibregl-ctrl-logo");return t.target="_blank",t.rel="noopener nofollow",t.href="https://maplibre.org/",t.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),t.setAttribute("rel","noopener nofollow"),this._container.appendChild(t),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){i.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class cr{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(e){const t=++this._id;return this._queue.push({callback:e,id:t,cancelled:!1}),t}remove(e){const t=this._currentlyRunning,i=t?this._queue.concat(t):this._queue;for(const n of i)if(n.id===e)return void(n.cancelled=!0)}run(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const t=this._currentlyRunning=this._queue;this._queue=[];for(const i of t)if(!i.cancelled&&(i.callback(e),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}const ur={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","TerrainControl.enableTerrain":"Enable terrain","TerrainControl.disableTerrain":"Disable terrain"};var hr=e.Q([{name:"a_pos3d",type:"Int16",components:3}]);class dr extends e.E{constructor(e){super(),this.sourceCache=e,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.deltaZoom=1,e.usedForTerrain=!0,e.tileSize=this.tileSize*2**this.deltaZoom}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(t,i){this.sourceCache.update(t,i),this._renderableTilesKeys=[];const n={};for(const r of t.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:i}))n[r.key]=!0,this._renderableTilesKeys.push(r.key),this._tiles[r.key]||(r.posMatrix=new Float64Array(16),e.aS(r.posMatrix,0,e.N,0,e.N,0,1),this._tiles[r.key]=new W(r,this.tileSize));for(const e in this._tiles)n[e]||delete this._tiles[e]}freeRtt(e){for(const t in this._tiles){const i=this._tiles[t];(!e||i.tileID.equals(e)||i.tileID.isChildOf(e)||e.isChildOf(i.tileID))&&(i.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map((e=>this.getTileByID(e)))}getTileByID(e){return this._tiles[e]}getTerrainCoords(t){const i={};for(const n of this._renderableTilesKeys){const r=this._tiles[n].tileID;if(r.canonical.equals(t.canonical)){const r=t.clone();r.posMatrix=new Float64Array(16),e.aS(r.posMatrix,0,e.N,0,e.N,0,1),i[n]=r}else if(r.canonical.isChildOf(t.canonical)){const a=t.clone();a.posMatrix=new Float64Array(16);const s=r.canonical.z-t.canonical.z,o=r.canonical.x-(r.canonical.x>>s<<s),l=r.canonical.y-(r.canonical.y>>s<<s),c=e.N>>s;e.aS(a.posMatrix,0,c,0,c,0,1),e.$(a.posMatrix,a.posMatrix,[-o*c,-l*c,0]),i[n]=a}else if(t.canonical.isChildOf(r.canonical)){const a=t.clone();a.posMatrix=new Float64Array(16);const s=t.canonical.z-r.canonical.z,o=t.canonical.x-(t.canonical.x>>s<<s),l=t.canonical.y-(t.canonical.y>>s<<s),c=e.N>>s;e.aS(a.posMatrix,0,e.N,0,e.N,0,1),e.$(a.posMatrix,a.posMatrix,[o*c,l*c,0]),e.a0(a.posMatrix,a.posMatrix,[1/2**s,1/2**s,0]),i[n]=a}}return i}getSourceTile(e,t){const i=this.sourceCache._source;let n=e.overscaledZ-this.deltaZoom;if(n>i.maxzoom&&(n=i.maxzoom),n<i.minzoom)return null;this._sourceTileCache[e.key]||(this._sourceTileCache[e.key]=e.scaledTo(n).key);let r=this.sourceCache.getTileByID(this._sourceTileCache[e.key]);if((!r||!r.dem)&&t)for(;n>=i.minzoom&&(!r||!r.dem);)r=this.sourceCache.getTileByID(e.scaledTo(n--).key);return r}tilesAfterTime(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Date.now();return Object.values(this._tiles).filter((t=>t.timeAdded>=e))}}class pr{constructor(e,t,i){this.painter=e,this.sourceCache=new dr(t),this.options=i,this.exaggeration="number"==typeof i.exaggeration?i.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(t,i,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.N;var a;if(!(i>=0&&i<r&&n>=0&&n<r))return 0;const s=this.getTerrainData(t),o=null===(a=s.tile)||void 0===a?void 0:a.dem;if(!o)return 0;const l=function(e,t,i){var n=t[0],r=t[1];return e[0]=i[0]*n+i[4]*r+i[12],e[1]=i[1]*n+i[5]*r+i[13],e}([],[i/r*e.N,n/r*e.N],s.u_terrain_matrix),c=[l[0]*o.dim,l[1]*o.dim],u=Math.floor(c[0]),h=Math.floor(c[1]),d=c[0]-u,p=c[1]-h;return o.get(u,h)*(1-d)*(1-p)+o.get(u+1,h)*d*(1-p)+o.get(u,h+1)*(1-d)*p+o.get(u+1,h+1)*d*p}getElevationForLngLatZoom(t,i){const{tileID:n,mercatorX:r,mercatorY:a}=this._getOverscaledTileIDFromLngLatZoom(t,i);return this.getElevation(n,r%e.N,a%e.N,e.N)}getElevation(t,i,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.N;return this.getDEMElevation(t,i,n,r)*this.exaggeration}getTerrainData(t){if(!this._emptyDemTexture){const t=this.painter.context,i=new e.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new v(t,i,t.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new v(t,new e.R({width:1,height:1}),t.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(t.gl.NEAREST,t.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=e.ao([])}const i=this.sourceCache.getSourceTile(t,!0);if(i&&i.dem&&(!i.demTexture||i.needsTerrainPrepare)){const e=this.painter.context;i.demTexture=this.painter.getTileTexture(i.dem.stride),i.demTexture?i.demTexture.update(i.dem.getPixels(),{premultiply:!1}):i.demTexture=new v(e,i.dem.getPixels(),e.gl.RGBA,{premultiply:!1}),i.demTexture.bind(e.gl.NEAREST,e.gl.CLAMP_TO_EDGE),i.needsTerrainPrepare=!1}const n=i&&i+i.tileID.key+t.key;if(n&&!this._demMatrixCache[n]){const n=this.sourceCache.sourceCache._source.maxzoom;let r=t.canonical.z-i.tileID.canonical.z;t.overscaledZ>t.canonical.z&&(t.canonical.z>=n?r=t.canonical.z-n:e.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const a=t.canonical.x-(t.canonical.x>>r<<r),s=t.canonical.y-(t.canonical.y>>r<<r),o=e.bc(new Float64Array(16),[1/(e.N<<r),1/(e.N<<r),0]);e.$(o,o,[a*e.N,s*e.N,0]),this._demMatrixCache[t.key]={matrix:o,coord:t}}return{u_depth:2,u_terrain:3,u_terrain_dim:i&&i.dem&&i.dem.dim||1,u_terrain_matrix:n?this._demMatrixCache[t.key].matrix:this._emptyDemMatrix,u_terrain_unpack:i&&i.dem&&i.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(i&&i.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:i}}getFramebuffer(e){const t=this.painter,i=t.width/devicePixelRatio,n=t.height/devicePixelRatio;return!this._fbo||this._fbo.width===i&&this._fbo.height===n||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new v(t.context,{width:i,height:n,data:null},t.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(t.context.gl.NEAREST,t.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new v(t.context,{width:i,height:n,data:null},t.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(t.context.gl.NEAREST,t.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=t.context.createFramebuffer(i,n,!0,!1),this._fbo.depthAttachment.set(t.context.createRenderbuffer(t.context.gl.DEPTH_COMPONENT16,i,n))),this._fbo.colorAttachment.set("coords"===e?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const t=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const i=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let e=0,a=0;e<this._coordsTextureSize;e++)for(let t=0;t<this._coordsTextureSize;t++,a+=4)i[a+0]=255&t,i[a+1]=255&e,i[a+2]=t>>8<<4|e>>8,i[a+3]=0;const n=new e.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(i.buffer)),r=new v(t,n,t.gl.RGBA,{premultiply:!1});return r.bind(t.gl.NEAREST,t.gl.CLAMP_TO_EDGE),this._coordsTexture=r,r}pointCoordinate(t){const i=new Uint8Array(4),n=this.painter.context,r=n.gl;n.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),r.readPixels(t.x,this.painter.height/devicePixelRatio-t.y-1,1,1,r.RGBA,r.UNSIGNED_BYTE,i),n.bindFramebuffer.set(null);const a=i[0]+(i[2]>>4<<8),s=i[1]+((15&i[2])<<8),o=this.coordsIndex[255-i[3]],l=o&&this.sourceCache.getTileByID(o);if(!l)return null;const c=this._coordsTextureSize,u=(1<<l.tileID.canonical.z)*c;return new e.U(this._allowMercatorOverflow(t,(l.tileID.canonical.x*c+a)/u),(l.tileID.canonical.y*c+s)/u,this.getElevation(l.tileID,a,s,c))}getTerrainMesh(){if(this._mesh)return this._mesh;const t=this.painter.context,i=new e.bd,n=new e.b0,r=this.meshSize,a=e.N/r,s=r*r;for(let e=0;e<=r;e++)for(let t=0;t<=r;t++)i.emplaceBack(t*a,e*a,0);for(let e=0;e<s;e+=r+1)for(let t=0;t<r;t++)n.emplaceBack(t+e,r+t+e+1,r+t+e+2),n.emplaceBack(t+e,r+t+e+2,t+e+1);const o=i.length,l=o+2*(r+1);for(const h of[0,1])for(let t=0;t<=r;t++)for(const n of[0,1])i.emplaceBack(t*a,h*e.N,n);for(let e=0;e<2*r;e+=2)n.emplaceBack(l+e,l+e+1,l+e+3),n.emplaceBack(l+e,l+e+3,l+e+2),n.emplaceBack(o+e,o+e+3,o+e+1),n.emplaceBack(o+e,o+e+2,o+e+3);const c=i.length,u=c+2*(r+1);for(const h of[0,1])for(let t=0;t<=r;t++)for(const n of[0,1])i.emplaceBack(h*e.N,t*a,n);for(let e=0;e<2*r;e+=2)n.emplaceBack(c+e,c+e+1,c+e+3),n.emplaceBack(c+e,c+e+3,c+e+2),n.emplaceBack(u+e,u+e+3,u+e+1),n.emplaceBack(u+e,u+e+2,u+e+3);return this._mesh={indexBuffer:t.createIndexBuffer(n),vertexBuffer:t.createVertexBuffer(i,hr.members),segments:e.S.simpleSegment(0,0,i.length,n.length)},this._mesh}getMeshFrameDelta(t){return 2*Math.PI*e.be/Math.pow(2,t)/5}getMinTileElevationForLngLatZoom(e,t){var i;const{tileID:n}=this._getOverscaledTileIDFromLngLatZoom(e,t);return null!==(i=this.getMinMaxElevation(n).minElevation)&&void 0!==i?i:0}getMinMaxElevation(e){const t=this.getTerrainData(e).tile,i={minElevation:null,maxElevation:null};return t&&t.dem&&(i.minElevation=t.dem.min*this.exaggeration,i.maxElevation=t.dem.max*this.exaggeration),i}_getOverscaledTileIDFromLngLatZoom(t,i){const n=e.U.fromLngLat(t.wrap()),r=(1<<i)*e.N,a=n.x*r,s=n.y*r,o=Math.floor(a/e.N),l=Math.floor(s/e.N);return{tileID:new e.O(i,0,i,o,l),mercatorX:a,mercatorY:s}}_allowMercatorOverflow(t,i){const n=t.x<this.painter.width/2;let r=e.bf(i);const a=this.painter.transform.center.lng;return n&&Math.sign(r)>0&&Math.sign(a)<0||!n&&Math.sign(r)<0&&Math.sign(a)>0?(r=360*Math.sign(a)+r,e.G(r)):i}}class fr{constructor(e,t,i){this._context=e,this._size=t,this._tileSize=i,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const e of this._objects)e.texture.destroy(),e.fbo.destroy()}_createObject(e){const t=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),i=new v(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return i.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),t.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),t.colorAttachment.set(i.texture),{id:e,fbo:t,texture:i,stamp:-1,inUse:!1}}getObjectForId(e){return this._objects[e]}useObject(e){e.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter((t=>e.id!==t)),this._recentlyUsed.push(e.id)}stampObject(e){e.stamp=++this._stamp}getOrCreateFreeObject(){for(const t of this._recentlyUsed)if(!this._objects[t].inUse)return this._objects[t];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const e=this._createObject(this._objects.length);return this._objects.push(e),e}freeObject(e){e.inUse=!1}freeAllObjects(){for(const e of this._objects)this.freeObject(e)}isFull(){return!(this._objects.length<this._size)&&!1===this._objects.some((e=>!e.inUse))}}const mr={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0};class gr{constructor(e,t){this.painter=e,this.terrain=t,this.pool=new fr(e.context,30,t.sourceCache.tileSize*t.qualityFactor)}destruct(){this.pool.destruct()}getTexture(e){return this.pool.getObjectForId(e.rtt[this._stacks.length-1].id).texture}prepareForRender(e,t){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=e._order.filter((i=>!e._layers[i].isHidden(t))),this._coordsDescendingInv={};for(const i in e.sourceCaches){this._coordsDescendingInv[i]={};const t=e.sourceCaches[i].getVisibleCoordinates();for(const e of t){const t=this.terrain.sourceCache.getTerrainCoords(e);for(const e in t)this._coordsDescendingInv[i][e]||(this._coordsDescendingInv[i][e]=[]),this._coordsDescendingInv[i][e].push(t[e])}}this._coordsDescendingInvStr={};for(const i of e._order){const t=e._layers[i],n=t.source;if(mr[t.type]&&!this._coordsDescendingInvStr[n]){this._coordsDescendingInvStr[n]={};for(const e in this._coordsDescendingInv[n])this._coordsDescendingInvStr[n][e]=this._coordsDescendingInv[n][e].map((e=>e.key)).sort().join()}}for(const i of this._renderableTiles)for(const e in this._coordsDescendingInvStr){const t=this._coordsDescendingInvStr[e][i.tileID.key];t&&t!==i.rttCoords[e]&&(i.rtt=[])}}renderLayer(t){if(t.isHidden(this.painter.transform.zoom))return!1;const i=t.type,n=this.painter,r=this._renderableLayerIds[this._renderableLayerIds.length-1]===t.id;if(mr[i]&&(this._prevType&&mr[this._prevType]||this._stacks.push([]),this._prevType=i,this._stacks[this._stacks.length-1].push(t.id),!r))return!0;if(mr[this._prevType]||mr[i]&&r){this._prevType=i;const t=this._stacks.length-1,r=this._stacks[t]||[];for(const i of this._renderableTiles){if(this.pool.isFull()&&(tn(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(i),i.rtt[t]){const e=this.pool.getObjectForId(i.rtt[t].id);if(e.stamp===i.rtt[t].stamp){this.pool.useObject(e);continue}}const a=this.pool.getOrCreateFreeObject();this.pool.useObject(a),this.pool.stampObject(a),i.rtt[t]={id:a.id,stamp:a.stamp},n.context.bindFramebuffer.set(a.fbo.framebuffer),n.context.clear({color:e.aT.transparent,stencil:0}),n.currentStencilSource=void 0;for(let e=0;e<r.length;e++){const t=n.style._layers[r[e]],s=t.source?this._coordsDescendingInv[t.source][i.tileID.key]:[i.tileID];n.context.viewport.set([0,0,a.fbo.width,a.fbo.height]),n._renderTileClippingMasks(t,s),n.renderLayer(n,n.style.sourceCaches[t.source],t,s),t.source&&(i.rttCoords[t.source]=this._coordsDescendingInvStr[t.source][i.tileID.key])}}return tn(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects(),mr[i]}return!1}}const yr=t,_r={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:void 0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:e.c.MAX_TILE_CACHE_ZOOM_LEVELS,localIdeographFontFamily:"sans-serif",transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,validateStyle:!0,maxCanvasSize:[4096,4096]},vr=e=>{e.touchstart=e.dragStart,e.touchmoveWindow=e.dragMove,e.touchend=e.dragEnd},xr={showCompass:!0,showZoom:!0,visualizePitch:!1};class br{constructor(t,n){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.mousedown=t=>{this.startMouse(e.e({},t,{ctrlKey:!0,preventDefault:()=>t.preventDefault()}),i.mousePos(this.element,t)),i.addEventListener(window,"mousemove",this.mousemove),i.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=e=>{this.moveMouse(e,i.mousePos(this.element,e))},this.mouseup=e=>{this.mouseRotate.dragEnd(e),this.mousePitch&&this.mousePitch.dragEnd(e),this.offTemp()},this.touchstart=e=>{1!==e.targetTouches.length?this.reset():(this._startPos=this._lastPos=i.touchPos(this.element,e.targetTouches)[0],this.startTouch(e,this._startPos),i.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),i.addEventListener(window,"touchend",this.touchend))},this.touchmove=e=>{1!==e.targetTouches.length?this.reset():(this._lastPos=i.touchPos(this.element,e.targetTouches)[0],this.moveTouch(e,this._lastPos))},this.touchend=e=>{0===e.targetTouches.length&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),this.touchRotate.reset(),this.touchPitch&&this.touchPitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10;const a=t.dragRotate._mouseRotate.getClickTolerance(),s=t.dragRotate._mousePitch.getClickTolerance();this.element=n,this.mouseRotate=Ln({clickTolerance:a,enable:!0}),this.touchRotate=(e=>{let{enable:t,clickTolerance:i,bearingDegreesPerPixelMoved:n=.8}=e;const r=new zn;return new In({clickTolerance:i,move:(e,t)=>({bearingDelta:(t.x-e.x)*n}),moveStateManager:r,enable:t,assignEvents:vr})})({clickTolerance:a,enable:!0}),this.map=t,r&&(this.mousePitch=Rn({clickTolerance:s,enable:!0}),this.touchPitch=(e=>{let{enable:t,clickTolerance:i,pitchDegreesPerPixelMoved:n=-.5}=e;const r=new zn;return new In({clickTolerance:i,move:(e,t)=>({pitchDelta:(t.y-e.y)*n}),moveStateManager:r,enable:t,assignEvents:vr})})({clickTolerance:s,enable:!0})),i.addEventListener(n,"mousedown",this.mousedown),i.addEventListener(n,"touchstart",this.touchstart,{passive:!1}),i.addEventListener(n,"touchcancel",this.reset)}startMouse(e,t){this.mouseRotate.dragStart(e,t),this.mousePitch&&this.mousePitch.dragStart(e,t),i.disableDrag()}startTouch(e,t){this.touchRotate.dragStart(e,t),this.touchPitch&&this.touchPitch.dragStart(e,t),i.disableDrag()}moveMouse(e,t){const i=this.map,{bearingDelta:n}=this.mouseRotate.dragMove(e,t)||{};if(n&&i.setBearing(i.getBearing()+n),this.mousePitch){const{pitchDelta:n}=this.mousePitch.dragMove(e,t)||{};n&&i.setPitch(i.getPitch()+n)}}moveTouch(e,t){const i=this.map,{bearingDelta:n}=this.touchRotate.dragMove(e,t)||{};if(n&&i.setBearing(i.getBearing()+n),this.touchPitch){const{pitchDelta:n}=this.touchPitch.dragMove(e,t)||{};n&&i.setPitch(i.getPitch()+n)}}off(){const e=this.element;i.removeEventListener(e,"mousedown",this.mousedown),i.removeEventListener(e,"touchstart",this.touchstart,{passive:!1}),i.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),i.removeEventListener(window,"touchend",this.touchend),i.removeEventListener(e,"touchcancel",this.reset),this.offTemp()}offTemp(){i.enableDrag(),i.removeEventListener(window,"mousemove",this.mousemove),i.removeEventListener(window,"mouseup",this.mouseup),i.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),i.removeEventListener(window,"touchend",this.touchend)}}let wr;function Sr(t,i,n){if(t=new e.L(t.lng,t.lat),i){const r=new e.L(t.lng-360,t.lat),a=new e.L(t.lng+360,t.lat),s=n.locationPoint(t).distSqr(i);n.locationPoint(r).distSqr(i)<s?t=r:n.locationPoint(a).distSqr(i)<s&&(t=a)}for(;Math.abs(t.lng-n.center.lng)>180;){const e=n.locationPoint(t);if(e.x>=0&&e.y>=0&&e.x<=n.width&&e.y<=n.height)break;t.lng>n.center.lng?t.lng-=360:t.lng+=360}return t}const Tr={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function kr(e,t,i){const n=e.classList;for(const r in Tr)n.remove(`maplibregl-${i}-anchor-${r}`);n.add(`maplibregl-${i}-anchor-${t}`)}class Er extends e.E{constructor(t){if(super(),this._onKeyPress=e=>{const t=e.code,i=e.charCode||e.keyCode;"Space"!==t&&"Enter"!==t&&32!==i&&13!==i||this.togglePopup()},this._onMapClick=e=>{const t=e.originalEvent.target,i=this._element;this._popup&&(t===i||i.contains(t))&&this.togglePopup()},this._update=e=>{if(!this._map)return;const t=this._map.loaded()&&!this._map.isMoving();("terrain"===(null==e?void 0:e.type)||"render"===(null==e?void 0:e.type)&&!t)&&this._map.once("render",this._update),this._map.transform.renderWorldCopies&&(this._lngLat=Sr(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);let n="";"viewport"===this._rotationAlignment||"auto"===this._rotationAlignment?n=`rotateZ(${this._rotation}deg)`:"map"===this._rotationAlignment&&(n=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let r="";"viewport"===this._pitchAlignment||"auto"===this._pitchAlignment?r="rotateX(0deg)":"map"===this._pitchAlignment&&(r=`rotateX(${this._map.getPitch()}deg)`),e&&"moveend"!==e.type||(this._pos=this._pos.round()),i.setTransform(this._element,`${Tr[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${r} ${n}`),this._map.terrain&&!this._opacityTimeout&&(this._opacityTimeout=setTimeout((()=>{const e=this._map.unproject(this._pos),t=40075016.686*Math.abs(Math.cos(this._lngLat.lat*Math.PI/180))/Math.pow(2,this._map.transform.tileZoom+8);this._element.style.opacity=e.distanceTo(this._lngLat)>20*t?"0.2":"1.0",this._opacityTimeout=null}),100))},this._onMove=t=>{if(!this._isDragging){const e=this._clickTolerance||this._map._clickTolerance;this._isDragging=t.point.dist(this._pointerdownPos)>=e}this._isDragging&&(this._pos=t.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new e.k("dragstart"))),this.fire(new e.k("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),"active"===this._state&&this.fire(new e.k("dragend")),this._state="inactive"},this._addDragHandler=e=>{this._element.contains(e.originalEvent.target)&&(e.preventDefault(),this._positionDelta=e.point.sub(this._pos).add(this._offset),this._pointerdownPos=e.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=t&&t.anchor||"center",this._color=t&&t.color||"#3FB1CE",this._scale=t&&t.scale||1,this._draggable=t&&t.draggable||!1,this._clickTolerance=t&&t.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=t&&t.rotation||0,this._rotationAlignment=t&&t.rotationAlignment||"auto",this._pitchAlignment=t&&t.pitchAlignment&&"auto"!==t.pitchAlignment?t.pitchAlignment:this._rotationAlignment,t&&t.element)this._element=t.element,this._offset=e.P.convert(t&&t.offset||[0,0]);else{this._defaultMarker=!0,this._element=i.create("div"),this._element.setAttribute("aria-label","Map marker");const n=i.createNS("http://www.w3.org/2000/svg","svg"),r=41,a=27;n.setAttributeNS(null,"display","block"),n.setAttributeNS(null,"height",`${r}px`),n.setAttributeNS(null,"width",`${a}px`),n.setAttributeNS(null,"viewBox",`0 0 ${a} ${r}`);const s=i.createNS("http://www.w3.org/2000/svg","g");s.setAttributeNS(null,"stroke","none"),s.setAttributeNS(null,"stroke-width","1"),s.setAttributeNS(null,"fill","none"),s.setAttributeNS(null,"fill-rule","evenodd");const o=i.createNS("http://www.w3.org/2000/svg","g");o.setAttributeNS(null,"fill-rule","nonzero");const l=i.createNS("http://www.w3.org/2000/svg","g");l.setAttributeNS(null,"transform","translate(3.0, 29.0)"),l.setAttributeNS(null,"fill","#000000");const c=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const e of c){const t=i.createNS("http://www.w3.org/2000/svg","ellipse");t.setAttributeNS(null,"opacity","0.04"),t.setAttributeNS(null,"cx","10.5"),t.setAttributeNS(null,"cy","5.80029008"),t.setAttributeNS(null,"rx",e.rx),t.setAttributeNS(null,"ry",e.ry),l.appendChild(t)}const u=i.createNS("http://www.w3.org/2000/svg","g");u.setAttributeNS(null,"fill",this._color);const h=i.createNS("http://www.w3.org/2000/svg","path");h.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),u.appendChild(h);const d=i.createNS("http://www.w3.org/2000/svg","g");d.setAttributeNS(null,"opacity","0.25"),d.setAttributeNS(null,"fill","#000000");const p=i.createNS("http://www.w3.org/2000/svg","path");p.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),d.appendChild(p);const f=i.createNS("http://www.w3.org/2000/svg","g");f.setAttributeNS(null,"transform","translate(6.0, 7.0)"),f.setAttributeNS(null,"fill","#FFFFFF");const m=i.createNS("http://www.w3.org/2000/svg","g");m.setAttributeNS(null,"transform","translate(8.0, 8.0)");const g=i.createNS("http://www.w3.org/2000/svg","circle");g.setAttributeNS(null,"fill","#000000"),g.setAttributeNS(null,"opacity","0.25"),g.setAttributeNS(null,"cx","5.5"),g.setAttributeNS(null,"cy","5.5"),g.setAttributeNS(null,"r","5.4999962");const y=i.createNS("http://www.w3.org/2000/svg","circle");y.setAttributeNS(null,"fill","#FFFFFF"),y.setAttributeNS(null,"cx","5.5"),y.setAttributeNS(null,"cy","5.5"),y.setAttributeNS(null,"r","5.4999962"),m.appendChild(g),m.appendChild(y),o.appendChild(l),o.appendChild(u),o.appendChild(d),o.appendChild(f),o.appendChild(m),n.appendChild(o),n.setAttributeNS(null,"height",r*this._scale+"px"),n.setAttributeNS(null,"width",a*this._scale+"px"),this._element.appendChild(n),this._offset=e.P.convert(t&&t.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",(e=>{e.preventDefault()})),this._element.addEventListener("mousedown",(e=>{e.preventDefault()})),kr(this._element,this._anchor,"marker"),t&&t.className)for(const e of t.className.split(" "))this._element.classList.add(e);this._popup=null}addTo(e){return this.remove(),this._map=e,e.getCanvasContainer().appendChild(this._element),e.on("move",this._update),e.on("moveend",this._update),e.on("terrain",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),i.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(t){return this._lngLat=e.L.convert(t),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(e){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),e){if(!("offset"in e.options)){const t=38.1,i=13.5,n=Math.abs(i)/Math.SQRT2;e.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-t],"bottom-left":[n,-1*(t-i+n)],"bottom-right":[-n,-1*(t-i+n)],left:[i,-1*(t-i)],right:[-i,-1*(t-i)]}:this._offset}this._popup=e,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}getPopup(){return this._popup}togglePopup(){const e=this._popup;return e?(e.isOpen()?e.remove():e.addTo(this._map),this):this}getOffset(){return this._offset}setOffset(t){return this._offset=e.P.convert(t),this._update(),this}addClassName(e){this._element.classList.add(e)}removeClassName(e){this._element.classList.remove(e)}toggleClassName(e){return this._element.classList.toggle(e)}setDraggable(e){return this._draggable=!!e,this._map&&(e?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(e){return this._rotation=e||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(e){return this._rotationAlignment=e||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(e){return this._pitchAlignment=e&&"auto"!==e?e:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}}const Pr={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let Cr=0,Ir=!1;const Ar={maxWidth:100,unit:"metric"};function Mr(e,t,i){const n=i&&i.maxWidth||100,r=e._container.clientHeight/2,a=e.unproject([0,r]),s=e.unproject([n,r]),o=a.distanceTo(s);if(i&&"imperial"===i.unit){const i=3.2808*o;i>5280?zr(t,n,i/5280,e._getUIString("ScaleControl.Miles")):zr(t,n,i,e._getUIString("ScaleControl.Feet"))}else i&&"nautical"===i.unit?zr(t,n,o/1852,e._getUIString("ScaleControl.NauticalMiles")):o>=1e3?zr(t,n,o/1e3,e._getUIString("ScaleControl.Kilometers")):zr(t,n,o,e._getUIString("ScaleControl.Meters"))}function zr(e,t,i,n){const r=function(e){const t=Math.pow(10,`${Math.floor(e)}`.length-1);let i=e/t;return i=i>=10?10:i>=5?5:i>=3?3:i>=2?2:i>=1?1:function(e){const t=Math.pow(10,Math.ceil(-Math.log(e)/Math.LN10));return Math.round(e*t)/t}(i),t*i}(i);e.style.width=t*(r/i)+"px",e.innerHTML=`${r}&nbsp;${n}`}const Dr={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},Lr=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Rr(t){if(t){if("number"==typeof t){const i=Math.round(Math.abs(t)/Math.SQRT2);return{center:new e.P(0,0),top:new e.P(0,t),"top-left":new e.P(i,i),"top-right":new e.P(-i,i),bottom:new e.P(0,-t),"bottom-left":new e.P(i,-i),"bottom-right":new e.P(-i,-i),left:new e.P(t,0),right:new e.P(-t,0)}}if(t instanceof e.P||Array.isArray(t)){const i=e.P.convert(t);return{center:i,top:i,"top-left":i,"top-right":i,bottom:i,"bottom-left":i,"bottom-right":i,left:i,right:i}}return{center:e.P.convert(t.center||[0,0]),top:e.P.convert(t.top||[0,0]),"top-left":e.P.convert(t["top-left"]||[0,0]),"top-right":e.P.convert(t["top-right"]||[0,0]),bottom:e.P.convert(t.bottom||[0,0]),"bottom-left":e.P.convert(t["bottom-left"]||[0,0]),"bottom-right":e.P.convert(t["bottom-right"]||[0,0]),left:e.P.convert(t.left||[0,0]),right:e.P.convert(t.right||[0,0])}}return Rr(new e.P(0,0))}const Fr={extend:function(t){for(var i=arguments.length,n=new Array(i>1?i-1:0),r=1;r<i;r++)n[r-1]=arguments[r];return e.e(t,...n)},run(e){e()},logToElement(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"log";const n=window.document.getElementById(i);n&&(t&&(n.innerHTML=""),n.innerHTML+=`<br>${e}`)}},Br=t;class Or{static get version(){return Br}static get workerCount(){return ee.workerCount}static set workerCount(e){ee.workerCount=e}static get maxParallelImageRequests(){return e.c.MAX_PARALLEL_IMAGE_REQUESTS}static set maxParallelImageRequests(t){e.c.MAX_PARALLEL_IMAGE_REQUESTS=t}static get workerUrl(){return e.c.WORKER_URL}static set workerUrl(t){e.c.WORKER_URL=t}static addProtocol(t,i){e.c.REGISTERED_PROTOCOLS[t]=i}static removeProtocol(t){delete e.c.REGISTERED_PROTOCOLS[t]}}return Or.Map=class extends sr{constructor(t){if(e.bg.mark(e.bh.create),null!=(t=e.e({},_r,t)).minZoom&&null!=t.maxZoom&&t.minZoom>t.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(null!=t.minPitch&&null!=t.maxPitch&&t.minPitch>t.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(null!=t.minPitch&&t.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(null!=t.maxPitch&&t.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new on(t.minZoom,t.maxZoom,t.minPitch,t.maxPitch,t.renderWorldCopies),{bearingSnap:t.bearingSnap}),this._cooperativeGesturesOnWheel=e=>{this._onCooperativeGesture(e,e[this._metaKey],1)},this._contextLost=t=>{t.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new e.k("webglcontextlost",{originalEvent:t}))},this._contextRestored=t=>{this._setupPainter(),this.resize(),this._update(),this.fire(new e.k("webglcontextrestored",{originalEvent:t}))},this._onMapScroll=e=>{if(e.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=t.interactive,this._cooperativeGestures=t.cooperativeGestures,this._metaKey=0===navigator.platform.indexOf("Mac")?"metaKey":"ctrlKey",this._maxTileCacheSize=t.maxTileCacheSize,this._maxTileCacheZoomLevels=t.maxTileCacheZoomLevels,this._failIfMajorPerformanceCaveat=t.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=t.preserveDrawingBuffer,this._antialias=t.antialias,this._trackResize=t.trackResize,this._bearingSnap=t.bearingSnap,this._refreshExpiredTiles=t.refreshExpiredTiles,this._fadeDuration=t.fadeDuration,this._crossSourceCollisions=t.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=t.collectResourceTiming,this._renderTaskQueue=new cr,this._controls=[],this._mapId=e.a2(),this._locale=e.e({},ur,t.locale),this._clickTolerance=t.clickTolerance,this._overridePixelRatio=t.pixelRatio,this._maxCanvasSize=t.maxCanvasSize,this.transformCameraUpdate=t.transformCameraUpdate,this._imageQueueHandle=c.addThrottleControl((()=>this.isMoving())),this._requestManager=new h(t.transformRequest),"string"==typeof t.container){if(this._container=document.getElementById(t.container),!this._container)throw new Error(`Container '${t.container}' not found.`)}else{if(!(t.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=t.container}if(t.maxBounds&&this.setMaxBounds(t.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",(()=>this._update(!1))),this.on("moveend",(()=>this._update(!1))),this.on("zoom",(()=>this._update(!0))),this.on("terrain",(()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)})),this.once("idle",(()=>{this._idleTriggered=!0})),"undefined"!=typeof window){addEventListener("online",this._onWindowOnline,!1);let e=!1;const t=ln((e=>{this._trackResize&&!this._removed&&this.resize(e)._update()}),50);this._resizeObserver=new ResizeObserver((i=>{e?t(i):e=!0})),this._resizeObserver.observe(this._container)}this.handlers=new ar(this,t),this._cooperativeGestures&&this._setupCooperativeGestures(),this._hash=t.hash&&new cn("string"==typeof t.hash&&t.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:t.center,zoom:t.zoom,bearing:t.bearing,pitch:t.pitch}),t.bounds&&(this.resize(),this.fitBounds(t.bounds,e.e({},t.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=t.localIdeographFontFamily,this._validateStyle=t.validateStyle,t.style&&this.setStyle(t.style,{localIdeographFontFamily:t.localIdeographFontFamily}),t.attributionControl&&this.addControl(new or({customAttribution:t.customAttribution})),t.maplibreLogo&&this.addControl(new lr,t.logoPosition),this.on("style.load",(()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)})),this.on("data",(t=>{this._update("style"===t.dataType),this.fire(new e.k(`${t.dataType}data`,t))})),this.on("dataloading",(t=>{this.fire(new e.k(`${t.dataType}dataloading`,t))})),this.on("dataabort",(t=>{this.fire(new e.k("sourcedataabort",t))}))}_getMapId(){return this._mapId}addControl(t,i){if(void 0===i&&(i=t.getDefaultPosition?t.getDefaultPosition():"top-right"),!t||!t.onAdd)return this.fire(new e.j(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const n=t.onAdd(this);this._controls.push(t);const r=this._controlPositions[i];return-1!==i.indexOf("bottom")?r.insertBefore(n,r.firstChild):r.appendChild(n),this}removeControl(t){if(!t||!t.onRemove)return this.fire(new e.j(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const i=this._controls.indexOf(t);return i>-1&&this._controls.splice(i,1),t.onRemove(this),this}hasControl(e){return this._controls.indexOf(e)>-1}calculateCameraOptionsFromTo(e,t,i,n){return null==n&&this.terrain&&(n=this.terrain.getElevationForLngLatZoom(i,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(e,t,i,n)}resize(t){var i;const n=this._containerDimensions(),r=n[0],a=n[1],s=this._getClampedPixelRatio(r,a);if(this._resizeCanvas(r,a,s),this.painter.resize(r,a,s),this.painter.overLimit()){const e=this.painter.context.gl;this._maxCanvasSize=[e.drawingBufferWidth,e.drawingBufferHeight];const t=this._getClampedPixelRatio(r,a);this._resizeCanvas(r,a,t),this.painter.resize(r,a,t)}this.transform.resize(r,a),null===(i=this._requestedCameraState)||void 0===i||i.resize(r,a);const o=!this._moving;return o&&(this.stop(),this.fire(new e.k("movestart",t)).fire(new e.k("move",t))),this.fire(new e.k("resize",t)),o&&this.fire(new e.k("moveend",t)),this}_getClampedPixelRatio(e,t){const{0:i,1:n}=this._maxCanvasSize,r=this.getPixelRatio(),a=e*r,s=t*r;return Math.min(a>i?i/a:1,s>n?n/s:1)*r}getPixelRatio(){var e;return null!==(e=this._overridePixelRatio)&&void 0!==e?e:devicePixelRatio}setPixelRatio(e){this._overridePixelRatio=e,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(e){return this.transform.setMaxBounds(z.convert(e)),this._update()}setMinZoom(e){if((e=null==e?-2:e)>=-2&&e<=this.transform.maxZoom)return this.transform.minZoom=e,this._update(),this.getZoom()<e&&this.setZoom(e),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(e){if((e=null==e?22:e)>=this.transform.minZoom)return this.transform.maxZoom=e,this._update(),this.getZoom()>e&&this.setZoom(e),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(e){if((e=null==e?0:e)<0)throw new Error("minPitch must be greater than or equal to 0");if(e>=0&&e<=this.transform.maxPitch)return this.transform.minPitch=e,this._update(),this.getPitch()<e&&this.setPitch(e),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(e){if((e=null==e?60:e)>85)throw new Error("maxPitch must be less than or equal to 85");if(e>=this.transform.minPitch)return this.transform.maxPitch=e,this._update(),this.getPitch()>e&&this.setPitch(e),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(e){return this.transform.renderWorldCopies=e,this._update()}getCooperativeGestures(){return this._cooperativeGestures}setCooperativeGestures(e){return this._cooperativeGestures=e,this._cooperativeGestures?this._setupCooperativeGestures():this._destroyCooperativeGestures(),this}project(t){return this.transform.locationPoint(e.L.convert(t),this.style&&this.terrain)}unproject(t){return this.transform.pointLocation(e.P.convert(t),this.terrain)}isMoving(){var e;return this._moving||(null===(e=this.handlers)||void 0===e?void 0:e.isMoving())}isZooming(){var e;return this._zooming||(null===(e=this.handlers)||void 0===e?void 0:e.isZooming())}isRotating(){var e;return this._rotating||(null===(e=this.handlers)||void 0===e?void 0:e.isRotating())}_createDelegatedListener(e,t,i){if("mouseenter"===e||"mouseover"===e){let n=!1;const r=r=>{const a=this.getLayer(t)?this.queryRenderedFeatures(r.point,{layers:[t]}):[];a.length?n||(n=!0,i.call(this,new _n(e,this,r.originalEvent,{features:a}))):n=!1};return{layer:t,listener:i,delegates:{mousemove:r,mouseout:()=>{n=!1}}}}if("mouseleave"===e||"mouseout"===e){let n=!1;const r=r=>{(this.getLayer(t)?this.queryRenderedFeatures(r.point,{layers:[t]}):[]).length?n=!0:n&&(n=!1,i.call(this,new _n(e,this,r.originalEvent)))},a=t=>{n&&(n=!1,i.call(this,new _n(e,this,t.originalEvent)))};return{layer:t,listener:i,delegates:{mousemove:r,mouseout:a}}}{const n=e=>{const n=this.getLayer(t)?this.queryRenderedFeatures(e.point,{layers:[t]}):[];n.length&&(e.features=n,i.call(this,e),delete e.features)};return{layer:t,listener:i,delegates:{[e]:n}}}}on(e,t,i){if(void 0===i)return super.on(e,t);const n=this._createDelegatedListener(e,t,i);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[e]=this._delegatedListeners[e]||[],this._delegatedListeners[e].push(n);for(const r in n.delegates)this.on(r,n.delegates[r]);return this}once(e,t,i){if(void 0===i)return super.once(e,t);const n=this._createDelegatedListener(e,t,i);for(const r in n.delegates)this.once(r,n.delegates[r]);return this}off(e,t,i){return void 0===i?super.off(e,t):(this._delegatedListeners&&this._delegatedListeners[e]&&(()=>{const n=this._delegatedListeners[e];for(let e=0;e<n.length;e++){const r=n[e];if(r.layer===t&&r.listener===i){for(const e in r.delegates)this.off(e,r.delegates[e]);return n.splice(e,1),this}}})(),this)}queryRenderedFeatures(t,i){if(!this.style)return[];let n;const r=t instanceof e.P||Array.isArray(t),a=r?t:[[0,0],[this.transform.width,this.transform.height]];if(i=i||(r?{}:t)||{},a instanceof e.P||"number"==typeof a[0])n=[e.P.convert(a)];else{const t=e.P.convert(a[0]),i=e.P.convert(a[1]);n=[t,new e.P(i.x,t.y),i,new e.P(t.x,i.y),t]}return this.style.queryRenderedFeatures(n,i,this.transform)}querySourceFeatures(e,t){return this.style.querySourceFeatures(e,t)}setStyle(t,i){return!1!==(i=e.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},i)).diff&&i.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&t?(this._diffStyle(t,i),this):(this._localIdeographFontFamily=i.localIdeographFontFamily,this._updateStyle(t,i))}setTransformRequest(e){return this._requestManager.setTransformRequest(e),this}_getUIString(e){const t=this._locale[e];if(null==t)throw new Error(`Missing UI string '${e}'`);return t}_updateStyle(e,t){if(t.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",(()=>this._updateStyle(e,t)));const i=this.style&&t.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!e)),e?(this.style=new nt(this,t||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof e?this.style.loadURL(e,t,i):this.style.loadJSON(e,t,i),this):(delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new nt(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(t,i){if("string"==typeof t){const n=this._requestManager.transformRequest(t,u.Style);e.f(n,((t,n)=>{t?this.fire(new e.j(t)):n&&this._updateDiff(n,i)}))}else"object"==typeof t&&this._updateDiff(t,i)}_updateDiff(t,i){try{this.style.setState(t,i)&&this._update(!0)}catch(n){e.w(`Unable to perform style diff: ${n.message||n.error||n}.  Rebuilding the style from scratch.`),this._updateStyle(t,i)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():e.w("There is no style added to the map.")}addSource(e,t){return this._lazyInitEmptyStyle(),this.style.addSource(e,t),this._update(!0)}isSourceLoaded(t){const i=this.style&&this.style.sourceCaches[t];if(void 0!==i)return i.loaded();this.fire(new e.j(new Error(`There is no source with ID '${t}'`)))}setTerrain(t){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),t){const i=this.style.sourceCaches[t.source];if(!i)throw new Error(`cannot load terrain, because there exists no source with ID: ${t.source}`);for(const n in this.style._layers){const i=this.style._layers[n];"hillshade"===i.type&&i.source===t.source&&e.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new pr(this.painter,i,t),this.painter.renderToTexture=new gr(this.painter,this.terrain),this.transform._minEleveationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._terrainDataCallback=e=>{"style"===e.dataType?this.terrain.sourceCache.freeRtt():"source"===e.dataType&&e.tile&&(e.sourceId!==t.source||this._elevationFreeze||(this.transform._minEleveationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.terrain.sourceCache.freeRtt(e.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform._minEleveationForCurrentTile=0,this.transform.elevation=0;return this.fire(new e.k("terrain",{terrain:t})),this}getTerrain(){var e,t;return null!==(t=null===(e=this.terrain)||void 0===e?void 0:e.options)&&void 0!==t?t:null}areTilesLoaded(){const e=this.style&&this.style.sourceCaches;for(const t in e){const i=e[t]._tiles;for(const e in i){const t=i[e];if("loaded"!==t.state&&"errored"!==t.state)return!1}}return!0}addSourceType(e,t,i){return this._lazyInitEmptyStyle(),this.style.addSourceType(e,t,i)}removeSource(e){return this.style.removeSource(e),this._update(!0)}getSource(e){return this.style.getSource(e)}addImage(t,i){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const{pixelRatio:r=1,sdf:a=!1,stretchX:s,stretchY:o,content:l}=n;if(this._lazyInitEmptyStyle(),!(i instanceof HTMLImageElement||e.a(i))){if(void 0===i.width||void 0===i.height)return this.fire(new e.j(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:n,height:c,data:u}=i,h=i;return this.style.addImage(t,{data:new e.R({width:n,height:c},new Uint8Array(u)),pixelRatio:r,stretchX:s,stretchY:o,content:l,sdf:a,version:0,userImage:h}),h.onAdd&&h.onAdd(this,t),this}}{const{width:n,height:c,data:u}=e.h.getImageData(i);this.style.addImage(t,{data:new e.R({width:n,height:c},u),pixelRatio:r,stretchX:s,stretchY:o,content:l,sdf:a,version:0})}}updateImage(t,i){const n=this.style.getImage(t);if(!n)return this.fire(new e.j(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const r=i instanceof HTMLImageElement||e.a(i)?e.h.getImageData(i):i,{width:a,height:s,data:o}=r;if(void 0===a||void 0===s)return this.fire(new e.j(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(a!==n.data.width||s!==n.data.height)return this.fire(new e.j(new Error("The width and height of the updated image must be that same as the previous version of the image")));const l=!(i instanceof HTMLImageElement||e.a(i));return n.data.replace(o,l),this.style.updateImage(t,n),this}getImage(e){return this.style.getImage(e)}hasImage(t){return t?!!this.style.getImage(t):(this.fire(new e.j(new Error("Missing required image id"))),!1)}removeImage(e){this.style.removeImage(e)}loadImage(e,t){c.getImage(this._requestManager.transformRequest(e,u.Image),t)}listImages(){return this.style.listImages()}addLayer(e,t){return this._lazyInitEmptyStyle(),this.style.addLayer(e,t),this._update(!0)}moveLayer(e,t){return this.style.moveLayer(e,t),this._update(!0)}removeLayer(e){return this.style.removeLayer(e),this._update(!0)}getLayer(e){return this.style.getLayer(e)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(e,t,i){return this.style.setLayerZoomRange(e,t,i),this._update(!0)}setFilter(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.style.setFilter(e,t,i),this._update(!0)}getFilter(e){return this.style.getFilter(e)}setPaintProperty(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return this.style.setPaintProperty(e,t,i,n),this._update(!0)}getPaintProperty(e,t){return this.style.getPaintProperty(e,t)}setLayoutProperty(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return this.style.setLayoutProperty(e,t,i,n),this._update(!0)}getLayoutProperty(e,t){return this.style.getLayoutProperty(e,t)}setGlyphs(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._lazyInitEmptyStyle(),this.style.setGlyphs(e,t),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this._lazyInitEmptyStyle(),this.style.addSprite(e,t,i,(e=>{e||this._update(!0)})),this}removeSprite(e){return this._lazyInitEmptyStyle(),this.style.removeSprite(e),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._lazyInitEmptyStyle(),this.style.setSprite(e,t,(e=>{e||this._update(!0)})),this}setLight(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._lazyInitEmptyStyle(),this.style.setLight(e,t),this._update(!0)}getLight(){return this.style.getLight()}setFeatureState(e,t){return this.style.setFeatureState(e,t),this._update()}removeFeatureState(e,t){return this.style.removeFeatureState(e,t),this._update()}getFeatureState(e){return this.style.getFeatureState(e)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let e=0,t=0;return this._container&&(e=this._container.clientWidth||400,t=this._container.clientHeight||300),[e,t]}_setupContainer(){const e=this._container;e.classList.add("maplibregl-map");const t=this._canvasContainer=i.create("div","maplibregl-canvas-container",e);this._interactive&&t.classList.add("maplibregl-interactive"),this._canvas=i.create("canvas","maplibregl-canvas",t),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");const n=this._containerDimensions(),r=this._getClampedPixelRatio(n[0],n[1]);this._resizeCanvas(n[0],n[1],r);const a=this._controlContainer=i.create("div","maplibregl-control-container",e),s=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach((e=>{s[e]=i.create("div",`maplibregl-ctrl-${e} `,a)})),this._container.addEventListener("scroll",this._onMapScroll,!1)}_setupCooperativeGestures(){this._cooperativeGesturesScreen=i.create("div","maplibregl-cooperative-gesture-screen",this._container);let e="boolean"!=typeof this._cooperativeGestures&&this._cooperativeGestures.windowsHelpText?this._cooperativeGestures.windowsHelpText:"Use Ctrl + scroll to zoom the map";0===navigator.platform.indexOf("Mac")&&(e="boolean"!=typeof this._cooperativeGestures&&this._cooperativeGestures.macHelpText?this._cooperativeGestures.macHelpText:"Use \u2318 + scroll to zoom the map"),this._cooperativeGesturesScreen.innerHTML=`\n            <div class="maplibregl-desktop-message">${e}</div>\n            <div class="maplibregl-mobile-message">${"boolean"!=typeof this._cooperativeGestures&&this._cooperativeGestures.mobileHelpText?this._cooperativeGestures.mobileHelpText:"Use two fingers to move the map"}</div>\n        `,this._cooperativeGesturesScreen.setAttribute("aria-hidden","true"),this._canvasContainer.addEventListener("wheel",this._cooperativeGesturesOnWheel,!1),this._canvasContainer.classList.add("maplibregl-cooperative-gestures")}_destroyCooperativeGestures(){i.remove(this._cooperativeGesturesScreen),this._canvasContainer.removeEventListener("wheel",this._cooperativeGesturesOnWheel,!1),this._canvasContainer.classList.remove("maplibregl-cooperative-gestures")}_resizeCanvas(e,t,i){this._canvas.width=Math.floor(i*e),this._canvas.height=Math.floor(i*t),this._canvas.style.width=`${e}px`,this._canvas.style.height=`${t}px`}_setupPainter(){const e={alpha:!0,stencil:!0,depth:!0,failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1};let t=null;this._canvas.addEventListener("webglcontextcreationerror",(i=>{t={requestedAttributes:e},i&&(t.statusMessage=i.statusMessage,t.type=i.type)}),{once:!0});const i=this._canvas.getContext("webgl2",e)||this._canvas.getContext("webgl",e);if(!i){const e="Failed to initialize WebGL";throw t?(t.message=e,new Error(JSON.stringify(t))):new Error(e)}this.painter=new nn(i,this.transform),n.testSupport(i)}_onCooperativeGesture(e,t,i){return!t&&i<2&&(this._cooperativeGesturesScreen.classList.add("maplibregl-show"),setTimeout((()=>{this._cooperativeGesturesScreen.classList.remove("maplibregl-show")}),100)),!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(e){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||e,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(e){return this._update(),this._renderTaskQueue.add(e)}_cancelRenderFrame(e){this._renderTaskQueue.remove(e)}_render(t){const i=this._idleTriggered?this._fadeDuration:0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(t),this._removed)return;let n=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const t=this.transform.zoom,r=e.h.now();this.style.zoomHistory.update(t,r);const a=new e.a8(t,{now:r,fadeDuration:i,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),s=a.crossFadingFactor();1===s&&s===this._crossFadingFactor||(n=!0,this._crossFadingFactor=s),this.style.update(a)}this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform._minEleveationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._elevationFreeze||(this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform._minEleveationForCurrentTile=0,this.transform.elevation=0),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,i,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:i,showPadding:this.showPadding}),this.fire(new e.k("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,e.bg.mark(e.bh.load),this.fire(new e.k("load"))),this.style&&(this.style.hasTransitions()||n)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const r=this._sourcesDirty||this._styleDirty||this._placementDirty;return r||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new e.k("idle")),!this._loaded||this._fullyLoaded||r||(this._fullyLoaded=!0,e.bg.mark(e.bh.fullLoad)),this}redraw(){return this.style&&(this._frame&&(this._frame.cancel(),this._frame=null),this._render(0)),this}remove(){var t;this._hash&&this._hash.remove();for(const e of this._controls)e.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),"undefined"!=typeof window&&removeEventListener("online",this._onWindowOnline,!1),c.removeThrottleControl(this._imageQueueHandle),null===(t=this._resizeObserver)||void 0===t||t.disconnect();const n=this.painter.context.gl.getExtension("WEBGL_lose_context");n&&n.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),i.remove(this._canvasContainer),i.remove(this._controlContainer),this._cooperativeGestures&&this._destroyCooperativeGestures(),this._container.classList.remove("maplibregl-map"),e.bg.clearMetrics(),this._removed=!0,this.fire(new e.k("remove"))}triggerRepaint(){this.style&&!this._frame&&(this._frame=e.h.frame((t=>{e.bg.frame(t),this._frame=null,this._render(t)})))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(e){this._showTileBoundaries!==e&&(this._showTileBoundaries=e,this._update())}get showPadding(){return!!this._showPadding}set showPadding(e){this._showPadding!==e&&(this._showPadding=e,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(e){this._showCollisionBoxes!==e&&(this._showCollisionBoxes=e,e?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(e){this._showOverdrawInspector!==e&&(this._showOverdrawInspector=e,this._update())}get repaint(){return!!this._repaint}set repaint(e){this._repaint!==e&&(this._repaint=e,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(e){this._vertices=e,this._update()}get version(){return yr}getCameraTargetElevation(){return this.transform.elevation}},Or.NavigationControl=class{constructor(t){this._updateZoomButtons=()=>{const e=this._map.getZoom(),t=e===this._map.getMaxZoom(),i=e===this._map.getMinZoom();this._zoomInButton.disabled=t,this._zoomOutButton.disabled=i,this._zoomInButton.setAttribute("aria-disabled",t.toString()),this._zoomOutButton.setAttribute("aria-disabled",i.toString())},this._rotateCompassArrow=()=>{const e=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=e},this._setButtonTitle=(e,t)=>{const i=this._map._getUIString(`NavigationControl.${t}`);e.title=i,e.setAttribute("aria-label",i)},this.options=e.e({},xr,t),this._container=i.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",(e=>e.preventDefault())),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",(e=>this._map.zoomIn({},{originalEvent:e}))),i.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",(e=>this._map.zoomOut({},{originalEvent:e}))),i.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",(e=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:e}):this._map.resetNorth({},{originalEvent:e})})),this._compassIcon=i.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(e){return this._map=e,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new br(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){i.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(e,t){const n=i.create("button",e,this._container);return n.type="button",n.addEventListener("click",t),n}},Or.GeolocateControl=class extends e.E{constructor(t){super(),this._onSuccess=t=>{if(this._map){if(this._isOutOfMapMaxBounds(t))return this._setErrorState(),this.fire(new e.k("outofmaxbounds",t)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=t,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(t),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(t),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new e.k("geolocate",t)),this._finish()}},this._updateCamera=t=>{const i=new e.L(t.coords.longitude,t.coords.latitude),n=t.coords.accuracy,r=this._map.getBearing(),a=e.e({bearing:r},this.options.fitBoundsOptions),s=z.fromLngLat(i,n);this._map.fitBounds(s,a,{geolocateSource:!0})},this._updateMarker=t=>{if(t){const i=new e.L(t.coords.longitude,t.coords.latitude);this._accuracyCircleMarker.setLngLat(i).addTo(this._map),this._userLocationDotMarker.setLngLat(i).addTo(this._map),this._accuracy=t.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=t=>{if(this._map){if(this.options.trackUserLocation)if(1===t.code){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const e=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=e,this._geolocateButton.setAttribute("aria-label",e),void 0!==this._geolocationWatchID&&this._clearWatch()}else{if(3===t.code&&Ir)return;this._setErrorState()}"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new e.k("error",t)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=t=>{if(this._map){if(this._container.addEventListener("contextmenu",(e=>e.preventDefault())),this._geolocateButton=i.create("button","maplibregl-ctrl-geolocate",this._container),i.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",!1===t){e.w("Geolocation support is not available so the GeolocateControl will be disabled.");const t=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=t,this._geolocateButton.setAttribute("aria-label",t)}else{const e=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=e,this._geolocateButton.setAttribute("aria-label",e)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=i.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new Er({element:this._dotElement}),this._circleElement=i.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Er({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",(t=>{t.geolocateSource||"ACTIVE_LOCK"!==this._watchState||t.originalEvent&&"resize"===t.originalEvent.type||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new e.k("trackuserlocationend")))}))}},this.options=e.e({},Pr,t)}onAdd(e){return this._map=e,this._container=i.create("div","maplibregl-ctrl maplibregl-ctrl-group"),function(e){void 0===wr||arguments.length>1&&void 0!==arguments[1]&&arguments[1]?void 0!==window.navigator.permissions?window.navigator.permissions.query({name:"geolocation"}).then((t=>{wr="denied"!==t.state,e(wr)})).catch((()=>{wr=!!window.navigator.geolocation,e(wr)})):(wr=!!window.navigator.geolocation,e(wr)):e(wr)}(this._setupUI),this._container}onRemove(){void 0!==this._geolocationWatchID&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),i.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,Cr=0,Ir=!1}_isOutOfMapMaxBounds(e){const t=this._map.getMaxBounds(),i=e.coords;return t&&(i.longitude<t.getWest()||i.longitude>t.getEast()||i.latitude<t.getSouth()||i.latitude>t.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){const e=this._map.getBounds(),t=e.getSouthEast(),i=e.getNorthEast(),n=t.distanceTo(i),r=Math.ceil(this._accuracy/(n/this._map._container.clientHeight)*2);this._circleElement.style.width=`${r}px`,this._circleElement.style.height=`${r}px`}trigger(){if(!this._setup)return e.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new e.k("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Cr--,Ir=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new e.k("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new e.k("trackuserlocationstart"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if("OFF"===this._watchState&&void 0!==this._geolocationWatchID)this._clearWatch();else if(void 0===this._geolocationWatchID){let e;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),Cr++,Cr>1?(e={maximumAge:6e5,timeout:0},Ir=!0):(e=this.options.positionOptions,Ir=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,e)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},Or.AttributionControl=or,Or.LogoControl=lr,Or.ScaleControl=class{constructor(t){this._onMove=()=>{Mr(this._map,this._container,this.options)},this.setUnit=e=>{this.options.unit=e,Mr(this._map,this._container,this.options)},this.options=e.e({},Ar,t)}getDefaultPosition(){return"bottom-left"}onAdd(e){return this._map=e,this._container=i.create("div","maplibregl-ctrl maplibregl-ctrl-scale",e.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){i.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},Or.FullscreenControl=class extends e.E{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(),this._onFullscreenChange=()=>{(window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement)===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,t&&t.container&&(t.container instanceof HTMLElement?this._container=t.container:e.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(e){return this._map=e,this._container||(this._container=this._map.getContainer()),this._controlContainer=i.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){i.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const e=this._fullscreenButton=i.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);i.create("span","maplibregl-ctrl-icon",e).setAttribute("aria-hidden","true"),e.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const e=this._getTitle();this._fullscreenButton.setAttribute("aria-label",e),this._fullscreenButton.title=e}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new e.k("fullscreenstart")),this._map._cooperativeGestures&&(this._prevCooperativeGestures=this._map._cooperativeGestures,this._map.setCooperativeGestures())):(this.fire(new e.k("fullscreenend")),this._prevCooperativeGestures&&(this._map.setCooperativeGestures(this._prevCooperativeGestures),delete this._prevCooperativeGestures))}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},Or.TerrainControl=class{constructor(e){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.disableTerrain")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.enableTerrain"))},this.options=e}onAdd(e){return this._map=e,this._container=i.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=i.create("button","maplibregl-ctrl-terrain",this._container),i.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){i.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},Or.Popup=class extends e.E{constructor(t){super(),this.remove=()=>(this._content&&i.remove(this._content),this._container&&(i.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new e.k("close")),this),this._onMouseUp=e=>{this._update(e.point)},this._onMouseMove=e=>{this._update(e.point)},this._onDrag=e=>{this._update(e.point)},this._update=e=>{if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=i.create("div","maplibregl-popup",this._map.getContainer()),this._tip=i.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const e of this.options.className.split(" "))this._container.classList.add(e);this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Sr(this._lngLat,this._pos,this._map.transform)),this._trackPointer&&!e)return;const t=this._pos=this._trackPointer&&e?e:this._map.project(this._lngLat);let n=this.options.anchor;const r=Rr(this.options.offset);if(!n){const e=this._container.offsetWidth,i=this._container.offsetHeight;let a;a=t.y+r.bottom.y<i?["top"]:t.y>this._map.transform.height-i?["bottom"]:[],t.x<e/2?a.push("left"):t.x>this._map.transform.width-e/2&&a.push("right"),n=0===a.length?"bottom":a.join("-")}const a=t.add(r[n]).round();i.setTransform(this._container,`${Tr[n]} translate(${a.x}px,${a.y}px)`),kr(this._container,n,"popup")},this._onClose=()=>{this.remove()},this.options=e.e(Object.create(Dr),t)}addTo(t){return this._map&&this.remove(),this._map=t,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new e.k("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(t){return this._lngLat=e.L.convert(t),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(e){return this.setDOMContent(document.createTextNode(e))}setHTML(e){const t=document.createDocumentFragment(),i=document.createElement("body");let n;for(i.innerHTML=e;n=i.firstChild,n;)t.appendChild(n);return this.setDOMContent(t)}getMaxWidth(){var e;return null===(e=this._container)||void 0===e?void 0:e.style.maxWidth}setMaxWidth(e){return this.options.maxWidth=e,this._update(),this}setDOMContent(e){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=i.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(e),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(e){this._container&&this._container.classList.add(e)}removeClassName(e){this._container&&this._container.classList.remove(e)}setOffset(e){return this.options.offset=e,this._update(),this}toggleClassName(e){if(this._container)return this._container.classList.toggle(e)}_createCloseButton(){this.options.closeButton&&(this._closeButton=i.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const e=this._container.querySelector(Lr);e&&e.focus()}},Or.Marker=Er,Or.Style=nt,Or.LngLat=e.L,Or.LngLatBounds=z,Or.Point=e.P,Or.MercatorCoordinate=e.U,Or.Evented=e.E,Or.AJAXError=e.bi,Or.config=e.c,Or.CanvasSource=j,Or.GeoJSONSource=B,Or.ImageSource=N,Or.RasterDEMTileSource=F,Or.RasterTileSource=R,Or.VectorTileSource=L,Or.VideoSource=V,Or.setRTLTextPlugin=e.bj,Or.getRTLTextPluginStatus=e.bk,Or.prewarm=function(){ne().acquire(Q)},Or.clearPrewarmedResources=function(){const e=ie;e&&(e.isPreloaded()&&1===e.numActive()?(e.release(Q),ie=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},Fr.extend(Or,{isSafari:e.ac,getPerformanceMetrics:e.bg.getPerformanceMetrics}),Or})),i}()},153:(e,t,i)=>{"use strict";var n=i(43),r=Symbol.for("react.element"),a=Symbol.for("react.fragment"),s=Object.prototype.hasOwnProperty,o=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,i){var n,a={},c=null,u=null;for(n in void 0!==i&&(c=""+i),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(u=t.ref),t)s.call(t,n)&&!l.hasOwnProperty(n)&&(a[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps)void 0===a[n]&&(a[n]=t[n]);return{$$typeof:r,type:e,key:c,ref:u,props:a,_owner:o.current}}t.jsx=c,t.jsxs=c},202:(e,t)=>{"use strict";var i=Symbol.for("react.element"),n=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),o=Symbol.for("react.provider"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),p=Symbol.iterator;var f={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},m=Object.assign,g={};function y(e,t,i){this.props=e,this.context=t,this.refs=g,this.updater=i||f}function _(){}function v(e,t,i){this.props=e,this.context=t,this.refs=g,this.updater=i||f}y.prototype.isReactComponent={},y.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},y.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},_.prototype=y.prototype;var x=v.prototype=new _;x.constructor=v,m(x,y.prototype),x.isPureReactComponent=!0;var b=Array.isArray,w=Object.prototype.hasOwnProperty,S={current:null},T={key:!0,ref:!0,__self:!0,__source:!0};function k(e,t,n){var r,a={},s=null,o=null;if(null!=t)for(r in void 0!==t.ref&&(o=t.ref),void 0!==t.key&&(s=""+t.key),t)w.call(t,r)&&!T.hasOwnProperty(r)&&(a[r]=t[r]);var l=arguments.length-2;if(1===l)a.children=n;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];a.children=c}if(e&&e.defaultProps)for(r in l=e.defaultProps)void 0===a[r]&&(a[r]=l[r]);return{$$typeof:i,type:e,key:s,ref:o,props:a,_owner:S.current}}function E(e){return"object"===typeof e&&null!==e&&e.$$typeof===i}var P=/\/+/g;function C(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function I(e,t,r,a,s){var o=typeof e;"undefined"!==o&&"boolean"!==o||(e=null);var l=!1;if(null===e)l=!0;else switch(o){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case i:case n:l=!0}}if(l)return s=s(l=e),e=""===a?"."+C(l,0):a,b(s)?(r="",null!=e&&(r=e.replace(P,"$&/")+"/"),I(s,t,r,"",(function(e){return e}))):null!=s&&(E(s)&&(s=function(e,t){return{$$typeof:i,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(s,r+(!s.key||l&&l.key===s.key?"":(""+s.key).replace(P,"$&/")+"/")+e)),t.push(s)),1;if(l=0,a=""===a?".":a+":",b(e))for(var c=0;c<e.length;c++){var u=a+C(o=e[c],c);l+=I(o,t,r,u,s)}else if(u=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=p&&e[p]||e["@@iterator"])?e:null}(e),"function"===typeof u)for(e=u.call(e),c=0;!(o=e.next()).done;)l+=I(o=o.value,t,r,u=a+C(o,c++),s);else if("object"===o)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function A(e,t,i){if(null==e)return e;var n=[],r=0;return I(e,n,"","",(function(e){return t.call(i,e,r++)})),n}function M(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var z={current:null},D={transition:null},L={ReactCurrentDispatcher:z,ReactCurrentBatchConfig:D,ReactCurrentOwner:S};function R(){throw Error("act(...) is not supported in production builds of React.")}t.Children={map:A,forEach:function(e,t,i){A(e,(function(){t.apply(this,arguments)}),i)},count:function(e){var t=0;return A(e,(function(){t++})),t},toArray:function(e){return A(e,(function(e){return e}))||[]},only:function(e){if(!E(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=y,t.Fragment=r,t.Profiler=s,t.PureComponent=v,t.StrictMode=a,t.Suspense=u,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=L,t.act=R,t.cloneElement=function(e,t,n){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=m({},e.props),a=e.key,s=e.ref,o=e._owner;if(null!=t){if(void 0!==t.ref&&(s=t.ref,o=S.current),void 0!==t.key&&(a=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)w.call(t,c)&&!T.hasOwnProperty(c)&&(r[c]=void 0===t[c]&&void 0!==l?l[c]:t[c])}var c=arguments.length-2;if(1===c)r.children=n;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];r.children=l}return{$$typeof:i,type:e.type,key:a,ref:s,props:r,_owner:o}},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:o,_context:e},e.Consumer=e},t.createElement=k,t.createFactory=function(e){var t=k.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=E,t.lazy=function(e){return{$$typeof:d,_payload:{_status:-1,_result:e},_init:M}},t.memo=function(e,t){return{$$typeof:h,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=D.transition;D.transition={};try{e()}finally{D.transition=t}},t.unstable_act=R,t.useCallback=function(e,t){return z.current.useCallback(e,t)},t.useContext=function(e){return z.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return z.current.useDeferredValue(e)},t.useEffect=function(e,t){return z.current.useEffect(e,t)},t.useId=function(){return z.current.useId()},t.useImperativeHandle=function(e,t,i){return z.current.useImperativeHandle(e,t,i)},t.useInsertionEffect=function(e,t){return z.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return z.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return z.current.useMemo(e,t)},t.useReducer=function(e,t,i){return z.current.useReducer(e,t,i)},t.useRef=function(e){return z.current.useRef(e)},t.useState=function(e){return z.current.useState(e)},t.useSyncExternalStore=function(e,t,i){return z.current.useSyncExternalStore(e,t,i)},t.useTransition=function(){return z.current.useTransition()},t.version="18.3.1"},234:(e,t)=>{"use strict";function i(e,t){var i=e.length;e.push(t);e:for(;0<i;){var n=i-1>>>1,r=e[n];if(!(0<a(r,t)))break e;e[n]=t,e[i]=r,i=n}}function n(e){return 0===e.length?null:e[0]}function r(e){if(0===e.length)return null;var t=e[0],i=e.pop();if(i!==t){e[0]=i;e:for(var n=0,r=e.length,s=r>>>1;n<s;){var o=2*(n+1)-1,l=e[o],c=o+1,u=e[c];if(0>a(l,i))c<r&&0>a(u,l)?(e[n]=u,e[c]=i,n=c):(e[n]=l,e[o]=i,n=o);else{if(!(c<r&&0>a(u,i)))break e;e[n]=u,e[c]=i,n=c}}}return t}function a(e,t){var i=e.sortIndex-t.sortIndex;return 0!==i?i:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var c=[],u=[],h=1,d=null,p=3,f=!1,m=!1,g=!1,y="function"===typeof setTimeout?setTimeout:null,_="function"===typeof clearTimeout?clearTimeout:null,v="undefined"!==typeof setImmediate?setImmediate:null;function x(e){for(var t=n(u);null!==t;){if(null===t.callback)r(u);else{if(!(t.startTime<=e))break;r(u),t.sortIndex=t.expirationTime,i(c,t)}t=n(u)}}function b(e){if(g=!1,x(e),!m)if(null!==n(c))m=!0,D(w);else{var t=n(u);null!==t&&L(b,t.startTime-e)}}function w(e,i){m=!1,g&&(g=!1,_(E),E=-1),f=!0;var a=p;try{for(x(i),d=n(c);null!==d&&(!(d.expirationTime>i)||e&&!I());){var s=d.callback;if("function"===typeof s){d.callback=null,p=d.priorityLevel;var o=s(d.expirationTime<=i);i=t.unstable_now(),"function"===typeof o?d.callback=o:d===n(c)&&r(c),x(i)}else r(c);d=n(c)}if(null!==d)var l=!0;else{var h=n(u);null!==h&&L(b,h.startTime-i),l=!1}return l}finally{d=null,p=a,f=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var S,T=!1,k=null,E=-1,P=5,C=-1;function I(){return!(t.unstable_now()-C<P)}function A(){if(null!==k){var e=t.unstable_now();C=e;var i=!0;try{i=k(!0,e)}finally{i?S():(T=!1,k=null)}}else T=!1}if("function"===typeof v)S=function(){v(A)};else if("undefined"!==typeof MessageChannel){var M=new MessageChannel,z=M.port2;M.port1.onmessage=A,S=function(){z.postMessage(null)}}else S=function(){y(A,0)};function D(e){k=e,T||(T=!0,S())}function L(e,i){E=y((function(){e(t.unstable_now())}),i)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){m||f||(m=!0,D(w))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):P=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return n(c)},t.unstable_next=function(e){switch(p){case 1:case 2:case 3:var t=3;break;default:t=p}var i=p;p=t;try{return e()}finally{p=i}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var i=p;p=e;try{return t()}finally{p=i}},t.unstable_scheduleCallback=function(e,r,a){var s=t.unstable_now();switch("object"===typeof a&&null!==a?a="number"===typeof(a=a.delay)&&0<a?s+a:s:a=s,e){case 1:var o=-1;break;case 2:o=250;break;case 5:o=1073741823;break;case 4:o=1e4;break;default:o=5e3}return e={id:h++,callback:r,priorityLevel:e,startTime:a,expirationTime:o=a+o,sortIndex:-1},a>s?(e.sortIndex=a,i(u,e),null===n(c)&&e===n(u)&&(g?(_(E),E=-1):g=!0,L(b,a-s))):(e.sortIndex=o,i(c,e),m||f||(m=!0,D(w))),e},t.unstable_shouldYield=I,t.unstable_wrapCallback=function(e){var t=p;return function(){var i=p;p=t;try{return e.apply(this,arguments)}finally{p=i}}}},391:(e,t,i)=>{"use strict";var n=i(950);t.createRoot=n.createRoot,t.hydrateRoot=n.hydrateRoot},579:(e,t,i)=>{"use strict";e.exports=i(153)},730:(e,t,i)=>{"use strict";var n=i(43),r=i(853);function a(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,i=1;i<arguments.length;i++)t+="&args[]="+encodeURIComponent(arguments[i]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var s=new Set,o={};function l(e,t){c(e,t),c(e+"Capture",t)}function c(e,t){for(o[e]=t,e=0;e<t.length;e++)s.add(t[e])}var u=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),h=Object.prototype.hasOwnProperty,d=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,p={},f={};function m(e,t,i,n,r,a,s){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=n,this.attributeNamespace=r,this.mustUseProperty=i,this.propertyName=e,this.type=t,this.sanitizeURL=a,this.removeEmptyString=s}var g={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){g[e]=new m(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];g[t]=new m(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){g[e]=new m(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){g[e]=new m(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){g[e]=new m(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){g[e]=new m(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){g[e]=new m(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){g[e]=new m(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){g[e]=new m(e,5,!1,e.toLowerCase(),null,!1,!1)}));var y=/[\-:]([a-z])/g;function _(e){return e[1].toUpperCase()}function v(e,t,i,n){var r=g.hasOwnProperty(t)?g[t]:null;(null!==r?0!==r.type:n||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,i,n){if(null===t||"undefined"===typeof t||function(e,t,i,n){if(null!==i&&0===i.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!n&&(null!==i?!i.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,i,n))return!0;if(n)return!1;if(null!==i)switch(i.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,i,r,n)&&(i=null),n||null===r?function(e){return!!h.call(f,e)||!h.call(p,e)&&(d.test(e)?f[e]=!0:(p[e]=!0,!1))}(t)&&(null===i?e.removeAttribute(t):e.setAttribute(t,""+i)):r.mustUseProperty?e[r.propertyName]=null===i?3!==r.type&&"":i:(t=r.attributeName,n=r.attributeNamespace,null===i?e.removeAttribute(t):(i=3===(r=r.type)||4===r&&!0===i?"":""+i,n?e.setAttributeNS(n,t,i):e.setAttribute(t,i))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(y,_);g[t]=new m(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(y,_);g[t]=new m(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(y,_);g[t]=new m(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){g[e]=new m(e,1,!1,e.toLowerCase(),null,!1,!1)})),g.xlinkHref=new m("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){g[e]=new m(e,1,!1,e.toLowerCase(),null,!0,!0)}));var x=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,b=Symbol.for("react.element"),w=Symbol.for("react.portal"),S=Symbol.for("react.fragment"),T=Symbol.for("react.strict_mode"),k=Symbol.for("react.profiler"),E=Symbol.for("react.provider"),P=Symbol.for("react.context"),C=Symbol.for("react.forward_ref"),I=Symbol.for("react.suspense"),A=Symbol.for("react.suspense_list"),M=Symbol.for("react.memo"),z=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var D=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var L=Symbol.iterator;function R(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=L&&e[L]||e["@@iterator"])?e:null}var F,B=Object.assign;function O(e){if(void 0===F)try{throw Error()}catch(i){var t=i.stack.trim().match(/\n( *(at )?)/);F=t&&t[1]||""}return"\n"+F+e}var N=!1;function V(e,t){if(!e||N)return"";N=!0;var i=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var n=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){n=c}e.call(t.prototype)}else{try{throw Error()}catch(c){n=c}e()}}catch(c){if(c&&n&&"string"===typeof c.stack){for(var r=c.stack.split("\n"),a=n.stack.split("\n"),s=r.length-1,o=a.length-1;1<=s&&0<=o&&r[s]!==a[o];)o--;for(;1<=s&&0<=o;s--,o--)if(r[s]!==a[o]){if(1!==s||1!==o)do{if(s--,0>--o||r[s]!==a[o]){var l="\n"+r[s].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}}while(1<=s&&0<=o);break}}}finally{N=!1,Error.prepareStackTrace=i}return(e=e?e.displayName||e.name:"")?O(e):""}function j(e){switch(e.tag){case 5:return O(e.type);case 16:return O("Lazy");case 13:return O("Suspense");case 19:return O("SuspenseList");case 0:case 2:case 15:return e=V(e.type,!1);case 11:return e=V(e.type.render,!1);case 1:return e=V(e.type,!0);default:return""}}function U(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case S:return"Fragment";case w:return"Portal";case k:return"Profiler";case T:return"StrictMode";case I:return"Suspense";case A:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case P:return(e.displayName||"Context")+".Consumer";case E:return(e._context.displayName||"Context")+".Provider";case C:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case M:return null!==(t=e.displayName||null)?t:U(e.type)||"Memo";case z:t=e._payload,e=e._init;try{return U(e(t))}catch(i){}}return null}function $(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return U(t);case 8:return t===T?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function q(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function Z(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function G(e){e._valueTracker||(e._valueTracker=function(e){var t=Z(e)?"checked":"value",i=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof i&&"function"===typeof i.get&&"function"===typeof i.set){var r=i.get,a=i.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return r.call(this)},set:function(e){n=""+e,a.call(this,e)}}),Object.defineProperty(e,t,{enumerable:i.enumerable}),{getValue:function(){return n},setValue:function(e){n=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function W(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var i=t.getValue(),n="";return e&&(n=Z(e)?e.checked?"true":"false":e.value),(e=n)!==i&&(t.setValue(e),!0)}function H(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function X(e,t){var i=t.checked;return B({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=i?i:e._wrapperState.initialChecked})}function K(e,t){var i=null==t.defaultValue?"":t.defaultValue,n=null!=t.checked?t.checked:t.defaultChecked;i=q(null!=t.value?t.value:i),e._wrapperState={initialChecked:n,initialValue:i,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function Y(e,t){null!=(t=t.checked)&&v(e,"checked",t,!1)}function J(e,t){Y(e,t);var i=q(t.value),n=t.type;if(null!=i)"number"===n?(0===i&&""===e.value||e.value!=i)&&(e.value=""+i):e.value!==""+i&&(e.value=""+i);else if("submit"===n||"reset"===n)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,i):t.hasOwnProperty("defaultValue")&&ee(e,t.type,q(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Q(e,t,i){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!("submit"!==n&&"reset"!==n||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,i||t===e.value||(e.value=t),e.defaultValue=t}""!==(i=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==i&&(e.name=i)}function ee(e,t,i){"number"===t&&H(e.ownerDocument)===e||(null==i?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+i&&(e.defaultValue=""+i))}var te=Array.isArray;function ie(e,t,i,n){if(e=e.options,t){t={};for(var r=0;r<i.length;r++)t["$"+i[r]]=!0;for(i=0;i<e.length;i++)r=t.hasOwnProperty("$"+e[i].value),e[i].selected!==r&&(e[i].selected=r),r&&n&&(e[i].defaultSelected=!0)}else{for(i=""+q(i),t=null,r=0;r<e.length;r++){if(e[r].value===i)return e[r].selected=!0,void(n&&(e[r].defaultSelected=!0));null!==t||e[r].disabled||(t=e[r])}null!==t&&(t.selected=!0)}}function ne(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(a(91));return B({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function re(e,t){var i=t.value;if(null==i){if(i=t.children,t=t.defaultValue,null!=i){if(null!=t)throw Error(a(92));if(te(i)){if(1<i.length)throw Error(a(93));i=i[0]}t=i}null==t&&(t=""),i=t}e._wrapperState={initialValue:q(i)}}function ae(e,t){var i=q(t.value),n=q(t.defaultValue);null!=i&&((i=""+i)!==e.value&&(e.value=i),null==t.defaultValue&&e.defaultValue!==i&&(e.defaultValue=i)),null!=n&&(e.defaultValue=""+n)}function se(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function oe(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function le(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?oe(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ce,ue,he=(ue=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ce=ce||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ce.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,i,n){MSApp.execUnsafeLocalFunction((function(){return ue(e,t)}))}:ue);function de(e,t){if(t){var i=e.firstChild;if(i&&i===e.lastChild&&3===i.nodeType)return void(i.nodeValue=t)}e.textContent=t}var pe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},fe=["Webkit","ms","Moz","O"];function me(e,t,i){return null==t||"boolean"===typeof t||""===t?"":i||"number"!==typeof t||0===t||pe.hasOwnProperty(e)&&pe[e]?(""+t).trim():t+"px"}function ge(e,t){for(var i in e=e.style,t)if(t.hasOwnProperty(i)){var n=0===i.indexOf("--"),r=me(i,t[i],n);"float"===i&&(i="cssFloat"),n?e.setProperty(i,r):e[i]=r}}Object.keys(pe).forEach((function(e){fe.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),pe[t]=pe[e]}))}));var ye=B({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function _e(e,t){if(t){if(ye[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(a(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(a(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(a(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(a(62))}}function ve(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var xe=null;function be(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var we=null,Se=null,Te=null;function ke(e){if(e=vr(e)){if("function"!==typeof we)throw Error(a(280));var t=e.stateNode;t&&(t=br(t),we(e.stateNode,e.type,t))}}function Ee(e){Se?Te?Te.push(e):Te=[e]:Se=e}function Pe(){if(Se){var e=Se,t=Te;if(Te=Se=null,ke(e),t)for(e=0;e<t.length;e++)ke(t[e])}}function Ce(e,t){return e(t)}function Ie(){}var Ae=!1;function Me(e,t,i){if(Ae)return e(t,i);Ae=!0;try{return Ce(e,t,i)}finally{Ae=!1,(null!==Se||null!==Te)&&(Ie(),Pe())}}function ze(e,t){var i=e.stateNode;if(null===i)return null;var n=br(i);if(null===n)return null;i=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(n=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!n;break e;default:e=!1}if(e)return null;if(i&&"function"!==typeof i)throw Error(a(231,t,typeof i));return i}var De=!1;if(u)try{var Le={};Object.defineProperty(Le,"passive",{get:function(){De=!0}}),window.addEventListener("test",Le,Le),window.removeEventListener("test",Le,Le)}catch(ue){De=!1}function Re(e,t,i,n,r,a,s,o,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(i,c)}catch(u){this.onError(u)}}var Fe=!1,Be=null,Oe=!1,Ne=null,Ve={onError:function(e){Fe=!0,Be=e}};function je(e,t,i,n,r,a,s,o,l){Fe=!1,Be=null,Re.apply(Ve,arguments)}function Ue(e){var t=e,i=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(i=t.return),e=t.return}while(e)}return 3===t.tag?i:null}function $e(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function qe(e){if(Ue(e)!==e)throw Error(a(188))}function Ze(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=Ue(e)))throw Error(a(188));return t!==e?null:e}for(var i=e,n=t;;){var r=i.return;if(null===r)break;var s=r.alternate;if(null===s){if(null!==(n=r.return)){i=n;continue}break}if(r.child===s.child){for(s=r.child;s;){if(s===i)return qe(r),e;if(s===n)return qe(r),t;s=s.sibling}throw Error(a(188))}if(i.return!==n.return)i=r,n=s;else{for(var o=!1,l=r.child;l;){if(l===i){o=!0,i=r,n=s;break}if(l===n){o=!0,n=r,i=s;break}l=l.sibling}if(!o){for(l=s.child;l;){if(l===i){o=!0,i=s,n=r;break}if(l===n){o=!0,n=s,i=r;break}l=l.sibling}if(!o)throw Error(a(189))}}if(i.alternate!==n)throw Error(a(190))}if(3!==i.tag)throw Error(a(188));return i.stateNode.current===i?e:t}(e))?Ge(e):null}function Ge(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=Ge(e);if(null!==t)return t;e=e.sibling}return null}var We=r.unstable_scheduleCallback,He=r.unstable_cancelCallback,Xe=r.unstable_shouldYield,Ke=r.unstable_requestPaint,Ye=r.unstable_now,Je=r.unstable_getCurrentPriorityLevel,Qe=r.unstable_ImmediatePriority,et=r.unstable_UserBlockingPriority,tt=r.unstable_NormalPriority,it=r.unstable_LowPriority,nt=r.unstable_IdlePriority,rt=null,at=null;var st=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(ot(e)/lt|0)|0},ot=Math.log,lt=Math.LN2;var ct=64,ut=4194304;function ht(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function dt(e,t){var i=e.pendingLanes;if(0===i)return 0;var n=0,r=e.suspendedLanes,a=e.pingedLanes,s=268435455&i;if(0!==s){var o=s&~r;0!==o?n=ht(o):0!==(a&=s)&&(n=ht(a))}else 0!==(s=i&~r)?n=ht(s):0!==a&&(n=ht(a));if(0===n)return 0;if(0!==t&&t!==n&&0===(t&r)&&((r=n&-n)>=(a=t&-t)||16===r&&0!==(4194240&a)))return t;if(0!==(4&n)&&(n|=16&i),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=n;0<t;)r=1<<(i=31-st(t)),n|=e[i],t&=~r;return n}function pt(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function ft(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function mt(){var e=ct;return 0===(4194240&(ct<<=1))&&(ct=64),e}function gt(e){for(var t=[],i=0;31>i;i++)t.push(e);return t}function yt(e,t,i){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-st(t)]=i}function _t(e,t){var i=e.entangledLanes|=t;for(e=e.entanglements;i;){var n=31-st(i),r=1<<n;r&t|e[n]&t&&(e[n]|=t),i&=~r}}var vt=0;function xt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var bt,wt,St,Tt,kt,Et=!1,Pt=[],Ct=null,It=null,At=null,Mt=new Map,zt=new Map,Dt=[],Lt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Rt(e,t){switch(e){case"focusin":case"focusout":Ct=null;break;case"dragenter":case"dragleave":It=null;break;case"mouseover":case"mouseout":At=null;break;case"pointerover":case"pointerout":Mt.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":zt.delete(t.pointerId)}}function Ft(e,t,i,n,r,a){return null===e||e.nativeEvent!==a?(e={blockedOn:t,domEventName:i,eventSystemFlags:n,nativeEvent:a,targetContainers:[r]},null!==t&&(null!==(t=vr(t))&&wt(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,null!==r&&-1===t.indexOf(r)&&t.push(r),e)}function Bt(e){var t=_r(e.target);if(null!==t){var i=Ue(t);if(null!==i)if(13===(t=i.tag)){if(null!==(t=$e(i)))return e.blockedOn=t,void kt(e.priority,(function(){St(i)}))}else if(3===t&&i.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===i.tag?i.stateNode.containerInfo:null)}e.blockedOn=null}function Ot(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var i=Xt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==i)return null!==(t=vr(i))&&wt(t),e.blockedOn=i,!1;var n=new(i=e.nativeEvent).constructor(i.type,i);xe=n,i.target.dispatchEvent(n),xe=null,t.shift()}return!0}function Nt(e,t,i){Ot(e)&&i.delete(t)}function Vt(){Et=!1,null!==Ct&&Ot(Ct)&&(Ct=null),null!==It&&Ot(It)&&(It=null),null!==At&&Ot(At)&&(At=null),Mt.forEach(Nt),zt.forEach(Nt)}function jt(e,t){e.blockedOn===t&&(e.blockedOn=null,Et||(Et=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,Vt)))}function Ut(e){function t(t){return jt(t,e)}if(0<Pt.length){jt(Pt[0],e);for(var i=1;i<Pt.length;i++){var n=Pt[i];n.blockedOn===e&&(n.blockedOn=null)}}for(null!==Ct&&jt(Ct,e),null!==It&&jt(It,e),null!==At&&jt(At,e),Mt.forEach(t),zt.forEach(t),i=0;i<Dt.length;i++)(n=Dt[i]).blockedOn===e&&(n.blockedOn=null);for(;0<Dt.length&&null===(i=Dt[0]).blockedOn;)Bt(i),null===i.blockedOn&&Dt.shift()}var $t=x.ReactCurrentBatchConfig,qt=!0;function Zt(e,t,i,n){var r=vt,a=$t.transition;$t.transition=null;try{vt=1,Wt(e,t,i,n)}finally{vt=r,$t.transition=a}}function Gt(e,t,i,n){var r=vt,a=$t.transition;$t.transition=null;try{vt=4,Wt(e,t,i,n)}finally{vt=r,$t.transition=a}}function Wt(e,t,i,n){if(qt){var r=Xt(e,t,i,n);if(null===r)qn(e,t,n,Ht,i),Rt(e,n);else if(function(e,t,i,n,r){switch(t){case"focusin":return Ct=Ft(Ct,e,t,i,n,r),!0;case"dragenter":return It=Ft(It,e,t,i,n,r),!0;case"mouseover":return At=Ft(At,e,t,i,n,r),!0;case"pointerover":var a=r.pointerId;return Mt.set(a,Ft(Mt.get(a)||null,e,t,i,n,r)),!0;case"gotpointercapture":return a=r.pointerId,zt.set(a,Ft(zt.get(a)||null,e,t,i,n,r)),!0}return!1}(r,e,t,i,n))n.stopPropagation();else if(Rt(e,n),4&t&&-1<Lt.indexOf(e)){for(;null!==r;){var a=vr(r);if(null!==a&&bt(a),null===(a=Xt(e,t,i,n))&&qn(e,t,n,Ht,i),a===r)break;r=a}null!==r&&n.stopPropagation()}else qn(e,t,n,null,i)}}var Ht=null;function Xt(e,t,i,n){if(Ht=null,null!==(e=_r(e=be(n))))if(null===(t=Ue(e)))e=null;else if(13===(i=t.tag)){if(null!==(e=$e(t)))return e;e=null}else if(3===i){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Ht=e,null}function Kt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Je()){case Qe:return 1;case et:return 4;case tt:case it:return 16;case nt:return 536870912;default:return 16}default:return 16}}var Yt=null,Jt=null,Qt=null;function ei(){if(Qt)return Qt;var e,t,i=Jt,n=i.length,r="value"in Yt?Yt.value:Yt.textContent,a=r.length;for(e=0;e<n&&i[e]===r[e];e++);var s=n-e;for(t=1;t<=s&&i[n-t]===r[a-t];t++);return Qt=r.slice(e,1<t?1-t:void 0)}function ti(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function ii(){return!0}function ni(){return!1}function ri(e){function t(t,i,n,r,a){for(var s in this._reactName=t,this._targetInst=n,this.type=i,this.nativeEvent=r,this.target=a,this.currentTarget=null,e)e.hasOwnProperty(s)&&(t=e[s],this[s]=t?t(r):r[s]);return this.isDefaultPrevented=(null!=r.defaultPrevented?r.defaultPrevented:!1===r.returnValue)?ii:ni,this.isPropagationStopped=ni,this}return B(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=ii)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=ii)},persist:function(){},isPersistent:ii}),t}var ai,si,oi,li={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ci=ri(li),ui=B({},li,{view:0,detail:0}),hi=ri(ui),di=B({},ui,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ti,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==oi&&(oi&&"mousemove"===e.type?(ai=e.screenX-oi.screenX,si=e.screenY-oi.screenY):si=ai=0,oi=e),ai)},movementY:function(e){return"movementY"in e?e.movementY:si}}),pi=ri(di),fi=ri(B({},di,{dataTransfer:0})),mi=ri(B({},ui,{relatedTarget:0})),gi=ri(B({},li,{animationName:0,elapsedTime:0,pseudoElement:0})),yi=B({},li,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),_i=ri(yi),vi=ri(B({},li,{data:0})),xi={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},bi={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},wi={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Si(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=wi[e])&&!!t[e]}function Ti(){return Si}var ki=B({},ui,{key:function(e){if(e.key){var t=xi[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=ti(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?bi[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ti,charCode:function(e){return"keypress"===e.type?ti(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?ti(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),Ei=ri(ki),Pi=ri(B({},di,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Ci=ri(B({},ui,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ti})),Ii=ri(B({},li,{propertyName:0,elapsedTime:0,pseudoElement:0})),Ai=B({},di,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Mi=ri(Ai),zi=[9,13,27,32],Di=u&&"CompositionEvent"in window,Li=null;u&&"documentMode"in document&&(Li=document.documentMode);var Ri=u&&"TextEvent"in window&&!Li,Fi=u&&(!Di||Li&&8<Li&&11>=Li),Bi=String.fromCharCode(32),Oi=!1;function Ni(e,t){switch(e){case"keyup":return-1!==zi.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Vi(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var ji=!1;var Ui={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function $i(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Ui[e.type]:"textarea"===t}function qi(e,t,i,n){Ee(n),0<(t=Gn(t,"onChange")).length&&(i=new ci("onChange","change",null,i,n),e.push({event:i,listeners:t}))}var Zi=null,Gi=null;function Wi(e){On(e,0)}function Hi(e){if(W(xr(e)))return e}function Xi(e,t){if("change"===e)return t}var Ki=!1;if(u){var Yi;if(u){var Ji="oninput"in document;if(!Ji){var Qi=document.createElement("div");Qi.setAttribute("oninput","return;"),Ji="function"===typeof Qi.oninput}Yi=Ji}else Yi=!1;Ki=Yi&&(!document.documentMode||9<document.documentMode)}function en(){Zi&&(Zi.detachEvent("onpropertychange",tn),Gi=Zi=null)}function tn(e){if("value"===e.propertyName&&Hi(Gi)){var t=[];qi(t,Gi,e,be(e)),Me(Wi,t)}}function nn(e,t,i){"focusin"===e?(en(),Gi=i,(Zi=t).attachEvent("onpropertychange",tn)):"focusout"===e&&en()}function rn(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Hi(Gi)}function an(e,t){if("click"===e)return Hi(t)}function sn(e,t){if("input"===e||"change"===e)return Hi(t)}var on="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function ln(e,t){if(on(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var i=Object.keys(e),n=Object.keys(t);if(i.length!==n.length)return!1;for(n=0;n<i.length;n++){var r=i[n];if(!h.call(t,r)||!on(e[r],t[r]))return!1}return!0}function cn(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function un(e,t){var i,n=cn(e);for(e=0;n;){if(3===n.nodeType){if(i=e+n.textContent.length,e<=t&&i>=t)return{node:n,offset:t-e};e=i}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=cn(n)}}function hn(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?hn(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function dn(){for(var e=window,t=H();t instanceof e.HTMLIFrameElement;){try{var i="string"===typeof t.contentWindow.location.href}catch(n){i=!1}if(!i)break;t=H((e=t.contentWindow).document)}return t}function pn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function fn(e){var t=dn(),i=e.focusedElem,n=e.selectionRange;if(t!==i&&i&&i.ownerDocument&&hn(i.ownerDocument.documentElement,i)){if(null!==n&&pn(i))if(t=n.start,void 0===(e=n.end)&&(e=t),"selectionStart"in i)i.selectionStart=t,i.selectionEnd=Math.min(e,i.value.length);else if((e=(t=i.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var r=i.textContent.length,a=Math.min(n.start,r);n=void 0===n.end?a:Math.min(n.end,r),!e.extend&&a>n&&(r=n,n=a,a=r),r=un(i,a);var s=un(i,n);r&&s&&(1!==e.rangeCount||e.anchorNode!==r.node||e.anchorOffset!==r.offset||e.focusNode!==s.node||e.focusOffset!==s.offset)&&((t=t.createRange()).setStart(r.node,r.offset),e.removeAllRanges(),a>n?(e.addRange(t),e.extend(s.node,s.offset)):(t.setEnd(s.node,s.offset),e.addRange(t)))}for(t=[],e=i;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof i.focus&&i.focus(),i=0;i<t.length;i++)(e=t[i]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var mn=u&&"documentMode"in document&&11>=document.documentMode,gn=null,yn=null,_n=null,vn=!1;function xn(e,t,i){var n=i.window===i?i.document:9===i.nodeType?i:i.ownerDocument;vn||null==gn||gn!==H(n)||("selectionStart"in(n=gn)&&pn(n)?n={start:n.selectionStart,end:n.selectionEnd}:n={anchorNode:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset},_n&&ln(_n,n)||(_n=n,0<(n=Gn(yn,"onSelect")).length&&(t=new ci("onSelect","select",null,t,i),e.push({event:t,listeners:n}),t.target=gn)))}function bn(e,t){var i={};return i[e.toLowerCase()]=t.toLowerCase(),i["Webkit"+e]="webkit"+t,i["Moz"+e]="moz"+t,i}var wn={animationend:bn("Animation","AnimationEnd"),animationiteration:bn("Animation","AnimationIteration"),animationstart:bn("Animation","AnimationStart"),transitionend:bn("Transition","TransitionEnd")},Sn={},Tn={};function kn(e){if(Sn[e])return Sn[e];if(!wn[e])return e;var t,i=wn[e];for(t in i)if(i.hasOwnProperty(t)&&t in Tn)return Sn[e]=i[t];return e}u&&(Tn=document.createElement("div").style,"AnimationEvent"in window||(delete wn.animationend.animation,delete wn.animationiteration.animation,delete wn.animationstart.animation),"TransitionEvent"in window||delete wn.transitionend.transition);var En=kn("animationend"),Pn=kn("animationiteration"),Cn=kn("animationstart"),In=kn("transitionend"),An=new Map,Mn="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function zn(e,t){An.set(e,t),l(t,[e])}for(var Dn=0;Dn<Mn.length;Dn++){var Ln=Mn[Dn];zn(Ln.toLowerCase(),"on"+(Ln[0].toUpperCase()+Ln.slice(1)))}zn(En,"onAnimationEnd"),zn(Pn,"onAnimationIteration"),zn(Cn,"onAnimationStart"),zn("dblclick","onDoubleClick"),zn("focusin","onFocus"),zn("focusout","onBlur"),zn(In,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Rn="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Fn=new Set("cancel close invalid load scroll toggle".split(" ").concat(Rn));function Bn(e,t,i){var n=e.type||"unknown-event";e.currentTarget=i,function(e,t,i,n,r,s,o,l,c){if(je.apply(this,arguments),Fe){if(!Fe)throw Error(a(198));var u=Be;Fe=!1,Be=null,Oe||(Oe=!0,Ne=u)}}(n,t,void 0,e),e.currentTarget=null}function On(e,t){t=0!==(4&t);for(var i=0;i<e.length;i++){var n=e[i],r=n.event;n=n.listeners;e:{var a=void 0;if(t)for(var s=n.length-1;0<=s;s--){var o=n[s],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==a&&r.isPropagationStopped())break e;Bn(r,o,c),a=l}else for(s=0;s<n.length;s++){if(l=(o=n[s]).instance,c=o.currentTarget,o=o.listener,l!==a&&r.isPropagationStopped())break e;Bn(r,o,c),a=l}}}if(Oe)throw e=Ne,Oe=!1,Ne=null,e}function Nn(e,t){var i=t[mr];void 0===i&&(i=t[mr]=new Set);var n=e+"__bubble";i.has(n)||($n(t,e,2,!1),i.add(n))}function Vn(e,t,i){var n=0;t&&(n|=4),$n(i,e,n,t)}var jn="_reactListening"+Math.random().toString(36).slice(2);function Un(e){if(!e[jn]){e[jn]=!0,s.forEach((function(t){"selectionchange"!==t&&(Fn.has(t)||Vn(t,!1,e),Vn(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[jn]||(t[jn]=!0,Vn("selectionchange",!1,t))}}function $n(e,t,i,n){switch(Kt(t)){case 1:var r=Zt;break;case 4:r=Gt;break;default:r=Wt}i=r.bind(null,t,i,e),r=void 0,!De||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(r=!0),n?void 0!==r?e.addEventListener(t,i,{capture:!0,passive:r}):e.addEventListener(t,i,!0):void 0!==r?e.addEventListener(t,i,{passive:r}):e.addEventListener(t,i,!1)}function qn(e,t,i,n,r){var a=n;if(0===(1&t)&&0===(2&t)&&null!==n)e:for(;;){if(null===n)return;var s=n.tag;if(3===s||4===s){var o=n.stateNode.containerInfo;if(o===r||8===o.nodeType&&o.parentNode===r)break;if(4===s)for(s=n.return;null!==s;){var l=s.tag;if((3===l||4===l)&&((l=s.stateNode.containerInfo)===r||8===l.nodeType&&l.parentNode===r))return;s=s.return}for(;null!==o;){if(null===(s=_r(o)))return;if(5===(l=s.tag)||6===l){n=a=s;continue e}o=o.parentNode}}n=n.return}Me((function(){var n=a,r=be(i),s=[];e:{var o=An.get(e);if(void 0!==o){var l=ci,c=e;switch(e){case"keypress":if(0===ti(i))break e;case"keydown":case"keyup":l=Ei;break;case"focusin":c="focus",l=mi;break;case"focusout":c="blur",l=mi;break;case"beforeblur":case"afterblur":l=mi;break;case"click":if(2===i.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=pi;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=fi;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=Ci;break;case En:case Pn:case Cn:l=gi;break;case In:l=Ii;break;case"scroll":l=hi;break;case"wheel":l=Mi;break;case"copy":case"cut":case"paste":l=_i;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=Pi}var u=0!==(4&t),h=!u&&"scroll"===e,d=u?null!==o?o+"Capture":null:o;u=[];for(var p,f=n;null!==f;){var m=(p=f).stateNode;if(5===p.tag&&null!==m&&(p=m,null!==d&&(null!=(m=ze(f,d))&&u.push(Zn(f,m,p)))),h)break;f=f.return}0<u.length&&(o=new l(o,c,null,i,r),s.push({event:o,listeners:u}))}}if(0===(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(o="mouseover"===e||"pointerover"===e)||i===xe||!(c=i.relatedTarget||i.fromElement)||!_r(c)&&!c[fr])&&(l||o)&&(o=r.window===r?r:(o=r.ownerDocument)?o.defaultView||o.parentWindow:window,l?(l=n,null!==(c=(c=i.relatedTarget||i.toElement)?_r(c):null)&&(c!==(h=Ue(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(l=null,c=n),l!==c)){if(u=pi,m="onMouseLeave",d="onMouseEnter",f="mouse","pointerout"!==e&&"pointerover"!==e||(u=Pi,m="onPointerLeave",d="onPointerEnter",f="pointer"),h=null==l?o:xr(l),p=null==c?o:xr(c),(o=new u(m,f+"leave",l,i,r)).target=h,o.relatedTarget=p,m=null,_r(r)===n&&((u=new u(d,f+"enter",c,i,r)).target=p,u.relatedTarget=h,m=u),h=m,l&&c)e:{for(d=c,f=0,p=u=l;p;p=Wn(p))f++;for(p=0,m=d;m;m=Wn(m))p++;for(;0<f-p;)u=Wn(u),f--;for(;0<p-f;)d=Wn(d),p--;for(;f--;){if(u===d||null!==d&&u===d.alternate)break e;u=Wn(u),d=Wn(d)}u=null}else u=null;null!==l&&Hn(s,o,l,u,!1),null!==c&&null!==h&&Hn(s,h,c,u,!0)}if("select"===(l=(o=n?xr(n):window).nodeName&&o.nodeName.toLowerCase())||"input"===l&&"file"===o.type)var g=Xi;else if($i(o))if(Ki)g=sn;else{g=rn;var y=nn}else(l=o.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===o.type||"radio"===o.type)&&(g=an);switch(g&&(g=g(e,n))?qi(s,g,i,r):(y&&y(e,o,n),"focusout"===e&&(y=o._wrapperState)&&y.controlled&&"number"===o.type&&ee(o,"number",o.value)),y=n?xr(n):window,e){case"focusin":($i(y)||"true"===y.contentEditable)&&(gn=y,yn=n,_n=null);break;case"focusout":_n=yn=gn=null;break;case"mousedown":vn=!0;break;case"contextmenu":case"mouseup":case"dragend":vn=!1,xn(s,i,r);break;case"selectionchange":if(mn)break;case"keydown":case"keyup":xn(s,i,r)}var _;if(Di)e:{switch(e){case"compositionstart":var v="onCompositionStart";break e;case"compositionend":v="onCompositionEnd";break e;case"compositionupdate":v="onCompositionUpdate";break e}v=void 0}else ji?Ni(e,i)&&(v="onCompositionEnd"):"keydown"===e&&229===i.keyCode&&(v="onCompositionStart");v&&(Fi&&"ko"!==i.locale&&(ji||"onCompositionStart"!==v?"onCompositionEnd"===v&&ji&&(_=ei()):(Jt="value"in(Yt=r)?Yt.value:Yt.textContent,ji=!0)),0<(y=Gn(n,v)).length&&(v=new vi(v,e,null,i,r),s.push({event:v,listeners:y}),_?v.data=_:null!==(_=Vi(i))&&(v.data=_))),(_=Ri?function(e,t){switch(e){case"compositionend":return Vi(t);case"keypress":return 32!==t.which?null:(Oi=!0,Bi);case"textInput":return(e=t.data)===Bi&&Oi?null:e;default:return null}}(e,i):function(e,t){if(ji)return"compositionend"===e||!Di&&Ni(e,t)?(e=ei(),Qt=Jt=Yt=null,ji=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Fi&&"ko"!==t.locale?null:t.data}}(e,i))&&(0<(n=Gn(n,"onBeforeInput")).length&&(r=new vi("onBeforeInput","beforeinput",null,i,r),s.push({event:r,listeners:n}),r.data=_))}On(s,t)}))}function Zn(e,t,i){return{instance:e,listener:t,currentTarget:i}}function Gn(e,t){for(var i=t+"Capture",n=[];null!==e;){var r=e,a=r.stateNode;5===r.tag&&null!==a&&(r=a,null!=(a=ze(e,i))&&n.unshift(Zn(e,a,r)),null!=(a=ze(e,t))&&n.push(Zn(e,a,r))),e=e.return}return n}function Wn(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Hn(e,t,i,n,r){for(var a=t._reactName,s=[];null!==i&&i!==n;){var o=i,l=o.alternate,c=o.stateNode;if(null!==l&&l===n)break;5===o.tag&&null!==c&&(o=c,r?null!=(l=ze(i,a))&&s.unshift(Zn(i,l,o)):r||null!=(l=ze(i,a))&&s.push(Zn(i,l,o))),i=i.return}0!==s.length&&e.push({event:t,listeners:s})}var Xn=/\r\n?/g,Kn=/\u0000|\uFFFD/g;function Yn(e){return("string"===typeof e?e:""+e).replace(Xn,"\n").replace(Kn,"")}function Jn(e,t,i){if(t=Yn(t),Yn(e)!==t&&i)throw Error(a(425))}function Qn(){}var er=null,tr=null;function ir(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var nr="function"===typeof setTimeout?setTimeout:void 0,rr="function"===typeof clearTimeout?clearTimeout:void 0,ar="function"===typeof Promise?Promise:void 0,sr="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof ar?function(e){return ar.resolve(null).then(e).catch(or)}:nr;function or(e){setTimeout((function(){throw e}))}function lr(e,t){var i=t,n=0;do{var r=i.nextSibling;if(e.removeChild(i),r&&8===r.nodeType)if("/$"===(i=r.data)){if(0===n)return e.removeChild(r),void Ut(t);n--}else"$"!==i&&"$?"!==i&&"$!"!==i||n++;i=r}while(i);Ut(t)}function cr(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function ur(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var i=e.data;if("$"===i||"$!"===i||"$?"===i){if(0===t)return e;t--}else"/$"===i&&t++}e=e.previousSibling}return null}var hr=Math.random().toString(36).slice(2),dr="__reactFiber$"+hr,pr="__reactProps$"+hr,fr="__reactContainer$"+hr,mr="__reactEvents$"+hr,gr="__reactListeners$"+hr,yr="__reactHandles$"+hr;function _r(e){var t=e[dr];if(t)return t;for(var i=e.parentNode;i;){if(t=i[fr]||i[dr]){if(i=t.alternate,null!==t.child||null!==i&&null!==i.child)for(e=ur(e);null!==e;){if(i=e[dr])return i;e=ur(e)}return t}i=(e=i).parentNode}return null}function vr(e){return!(e=e[dr]||e[fr])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function xr(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(a(33))}function br(e){return e[pr]||null}var wr=[],Sr=-1;function Tr(e){return{current:e}}function kr(e){0>Sr||(e.current=wr[Sr],wr[Sr]=null,Sr--)}function Er(e,t){Sr++,wr[Sr]=e.current,e.current=t}var Pr={},Cr=Tr(Pr),Ir=Tr(!1),Ar=Pr;function Mr(e,t){var i=e.type.contextTypes;if(!i)return Pr;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var r,a={};for(r in i)a[r]=t[r];return n&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function zr(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Dr(){kr(Ir),kr(Cr)}function Lr(e,t,i){if(Cr.current!==Pr)throw Error(a(168));Er(Cr,t),Er(Ir,i)}function Rr(e,t,i){var n=e.stateNode;if(t=t.childContextTypes,"function"!==typeof n.getChildContext)return i;for(var r in n=n.getChildContext())if(!(r in t))throw Error(a(108,$(e)||"Unknown",r));return B({},i,n)}function Fr(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Pr,Ar=Cr.current,Er(Cr,e),Er(Ir,Ir.current),!0}function Br(e,t,i){var n=e.stateNode;if(!n)throw Error(a(169));i?(e=Rr(e,t,Ar),n.__reactInternalMemoizedMergedChildContext=e,kr(Ir),kr(Cr),Er(Cr,e)):kr(Ir),Er(Ir,i)}var Or=null,Nr=!1,Vr=!1;function jr(e){null===Or?Or=[e]:Or.push(e)}function Ur(){if(!Vr&&null!==Or){Vr=!0;var e=0,t=vt;try{var i=Or;for(vt=1;e<i.length;e++){var n=i[e];do{n=n(!0)}while(null!==n)}Or=null,Nr=!1}catch(r){throw null!==Or&&(Or=Or.slice(e+1)),We(Qe,Ur),r}finally{vt=t,Vr=!1}}return null}var $r=[],qr=0,Zr=null,Gr=0,Wr=[],Hr=0,Xr=null,Kr=1,Yr="";function Jr(e,t){$r[qr++]=Gr,$r[qr++]=Zr,Zr=e,Gr=t}function Qr(e,t,i){Wr[Hr++]=Kr,Wr[Hr++]=Yr,Wr[Hr++]=Xr,Xr=e;var n=Kr;e=Yr;var r=32-st(n)-1;n&=~(1<<r),i+=1;var a=32-st(t)+r;if(30<a){var s=r-r%5;a=(n&(1<<s)-1).toString(32),n>>=s,r-=s,Kr=1<<32-st(t)+r|i<<r|n,Yr=a+e}else Kr=1<<a|i<<r|n,Yr=e}function ea(e){null!==e.return&&(Jr(e,1),Qr(e,1,0))}function ta(e){for(;e===Zr;)Zr=$r[--qr],$r[qr]=null,Gr=$r[--qr],$r[qr]=null;for(;e===Xr;)Xr=Wr[--Hr],Wr[Hr]=null,Yr=Wr[--Hr],Wr[Hr]=null,Kr=Wr[--Hr],Wr[Hr]=null}var ia=null,na=null,ra=!1,aa=null;function sa(e,t){var i=Mc(5,null,null,0);i.elementType="DELETED",i.stateNode=t,i.return=e,null===(t=e.deletions)?(e.deletions=[i],e.flags|=16):t.push(i)}function oa(e,t){switch(e.tag){case 5:var i=e.type;return null!==(t=1!==t.nodeType||i.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,ia=e,na=cr(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,ia=e,na=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(i=null!==Xr?{id:Kr,overflow:Yr}:null,e.memoizedState={dehydrated:t,treeContext:i,retryLane:1073741824},(i=Mc(18,null,null,0)).stateNode=t,i.return=e,e.child=i,ia=e,na=null,!0);default:return!1}}function la(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function ca(e){if(ra){var t=na;if(t){var i=t;if(!oa(e,t)){if(la(e))throw Error(a(418));t=cr(i.nextSibling);var n=ia;t&&oa(e,t)?sa(n,i):(e.flags=-4097&e.flags|2,ra=!1,ia=e)}}else{if(la(e))throw Error(a(418));e.flags=-4097&e.flags|2,ra=!1,ia=e}}}function ua(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;ia=e}function ha(e){if(e!==ia)return!1;if(!ra)return ua(e),ra=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!ir(e.type,e.memoizedProps)),t&&(t=na)){if(la(e))throw da(),Error(a(418));for(;t;)sa(e,t),t=cr(t.nextSibling)}if(ua(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(a(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var i=e.data;if("/$"===i){if(0===t){na=cr(e.nextSibling);break e}t--}else"$"!==i&&"$!"!==i&&"$?"!==i||t++}e=e.nextSibling}na=null}}else na=ia?cr(e.stateNode.nextSibling):null;return!0}function da(){for(var e=na;e;)e=cr(e.nextSibling)}function pa(){na=ia=null,ra=!1}function fa(e){null===aa?aa=[e]:aa.push(e)}var ma=x.ReactCurrentBatchConfig;function ga(e,t,i){if(null!==(e=i.ref)&&"function"!==typeof e&&"object"!==typeof e){if(i._owner){if(i=i._owner){if(1!==i.tag)throw Error(a(309));var n=i.stateNode}if(!n)throw Error(a(147,e));var r=n,s=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===s?t.ref:(t=function(e){var t=r.refs;null===e?delete t[s]:t[s]=e},t._stringRef=s,t)}if("string"!==typeof e)throw Error(a(284));if(!i._owner)throw Error(a(290,e))}return e}function ya(e,t){throw e=Object.prototype.toString.call(t),Error(a(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function _a(e){return(0,e._init)(e._payload)}function va(e){function t(t,i){if(e){var n=t.deletions;null===n?(t.deletions=[i],t.flags|=16):n.push(i)}}function i(i,n){if(!e)return null;for(;null!==n;)t(i,n),n=n.sibling;return null}function n(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function r(e,t){return(e=Dc(e,t)).index=0,e.sibling=null,e}function s(t,i,n){return t.index=n,e?null!==(n=t.alternate)?(n=n.index)<i?(t.flags|=2,i):n:(t.flags|=2,i):(t.flags|=1048576,i)}function o(t){return e&&null===t.alternate&&(t.flags|=2),t}function l(e,t,i,n){return null===t||6!==t.tag?((t=Bc(i,e.mode,n)).return=e,t):((t=r(t,i)).return=e,t)}function c(e,t,i,n){var a=i.type;return a===S?h(e,t,i.props.children,n,i.key):null!==t&&(t.elementType===a||"object"===typeof a&&null!==a&&a.$$typeof===z&&_a(a)===t.type)?((n=r(t,i.props)).ref=ga(e,t,i),n.return=e,n):((n=Lc(i.type,i.key,i.props,null,e.mode,n)).ref=ga(e,t,i),n.return=e,n)}function u(e,t,i,n){return null===t||4!==t.tag||t.stateNode.containerInfo!==i.containerInfo||t.stateNode.implementation!==i.implementation?((t=Oc(i,e.mode,n)).return=e,t):((t=r(t,i.children||[])).return=e,t)}function h(e,t,i,n,a){return null===t||7!==t.tag?((t=Rc(i,e.mode,n,a)).return=e,t):((t=r(t,i)).return=e,t)}function d(e,t,i){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=Bc(""+t,e.mode,i)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case b:return(i=Lc(t.type,t.key,t.props,null,e.mode,i)).ref=ga(e,null,t),i.return=e,i;case w:return(t=Oc(t,e.mode,i)).return=e,t;case z:return d(e,(0,t._init)(t._payload),i)}if(te(t)||R(t))return(t=Rc(t,e.mode,i,null)).return=e,t;ya(e,t)}return null}function p(e,t,i,n){var r=null!==t?t.key:null;if("string"===typeof i&&""!==i||"number"===typeof i)return null!==r?null:l(e,t,""+i,n);if("object"===typeof i&&null!==i){switch(i.$$typeof){case b:return i.key===r?c(e,t,i,n):null;case w:return i.key===r?u(e,t,i,n):null;case z:return p(e,t,(r=i._init)(i._payload),n)}if(te(i)||R(i))return null!==r?null:h(e,t,i,n,null);ya(e,i)}return null}function f(e,t,i,n,r){if("string"===typeof n&&""!==n||"number"===typeof n)return l(t,e=e.get(i)||null,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case b:return c(t,e=e.get(null===n.key?i:n.key)||null,n,r);case w:return u(t,e=e.get(null===n.key?i:n.key)||null,n,r);case z:return f(e,t,i,(0,n._init)(n._payload),r)}if(te(n)||R(n))return h(t,e=e.get(i)||null,n,r,null);ya(t,n)}return null}function m(r,a,o,l){for(var c=null,u=null,h=a,m=a=0,g=null;null!==h&&m<o.length;m++){h.index>m?(g=h,h=null):g=h.sibling;var y=p(r,h,o[m],l);if(null===y){null===h&&(h=g);break}e&&h&&null===y.alternate&&t(r,h),a=s(y,a,m),null===u?c=y:u.sibling=y,u=y,h=g}if(m===o.length)return i(r,h),ra&&Jr(r,m),c;if(null===h){for(;m<o.length;m++)null!==(h=d(r,o[m],l))&&(a=s(h,a,m),null===u?c=h:u.sibling=h,u=h);return ra&&Jr(r,m),c}for(h=n(r,h);m<o.length;m++)null!==(g=f(h,r,m,o[m],l))&&(e&&null!==g.alternate&&h.delete(null===g.key?m:g.key),a=s(g,a,m),null===u?c=g:u.sibling=g,u=g);return e&&h.forEach((function(e){return t(r,e)})),ra&&Jr(r,m),c}function g(r,o,l,c){var u=R(l);if("function"!==typeof u)throw Error(a(150));if(null==(l=u.call(l)))throw Error(a(151));for(var h=u=null,m=o,g=o=0,y=null,_=l.next();null!==m&&!_.done;g++,_=l.next()){m.index>g?(y=m,m=null):y=m.sibling;var v=p(r,m,_.value,c);if(null===v){null===m&&(m=y);break}e&&m&&null===v.alternate&&t(r,m),o=s(v,o,g),null===h?u=v:h.sibling=v,h=v,m=y}if(_.done)return i(r,m),ra&&Jr(r,g),u;if(null===m){for(;!_.done;g++,_=l.next())null!==(_=d(r,_.value,c))&&(o=s(_,o,g),null===h?u=_:h.sibling=_,h=_);return ra&&Jr(r,g),u}for(m=n(r,m);!_.done;g++,_=l.next())null!==(_=f(m,r,g,_.value,c))&&(e&&null!==_.alternate&&m.delete(null===_.key?g:_.key),o=s(_,o,g),null===h?u=_:h.sibling=_,h=_);return e&&m.forEach((function(e){return t(r,e)})),ra&&Jr(r,g),u}return function e(n,a,s,l){if("object"===typeof s&&null!==s&&s.type===S&&null===s.key&&(s=s.props.children),"object"===typeof s&&null!==s){switch(s.$$typeof){case b:e:{for(var c=s.key,u=a;null!==u;){if(u.key===c){if((c=s.type)===S){if(7===u.tag){i(n,u.sibling),(a=r(u,s.props.children)).return=n,n=a;break e}}else if(u.elementType===c||"object"===typeof c&&null!==c&&c.$$typeof===z&&_a(c)===u.type){i(n,u.sibling),(a=r(u,s.props)).ref=ga(n,u,s),a.return=n,n=a;break e}i(n,u);break}t(n,u),u=u.sibling}s.type===S?((a=Rc(s.props.children,n.mode,l,s.key)).return=n,n=a):((l=Lc(s.type,s.key,s.props,null,n.mode,l)).ref=ga(n,a,s),l.return=n,n=l)}return o(n);case w:e:{for(u=s.key;null!==a;){if(a.key===u){if(4===a.tag&&a.stateNode.containerInfo===s.containerInfo&&a.stateNode.implementation===s.implementation){i(n,a.sibling),(a=r(a,s.children||[])).return=n,n=a;break e}i(n,a);break}t(n,a),a=a.sibling}(a=Oc(s,n.mode,l)).return=n,n=a}return o(n);case z:return e(n,a,(u=s._init)(s._payload),l)}if(te(s))return m(n,a,s,l);if(R(s))return g(n,a,s,l);ya(n,s)}return"string"===typeof s&&""!==s||"number"===typeof s?(s=""+s,null!==a&&6===a.tag?(i(n,a.sibling),(a=r(a,s)).return=n,n=a):(i(n,a),(a=Bc(s,n.mode,l)).return=n,n=a),o(n)):i(n,a)}}var xa=va(!0),ba=va(!1),wa=Tr(null),Sa=null,Ta=null,ka=null;function Ea(){ka=Ta=Sa=null}function Pa(e){var t=wa.current;kr(wa),e._currentValue=t}function Ca(e,t,i){for(;null!==e;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==n&&(n.childLanes|=t)):null!==n&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===i)break;e=e.return}}function Ia(e,t){Sa=e,ka=Ta=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(vo=!0),e.firstContext=null)}function Aa(e){var t=e._currentValue;if(ka!==e)if(e={context:e,memoizedValue:t,next:null},null===Ta){if(null===Sa)throw Error(a(308));Ta=e,Sa.dependencies={lanes:0,firstContext:e}}else Ta=Ta.next=e;return t}var Ma=null;function za(e){null===Ma?Ma=[e]:Ma.push(e)}function Da(e,t,i,n){var r=t.interleaved;return null===r?(i.next=i,za(t)):(i.next=r.next,r.next=i),t.interleaved=i,La(e,n)}function La(e,t){e.lanes|=t;var i=e.alternate;for(null!==i&&(i.lanes|=t),i=e,e=e.return;null!==e;)e.childLanes|=t,null!==(i=e.alternate)&&(i.childLanes|=t),i=e,e=e.return;return 3===i.tag?i.stateNode:null}var Ra=!1;function Fa(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Ba(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Oa(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Na(e,t,i){var n=e.updateQueue;if(null===n)return null;if(n=n.shared,0!==(2&Cl)){var r=n.pending;return null===r?t.next=t:(t.next=r.next,r.next=t),n.pending=t,La(e,i)}return null===(r=n.interleaved)?(t.next=t,za(n)):(t.next=r.next,r.next=t),n.interleaved=t,La(e,i)}function Va(e,t,i){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&i))){var n=t.lanes;i|=n&=e.pendingLanes,t.lanes=i,_t(e,i)}}function ja(e,t){var i=e.updateQueue,n=e.alternate;if(null!==n&&i===(n=n.updateQueue)){var r=null,a=null;if(null!==(i=i.firstBaseUpdate)){do{var s={eventTime:i.eventTime,lane:i.lane,tag:i.tag,payload:i.payload,callback:i.callback,next:null};null===a?r=a=s:a=a.next=s,i=i.next}while(null!==i);null===a?r=a=t:a=a.next=t}else r=a=t;return i={baseState:n.baseState,firstBaseUpdate:r,lastBaseUpdate:a,shared:n.shared,effects:n.effects},void(e.updateQueue=i)}null===(e=i.lastBaseUpdate)?i.firstBaseUpdate=t:e.next=t,i.lastBaseUpdate=t}function Ua(e,t,i,n){var r=e.updateQueue;Ra=!1;var a=r.firstBaseUpdate,s=r.lastBaseUpdate,o=r.shared.pending;if(null!==o){r.shared.pending=null;var l=o,c=l.next;l.next=null,null===s?a=c:s.next=c,s=l;var u=e.alternate;null!==u&&((o=(u=u.updateQueue).lastBaseUpdate)!==s&&(null===o?u.firstBaseUpdate=c:o.next=c,u.lastBaseUpdate=l))}if(null!==a){var h=r.baseState;for(s=0,u=c=l=null,o=a;;){var d=o.lane,p=o.eventTime;if((n&d)===d){null!==u&&(u=u.next={eventTime:p,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var f=e,m=o;switch(d=t,p=i,m.tag){case 1:if("function"===typeof(f=m.payload)){h=f.call(p,h,d);break e}h=f;break e;case 3:f.flags=-65537&f.flags|128;case 0:if(null===(d="function"===typeof(f=m.payload)?f.call(p,h,d):f)||void 0===d)break e;h=B({},h,d);break e;case 2:Ra=!0}}null!==o.callback&&0!==o.lane&&(e.flags|=64,null===(d=r.effects)?r.effects=[o]:d.push(o))}else p={eventTime:p,lane:d,tag:o.tag,payload:o.payload,callback:o.callback,next:null},null===u?(c=u=p,l=h):u=u.next=p,s|=d;if(null===(o=o.next)){if(null===(o=r.shared.pending))break;o=(d=o).next,d.next=null,r.lastBaseUpdate=d,r.shared.pending=null}}if(null===u&&(l=h),r.baseState=l,r.firstBaseUpdate=c,r.lastBaseUpdate=u,null!==(t=r.shared.interleaved)){r=t;do{s|=r.lane,r=r.next}while(r!==t)}else null===a&&(r.shared.lanes=0);Fl|=s,e.lanes=s,e.memoizedState=h}}function $a(e,t,i){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var n=e[t],r=n.callback;if(null!==r){if(n.callback=null,n=i,"function"!==typeof r)throw Error(a(191,r));r.call(n)}}}var qa={},Za=Tr(qa),Ga=Tr(qa),Wa=Tr(qa);function Ha(e){if(e===qa)throw Error(a(174));return e}function Xa(e,t){switch(Er(Wa,t),Er(Ga,e),Er(Za,qa),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:le(null,"");break;default:t=le(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}kr(Za),Er(Za,t)}function Ka(){kr(Za),kr(Ga),kr(Wa)}function Ya(e){Ha(Wa.current);var t=Ha(Za.current),i=le(t,e.type);t!==i&&(Er(Ga,e),Er(Za,i))}function Ja(e){Ga.current===e&&(kr(Za),kr(Ga))}var Qa=Tr(0);function es(e){for(var t=e;null!==t;){if(13===t.tag){var i=t.memoizedState;if(null!==i&&(null===(i=i.dehydrated)||"$?"===i.data||"$!"===i.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var ts=[];function is(){for(var e=0;e<ts.length;e++)ts[e]._workInProgressVersionPrimary=null;ts.length=0}var ns=x.ReactCurrentDispatcher,rs=x.ReactCurrentBatchConfig,as=0,ss=null,os=null,ls=null,cs=!1,us=!1,hs=0,ds=0;function ps(){throw Error(a(321))}function fs(e,t){if(null===t)return!1;for(var i=0;i<t.length&&i<e.length;i++)if(!on(e[i],t[i]))return!1;return!0}function ms(e,t,i,n,r,s){if(as=s,ss=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,ns.current=null===e||null===e.memoizedState?Js:Qs,e=i(n,r),us){s=0;do{if(us=!1,hs=0,25<=s)throw Error(a(301));s+=1,ls=os=null,t.updateQueue=null,ns.current=eo,e=i(n,r)}while(us)}if(ns.current=Ys,t=null!==os&&null!==os.next,as=0,ls=os=ss=null,cs=!1,t)throw Error(a(300));return e}function gs(){var e=0!==hs;return hs=0,e}function ys(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===ls?ss.memoizedState=ls=e:ls=ls.next=e,ls}function _s(){if(null===os){var e=ss.alternate;e=null!==e?e.memoizedState:null}else e=os.next;var t=null===ls?ss.memoizedState:ls.next;if(null!==t)ls=t,os=e;else{if(null===e)throw Error(a(310));e={memoizedState:(os=e).memoizedState,baseState:os.baseState,baseQueue:os.baseQueue,queue:os.queue,next:null},null===ls?ss.memoizedState=ls=e:ls=ls.next=e}return ls}function vs(e,t){return"function"===typeof t?t(e):t}function xs(e){var t=_s(),i=t.queue;if(null===i)throw Error(a(311));i.lastRenderedReducer=e;var n=os,r=n.baseQueue,s=i.pending;if(null!==s){if(null!==r){var o=r.next;r.next=s.next,s.next=o}n.baseQueue=r=s,i.pending=null}if(null!==r){s=r.next,n=n.baseState;var l=o=null,c=null,u=s;do{var h=u.lane;if((as&h)===h)null!==c&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),n=u.hasEagerState?u.eagerState:e(n,u.action);else{var d={lane:h,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};null===c?(l=c=d,o=n):c=c.next=d,ss.lanes|=h,Fl|=h}u=u.next}while(null!==u&&u!==s);null===c?o=n:c.next=l,on(n,t.memoizedState)||(vo=!0),t.memoizedState=n,t.baseState=o,t.baseQueue=c,i.lastRenderedState=n}if(null!==(e=i.interleaved)){r=e;do{s=r.lane,ss.lanes|=s,Fl|=s,r=r.next}while(r!==e)}else null===r&&(i.lanes=0);return[t.memoizedState,i.dispatch]}function bs(e){var t=_s(),i=t.queue;if(null===i)throw Error(a(311));i.lastRenderedReducer=e;var n=i.dispatch,r=i.pending,s=t.memoizedState;if(null!==r){i.pending=null;var o=r=r.next;do{s=e(s,o.action),o=o.next}while(o!==r);on(s,t.memoizedState)||(vo=!0),t.memoizedState=s,null===t.baseQueue&&(t.baseState=s),i.lastRenderedState=s}return[s,n]}function ws(){}function Ss(e,t){var i=ss,n=_s(),r=t(),s=!on(n.memoizedState,r);if(s&&(n.memoizedState=r,vo=!0),n=n.queue,Rs(Es.bind(null,i,n,e),[e]),n.getSnapshot!==t||s||null!==ls&&1&ls.memoizedState.tag){if(i.flags|=2048,As(9,ks.bind(null,i,n,r,t),void 0,null),null===Il)throw Error(a(349));0!==(30&as)||Ts(i,t,r)}return r}function Ts(e,t,i){e.flags|=16384,e={getSnapshot:t,value:i},null===(t=ss.updateQueue)?(t={lastEffect:null,stores:null},ss.updateQueue=t,t.stores=[e]):null===(i=t.stores)?t.stores=[e]:i.push(e)}function ks(e,t,i,n){t.value=i,t.getSnapshot=n,Ps(t)&&Cs(e)}function Es(e,t,i){return i((function(){Ps(t)&&Cs(e)}))}function Ps(e){var t=e.getSnapshot;e=e.value;try{var i=t();return!on(e,i)}catch(n){return!0}}function Cs(e){var t=La(e,1);null!==t&&ic(t,e,1,-1)}function Is(e){var t=ys();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:vs,lastRenderedState:e},t.queue=e,e=e.dispatch=Ws.bind(null,ss,e),[t.memoizedState,e]}function As(e,t,i,n){return e={tag:e,create:t,destroy:i,deps:n,next:null},null===(t=ss.updateQueue)?(t={lastEffect:null,stores:null},ss.updateQueue=t,t.lastEffect=e.next=e):null===(i=t.lastEffect)?t.lastEffect=e.next=e:(n=i.next,i.next=e,e.next=n,t.lastEffect=e),e}function Ms(){return _s().memoizedState}function zs(e,t,i,n){var r=ys();ss.flags|=e,r.memoizedState=As(1|t,i,void 0,void 0===n?null:n)}function Ds(e,t,i,n){var r=_s();n=void 0===n?null:n;var a=void 0;if(null!==os){var s=os.memoizedState;if(a=s.destroy,null!==n&&fs(n,s.deps))return void(r.memoizedState=As(t,i,a,n))}ss.flags|=e,r.memoizedState=As(1|t,i,a,n)}function Ls(e,t){return zs(8390656,8,e,t)}function Rs(e,t){return Ds(2048,8,e,t)}function Fs(e,t){return Ds(4,2,e,t)}function Bs(e,t){return Ds(4,4,e,t)}function Os(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Ns(e,t,i){return i=null!==i&&void 0!==i?i.concat([e]):null,Ds(4,4,Os.bind(null,t,e),i)}function Vs(){}function js(e,t){var i=_s();t=void 0===t?null:t;var n=i.memoizedState;return null!==n&&null!==t&&fs(t,n[1])?n[0]:(i.memoizedState=[e,t],e)}function Us(e,t){var i=_s();t=void 0===t?null:t;var n=i.memoizedState;return null!==n&&null!==t&&fs(t,n[1])?n[0]:(e=e(),i.memoizedState=[e,t],e)}function $s(e,t,i){return 0===(21&as)?(e.baseState&&(e.baseState=!1,vo=!0),e.memoizedState=i):(on(i,t)||(i=mt(),ss.lanes|=i,Fl|=i,e.baseState=!0),t)}function qs(e,t){var i=vt;vt=0!==i&&4>i?i:4,e(!0);var n=rs.transition;rs.transition={};try{e(!1),t()}finally{vt=i,rs.transition=n}}function Zs(){return _s().memoizedState}function Gs(e,t,i){var n=tc(e);if(i={lane:n,action:i,hasEagerState:!1,eagerState:null,next:null},Hs(e))Xs(t,i);else if(null!==(i=Da(e,t,i,n))){ic(i,e,n,ec()),Ks(i,t,n)}}function Ws(e,t,i){var n=tc(e),r={lane:n,action:i,hasEagerState:!1,eagerState:null,next:null};if(Hs(e))Xs(t,r);else{var a=e.alternate;if(0===e.lanes&&(null===a||0===a.lanes)&&null!==(a=t.lastRenderedReducer))try{var s=t.lastRenderedState,o=a(s,i);if(r.hasEagerState=!0,r.eagerState=o,on(o,s)){var l=t.interleaved;return null===l?(r.next=r,za(t)):(r.next=l.next,l.next=r),void(t.interleaved=r)}}catch(c){}null!==(i=Da(e,t,r,n))&&(ic(i,e,n,r=ec()),Ks(i,t,n))}}function Hs(e){var t=e.alternate;return e===ss||null!==t&&t===ss}function Xs(e,t){us=cs=!0;var i=e.pending;null===i?t.next=t:(t.next=i.next,i.next=t),e.pending=t}function Ks(e,t,i){if(0!==(4194240&i)){var n=t.lanes;i|=n&=e.pendingLanes,t.lanes=i,_t(e,i)}}var Ys={readContext:Aa,useCallback:ps,useContext:ps,useEffect:ps,useImperativeHandle:ps,useInsertionEffect:ps,useLayoutEffect:ps,useMemo:ps,useReducer:ps,useRef:ps,useState:ps,useDebugValue:ps,useDeferredValue:ps,useTransition:ps,useMutableSource:ps,useSyncExternalStore:ps,useId:ps,unstable_isNewReconciler:!1},Js={readContext:Aa,useCallback:function(e,t){return ys().memoizedState=[e,void 0===t?null:t],e},useContext:Aa,useEffect:Ls,useImperativeHandle:function(e,t,i){return i=null!==i&&void 0!==i?i.concat([e]):null,zs(4194308,4,Os.bind(null,t,e),i)},useLayoutEffect:function(e,t){return zs(4194308,4,e,t)},useInsertionEffect:function(e,t){return zs(4,2,e,t)},useMemo:function(e,t){var i=ys();return t=void 0===t?null:t,e=e(),i.memoizedState=[e,t],e},useReducer:function(e,t,i){var n=ys();return t=void 0!==i?i(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=Gs.bind(null,ss,e),[n.memoizedState,e]},useRef:function(e){return e={current:e},ys().memoizedState=e},useState:Is,useDebugValue:Vs,useDeferredValue:function(e){return ys().memoizedState=e},useTransition:function(){var e=Is(!1),t=e[0];return e=qs.bind(null,e[1]),ys().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,i){var n=ss,r=ys();if(ra){if(void 0===i)throw Error(a(407));i=i()}else{if(i=t(),null===Il)throw Error(a(349));0!==(30&as)||Ts(n,t,i)}r.memoizedState=i;var s={value:i,getSnapshot:t};return r.queue=s,Ls(Es.bind(null,n,s,e),[e]),n.flags|=2048,As(9,ks.bind(null,n,s,i,t),void 0,null),i},useId:function(){var e=ys(),t=Il.identifierPrefix;if(ra){var i=Yr;t=":"+t+"R"+(i=(Kr&~(1<<32-st(Kr)-1)).toString(32)+i),0<(i=hs++)&&(t+="H"+i.toString(32)),t+=":"}else t=":"+t+"r"+(i=ds++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},Qs={readContext:Aa,useCallback:js,useContext:Aa,useEffect:Rs,useImperativeHandle:Ns,useInsertionEffect:Fs,useLayoutEffect:Bs,useMemo:Us,useReducer:xs,useRef:Ms,useState:function(){return xs(vs)},useDebugValue:Vs,useDeferredValue:function(e){return $s(_s(),os.memoizedState,e)},useTransition:function(){return[xs(vs)[0],_s().memoizedState]},useMutableSource:ws,useSyncExternalStore:Ss,useId:Zs,unstable_isNewReconciler:!1},eo={readContext:Aa,useCallback:js,useContext:Aa,useEffect:Rs,useImperativeHandle:Ns,useInsertionEffect:Fs,useLayoutEffect:Bs,useMemo:Us,useReducer:bs,useRef:Ms,useState:function(){return bs(vs)},useDebugValue:Vs,useDeferredValue:function(e){var t=_s();return null===os?t.memoizedState=e:$s(t,os.memoizedState,e)},useTransition:function(){return[bs(vs)[0],_s().memoizedState]},useMutableSource:ws,useSyncExternalStore:Ss,useId:Zs,unstable_isNewReconciler:!1};function to(e,t){if(e&&e.defaultProps){for(var i in t=B({},t),e=e.defaultProps)void 0===t[i]&&(t[i]=e[i]);return t}return t}function io(e,t,i,n){i=null===(i=i(n,t=e.memoizedState))||void 0===i?t:B({},t,i),e.memoizedState=i,0===e.lanes&&(e.updateQueue.baseState=i)}var no={isMounted:function(e){return!!(e=e._reactInternals)&&Ue(e)===e},enqueueSetState:function(e,t,i){e=e._reactInternals;var n=ec(),r=tc(e),a=Oa(n,r);a.payload=t,void 0!==i&&null!==i&&(a.callback=i),null!==(t=Na(e,a,r))&&(ic(t,e,r,n),Va(t,e,r))},enqueueReplaceState:function(e,t,i){e=e._reactInternals;var n=ec(),r=tc(e),a=Oa(n,r);a.tag=1,a.payload=t,void 0!==i&&null!==i&&(a.callback=i),null!==(t=Na(e,a,r))&&(ic(t,e,r,n),Va(t,e,r))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var i=ec(),n=tc(e),r=Oa(i,n);r.tag=2,void 0!==t&&null!==t&&(r.callback=t),null!==(t=Na(e,r,n))&&(ic(t,e,n,i),Va(t,e,n))}};function ro(e,t,i,n,r,a,s){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(n,a,s):!t.prototype||!t.prototype.isPureReactComponent||(!ln(i,n)||!ln(r,a))}function ao(e,t,i){var n=!1,r=Pr,a=t.contextType;return"object"===typeof a&&null!==a?a=Aa(a):(r=zr(t)?Ar:Cr.current,a=(n=null!==(n=t.contextTypes)&&void 0!==n)?Mr(e,r):Pr),t=new t(i,a),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=no,e.stateNode=t,t._reactInternals=e,n&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=r,e.__reactInternalMemoizedMaskedChildContext=a),t}function so(e,t,i,n){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(i,n),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(i,n),t.state!==e&&no.enqueueReplaceState(t,t.state,null)}function oo(e,t,i,n){var r=e.stateNode;r.props=i,r.state=e.memoizedState,r.refs={},Fa(e);var a=t.contextType;"object"===typeof a&&null!==a?r.context=Aa(a):(a=zr(t)?Ar:Cr.current,r.context=Mr(e,a)),r.state=e.memoizedState,"function"===typeof(a=t.getDerivedStateFromProps)&&(io(e,t,a,i),r.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof r.getSnapshotBeforeUpdate||"function"!==typeof r.UNSAFE_componentWillMount&&"function"!==typeof r.componentWillMount||(t=r.state,"function"===typeof r.componentWillMount&&r.componentWillMount(),"function"===typeof r.UNSAFE_componentWillMount&&r.UNSAFE_componentWillMount(),t!==r.state&&no.enqueueReplaceState(r,r.state,null),Ua(e,i,r,n),r.state=e.memoizedState),"function"===typeof r.componentDidMount&&(e.flags|=4194308)}function lo(e,t){try{var i="",n=t;do{i+=j(n),n=n.return}while(n);var r=i}catch(a){r="\nError generating stack: "+a.message+"\n"+a.stack}return{value:e,source:t,stack:r,digest:null}}function co(e,t,i){return{value:e,source:null,stack:null!=i?i:null,digest:null!=t?t:null}}function uo(e,t){try{console.error(t.value)}catch(i){setTimeout((function(){throw i}))}}var ho="function"===typeof WeakMap?WeakMap:Map;function po(e,t,i){(i=Oa(-1,i)).tag=3,i.payload={element:null};var n=t.value;return i.callback=function(){ql||(ql=!0,Zl=n),uo(0,t)},i}function fo(e,t,i){(i=Oa(-1,i)).tag=3;var n=e.type.getDerivedStateFromError;if("function"===typeof n){var r=t.value;i.payload=function(){return n(r)},i.callback=function(){uo(0,t)}}var a=e.stateNode;return null!==a&&"function"===typeof a.componentDidCatch&&(i.callback=function(){uo(0,t),"function"!==typeof n&&(null===Gl?Gl=new Set([this]):Gl.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),i}function mo(e,t,i){var n=e.pingCache;if(null===n){n=e.pingCache=new ho;var r=new Set;n.set(t,r)}else void 0===(r=n.get(t))&&(r=new Set,n.set(t,r));r.has(i)||(r.add(i),e=kc.bind(null,e,t,i),t.then(e,e))}function go(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function yo(e,t,i,n,r){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,i.flags|=131072,i.flags&=-52805,1===i.tag&&(null===i.alternate?i.tag=17:((t=Oa(-1,1)).tag=2,Na(i,t,1))),i.lanes|=1),e):(e.flags|=65536,e.lanes=r,e)}var _o=x.ReactCurrentOwner,vo=!1;function xo(e,t,i,n){t.child=null===e?ba(t,null,i,n):xa(t,e.child,i,n)}function bo(e,t,i,n,r){i=i.render;var a=t.ref;return Ia(t,r),n=ms(e,t,i,n,a,r),i=gs(),null===e||vo?(ra&&i&&ea(t),t.flags|=1,xo(e,t,n,r),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r,qo(e,t,r))}function wo(e,t,i,n,r){if(null===e){var a=i.type;return"function"!==typeof a||zc(a)||void 0!==a.defaultProps||null!==i.compare||void 0!==i.defaultProps?((e=Lc(i.type,null,n,t,t.mode,r)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=a,So(e,t,a,n,r))}if(a=e.child,0===(e.lanes&r)){var s=a.memoizedProps;if((i=null!==(i=i.compare)?i:ln)(s,n)&&e.ref===t.ref)return qo(e,t,r)}return t.flags|=1,(e=Dc(a,n)).ref=t.ref,e.return=t,t.child=e}function So(e,t,i,n,r){if(null!==e){var a=e.memoizedProps;if(ln(a,n)&&e.ref===t.ref){if(vo=!1,t.pendingProps=n=a,0===(e.lanes&r))return t.lanes=e.lanes,qo(e,t,r);0!==(131072&e.flags)&&(vo=!0)}}return Eo(e,t,i,n,r)}function To(e,t,i){var n=t.pendingProps,r=n.children,a=null!==e?e.memoizedState:null;if("hidden"===n.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Er(Dl,zl),zl|=i;else{if(0===(1073741824&i))return e=null!==a?a.baseLanes|i:i,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Er(Dl,zl),zl|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=null!==a?a.baseLanes:i,Er(Dl,zl),zl|=n}else null!==a?(n=a.baseLanes|i,t.memoizedState=null):n=i,Er(Dl,zl),zl|=n;return xo(e,t,r,i),t.child}function ko(e,t){var i=t.ref;(null===e&&null!==i||null!==e&&e.ref!==i)&&(t.flags|=512,t.flags|=2097152)}function Eo(e,t,i,n,r){var a=zr(i)?Ar:Cr.current;return a=Mr(t,a),Ia(t,r),i=ms(e,t,i,n,a,r),n=gs(),null===e||vo?(ra&&n&&ea(t),t.flags|=1,xo(e,t,i,r),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r,qo(e,t,r))}function Po(e,t,i,n,r){if(zr(i)){var a=!0;Fr(t)}else a=!1;if(Ia(t,r),null===t.stateNode)$o(e,t),ao(t,i,n),oo(t,i,n,r),n=!0;else if(null===e){var s=t.stateNode,o=t.memoizedProps;s.props=o;var l=s.context,c=i.contextType;"object"===typeof c&&null!==c?c=Aa(c):c=Mr(t,c=zr(i)?Ar:Cr.current);var u=i.getDerivedStateFromProps,h="function"===typeof u||"function"===typeof s.getSnapshotBeforeUpdate;h||"function"!==typeof s.UNSAFE_componentWillReceiveProps&&"function"!==typeof s.componentWillReceiveProps||(o!==n||l!==c)&&so(t,s,n,c),Ra=!1;var d=t.memoizedState;s.state=d,Ua(t,n,s,r),l=t.memoizedState,o!==n||d!==l||Ir.current||Ra?("function"===typeof u&&(io(t,i,u,n),l=t.memoizedState),(o=Ra||ro(t,i,o,n,d,l,c))?(h||"function"!==typeof s.UNSAFE_componentWillMount&&"function"!==typeof s.componentWillMount||("function"===typeof s.componentWillMount&&s.componentWillMount(),"function"===typeof s.UNSAFE_componentWillMount&&s.UNSAFE_componentWillMount()),"function"===typeof s.componentDidMount&&(t.flags|=4194308)):("function"===typeof s.componentDidMount&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=l),s.props=n,s.state=l,s.context=c,n=o):("function"===typeof s.componentDidMount&&(t.flags|=4194308),n=!1)}else{s=t.stateNode,Ba(e,t),o=t.memoizedProps,c=t.type===t.elementType?o:to(t.type,o),s.props=c,h=t.pendingProps,d=s.context,"object"===typeof(l=i.contextType)&&null!==l?l=Aa(l):l=Mr(t,l=zr(i)?Ar:Cr.current);var p=i.getDerivedStateFromProps;(u="function"===typeof p||"function"===typeof s.getSnapshotBeforeUpdate)||"function"!==typeof s.UNSAFE_componentWillReceiveProps&&"function"!==typeof s.componentWillReceiveProps||(o!==h||d!==l)&&so(t,s,n,l),Ra=!1,d=t.memoizedState,s.state=d,Ua(t,n,s,r);var f=t.memoizedState;o!==h||d!==f||Ir.current||Ra?("function"===typeof p&&(io(t,i,p,n),f=t.memoizedState),(c=Ra||ro(t,i,c,n,d,f,l)||!1)?(u||"function"!==typeof s.UNSAFE_componentWillUpdate&&"function"!==typeof s.componentWillUpdate||("function"===typeof s.componentWillUpdate&&s.componentWillUpdate(n,f,l),"function"===typeof s.UNSAFE_componentWillUpdate&&s.UNSAFE_componentWillUpdate(n,f,l)),"function"===typeof s.componentDidUpdate&&(t.flags|=4),"function"===typeof s.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof s.componentDidUpdate||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!==typeof s.getSnapshotBeforeUpdate||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=f),s.props=n,s.state=f,s.context=l,n=c):("function"!==typeof s.componentDidUpdate||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!==typeof s.getSnapshotBeforeUpdate||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),n=!1)}return Co(e,t,i,n,a,r)}function Co(e,t,i,n,r,a){ko(e,t);var s=0!==(128&t.flags);if(!n&&!s)return r&&Br(t,i,!1),qo(e,t,a);n=t.stateNode,_o.current=t;var o=s&&"function"!==typeof i.getDerivedStateFromError?null:n.render();return t.flags|=1,null!==e&&s?(t.child=xa(t,e.child,null,a),t.child=xa(t,null,o,a)):xo(e,t,o,a),t.memoizedState=n.state,r&&Br(t,i,!0),t.child}function Io(e){var t=e.stateNode;t.pendingContext?Lr(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Lr(0,t.context,!1),Xa(e,t.containerInfo)}function Ao(e,t,i,n,r){return pa(),fa(r),t.flags|=256,xo(e,t,i,n),t.child}var Mo,zo,Do,Lo,Ro={dehydrated:null,treeContext:null,retryLane:0};function Fo(e){return{baseLanes:e,cachePool:null,transitions:null}}function Bo(e,t,i){var n,r=t.pendingProps,s=Qa.current,o=!1,l=0!==(128&t.flags);if((n=l)||(n=(null===e||null!==e.memoizedState)&&0!==(2&s)),n?(o=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(s|=1),Er(Qa,1&s),null===e)return ca(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(l=r.children,e=r.fallback,o?(r=t.mode,o=t.child,l={mode:"hidden",children:l},0===(1&r)&&null!==o?(o.childLanes=0,o.pendingProps=l):o=Fc(l,r,0,null),e=Rc(e,r,i,null),o.return=t,e.return=t,o.sibling=e,t.child=o,t.child.memoizedState=Fo(i),t.memoizedState=Ro,e):Oo(t,l));if(null!==(s=e.memoizedState)&&null!==(n=s.dehydrated))return function(e,t,i,n,r,s,o){if(i)return 256&t.flags?(t.flags&=-257,No(e,t,o,n=co(Error(a(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(s=n.fallback,r=t.mode,n=Fc({mode:"visible",children:n.children},r,0,null),(s=Rc(s,r,o,null)).flags|=2,n.return=t,s.return=t,n.sibling=s,t.child=n,0!==(1&t.mode)&&xa(t,e.child,null,o),t.child.memoizedState=Fo(o),t.memoizedState=Ro,s);if(0===(1&t.mode))return No(e,t,o,null);if("$!"===r.data){if(n=r.nextSibling&&r.nextSibling.dataset)var l=n.dgst;return n=l,No(e,t,o,n=co(s=Error(a(419)),n,void 0))}if(l=0!==(o&e.childLanes),vo||l){if(null!==(n=Il)){switch(o&-o){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}0!==(r=0!==(r&(n.suspendedLanes|o))?0:r)&&r!==s.retryLane&&(s.retryLane=r,La(e,r),ic(n,e,r,-1))}return mc(),No(e,t,o,n=co(Error(a(421))))}return"$?"===r.data?(t.flags|=128,t.child=e.child,t=Pc.bind(null,e),r._reactRetry=t,null):(e=s.treeContext,na=cr(r.nextSibling),ia=t,ra=!0,aa=null,null!==e&&(Wr[Hr++]=Kr,Wr[Hr++]=Yr,Wr[Hr++]=Xr,Kr=e.id,Yr=e.overflow,Xr=t),t=Oo(t,n.children),t.flags|=4096,t)}(e,t,l,r,n,s,i);if(o){o=r.fallback,l=t.mode,n=(s=e.child).sibling;var c={mode:"hidden",children:r.children};return 0===(1&l)&&t.child!==s?((r=t.child).childLanes=0,r.pendingProps=c,t.deletions=null):(r=Dc(s,c)).subtreeFlags=14680064&s.subtreeFlags,null!==n?o=Dc(n,o):(o=Rc(o,l,i,null)).flags|=2,o.return=t,r.return=t,r.sibling=o,t.child=r,r=o,o=t.child,l=null===(l=e.child.memoizedState)?Fo(i):{baseLanes:l.baseLanes|i,cachePool:null,transitions:l.transitions},o.memoizedState=l,o.childLanes=e.childLanes&~i,t.memoizedState=Ro,r}return e=(o=e.child).sibling,r=Dc(o,{mode:"visible",children:r.children}),0===(1&t.mode)&&(r.lanes=i),r.return=t,r.sibling=null,null!==e&&(null===(i=t.deletions)?(t.deletions=[e],t.flags|=16):i.push(e)),t.child=r,t.memoizedState=null,r}function Oo(e,t){return(t=Fc({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function No(e,t,i,n){return null!==n&&fa(n),xa(t,e.child,null,i),(e=Oo(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Vo(e,t,i){e.lanes|=t;var n=e.alternate;null!==n&&(n.lanes|=t),Ca(e.return,t,i)}function jo(e,t,i,n,r){var a=e.memoizedState;null===a?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:i,tailMode:r}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=n,a.tail=i,a.tailMode=r)}function Uo(e,t,i){var n=t.pendingProps,r=n.revealOrder,a=n.tail;if(xo(e,t,n.children,i),0!==(2&(n=Qa.current)))n=1&n|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Vo(e,i,t);else if(19===e.tag)Vo(e,i,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(Er(Qa,n),0===(1&t.mode))t.memoizedState=null;else switch(r){case"forwards":for(i=t.child,r=null;null!==i;)null!==(e=i.alternate)&&null===es(e)&&(r=i),i=i.sibling;null===(i=r)?(r=t.child,t.child=null):(r=i.sibling,i.sibling=null),jo(t,!1,r,i,a);break;case"backwards":for(i=null,r=t.child,t.child=null;null!==r;){if(null!==(e=r.alternate)&&null===es(e)){t.child=r;break}e=r.sibling,r.sibling=i,i=r,r=e}jo(t,!0,i,null,a);break;case"together":jo(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function $o(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function qo(e,t,i){if(null!==e&&(t.dependencies=e.dependencies),Fl|=t.lanes,0===(i&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(a(153));if(null!==t.child){for(i=Dc(e=t.child,e.pendingProps),t.child=i,i.return=t;null!==e.sibling;)e=e.sibling,(i=i.sibling=Dc(e,e.pendingProps)).return=t;i.sibling=null}return t.child}function Zo(e,t){if(!ra)switch(e.tailMode){case"hidden":t=e.tail;for(var i=null;null!==t;)null!==t.alternate&&(i=t),t=t.sibling;null===i?e.tail=null:i.sibling=null;break;case"collapsed":i=e.tail;for(var n=null;null!==i;)null!==i.alternate&&(n=i),i=i.sibling;null===n?t||null===e.tail?e.tail=null:e.tail.sibling=null:n.sibling=null}}function Go(e){var t=null!==e.alternate&&e.alternate.child===e.child,i=0,n=0;if(t)for(var r=e.child;null!==r;)i|=r.lanes|r.childLanes,n|=14680064&r.subtreeFlags,n|=14680064&r.flags,r.return=e,r=r.sibling;else for(r=e.child;null!==r;)i|=r.lanes|r.childLanes,n|=r.subtreeFlags,n|=r.flags,r.return=e,r=r.sibling;return e.subtreeFlags|=n,e.childLanes=i,t}function Wo(e,t,i){var n=t.pendingProps;switch(ta(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Go(t),null;case 1:case 17:return zr(t.type)&&Dr(),Go(t),null;case 3:return n=t.stateNode,Ka(),kr(Ir),kr(Cr),is(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),null!==e&&null!==e.child||(ha(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==aa&&(sc(aa),aa=null))),zo(e,t),Go(t),null;case 5:Ja(t);var r=Ha(Wa.current);if(i=t.type,null!==e&&null!=t.stateNode)Do(e,t,i,n,r),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(null===t.stateNode)throw Error(a(166));return Go(t),null}if(e=Ha(Za.current),ha(t)){n=t.stateNode,i=t.type;var s=t.memoizedProps;switch(n[dr]=t,n[pr]=s,e=0!==(1&t.mode),i){case"dialog":Nn("cancel",n),Nn("close",n);break;case"iframe":case"object":case"embed":Nn("load",n);break;case"video":case"audio":for(r=0;r<Rn.length;r++)Nn(Rn[r],n);break;case"source":Nn("error",n);break;case"img":case"image":case"link":Nn("error",n),Nn("load",n);break;case"details":Nn("toggle",n);break;case"input":K(n,s),Nn("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},Nn("invalid",n);break;case"textarea":re(n,s),Nn("invalid",n)}for(var l in _e(i,s),r=null,s)if(s.hasOwnProperty(l)){var c=s[l];"children"===l?"string"===typeof c?n.textContent!==c&&(!0!==s.suppressHydrationWarning&&Jn(n.textContent,c,e),r=["children",c]):"number"===typeof c&&n.textContent!==""+c&&(!0!==s.suppressHydrationWarning&&Jn(n.textContent,c,e),r=["children",""+c]):o.hasOwnProperty(l)&&null!=c&&"onScroll"===l&&Nn("scroll",n)}switch(i){case"input":G(n),Q(n,s,!0);break;case"textarea":G(n),se(n);break;case"select":case"option":break;default:"function"===typeof s.onClick&&(n.onclick=Qn)}n=r,t.updateQueue=n,null!==n&&(t.flags|=4)}else{l=9===r.nodeType?r:r.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=oe(i)),"http://www.w3.org/1999/xhtml"===e?"script"===i?((e=l.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof n.is?e=l.createElement(i,{is:n.is}):(e=l.createElement(i),"select"===i&&(l=e,n.multiple?l.multiple=!0:n.size&&(l.size=n.size))):e=l.createElementNS(e,i),e[dr]=t,e[pr]=n,Mo(e,t,!1,!1),t.stateNode=e;e:{switch(l=ve(i,n),i){case"dialog":Nn("cancel",e),Nn("close",e),r=n;break;case"iframe":case"object":case"embed":Nn("load",e),r=n;break;case"video":case"audio":for(r=0;r<Rn.length;r++)Nn(Rn[r],e);r=n;break;case"source":Nn("error",e),r=n;break;case"img":case"image":case"link":Nn("error",e),Nn("load",e),r=n;break;case"details":Nn("toggle",e),r=n;break;case"input":K(e,n),r=X(e,n),Nn("invalid",e);break;case"option":default:r=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},r=B({},n,{value:void 0}),Nn("invalid",e);break;case"textarea":re(e,n),r=ne(e,n),Nn("invalid",e)}for(s in _e(i,r),c=r)if(c.hasOwnProperty(s)){var u=c[s];"style"===s?ge(e,u):"dangerouslySetInnerHTML"===s?null!=(u=u?u.__html:void 0)&&he(e,u):"children"===s?"string"===typeof u?("textarea"!==i||""!==u)&&de(e,u):"number"===typeof u&&de(e,""+u):"suppressContentEditableWarning"!==s&&"suppressHydrationWarning"!==s&&"autoFocus"!==s&&(o.hasOwnProperty(s)?null!=u&&"onScroll"===s&&Nn("scroll",e):null!=u&&v(e,s,u,l))}switch(i){case"input":G(e),Q(e,n,!1);break;case"textarea":G(e),se(e);break;case"option":null!=n.value&&e.setAttribute("value",""+q(n.value));break;case"select":e.multiple=!!n.multiple,null!=(s=n.value)?ie(e,!!n.multiple,s,!1):null!=n.defaultValue&&ie(e,!!n.multiple,n.defaultValue,!0);break;default:"function"===typeof r.onClick&&(e.onclick=Qn)}switch(i){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Go(t),null;case 6:if(e&&null!=t.stateNode)Lo(e,t,e.memoizedProps,n);else{if("string"!==typeof n&&null===t.stateNode)throw Error(a(166));if(i=Ha(Wa.current),Ha(Za.current),ha(t)){if(n=t.stateNode,i=t.memoizedProps,n[dr]=t,(s=n.nodeValue!==i)&&null!==(e=ia))switch(e.tag){case 3:Jn(n.nodeValue,i,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Jn(n.nodeValue,i,0!==(1&e.mode))}s&&(t.flags|=4)}else(n=(9===i.nodeType?i:i.ownerDocument).createTextNode(n))[dr]=t,t.stateNode=n}return Go(t),null;case 13:if(kr(Qa),n=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(ra&&null!==na&&0!==(1&t.mode)&&0===(128&t.flags))da(),pa(),t.flags|=98560,s=!1;else if(s=ha(t),null!==n&&null!==n.dehydrated){if(null===e){if(!s)throw Error(a(318));if(!(s=null!==(s=t.memoizedState)?s.dehydrated:null))throw Error(a(317));s[dr]=t}else pa(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Go(t),s=!1}else null!==aa&&(sc(aa),aa=null),s=!0;if(!s)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=i,t):((n=null!==n)!==(null!==e&&null!==e.memoizedState)&&n&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&Qa.current)?0===Ll&&(Ll=3):mc())),null!==t.updateQueue&&(t.flags|=4),Go(t),null);case 4:return Ka(),zo(e,t),null===e&&Un(t.stateNode.containerInfo),Go(t),null;case 10:return Pa(t.type._context),Go(t),null;case 19:if(kr(Qa),null===(s=t.memoizedState))return Go(t),null;if(n=0!==(128&t.flags),null===(l=s.rendering))if(n)Zo(s,!1);else{if(0!==Ll||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(l=es(e))){for(t.flags|=128,Zo(s,!1),null!==(n=l.updateQueue)&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=i,i=t.child;null!==i;)e=n,(s=i).flags&=14680066,null===(l=s.alternate)?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=l.childLanes,s.lanes=l.lanes,s.child=l.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=l.memoizedProps,s.memoizedState=l.memoizedState,s.updateQueue=l.updateQueue,s.type=l.type,e=l.dependencies,s.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),i=i.sibling;return Er(Qa,1&Qa.current|2),t.child}e=e.sibling}null!==s.tail&&Ye()>Ul&&(t.flags|=128,n=!0,Zo(s,!1),t.lanes=4194304)}else{if(!n)if(null!==(e=es(l))){if(t.flags|=128,n=!0,null!==(i=e.updateQueue)&&(t.updateQueue=i,t.flags|=4),Zo(s,!0),null===s.tail&&"hidden"===s.tailMode&&!l.alternate&&!ra)return Go(t),null}else 2*Ye()-s.renderingStartTime>Ul&&1073741824!==i&&(t.flags|=128,n=!0,Zo(s,!1),t.lanes=4194304);s.isBackwards?(l.sibling=t.child,t.child=l):(null!==(i=s.last)?i.sibling=l:t.child=l,s.last=l)}return null!==s.tail?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=Ye(),t.sibling=null,i=Qa.current,Er(Qa,n?1&i|2:1&i),t):(Go(t),null);case 22:case 23:return hc(),n=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==n&&(t.flags|=8192),n&&0!==(1&t.mode)?0!==(1073741824&zl)&&(Go(t),6&t.subtreeFlags&&(t.flags|=8192)):Go(t),null;case 24:case 25:return null}throw Error(a(156,t.tag))}function Ho(e,t){switch(ta(t),t.tag){case 1:return zr(t.type)&&Dr(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return Ka(),kr(Ir),kr(Cr),is(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return Ja(t),null;case 13:if(kr(Qa),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(a(340));pa()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return kr(Qa),null;case 4:return Ka(),null;case 10:return Pa(t.type._context),null;case 22:case 23:return hc(),null;default:return null}}Mo=function(e,t){for(var i=t.child;null!==i;){if(5===i.tag||6===i.tag)e.appendChild(i.stateNode);else if(4!==i.tag&&null!==i.child){i.child.return=i,i=i.child;continue}if(i===t)break;for(;null===i.sibling;){if(null===i.return||i.return===t)return;i=i.return}i.sibling.return=i.return,i=i.sibling}},zo=function(){},Do=function(e,t,i,n){var r=e.memoizedProps;if(r!==n){e=t.stateNode,Ha(Za.current);var a,s=null;switch(i){case"input":r=X(e,r),n=X(e,n),s=[];break;case"select":r=B({},r,{value:void 0}),n=B({},n,{value:void 0}),s=[];break;case"textarea":r=ne(e,r),n=ne(e,n),s=[];break;default:"function"!==typeof r.onClick&&"function"===typeof n.onClick&&(e.onclick=Qn)}for(u in _e(i,n),i=null,r)if(!n.hasOwnProperty(u)&&r.hasOwnProperty(u)&&null!=r[u])if("style"===u){var l=r[u];for(a in l)l.hasOwnProperty(a)&&(i||(i={}),i[a]="")}else"dangerouslySetInnerHTML"!==u&&"children"!==u&&"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&"autoFocus"!==u&&(o.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in n){var c=n[u];if(l=null!=r?r[u]:void 0,n.hasOwnProperty(u)&&c!==l&&(null!=c||null!=l))if("style"===u)if(l){for(a in l)!l.hasOwnProperty(a)||c&&c.hasOwnProperty(a)||(i||(i={}),i[a]="");for(a in c)c.hasOwnProperty(a)&&l[a]!==c[a]&&(i||(i={}),i[a]=c[a])}else i||(s||(s=[]),s.push(u,i)),i=c;else"dangerouslySetInnerHTML"===u?(c=c?c.__html:void 0,l=l?l.__html:void 0,null!=c&&l!==c&&(s=s||[]).push(u,c)):"children"===u?"string"!==typeof c&&"number"!==typeof c||(s=s||[]).push(u,""+c):"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&(o.hasOwnProperty(u)?(null!=c&&"onScroll"===u&&Nn("scroll",e),s||l===c||(s=[])):(s=s||[]).push(u,c))}i&&(s=s||[]).push("style",i);var u=s;(t.updateQueue=u)&&(t.flags|=4)}},Lo=function(e,t,i,n){i!==n&&(t.flags|=4)};var Xo=!1,Ko=!1,Yo="function"===typeof WeakSet?WeakSet:Set,Jo=null;function Qo(e,t){var i=e.ref;if(null!==i)if("function"===typeof i)try{i(null)}catch(n){Tc(e,t,n)}else i.current=null}function el(e,t,i){try{i()}catch(n){Tc(e,t,n)}}var tl=!1;function il(e,t,i){var n=t.updateQueue;if(null!==(n=null!==n?n.lastEffect:null)){var r=n=n.next;do{if((r.tag&e)===e){var a=r.destroy;r.destroy=void 0,void 0!==a&&el(t,i,a)}r=r.next}while(r!==n)}}function nl(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var i=t=t.next;do{if((i.tag&e)===e){var n=i.create;i.destroy=n()}i=i.next}while(i!==t)}}function rl(e){var t=e.ref;if(null!==t){var i=e.stateNode;e.tag,e=i,"function"===typeof t?t(e):t.current=e}}function al(e){var t=e.alternate;null!==t&&(e.alternate=null,al(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[dr],delete t[pr],delete t[mr],delete t[gr],delete t[yr])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function sl(e){return 5===e.tag||3===e.tag||4===e.tag}function ol(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||sl(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function ll(e,t,i){var n=e.tag;if(5===n||6===n)e=e.stateNode,t?8===i.nodeType?i.parentNode.insertBefore(e,t):i.insertBefore(e,t):(8===i.nodeType?(t=i.parentNode).insertBefore(e,i):(t=i).appendChild(e),null!==(i=i._reactRootContainer)&&void 0!==i||null!==t.onclick||(t.onclick=Qn));else if(4!==n&&null!==(e=e.child))for(ll(e,t,i),e=e.sibling;null!==e;)ll(e,t,i),e=e.sibling}function cl(e,t,i){var n=e.tag;if(5===n||6===n)e=e.stateNode,t?i.insertBefore(e,t):i.appendChild(e);else if(4!==n&&null!==(e=e.child))for(cl(e,t,i),e=e.sibling;null!==e;)cl(e,t,i),e=e.sibling}var ul=null,hl=!1;function dl(e,t,i){for(i=i.child;null!==i;)pl(e,t,i),i=i.sibling}function pl(e,t,i){if(at&&"function"===typeof at.onCommitFiberUnmount)try{at.onCommitFiberUnmount(rt,i)}catch(o){}switch(i.tag){case 5:Ko||Qo(i,t);case 6:var n=ul,r=hl;ul=null,dl(e,t,i),hl=r,null!==(ul=n)&&(hl?(e=ul,i=i.stateNode,8===e.nodeType?e.parentNode.removeChild(i):e.removeChild(i)):ul.removeChild(i.stateNode));break;case 18:null!==ul&&(hl?(e=ul,i=i.stateNode,8===e.nodeType?lr(e.parentNode,i):1===e.nodeType&&lr(e,i),Ut(e)):lr(ul,i.stateNode));break;case 4:n=ul,r=hl,ul=i.stateNode.containerInfo,hl=!0,dl(e,t,i),ul=n,hl=r;break;case 0:case 11:case 14:case 15:if(!Ko&&(null!==(n=i.updateQueue)&&null!==(n=n.lastEffect))){r=n=n.next;do{var a=r,s=a.destroy;a=a.tag,void 0!==s&&(0!==(2&a)||0!==(4&a))&&el(i,t,s),r=r.next}while(r!==n)}dl(e,t,i);break;case 1:if(!Ko&&(Qo(i,t),"function"===typeof(n=i.stateNode).componentWillUnmount))try{n.props=i.memoizedProps,n.state=i.memoizedState,n.componentWillUnmount()}catch(o){Tc(i,t,o)}dl(e,t,i);break;case 21:dl(e,t,i);break;case 22:1&i.mode?(Ko=(n=Ko)||null!==i.memoizedState,dl(e,t,i),Ko=n):dl(e,t,i);break;default:dl(e,t,i)}}function fl(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var i=e.stateNode;null===i&&(i=e.stateNode=new Yo),t.forEach((function(t){var n=Cc.bind(null,e,t);i.has(t)||(i.add(t),t.then(n,n))}))}}function ml(e,t){var i=t.deletions;if(null!==i)for(var n=0;n<i.length;n++){var r=i[n];try{var s=e,o=t,l=o;e:for(;null!==l;){switch(l.tag){case 5:ul=l.stateNode,hl=!1;break e;case 3:case 4:ul=l.stateNode.containerInfo,hl=!0;break e}l=l.return}if(null===ul)throw Error(a(160));pl(s,o,r),ul=null,hl=!1;var c=r.alternate;null!==c&&(c.return=null),r.return=null}catch(u){Tc(r,t,u)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)gl(t,e),t=t.sibling}function gl(e,t){var i=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(ml(t,e),yl(e),4&n){try{il(3,e,e.return),nl(3,e)}catch(g){Tc(e,e.return,g)}try{il(5,e,e.return)}catch(g){Tc(e,e.return,g)}}break;case 1:ml(t,e),yl(e),512&n&&null!==i&&Qo(i,i.return);break;case 5:if(ml(t,e),yl(e),512&n&&null!==i&&Qo(i,i.return),32&e.flags){var r=e.stateNode;try{de(r,"")}catch(g){Tc(e,e.return,g)}}if(4&n&&null!=(r=e.stateNode)){var s=e.memoizedProps,o=null!==i?i.memoizedProps:s,l=e.type,c=e.updateQueue;if(e.updateQueue=null,null!==c)try{"input"===l&&"radio"===s.type&&null!=s.name&&Y(r,s),ve(l,o);var u=ve(l,s);for(o=0;o<c.length;o+=2){var h=c[o],d=c[o+1];"style"===h?ge(r,d):"dangerouslySetInnerHTML"===h?he(r,d):"children"===h?de(r,d):v(r,h,d,u)}switch(l){case"input":J(r,s);break;case"textarea":ae(r,s);break;case"select":var p=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!s.multiple;var f=s.value;null!=f?ie(r,!!s.multiple,f,!1):p!==!!s.multiple&&(null!=s.defaultValue?ie(r,!!s.multiple,s.defaultValue,!0):ie(r,!!s.multiple,s.multiple?[]:"",!1))}r[pr]=s}catch(g){Tc(e,e.return,g)}}break;case 6:if(ml(t,e),yl(e),4&n){if(null===e.stateNode)throw Error(a(162));r=e.stateNode,s=e.memoizedProps;try{r.nodeValue=s}catch(g){Tc(e,e.return,g)}}break;case 3:if(ml(t,e),yl(e),4&n&&null!==i&&i.memoizedState.isDehydrated)try{Ut(t.containerInfo)}catch(g){Tc(e,e.return,g)}break;case 4:default:ml(t,e),yl(e);break;case 13:ml(t,e),yl(e),8192&(r=e.child).flags&&(s=null!==r.memoizedState,r.stateNode.isHidden=s,!s||null!==r.alternate&&null!==r.alternate.memoizedState||(jl=Ye())),4&n&&fl(e);break;case 22:if(h=null!==i&&null!==i.memoizedState,1&e.mode?(Ko=(u=Ko)||h,ml(t,e),Ko=u):ml(t,e),yl(e),8192&n){if(u=null!==e.memoizedState,(e.stateNode.isHidden=u)&&!h&&0!==(1&e.mode))for(Jo=e,h=e.child;null!==h;){for(d=Jo=h;null!==Jo;){switch(f=(p=Jo).child,p.tag){case 0:case 11:case 14:case 15:il(4,p,p.return);break;case 1:Qo(p,p.return);var m=p.stateNode;if("function"===typeof m.componentWillUnmount){n=p,i=p.return;try{t=n,m.props=t.memoizedProps,m.state=t.memoizedState,m.componentWillUnmount()}catch(g){Tc(n,i,g)}}break;case 5:Qo(p,p.return);break;case 22:if(null!==p.memoizedState){bl(d);continue}}null!==f?(f.return=p,Jo=f):bl(d)}h=h.sibling}e:for(h=null,d=e;;){if(5===d.tag){if(null===h){h=d;try{r=d.stateNode,u?"function"===typeof(s=r.style).setProperty?s.setProperty("display","none","important"):s.display="none":(l=d.stateNode,o=void 0!==(c=d.memoizedProps.style)&&null!==c&&c.hasOwnProperty("display")?c.display:null,l.style.display=me("display",o))}catch(g){Tc(e,e.return,g)}}}else if(6===d.tag){if(null===h)try{d.stateNode.nodeValue=u?"":d.memoizedProps}catch(g){Tc(e,e.return,g)}}else if((22!==d.tag&&23!==d.tag||null===d.memoizedState||d===e)&&null!==d.child){d.child.return=d,d=d.child;continue}if(d===e)break e;for(;null===d.sibling;){if(null===d.return||d.return===e)break e;h===d&&(h=null),d=d.return}h===d&&(h=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:ml(t,e),yl(e),4&n&&fl(e);case 21:}}function yl(e){var t=e.flags;if(2&t){try{e:{for(var i=e.return;null!==i;){if(sl(i)){var n=i;break e}i=i.return}throw Error(a(160))}switch(n.tag){case 5:var r=n.stateNode;32&n.flags&&(de(r,""),n.flags&=-33),cl(e,ol(e),r);break;case 3:case 4:var s=n.stateNode.containerInfo;ll(e,ol(e),s);break;default:throw Error(a(161))}}catch(o){Tc(e,e.return,o)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function _l(e,t,i){Jo=e,vl(e,t,i)}function vl(e,t,i){for(var n=0!==(1&e.mode);null!==Jo;){var r=Jo,a=r.child;if(22===r.tag&&n){var s=null!==r.memoizedState||Xo;if(!s){var o=r.alternate,l=null!==o&&null!==o.memoizedState||Ko;o=Xo;var c=Ko;if(Xo=s,(Ko=l)&&!c)for(Jo=r;null!==Jo;)l=(s=Jo).child,22===s.tag&&null!==s.memoizedState?wl(r):null!==l?(l.return=s,Jo=l):wl(r);for(;null!==a;)Jo=a,vl(a,t,i),a=a.sibling;Jo=r,Xo=o,Ko=c}xl(e)}else 0!==(8772&r.subtreeFlags)&&null!==a?(a.return=r,Jo=a):xl(e)}}function xl(e){for(;null!==Jo;){var t=Jo;if(0!==(8772&t.flags)){var i=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Ko||nl(5,t);break;case 1:var n=t.stateNode;if(4&t.flags&&!Ko)if(null===i)n.componentDidMount();else{var r=t.elementType===t.type?i.memoizedProps:to(t.type,i.memoizedProps);n.componentDidUpdate(r,i.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;null!==s&&$a(t,s,n);break;case 3:var o=t.updateQueue;if(null!==o){if(i=null,null!==t.child)switch(t.child.tag){case 5:case 1:i=t.child.stateNode}$a(t,o,i)}break;case 5:var l=t.stateNode;if(null===i&&4&t.flags){i=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&i.focus();break;case"img":c.src&&(i.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var u=t.alternate;if(null!==u){var h=u.memoizedState;if(null!==h){var d=h.dehydrated;null!==d&&Ut(d)}}}break;default:throw Error(a(163))}Ko||512&t.flags&&rl(t)}catch(p){Tc(t,t.return,p)}}if(t===e){Jo=null;break}if(null!==(i=t.sibling)){i.return=t.return,Jo=i;break}Jo=t.return}}function bl(e){for(;null!==Jo;){var t=Jo;if(t===e){Jo=null;break}var i=t.sibling;if(null!==i){i.return=t.return,Jo=i;break}Jo=t.return}}function wl(e){for(;null!==Jo;){var t=Jo;try{switch(t.tag){case 0:case 11:case 15:var i=t.return;try{nl(4,t)}catch(l){Tc(t,i,l)}break;case 1:var n=t.stateNode;if("function"===typeof n.componentDidMount){var r=t.return;try{n.componentDidMount()}catch(l){Tc(t,r,l)}}var a=t.return;try{rl(t)}catch(l){Tc(t,a,l)}break;case 5:var s=t.return;try{rl(t)}catch(l){Tc(t,s,l)}}}catch(l){Tc(t,t.return,l)}if(t===e){Jo=null;break}var o=t.sibling;if(null!==o){o.return=t.return,Jo=o;break}Jo=t.return}}var Sl,Tl=Math.ceil,kl=x.ReactCurrentDispatcher,El=x.ReactCurrentOwner,Pl=x.ReactCurrentBatchConfig,Cl=0,Il=null,Al=null,Ml=0,zl=0,Dl=Tr(0),Ll=0,Rl=null,Fl=0,Bl=0,Ol=0,Nl=null,Vl=null,jl=0,Ul=1/0,$l=null,ql=!1,Zl=null,Gl=null,Wl=!1,Hl=null,Xl=0,Kl=0,Yl=null,Jl=-1,Ql=0;function ec(){return 0!==(6&Cl)?Ye():-1!==Jl?Jl:Jl=Ye()}function tc(e){return 0===(1&e.mode)?1:0!==(2&Cl)&&0!==Ml?Ml&-Ml:null!==ma.transition?(0===Ql&&(Ql=mt()),Ql):0!==(e=vt)?e:e=void 0===(e=window.event)?16:Kt(e.type)}function ic(e,t,i,n){if(50<Kl)throw Kl=0,Yl=null,Error(a(185));yt(e,i,n),0!==(2&Cl)&&e===Il||(e===Il&&(0===(2&Cl)&&(Bl|=i),4===Ll&&oc(e,Ml)),nc(e,n),1===i&&0===Cl&&0===(1&t.mode)&&(Ul=Ye()+500,Nr&&Ur()))}function nc(e,t){var i=e.callbackNode;!function(e,t){for(var i=e.suspendedLanes,n=e.pingedLanes,r=e.expirationTimes,a=e.pendingLanes;0<a;){var s=31-st(a),o=1<<s,l=r[s];-1===l?0!==(o&i)&&0===(o&n)||(r[s]=pt(o,t)):l<=t&&(e.expiredLanes|=o),a&=~o}}(e,t);var n=dt(e,e===Il?Ml:0);if(0===n)null!==i&&He(i),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(null!=i&&He(i),1===t)0===e.tag?function(e){Nr=!0,jr(e)}(lc.bind(null,e)):jr(lc.bind(null,e)),sr((function(){0===(6&Cl)&&Ur()})),i=null;else{switch(xt(n)){case 1:i=Qe;break;case 4:i=et;break;case 16:default:i=tt;break;case 536870912:i=nt}i=Ic(i,rc.bind(null,e))}e.callbackPriority=t,e.callbackNode=i}}function rc(e,t){if(Jl=-1,Ql=0,0!==(6&Cl))throw Error(a(327));var i=e.callbackNode;if(wc()&&e.callbackNode!==i)return null;var n=dt(e,e===Il?Ml:0);if(0===n)return null;if(0!==(30&n)||0!==(n&e.expiredLanes)||t)t=gc(e,n);else{t=n;var r=Cl;Cl|=2;var s=fc();for(Il===e&&Ml===t||($l=null,Ul=Ye()+500,dc(e,t));;)try{_c();break}catch(l){pc(e,l)}Ea(),kl.current=s,Cl=r,null!==Al?t=0:(Il=null,Ml=0,t=Ll)}if(0!==t){if(2===t&&(0!==(r=ft(e))&&(n=r,t=ac(e,r))),1===t)throw i=Rl,dc(e,0),oc(e,n),nc(e,Ye()),i;if(6===t)oc(e,n);else{if(r=e.current.alternate,0===(30&n)&&!function(e){for(var t=e;;){if(16384&t.flags){var i=t.updateQueue;if(null!==i&&null!==(i=i.stores))for(var n=0;n<i.length;n++){var r=i[n],a=r.getSnapshot;r=r.value;try{if(!on(a(),r))return!1}catch(o){return!1}}}if(i=t.child,16384&t.subtreeFlags&&null!==i)i.return=t,t=i;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(r)&&(2===(t=gc(e,n))&&(0!==(s=ft(e))&&(n=s,t=ac(e,s))),1===t))throw i=Rl,dc(e,0),oc(e,n),nc(e,Ye()),i;switch(e.finishedWork=r,e.finishedLanes=n,t){case 0:case 1:throw Error(a(345));case 2:case 5:bc(e,Vl,$l);break;case 3:if(oc(e,n),(130023424&n)===n&&10<(t=jl+500-Ye())){if(0!==dt(e,0))break;if(((r=e.suspendedLanes)&n)!==n){ec(),e.pingedLanes|=e.suspendedLanes&r;break}e.timeoutHandle=nr(bc.bind(null,e,Vl,$l),t);break}bc(e,Vl,$l);break;case 4:if(oc(e,n),(4194240&n)===n)break;for(t=e.eventTimes,r=-1;0<n;){var o=31-st(n);s=1<<o,(o=t[o])>r&&(r=o),n&=~s}if(n=r,10<(n=(120>(n=Ye()-n)?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*Tl(n/1960))-n)){e.timeoutHandle=nr(bc.bind(null,e,Vl,$l),n);break}bc(e,Vl,$l);break;default:throw Error(a(329))}}}return nc(e,Ye()),e.callbackNode===i?rc.bind(null,e):null}function ac(e,t){var i=Nl;return e.current.memoizedState.isDehydrated&&(dc(e,t).flags|=256),2!==(e=gc(e,t))&&(t=Vl,Vl=i,null!==t&&sc(t)),e}function sc(e){null===Vl?Vl=e:Vl.push.apply(Vl,e)}function oc(e,t){for(t&=~Ol,t&=~Bl,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var i=31-st(t),n=1<<i;e[i]=-1,t&=~n}}function lc(e){if(0!==(6&Cl))throw Error(a(327));wc();var t=dt(e,0);if(0===(1&t))return nc(e,Ye()),null;var i=gc(e,t);if(0!==e.tag&&2===i){var n=ft(e);0!==n&&(t=n,i=ac(e,n))}if(1===i)throw i=Rl,dc(e,0),oc(e,t),nc(e,Ye()),i;if(6===i)throw Error(a(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,bc(e,Vl,$l),nc(e,Ye()),null}function cc(e,t){var i=Cl;Cl|=1;try{return e(t)}finally{0===(Cl=i)&&(Ul=Ye()+500,Nr&&Ur())}}function uc(e){null!==Hl&&0===Hl.tag&&0===(6&Cl)&&wc();var t=Cl;Cl|=1;var i=Pl.transition,n=vt;try{if(Pl.transition=null,vt=1,e)return e()}finally{vt=n,Pl.transition=i,0===(6&(Cl=t))&&Ur()}}function hc(){zl=Dl.current,kr(Dl)}function dc(e,t){e.finishedWork=null,e.finishedLanes=0;var i=e.timeoutHandle;if(-1!==i&&(e.timeoutHandle=-1,rr(i)),null!==Al)for(i=Al.return;null!==i;){var n=i;switch(ta(n),n.tag){case 1:null!==(n=n.type.childContextTypes)&&void 0!==n&&Dr();break;case 3:Ka(),kr(Ir),kr(Cr),is();break;case 5:Ja(n);break;case 4:Ka();break;case 13:case 19:kr(Qa);break;case 10:Pa(n.type._context);break;case 22:case 23:hc()}i=i.return}if(Il=e,Al=e=Dc(e.current,null),Ml=zl=t,Ll=0,Rl=null,Ol=Bl=Fl=0,Vl=Nl=null,null!==Ma){for(t=0;t<Ma.length;t++)if(null!==(n=(i=Ma[t]).interleaved)){i.interleaved=null;var r=n.next,a=i.pending;if(null!==a){var s=a.next;a.next=r,n.next=s}i.pending=n}Ma=null}return e}function pc(e,t){for(;;){var i=Al;try{if(Ea(),ns.current=Ys,cs){for(var n=ss.memoizedState;null!==n;){var r=n.queue;null!==r&&(r.pending=null),n=n.next}cs=!1}if(as=0,ls=os=ss=null,us=!1,hs=0,El.current=null,null===i||null===i.return){Ll=1,Rl=t,Al=null;break}e:{var s=e,o=i.return,l=i,c=t;if(t=Ml,l.flags|=32768,null!==c&&"object"===typeof c&&"function"===typeof c.then){var u=c,h=l,d=h.tag;if(0===(1&h.mode)&&(0===d||11===d||15===d)){var p=h.alternate;p?(h.updateQueue=p.updateQueue,h.memoizedState=p.memoizedState,h.lanes=p.lanes):(h.updateQueue=null,h.memoizedState=null)}var f=go(o);if(null!==f){f.flags&=-257,yo(f,o,l,0,t),1&f.mode&&mo(s,u,t),c=u;var m=(t=f).updateQueue;if(null===m){var g=new Set;g.add(c),t.updateQueue=g}else m.add(c);break e}if(0===(1&t)){mo(s,u,t),mc();break e}c=Error(a(426))}else if(ra&&1&l.mode){var y=go(o);if(null!==y){0===(65536&y.flags)&&(y.flags|=256),yo(y,o,l,0,t),fa(lo(c,l));break e}}s=c=lo(c,l),4!==Ll&&(Ll=2),null===Nl?Nl=[s]:Nl.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t,ja(s,po(0,c,t));break e;case 1:l=c;var _=s.type,v=s.stateNode;if(0===(128&s.flags)&&("function"===typeof _.getDerivedStateFromError||null!==v&&"function"===typeof v.componentDidCatch&&(null===Gl||!Gl.has(v)))){s.flags|=65536,t&=-t,s.lanes|=t,ja(s,fo(s,l,t));break e}}s=s.return}while(null!==s)}xc(i)}catch(x){t=x,Al===i&&null!==i&&(Al=i=i.return);continue}break}}function fc(){var e=kl.current;return kl.current=Ys,null===e?Ys:e}function mc(){0!==Ll&&3!==Ll&&2!==Ll||(Ll=4),null===Il||0===(268435455&Fl)&&0===(268435455&Bl)||oc(Il,Ml)}function gc(e,t){var i=Cl;Cl|=2;var n=fc();for(Il===e&&Ml===t||($l=null,dc(e,t));;)try{yc();break}catch(r){pc(e,r)}if(Ea(),Cl=i,kl.current=n,null!==Al)throw Error(a(261));return Il=null,Ml=0,Ll}function yc(){for(;null!==Al;)vc(Al)}function _c(){for(;null!==Al&&!Xe();)vc(Al)}function vc(e){var t=Sl(e.alternate,e,zl);e.memoizedProps=e.pendingProps,null===t?xc(e):Al=t,El.current=null}function xc(e){var t=e;do{var i=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(i=Wo(i,t,zl)))return void(Al=i)}else{if(null!==(i=Ho(i,t)))return i.flags&=32767,void(Al=i);if(null===e)return Ll=6,void(Al=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Al=t);Al=t=e}while(null!==t);0===Ll&&(Ll=5)}function bc(e,t,i){var n=vt,r=Pl.transition;try{Pl.transition=null,vt=1,function(e,t,i,n){do{wc()}while(null!==Hl);if(0!==(6&Cl))throw Error(a(327));i=e.finishedWork;var r=e.finishedLanes;if(null===i)return null;if(e.finishedWork=null,e.finishedLanes=0,i===e.current)throw Error(a(177));e.callbackNode=null,e.callbackPriority=0;var s=i.lanes|i.childLanes;if(function(e,t){var i=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<i;){var r=31-st(i),a=1<<r;t[r]=0,n[r]=-1,e[r]=-1,i&=~a}}(e,s),e===Il&&(Al=Il=null,Ml=0),0===(2064&i.subtreeFlags)&&0===(2064&i.flags)||Wl||(Wl=!0,Ic(tt,(function(){return wc(),null}))),s=0!==(15990&i.flags),0!==(15990&i.subtreeFlags)||s){s=Pl.transition,Pl.transition=null;var o=vt;vt=1;var l=Cl;Cl|=4,El.current=null,function(e,t){if(er=qt,pn(e=dn())){if("selectionStart"in e)var i={start:e.selectionStart,end:e.selectionEnd};else e:{var n=(i=(i=e.ownerDocument)&&i.defaultView||window).getSelection&&i.getSelection();if(n&&0!==n.rangeCount){i=n.anchorNode;var r=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{i.nodeType,s.nodeType}catch(b){i=null;break e}var o=0,l=-1,c=-1,u=0,h=0,d=e,p=null;t:for(;;){for(var f;d!==i||0!==r&&3!==d.nodeType||(l=o+r),d!==s||0!==n&&3!==d.nodeType||(c=o+n),3===d.nodeType&&(o+=d.nodeValue.length),null!==(f=d.firstChild);)p=d,d=f;for(;;){if(d===e)break t;if(p===i&&++u===r&&(l=o),p===s&&++h===n&&(c=o),null!==(f=d.nextSibling))break;p=(d=p).parentNode}d=f}i=-1===l||-1===c?null:{start:l,end:c}}else i=null}i=i||{start:0,end:0}}else i=null;for(tr={focusedElem:e,selectionRange:i},qt=!1,Jo=t;null!==Jo;)if(e=(t=Jo).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Jo=e;else for(;null!==Jo;){t=Jo;try{var m=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==m){var g=m.memoizedProps,y=m.memoizedState,_=t.stateNode,v=_.getSnapshotBeforeUpdate(t.elementType===t.type?g:to(t.type,g),y);_.__reactInternalSnapshotBeforeUpdate=v}break;case 3:var x=t.stateNode.containerInfo;1===x.nodeType?x.textContent="":9===x.nodeType&&x.documentElement&&x.removeChild(x.documentElement);break;default:throw Error(a(163))}}catch(b){Tc(t,t.return,b)}if(null!==(e=t.sibling)){e.return=t.return,Jo=e;break}Jo=t.return}m=tl,tl=!1}(e,i),gl(i,e),fn(tr),qt=!!er,tr=er=null,e.current=i,_l(i,e,r),Ke(),Cl=l,vt=o,Pl.transition=s}else e.current=i;if(Wl&&(Wl=!1,Hl=e,Xl=r),s=e.pendingLanes,0===s&&(Gl=null),function(e){if(at&&"function"===typeof at.onCommitFiberRoot)try{at.onCommitFiberRoot(rt,e,void 0,128===(128&e.current.flags))}catch(t){}}(i.stateNode),nc(e,Ye()),null!==t)for(n=e.onRecoverableError,i=0;i<t.length;i++)r=t[i],n(r.value,{componentStack:r.stack,digest:r.digest});if(ql)throw ql=!1,e=Zl,Zl=null,e;0!==(1&Xl)&&0!==e.tag&&wc(),s=e.pendingLanes,0!==(1&s)?e===Yl?Kl++:(Kl=0,Yl=e):Kl=0,Ur()}(e,t,i,n)}finally{Pl.transition=r,vt=n}return null}function wc(){if(null!==Hl){var e=xt(Xl),t=Pl.transition,i=vt;try{if(Pl.transition=null,vt=16>e?16:e,null===Hl)var n=!1;else{if(e=Hl,Hl=null,Xl=0,0!==(6&Cl))throw Error(a(331));var r=Cl;for(Cl|=4,Jo=e.current;null!==Jo;){var s=Jo,o=s.child;if(0!==(16&Jo.flags)){var l=s.deletions;if(null!==l){for(var c=0;c<l.length;c++){var u=l[c];for(Jo=u;null!==Jo;){var h=Jo;switch(h.tag){case 0:case 11:case 15:il(8,h,s)}var d=h.child;if(null!==d)d.return=h,Jo=d;else for(;null!==Jo;){var p=(h=Jo).sibling,f=h.return;if(al(h),h===u){Jo=null;break}if(null!==p){p.return=f,Jo=p;break}Jo=f}}}var m=s.alternate;if(null!==m){var g=m.child;if(null!==g){m.child=null;do{var y=g.sibling;g.sibling=null,g=y}while(null!==g)}}Jo=s}}if(0!==(2064&s.subtreeFlags)&&null!==o)o.return=s,Jo=o;else e:for(;null!==Jo;){if(0!==(2048&(s=Jo).flags))switch(s.tag){case 0:case 11:case 15:il(9,s,s.return)}var _=s.sibling;if(null!==_){_.return=s.return,Jo=_;break e}Jo=s.return}}var v=e.current;for(Jo=v;null!==Jo;){var x=(o=Jo).child;if(0!==(2064&o.subtreeFlags)&&null!==x)x.return=o,Jo=x;else e:for(o=v;null!==Jo;){if(0!==(2048&(l=Jo).flags))try{switch(l.tag){case 0:case 11:case 15:nl(9,l)}}catch(w){Tc(l,l.return,w)}if(l===o){Jo=null;break e}var b=l.sibling;if(null!==b){b.return=l.return,Jo=b;break e}Jo=l.return}}if(Cl=r,Ur(),at&&"function"===typeof at.onPostCommitFiberRoot)try{at.onPostCommitFiberRoot(rt,e)}catch(w){}n=!0}return n}finally{vt=i,Pl.transition=t}}return!1}function Sc(e,t,i){e=Na(e,t=po(0,t=lo(i,t),1),1),t=ec(),null!==e&&(yt(e,1,t),nc(e,t))}function Tc(e,t,i){if(3===e.tag)Sc(e,e,i);else for(;null!==t;){if(3===t.tag){Sc(t,e,i);break}if(1===t.tag){var n=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof n.componentDidCatch&&(null===Gl||!Gl.has(n))){t=Na(t,e=fo(t,e=lo(i,e),1),1),e=ec(),null!==t&&(yt(t,1,e),nc(t,e));break}}t=t.return}}function kc(e,t,i){var n=e.pingCache;null!==n&&n.delete(t),t=ec(),e.pingedLanes|=e.suspendedLanes&i,Il===e&&(Ml&i)===i&&(4===Ll||3===Ll&&(130023424&Ml)===Ml&&500>Ye()-jl?dc(e,0):Ol|=i),nc(e,t)}function Ec(e,t){0===t&&(0===(1&e.mode)?t=1:(t=ut,0===(130023424&(ut<<=1))&&(ut=4194304)));var i=ec();null!==(e=La(e,t))&&(yt(e,t,i),nc(e,i))}function Pc(e){var t=e.memoizedState,i=0;null!==t&&(i=t.retryLane),Ec(e,i)}function Cc(e,t){var i=0;switch(e.tag){case 13:var n=e.stateNode,r=e.memoizedState;null!==r&&(i=r.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(a(314))}null!==n&&n.delete(t),Ec(e,i)}function Ic(e,t){return We(e,t)}function Ac(e,t,i,n){this.tag=e,this.key=i,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Mc(e,t,i,n){return new Ac(e,t,i,n)}function zc(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Dc(e,t){var i=e.alternate;return null===i?((i=Mc(e.tag,t,e.key,e.mode)).elementType=e.elementType,i.type=e.type,i.stateNode=e.stateNode,i.alternate=e,e.alternate=i):(i.pendingProps=t,i.type=e.type,i.flags=0,i.subtreeFlags=0,i.deletions=null),i.flags=14680064&e.flags,i.childLanes=e.childLanes,i.lanes=e.lanes,i.child=e.child,i.memoizedProps=e.memoizedProps,i.memoizedState=e.memoizedState,i.updateQueue=e.updateQueue,t=e.dependencies,i.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},i.sibling=e.sibling,i.index=e.index,i.ref=e.ref,i}function Lc(e,t,i,n,r,s){var o=2;if(n=e,"function"===typeof e)zc(e)&&(o=1);else if("string"===typeof e)o=5;else e:switch(e){case S:return Rc(i.children,r,s,t);case T:o=8,r|=8;break;case k:return(e=Mc(12,i,t,2|r)).elementType=k,e.lanes=s,e;case I:return(e=Mc(13,i,t,r)).elementType=I,e.lanes=s,e;case A:return(e=Mc(19,i,t,r)).elementType=A,e.lanes=s,e;case D:return Fc(i,r,s,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case E:o=10;break e;case P:o=9;break e;case C:o=11;break e;case M:o=14;break e;case z:o=16,n=null;break e}throw Error(a(130,null==e?e:typeof e,""))}return(t=Mc(o,i,t,r)).elementType=e,t.type=n,t.lanes=s,t}function Rc(e,t,i,n){return(e=Mc(7,e,n,t)).lanes=i,e}function Fc(e,t,i,n){return(e=Mc(22,e,n,t)).elementType=D,e.lanes=i,e.stateNode={isHidden:!1},e}function Bc(e,t,i){return(e=Mc(6,e,null,t)).lanes=i,e}function Oc(e,t,i){return(t=Mc(4,null!==e.children?e.children:[],e.key,t)).lanes=i,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Nc(e,t,i,n,r){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=gt(0),this.expirationTimes=gt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gt(0),this.identifierPrefix=n,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function Vc(e,t,i,n,r,a,s,o,l){return e=new Nc(e,t,i,o,l),1===t?(t=1,!0===a&&(t|=8)):t=0,a=Mc(3,null,null,t),e.current=a,a.stateNode=e,a.memoizedState={element:n,isDehydrated:i,cache:null,transitions:null,pendingSuspenseBoundaries:null},Fa(a),e}function jc(e){if(!e)return Pr;e:{if(Ue(e=e._reactInternals)!==e||1!==e.tag)throw Error(a(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(zr(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(a(171))}if(1===e.tag){var i=e.type;if(zr(i))return Rr(e,i,t)}return t}function Uc(e,t,i,n,r,a,s,o,l){return(e=Vc(i,n,!0,e,0,a,0,o,l)).context=jc(null),i=e.current,(a=Oa(n=ec(),r=tc(i))).callback=void 0!==t&&null!==t?t:null,Na(i,a,r),e.current.lanes=r,yt(e,r,n),nc(e,n),e}function $c(e,t,i,n){var r=t.current,a=ec(),s=tc(r);return i=jc(i),null===t.context?t.context=i:t.pendingContext=i,(t=Oa(a,s)).payload={element:e},null!==(n=void 0===n?null:n)&&(t.callback=n),null!==(e=Na(r,t,s))&&(ic(e,r,s,a),Va(e,r,s)),s}function qc(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Zc(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var i=e.retryLane;e.retryLane=0!==i&&i<t?i:t}}function Gc(e,t){Zc(e,t),(e=e.alternate)&&Zc(e,t)}Sl=function(e,t,i){if(null!==e)if(e.memoizedProps!==t.pendingProps||Ir.current)vo=!0;else{if(0===(e.lanes&i)&&0===(128&t.flags))return vo=!1,function(e,t,i){switch(t.tag){case 3:Io(t),pa();break;case 5:Ya(t);break;case 1:zr(t.type)&&Fr(t);break;case 4:Xa(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,r=t.memoizedProps.value;Er(wa,n._currentValue),n._currentValue=r;break;case 13:if(null!==(n=t.memoizedState))return null!==n.dehydrated?(Er(Qa,1&Qa.current),t.flags|=128,null):0!==(i&t.child.childLanes)?Bo(e,t,i):(Er(Qa,1&Qa.current),null!==(e=qo(e,t,i))?e.sibling:null);Er(Qa,1&Qa.current);break;case 19:if(n=0!==(i&t.childLanes),0!==(128&e.flags)){if(n)return Uo(e,t,i);t.flags|=128}if(null!==(r=t.memoizedState)&&(r.rendering=null,r.tail=null,r.lastEffect=null),Er(Qa,Qa.current),n)break;return null;case 22:case 23:return t.lanes=0,To(e,t,i)}return qo(e,t,i)}(e,t,i);vo=0!==(131072&e.flags)}else vo=!1,ra&&0!==(1048576&t.flags)&&Qr(t,Gr,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;$o(e,t),e=t.pendingProps;var r=Mr(t,Cr.current);Ia(t,i),r=ms(null,t,n,e,r,i);var s=gs();return t.flags|=1,"object"===typeof r&&null!==r&&"function"===typeof r.render&&void 0===r.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,zr(n)?(s=!0,Fr(t)):s=!1,t.memoizedState=null!==r.state&&void 0!==r.state?r.state:null,Fa(t),r.updater=no,t.stateNode=r,r._reactInternals=t,oo(t,n,e,i),t=Co(null,t,n,!0,s,i)):(t.tag=0,ra&&s&&ea(t),xo(null,t,r,i),t=t.child),t;case 16:n=t.elementType;e:{switch($o(e,t),e=t.pendingProps,n=(r=n._init)(n._payload),t.type=n,r=t.tag=function(e){if("function"===typeof e)return zc(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===C)return 11;if(e===M)return 14}return 2}(n),e=to(n,e),r){case 0:t=Eo(null,t,n,e,i);break e;case 1:t=Po(null,t,n,e,i);break e;case 11:t=bo(null,t,n,e,i);break e;case 14:t=wo(null,t,n,to(n.type,e),i);break e}throw Error(a(306,n,""))}return t;case 0:return n=t.type,r=t.pendingProps,Eo(e,t,n,r=t.elementType===n?r:to(n,r),i);case 1:return n=t.type,r=t.pendingProps,Po(e,t,n,r=t.elementType===n?r:to(n,r),i);case 3:e:{if(Io(t),null===e)throw Error(a(387));n=t.pendingProps,r=(s=t.memoizedState).element,Ba(e,t),Ua(t,n,null,i);var o=t.memoizedState;if(n=o.element,s.isDehydrated){if(s={element:n,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=s,t.memoizedState=s,256&t.flags){t=Ao(e,t,n,i,r=lo(Error(a(423)),t));break e}if(n!==r){t=Ao(e,t,n,i,r=lo(Error(a(424)),t));break e}for(na=cr(t.stateNode.containerInfo.firstChild),ia=t,ra=!0,aa=null,i=ba(t,null,n,i),t.child=i;i;)i.flags=-3&i.flags|4096,i=i.sibling}else{if(pa(),n===r){t=qo(e,t,i);break e}xo(e,t,n,i)}t=t.child}return t;case 5:return Ya(t),null===e&&ca(t),n=t.type,r=t.pendingProps,s=null!==e?e.memoizedProps:null,o=r.children,ir(n,r)?o=null:null!==s&&ir(n,s)&&(t.flags|=32),ko(e,t),xo(e,t,o,i),t.child;case 6:return null===e&&ca(t),null;case 13:return Bo(e,t,i);case 4:return Xa(t,t.stateNode.containerInfo),n=t.pendingProps,null===e?t.child=xa(t,null,n,i):xo(e,t,n,i),t.child;case 11:return n=t.type,r=t.pendingProps,bo(e,t,n,r=t.elementType===n?r:to(n,r),i);case 7:return xo(e,t,t.pendingProps,i),t.child;case 8:case 12:return xo(e,t,t.pendingProps.children,i),t.child;case 10:e:{if(n=t.type._context,r=t.pendingProps,s=t.memoizedProps,o=r.value,Er(wa,n._currentValue),n._currentValue=o,null!==s)if(on(s.value,o)){if(s.children===r.children&&!Ir.current){t=qo(e,t,i);break e}}else for(null!==(s=t.child)&&(s.return=t);null!==s;){var l=s.dependencies;if(null!==l){o=s.child;for(var c=l.firstContext;null!==c;){if(c.context===n){if(1===s.tag){(c=Oa(-1,i&-i)).tag=2;var u=s.updateQueue;if(null!==u){var h=(u=u.shared).pending;null===h?c.next=c:(c.next=h.next,h.next=c),u.pending=c}}s.lanes|=i,null!==(c=s.alternate)&&(c.lanes|=i),Ca(s.return,i,t),l.lanes|=i;break}c=c.next}}else if(10===s.tag)o=s.type===t.type?null:s.child;else if(18===s.tag){if(null===(o=s.return))throw Error(a(341));o.lanes|=i,null!==(l=o.alternate)&&(l.lanes|=i),Ca(o,i,t),o=s.sibling}else o=s.child;if(null!==o)o.return=s;else for(o=s;null!==o;){if(o===t){o=null;break}if(null!==(s=o.sibling)){s.return=o.return,o=s;break}o=o.return}s=o}xo(e,t,r.children,i),t=t.child}return t;case 9:return r=t.type,n=t.pendingProps.children,Ia(t,i),n=n(r=Aa(r)),t.flags|=1,xo(e,t,n,i),t.child;case 14:return r=to(n=t.type,t.pendingProps),wo(e,t,n,r=to(n.type,r),i);case 15:return So(e,t,t.type,t.pendingProps,i);case 17:return n=t.type,r=t.pendingProps,r=t.elementType===n?r:to(n,r),$o(e,t),t.tag=1,zr(n)?(e=!0,Fr(t)):e=!1,Ia(t,i),ao(t,n,r),oo(t,n,r,i),Co(null,t,n,!0,e,i);case 19:return Uo(e,t,i);case 22:return To(e,t,i)}throw Error(a(156,t.tag))};var Wc="function"===typeof reportError?reportError:function(e){console.error(e)};function Hc(e){this._internalRoot=e}function Xc(e){this._internalRoot=e}function Kc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Yc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Jc(){}function Qc(e,t,i,n,r){var a=i._reactRootContainer;if(a){var s=a;if("function"===typeof r){var o=r;r=function(){var e=qc(s);o.call(e)}}$c(t,s,e,r)}else s=function(e,t,i,n,r){if(r){if("function"===typeof n){var a=n;n=function(){var e=qc(s);a.call(e)}}var s=Uc(t,n,e,0,null,!1,0,"",Jc);return e._reactRootContainer=s,e[fr]=s.current,Un(8===e.nodeType?e.parentNode:e),uc(),s}for(;r=e.lastChild;)e.removeChild(r);if("function"===typeof n){var o=n;n=function(){var e=qc(l);o.call(e)}}var l=Vc(e,0,!1,null,0,!1,0,"",Jc);return e._reactRootContainer=l,e[fr]=l.current,Un(8===e.nodeType?e.parentNode:e),uc((function(){$c(t,l,i,n)})),l}(i,t,e,r,n);return qc(s)}Xc.prototype.render=Hc.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(a(409));$c(e,t,null,null)},Xc.prototype.unmount=Hc.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;uc((function(){$c(null,e,null,null)})),t[fr]=null}},Xc.prototype.unstable_scheduleHydration=function(e){if(e){var t=Tt();e={blockedOn:null,target:e,priority:t};for(var i=0;i<Dt.length&&0!==t&&t<Dt[i].priority;i++);Dt.splice(i,0,e),0===i&&Bt(e)}},bt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var i=ht(t.pendingLanes);0!==i&&(_t(t,1|i),nc(t,Ye()),0===(6&Cl)&&(Ul=Ye()+500,Ur()))}break;case 13:uc((function(){var t=La(e,1);if(null!==t){var i=ec();ic(t,e,1,i)}})),Gc(e,1)}},wt=function(e){if(13===e.tag){var t=La(e,134217728);if(null!==t)ic(t,e,134217728,ec());Gc(e,134217728)}},St=function(e){if(13===e.tag){var t=tc(e),i=La(e,t);if(null!==i)ic(i,e,t,ec());Gc(e,t)}},Tt=function(){return vt},kt=function(e,t){var i=vt;try{return vt=e,t()}finally{vt=i}},we=function(e,t,i){switch(t){case"input":if(J(e,i),t=i.name,"radio"===i.type&&null!=t){for(i=e;i.parentNode;)i=i.parentNode;for(i=i.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<i.length;t++){var n=i[t];if(n!==e&&n.form===e.form){var r=br(n);if(!r)throw Error(a(90));W(n),J(n,r)}}}break;case"textarea":ae(e,i);break;case"select":null!=(t=i.value)&&ie(e,!!i.multiple,t,!1)}},Ce=cc,Ie=uc;var eu={usingClientEntryPoint:!1,Events:[vr,xr,br,Ee,Pe,cc]},tu={findFiberByHostInstance:_r,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},iu={bundleType:tu.bundleType,version:tu.version,rendererPackageName:tu.rendererPackageName,rendererConfig:tu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:x.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=Ze(e))?null:e.stateNode},findFiberByHostInstance:tu.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var nu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!nu.isDisabled&&nu.supportsFiber)try{rt=nu.inject(iu),at=nu}catch(ue){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=eu,t.createPortal=function(e,t){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Kc(t))throw Error(a(200));return function(e,t,i){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:w,key:null==n?null:""+n,children:e,containerInfo:t,implementation:i}}(e,t,null,i)},t.createRoot=function(e,t){if(!Kc(e))throw Error(a(299));var i=!1,n="",r=Wc;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(i=!0),void 0!==t.identifierPrefix&&(n=t.identifierPrefix),void 0!==t.onRecoverableError&&(r=t.onRecoverableError)),t=Vc(e,1,!1,null,0,i,0,n,r),e[fr]=t.current,Un(8===e.nodeType?e.parentNode:e),new Hc(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(a(188));throw e=Object.keys(e).join(","),Error(a(268,e))}return e=null===(e=Ze(t))?null:e.stateNode},t.flushSync=function(e){return uc(e)},t.hydrate=function(e,t,i){if(!Yc(t))throw Error(a(200));return Qc(null,e,t,!0,i)},t.hydrateRoot=function(e,t,i){if(!Kc(e))throw Error(a(405));var n=null!=i&&i.hydratedSources||null,r=!1,s="",o=Wc;if(null!==i&&void 0!==i&&(!0===i.unstable_strictMode&&(r=!0),void 0!==i.identifierPrefix&&(s=i.identifierPrefix),void 0!==i.onRecoverableError&&(o=i.onRecoverableError)),t=Uc(t,null,e,1,null!=i?i:null,r,0,s,o),e[fr]=t.current,Un(e),n)for(e=0;e<n.length;e++)r=(r=(i=n[e])._getVersion)(i._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[i,r]:t.mutableSourceEagerHydrationData.push(i,r);return new Xc(t)},t.render=function(e,t,i){if(!Yc(t))throw Error(a(200));return Qc(null,e,t,!1,i)},t.unmountComponentAtNode=function(e){if(!Yc(e))throw Error(a(40));return!!e._reactRootContainer&&(uc((function(){Qc(null,null,e,!1,(function(){e._reactRootContainer=null,e[fr]=null}))})),!0)},t.unstable_batchedUpdates=cc,t.unstable_renderSubtreeIntoContainer=function(e,t,i,n){if(!Yc(i))throw Error(a(200));if(null==e||void 0===e._reactInternals)throw Error(a(38));return Qc(e,t,i,!1,n)},t.version="18.3.1-next-f1338f8080-20240426"},853:(e,t,i)=>{"use strict";e.exports=i(234)},950:(e,t,i)=>{"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=i(730)}},t={};function i(n){var r=t[n];if(void 0!==r)return r.exports;var a=t[n]={exports:{}};return e[n].call(a.exports,a,a.exports,i),a.exports}i.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return i.d(t,{a:t}),t},(()=>{var e,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__;i.t=function(n,r){if(1&r&&(n=this(n)),8&r)return n;if("object"===typeof n&&n){if(4&r&&n.__esModule)return n;if(16&r&&"function"===typeof n.then)return n}var a=Object.create(null);i.r(a);var s={};e=e||[null,t({}),t([]),t(t)];for(var o=2&r&&n;"object"==typeof o&&!~e.indexOf(o);o=t(o))Object.getOwnPropertyNames(o).forEach((e=>s[e]=()=>n[e]));return s.default=()=>n,i.d(a,s),a}})(),i.d=(e,t)=>{for(var n in t)i.o(t,n)&&!i.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.p="/agro_ecommerce_frontend_demo/",(()=>{"use strict";var e,t=i(43),n=i.t(t,2),r=i(391),a=i(950),s=i.t(a,2);function o(){return o=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},o.apply(this,arguments)}!function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"}(e||(e={}));const l="popstate";function c(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}function u(e,t){if(!e){"undefined"!==typeof console&&console.warn(t);try{throw new Error(t)}catch(i){}}}function h(e,t){return{usr:e.state,key:e.key,idx:t}}function d(e,t,i,n){return void 0===i&&(i=null),o({pathname:"string"===typeof e?e:e.pathname,search:"",hash:""},"string"===typeof t?f(t):t,{state:i,key:t&&t.key||n||Math.random().toString(36).substr(2,8)})}function p(e){let{pathname:t="/",search:i="",hash:n=""}=e;return i&&"?"!==i&&(t+="?"===i.charAt(0)?i:"?"+i),n&&"#"!==n&&(t+="#"===n.charAt(0)?n:"#"+n),t}function f(e){let t={};if(e){let i=e.indexOf("#");i>=0&&(t.hash=e.substr(i),e=e.substr(0,i));let n=e.indexOf("?");n>=0&&(t.search=e.substr(n),e=e.substr(0,n)),e&&(t.pathname=e)}return t}function m(t,i,n,r){void 0===r&&(r={});let{window:a=document.defaultView,v5Compat:s=!1}=r,u=a.history,f=e.Pop,m=null,g=y();function y(){return(u.state||{idx:null}).idx}function _(){f=e.Pop;let t=y(),i=null==t?null:t-g;g=t,m&&m({action:f,location:x.location,delta:i})}function v(e){let t="null"!==a.location.origin?a.location.origin:a.location.href,i="string"===typeof e?e:p(e);return i=i.replace(/ $/,"%20"),c(t,"No window.location.(origin|href) available to create URL for href: "+i),new URL(i,t)}null==g&&(g=0,u.replaceState(o({},u.state,{idx:g}),""));let x={get action(){return f},get location(){return t(a,u)},listen(e){if(m)throw new Error("A history only accepts one active listener");return a.addEventListener(l,_),m=e,()=>{a.removeEventListener(l,_),m=null}},createHref:e=>i(a,e),createURL:v,encodeLocation(e){let t=v(e);return{pathname:t.pathname,search:t.search,hash:t.hash}},push:function(t,i){f=e.Push;let r=d(x.location,t,i);n&&n(r,t),g=y()+1;let o=h(r,g),l=x.createHref(r);try{u.pushState(o,"",l)}catch(c){if(c instanceof DOMException&&"DataCloneError"===c.name)throw c;a.location.assign(l)}s&&m&&m({action:f,location:x.location,delta:1})},replace:function(t,i){f=e.Replace;let r=d(x.location,t,i);n&&n(r,t),g=y();let a=h(r,g),o=x.createHref(r);u.replaceState(a,"",o),s&&m&&m({action:f,location:x.location,delta:0})},go:e=>u.go(e)};return x}var g;!function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"}(g||(g={}));new Set(["lazy","caseSensitive","path","id","index","children"]);function y(e,t,i){return void 0===i&&(i="/"),_(e,t,i,!1)}function _(e,t,i,n){let r=z(("string"===typeof t?f(t):t).pathname||"/",i);if(null==r)return null;let a=v(e);!function(e){e.sort(((e,t)=>e.score!==t.score?t.score-e.score:function(e,t){let i=e.length===t.length&&e.slice(0,-1).every(((e,i)=>e===t[i]));return i?e[e.length-1]-t[t.length-1]:0}(e.routesMeta.map((e=>e.childrenIndex)),t.routesMeta.map((e=>e.childrenIndex)))))}(a);let s=null;for(let o=0;null==s&&o<a.length;++o){let e=M(r);s=I(a[o],e,n)}return s}function v(e,t,i,n){void 0===t&&(t=[]),void 0===i&&(i=[]),void 0===n&&(n="");let r=(e,r,a)=>{let s={relativePath:void 0===a?e.path||"":a,caseSensitive:!0===e.caseSensitive,childrenIndex:r,route:e};s.relativePath.startsWith("/")&&(c(s.relativePath.startsWith(n),'Absolute route path "'+s.relativePath+'" nested under path "'+n+'" is not valid. An absolute child route path must start with the combined path of all its parent routes.'),s.relativePath=s.relativePath.slice(n.length));let o=B([n,s.relativePath]),l=i.concat(s);e.children&&e.children.length>0&&(c(!0!==e.index,'Index routes must not have child routes. Please remove all child routes from route path "'+o+'".'),v(e.children,t,l,o)),(null!=e.path||e.index)&&t.push({path:o,score:C(o,e.index),routesMeta:l})};return e.forEach(((e,t)=>{var i;if(""!==e.path&&null!=(i=e.path)&&i.includes("?"))for(let n of x(e.path))r(e,t,n);else r(e,t)})),t}function x(e){let t=e.split("/");if(0===t.length)return[];let[i,...n]=t,r=i.endsWith("?"),a=i.replace(/\?$/,"");if(0===n.length)return r?[a,""]:[a];let s=x(n.join("/")),o=[];return o.push(...s.map((e=>""===e?a:[a,e].join("/")))),r&&o.push(...s),o.map((t=>e.startsWith("/")&&""===t?"/":t))}const b=/^:[\w-]+$/,w=3,S=2,T=1,k=10,E=-2,P=e=>"*"===e;function C(e,t){let i=e.split("/"),n=i.length;return i.some(P)&&(n+=E),t&&(n+=S),i.filter((e=>!P(e))).reduce(((e,t)=>e+(b.test(t)?w:""===t?T:k)),n)}function I(e,t,i){void 0===i&&(i=!1);let{routesMeta:n}=e,r={},a="/",s=[];for(let o=0;o<n.length;++o){let e=n[o],l=o===n.length-1,c="/"===a?t:t.slice(a.length)||"/",u=A({path:e.relativePath,caseSensitive:e.caseSensitive,end:l},c),h=e.route;if(!u&&l&&i&&!n[n.length-1].route.index&&(u=A({path:e.relativePath,caseSensitive:e.caseSensitive,end:!1},c)),!u)return null;Object.assign(r,u.params),s.push({params:r,pathname:B([a,u.pathname]),pathnameBase:O(B([a,u.pathnameBase])),route:h}),"/"!==u.pathnameBase&&(a=B([a,u.pathnameBase]))}return s}function A(e,t){"string"===typeof e&&(e={path:e,caseSensitive:!1,end:!0});let[i,n]=function(e,t,i){void 0===t&&(t=!1);void 0===i&&(i=!0);u("*"===e||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were "'+e.replace(/\*$/,"/*")+'" because the `*` character must always follow a `/` in the pattern. To get rid of this warning, please change the route path to "'+e.replace(/\*$/,"/*")+'".');let n=[],r="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,((e,t,i)=>(n.push({paramName:t,isOptional:null!=i}),i?"/?([^\\/]+)?":"/([^\\/]+)")));e.endsWith("*")?(n.push({paramName:"*"}),r+="*"===e||"/*"===e?"(.*)$":"(?:\\/(.+)|\\/*)$"):i?r+="\\/*$":""!==e&&"/"!==e&&(r+="(?:(?=\\/|$))");let a=new RegExp(r,t?void 0:"i");return[a,n]}(e.path,e.caseSensitive,e.end),r=t.match(i);if(!r)return null;let a=r[0],s=a.replace(/(.)\/+$/,"$1"),o=r.slice(1),l=n.reduce(((e,t,i)=>{let{paramName:n,isOptional:r}=t;if("*"===n){let e=o[i]||"";s=a.slice(0,a.length-e.length).replace(/(.)\/+$/,"$1")}const l=o[i];return e[n]=r&&!l?void 0:(l||"").replace(/%2F/g,"/"),e}),{});return{params:l,pathname:a,pathnameBase:s,pattern:e}}function M(e){try{return e.split("/").map((e=>decodeURIComponent(e).replace(/\//g,"%2F"))).join("/")}catch(t){return u(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent encoding ('+t+")."),e}}function z(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let i=t.endsWith("/")?t.length-1:t.length,n=e.charAt(i);return n&&"/"!==n?null:e.slice(i)||"/"}function D(e,t,i,n){return"Cannot include a '"+e+"' character in a manually specified `to."+t+"` field ["+JSON.stringify(n)+"].  Please separate it out to the `to."+i+'` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.'}function L(e){return e.filter(((e,t)=>0===t||e.route.path&&e.route.path.length>0))}function R(e,t){let i=L(e);return t?i.map(((e,t)=>t===i.length-1?e.pathname:e.pathnameBase)):i.map((e=>e.pathnameBase))}function F(e,t,i,n){let r;void 0===n&&(n=!1),"string"===typeof e?r=f(e):(r=o({},e),c(!r.pathname||!r.pathname.includes("?"),D("?","pathname","search",r)),c(!r.pathname||!r.pathname.includes("#"),D("#","pathname","hash",r)),c(!r.search||!r.search.includes("#"),D("#","search","hash",r)));let a,s=""===e||""===r.pathname,l=s?"/":r.pathname;if(null==l)a=i;else{let e=t.length-1;if(!n&&l.startsWith("..")){let t=l.split("/");for(;".."===t[0];)t.shift(),e-=1;r.pathname=t.join("/")}a=e>=0?t[e]:"/"}let u=function(e,t){void 0===t&&(t="/");let{pathname:i,search:n="",hash:r=""}="string"===typeof e?f(e):e,a=i?i.startsWith("/")?i:function(e,t){let i=t.replace(/\/+$/,"").split("/");return e.split("/").forEach((e=>{".."===e?i.length>1&&i.pop():"."!==e&&i.push(e)})),i.length>1?i.join("/"):"/"}(i,t):t;return{pathname:a,search:N(n),hash:V(r)}}(r,a),h=l&&"/"!==l&&l.endsWith("/"),d=(s||"."===l)&&i.endsWith("/");return u.pathname.endsWith("/")||!h&&!d||(u.pathname+="/"),u}const B=e=>e.join("/").replace(/\/\/+/g,"/"),O=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),N=e=>e&&"?"!==e?e.startsWith("?")?e:"?"+e:"",V=e=>e&&"#"!==e?e.startsWith("#")?e:"#"+e:"";Error;function j(e){return null!=e&&"number"===typeof e.status&&"string"===typeof e.statusText&&"boolean"===typeof e.internal&&"data"in e}const U=["post","put","patch","delete"],$=(new Set(U),["get",...U]);new Set($),new Set([301,302,303,307,308]),new Set([307,308]);Symbol("deferred");function q(){return q=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},q.apply(this,arguments)}const Z=t.createContext(null);const G=t.createContext(null);const W=t.createContext(null);const H=t.createContext(null);const X=t.createContext({outlet:null,matches:[],isDataRoute:!1});const K=t.createContext(null);function Y(){return null!=t.useContext(H)}function J(){return Y()||c(!1),t.useContext(H).location}function Q(e){t.useContext(W).static||t.useLayoutEffect(e)}function ee(){let{isDataRoute:e}=t.useContext(X);return e?function(){let{router:e}=ue(le.UseNavigateStable),i=de(ce.UseNavigateStable),n=t.useRef(!1);Q((()=>{n.current=!0}));let r=t.useCallback((function(t,r){void 0===r&&(r={}),n.current&&("number"===typeof t?e.navigate(t):e.navigate(t,q({fromRouteId:i},r)))}),[e,i]);return r}():function(){Y()||c(!1);let e=t.useContext(Z),{basename:i,future:n,navigator:r}=t.useContext(W),{matches:a}=t.useContext(X),{pathname:s}=J(),o=JSON.stringify(R(a,n.v7_relativeSplatPath)),l=t.useRef(!1);return Q((()=>{l.current=!0})),t.useCallback((function(t,n){if(void 0===n&&(n={}),!l.current)return;if("number"===typeof t)return void r.go(t);let a=F(t,JSON.parse(o),s,"path"===n.relative);null==e&&"/"!==i&&(a.pathname="/"===a.pathname?i:B([i,a.pathname])),(n.replace?r.replace:r.push)(a,n.state,n)}),[i,r,o,s,e])}()}function te(e,i){let{relative:n}=void 0===i?{}:i,{future:r}=t.useContext(W),{matches:a}=t.useContext(X),{pathname:s}=J(),o=JSON.stringify(R(a,r.v7_relativeSplatPath));return t.useMemo((()=>F(e,JSON.parse(o),s,"path"===n)),[e,o,s,n])}function ie(i,n,r,a){Y()||c(!1);let{navigator:s,static:o}=t.useContext(W),{matches:l}=t.useContext(X),u=l[l.length-1],h=u?u.params:{},d=(u&&u.pathname,u?u.pathnameBase:"/");u&&u.route;let p,m=J();if(n){var g;let e="string"===typeof n?f(n):n;"/"===d||(null==(g=e.pathname)?void 0:g.startsWith(d))||c(!1),p=e}else p=m;let _=p.pathname||"/",v=_;if("/"!==d){let e=d.replace(/^\//,"").split("/");v="/"+_.replace(/^\//,"").split("/").slice(e.length).join("/")}let x=!o&&r&&r.matches&&r.matches.length>0?r.matches:y(i,{pathname:v});let b=oe(x&&x.map((e=>Object.assign({},e,{params:Object.assign({},h,e.params),pathname:B([d,s.encodeLocation?s.encodeLocation(e.pathname).pathname:e.pathname]),pathnameBase:"/"===e.pathnameBase?d:B([d,s.encodeLocation?s.encodeLocation(e.pathnameBase).pathname:e.pathnameBase])}))),l,r,a);return n&&b?t.createElement(H.Provider,{value:{location:q({pathname:"/",search:"",hash:"",state:null,key:"default"},p),navigationType:e.Pop}},b):b}function ne(){let e=function(){var e;let i=t.useContext(K),n=he(ce.UseRouteError),r=de(ce.UseRouteError);if(void 0!==i)return i;return null==(e=n.errors)?void 0:e[r]}(),i=j(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,r="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:r};return t.createElement(t.Fragment,null,t.createElement("h2",null,"Unexpected Application Error!"),t.createElement("h3",{style:{fontStyle:"italic"}},i),n?t.createElement("pre",{style:a},n):null,null)}const re=t.createElement(ne,null);class ae extends t.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||"idle"!==t.revalidation&&"idle"===e.revalidation?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:void 0!==e.error?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return void 0!==this.state.error?t.createElement(X.Provider,{value:this.props.routeContext},t.createElement(K.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function se(e){let{routeContext:i,match:n,children:r}=e,a=t.useContext(Z);return a&&a.static&&a.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=n.route.id),t.createElement(X.Provider,{value:i},r)}function oe(e,i,n,r){var a;if(void 0===i&&(i=[]),void 0===n&&(n=null),void 0===r&&(r=null),null==e){var s;if(!n)return null;if(n.errors)e=n.matches;else{if(!(null!=(s=r)&&s.v7_partialHydration&&0===i.length&&!n.initialized&&n.matches.length>0))return null;e=n.matches}}let o=e,l=null==(a=n)?void 0:a.errors;if(null!=l){let e=o.findIndex((e=>e.route.id&&void 0!==(null==l?void 0:l[e.route.id])));e>=0||c(!1),o=o.slice(0,Math.min(o.length,e+1))}let u=!1,h=-1;if(n&&r&&r.v7_partialHydration)for(let t=0;t<o.length;t++){let e=o[t];if((e.route.HydrateFallback||e.route.hydrateFallbackElement)&&(h=t),e.route.id){let{loaderData:t,errors:i}=n,r=e.route.loader&&void 0===t[e.route.id]&&(!i||void 0===i[e.route.id]);if(e.route.lazy||r){u=!0,o=h>=0?o.slice(0,h+1):[o[0]];break}}}return o.reduceRight(((e,r,a)=>{let s,c=!1,d=null,p=null;var f;n&&(s=l&&r.route.id?l[r.route.id]:void 0,d=r.route.errorElement||re,u&&(h<0&&0===a?(f="route-fallback",!1||pe[f]||(pe[f]=!0),c=!0,p=null):h===a&&(c=!0,p=r.route.hydrateFallbackElement||null)));let m=i.concat(o.slice(0,a+1)),g=()=>{let i;return i=s?d:c?p:r.route.Component?t.createElement(r.route.Component,null):r.route.element?r.route.element:e,t.createElement(se,{match:r,routeContext:{outlet:e,matches:m,isDataRoute:null!=n},children:i})};return n&&(r.route.ErrorBoundary||r.route.errorElement||0===a)?t.createElement(ae,{location:n.location,revalidation:n.revalidation,component:d,error:s,children:g(),routeContext:{outlet:null,matches:m,isDataRoute:!0}}):g()}),null)}var le=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(le||{}),ce=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(ce||{});function ue(e){let i=t.useContext(Z);return i||c(!1),i}function he(e){let i=t.useContext(G);return i||c(!1),i}function de(e){let i=function(){let e=t.useContext(X);return e||c(!1),e}(),n=i.matches[i.matches.length-1];return n.route.id||c(!1),n.route.id}const pe={};function fe(e,t){null==e||e.v7_startTransition,void 0===(null==e?void 0:e.v7_relativeSplatPath)&&(!t||t.v7_relativeSplatPath),t&&(t.v7_fetcherPersist,t.v7_normalizeFormMethod,t.v7_partialHydration,t.v7_skipActionErrorRevalidation)}n.startTransition;function me(e){c(!1)}function ge(i){let{basename:n="/",children:r=null,location:a,navigationType:s=e.Pop,navigator:o,static:l=!1,future:u}=i;Y()&&c(!1);let h=n.replace(/^\/*/,"/"),d=t.useMemo((()=>({basename:h,navigator:o,static:l,future:q({v7_relativeSplatPath:!1},u)})),[h,u,o,l]);"string"===typeof a&&(a=f(a));let{pathname:p="/",search:m="",hash:g="",state:y=null,key:_="default"}=a,v=t.useMemo((()=>{let e=z(p,h);return null==e?null:{location:{pathname:e,search:m,hash:g,state:y,key:_},navigationType:s}}),[h,p,m,g,y,_,s]);return null==v?null:t.createElement(W.Provider,{value:d},t.createElement(H.Provider,{children:r,value:v}))}function ye(e){let{children:t,location:i}=e;return ie(_e(t),i)}new Promise((()=>{}));t.Component;function _e(e,i){void 0===i&&(i=[]);let n=[];return t.Children.forEach(e,((e,r)=>{if(!t.isValidElement(e))return;let a=[...i,r];if(e.type===t.Fragment)return void n.push.apply(n,_e(e.props.children,a));e.type!==me&&c(!1),e.props.index&&e.props.children&&c(!1);let s={id:e.props.id||a.join("-"),caseSensitive:e.props.caseSensitive,element:e.props.element,Component:e.props.Component,index:e.props.index,path:e.props.path,loader:e.props.loader,action:e.props.action,errorElement:e.props.errorElement,ErrorBoundary:e.props.ErrorBoundary,hasErrorBoundary:null!=e.props.ErrorBoundary||null!=e.props.errorElement,shouldRevalidate:e.props.shouldRevalidate,handle:e.props.handle,lazy:e.props.lazy};e.props.children&&(s.children=_e(e.props.children,a)),n.push(s)})),n}function ve(){return ve=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},ve.apply(this,arguments)}function xe(e,t){if(null==e)return{};var i,n,r={},a=Object.keys(e);for(n=0;n<a.length;n++)i=a[n],t.indexOf(i)>=0||(r[i]=e[i]);return r}new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);const be=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"];try{window.__reactRouterVersion="6"}catch(tl){}new Map;const we=n.startTransition;s.flushSync,n.useId;function Se(e){let{basename:i,children:n,future:r,window:a}=e,s=t.useRef();var o;null==s.current&&(s.current=(void 0===(o={window:a,v5Compat:!0})&&(o={}),m((function(e,t){let{pathname:i,search:n,hash:r}=e.location;return d("",{pathname:i,search:n,hash:r},t.state&&t.state.usr||null,t.state&&t.state.key||"default")}),(function(e,t){return"string"===typeof t?t:p(t)}),null,o)));let l=s.current,[c,u]=t.useState({action:l.action,location:l.location}),{v7_startTransition:h}=r||{},f=t.useCallback((e=>{h&&we?we((()=>u(e))):u(e)}),[u,h]);return t.useLayoutEffect((()=>l.listen(f)),[l,f]),t.useEffect((()=>fe(r)),[r]),t.createElement(ge,{basename:i,children:n,location:c.location,navigationType:c.action,navigator:l,future:r})}const Te="undefined"!==typeof window&&"undefined"!==typeof window.document&&"undefined"!==typeof window.document.createElement,ke=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Ee=t.forwardRef((function(e,i){let n,{onClick:r,relative:a,reloadDocument:s,replace:o,state:l,target:u,to:h,preventScrollReset:d,viewTransition:f}=e,m=xe(e,be),{basename:g}=t.useContext(W),y=!1;if("string"===typeof h&&ke.test(h)&&(n=h,Te))try{let e=new URL(window.location.href),t=h.startsWith("//")?new URL(e.protocol+h):new URL(h),i=z(t.pathname,g);t.origin===e.origin&&null!=i?h=i+t.search+t.hash:y=!0}catch(tl){}let _=function(e,i){let{relative:n}=void 0===i?{}:i;Y()||c(!1);let{basename:r,navigator:a}=t.useContext(W),{hash:s,pathname:o,search:l}=te(e,{relative:n}),u=o;return"/"!==r&&(u="/"===o?r:B([r,o])),a.createHref({pathname:u,search:l,hash:s})}(h,{relative:a}),v=function(e,i){let{target:n,replace:r,state:a,preventScrollReset:s,relative:o,viewTransition:l}=void 0===i?{}:i,c=ee(),u=J(),h=te(e,{relative:o});return t.useCallback((t=>{if(function(e,t){return 0===e.button&&(!t||"_self"===t)&&!function(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}(e)}(t,n)){t.preventDefault();let i=void 0!==r?r:p(u)===p(h);c(e,{replace:i,state:a,preventScrollReset:s,relative:o,viewTransition:l})}}),[u,c,h,r,a,n,e,s,o,l])}(h,{replace:o,state:l,target:u,preventScrollReset:d,relative:a,viewTransition:f});return t.createElement("a",ve({},m,{href:n||_,onClick:y||s?r:function(e){r&&r(e),e.defaultPrevented||v(e)},ref:i,target:u}))}));var Pe,Ce;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(Pe||(Pe={})),function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"}(Ce||(Ce={}));const Ie=(0,t.createContext)({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"}),Ae=(0,t.createContext)({}),Me=(0,t.createContext)(null),ze="undefined"!==typeof document,De=ze?t.useLayoutEffect:t.useEffect,Le=(0,t.createContext)({strict:!1}),Re=e=>e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),Fe="data-"+Re("framerAppearId");function Be(e){return e&&"object"===typeof e&&Object.prototype.hasOwnProperty.call(e,"current")}function Oe(e){return"string"===typeof e||Array.isArray(e)}function Ne(e){return null!==e&&"object"===typeof e&&"function"===typeof e.start}const Ve=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],je=["initial",...Ve];function Ue(e){return Ne(e.animate)||je.some((t=>Oe(e[t])))}function $e(e){return Boolean(Ue(e)||e.variants)}function qe(e){const{initial:i,animate:n}=function(e,t){if(Ue(e)){const{initial:t,animate:i}=e;return{initial:!1===t||Oe(t)?t:void 0,animate:Oe(i)?i:void 0}}return!1!==e.inherit?t:{}}(e,(0,t.useContext)(Ae));return(0,t.useMemo)((()=>({initial:i,animate:n})),[Ze(i),Ze(n)])}function Ze(e){return Array.isArray(e)?e.join(" "):e}const Ge={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},We={};for(const i in Ge)We[i]={isEnabled:e=>Ge[i].some((t=>!!e[t]))};const He=(0,t.createContext)({}),Xe=(0,t.createContext)({}),Ke=Symbol.for("motionComponentSymbol");function Ye(e){let{preloadedFeatures:i,createVisualElement:n,useRender:r,useVisualState:a,Component:s}=e;i&&function(e){for(const t in e)We[t]={...We[t],...e[t]}}(i);const o=(0,t.forwardRef)((function(e,o){let l;const c={...(0,t.useContext)(Ie),...e,layoutId:Je(e)},{isStatic:u}=c,h=qe(e),d=a(e,u);if(!u&&ze){h.visualElement=function(e,i,n,r){const{visualElement:a}=(0,t.useContext)(Ae),s=(0,t.useContext)(Le),o=(0,t.useContext)(Me),l=(0,t.useContext)(Ie).reducedMotion,c=(0,t.useRef)();r=r||s.renderer,!c.current&&r&&(c.current=r(e,{visualState:i,parent:a,props:n,presenceContext:o,blockInitialAnimation:!!o&&!1===o.initial,reducedMotionConfig:l}));const u=c.current;(0,t.useInsertionEffect)((()=>{u&&u.update(n,o)}));const h=(0,t.useRef)(Boolean(n[Fe]&&!window.HandoffComplete));return De((()=>{u&&(u.render(),h.current&&u.animationState&&u.animationState.animateChanges())})),(0,t.useEffect)((()=>{u&&(u.updateFeatures(),!h.current&&u.animationState&&u.animationState.animateChanges(),h.current&&(h.current=!1,window.HandoffComplete=!0))})),u}(s,d,c,n);const e=(0,t.useContext)(Xe),r=(0,t.useContext)(Le).strict;h.visualElement&&(l=h.visualElement.loadFeatures(c,r,i,e))}return t.createElement(Ae.Provider,{value:h},l&&h.visualElement?t.createElement(l,{visualElement:h.visualElement,...c}):null,r(s,e,function(e,i,n){return(0,t.useCallback)((t=>{t&&e.mount&&e.mount(t),i&&(t?i.mount(t):i.unmount()),n&&("function"===typeof n?n(t):Be(n)&&(n.current=t))}),[i])}(d,h.visualElement,o),d,u,h.visualElement))}));return o[Ke]=s,o}function Je(e){let{layoutId:i}=e;const n=(0,t.useContext)(He).id;return n&&void 0!==i?n+"-"+i:i}function Qe(e){function t(t){return Ye(e(t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}))}if("undefined"===typeof Proxy)return t;const i=new Map;return new Proxy(t,{get:(e,n)=>(i.has(n)||i.set(n,t(n)),i.get(n))})}const et=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function tt(e){return"string"===typeof e&&!e.includes("-")&&!!(et.indexOf(e)>-1||/[A-Z]/.test(e))}const it={};const nt=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],rt=new Set(nt);function at(e,t){let{layout:i,layoutId:n}=t;return rt.has(e)||e.startsWith("origin")||(i||void 0!==n)&&(!!it[e]||"opacity"===e)}const st=e=>Boolean(e&&e.getVelocity),ot={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},lt=nt.length;const ct=e=>t=>"string"===typeof t&&t.startsWith(e),ut=ct("--"),ht=ct("var(--"),dt=(e,t)=>t&&"number"===typeof e?t.transform(e):e,pt=(e,t,i)=>Math.min(Math.max(i,e),t),ft={test:e=>"number"===typeof e,parse:parseFloat,transform:e=>e},mt={...ft,transform:e=>pt(0,1,e)},gt={...ft,default:1},yt=e=>Math.round(1e5*e)/1e5,_t=/(-)?([\d]*\.?[\d])+/g,vt=/(#[0-9a-f]{3,8}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2}(-?[\d\.]+%?)\s*[\,\/]?\s*[\d\.]*%?\))/gi,xt=/^(#[0-9a-f]{3,8}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2}(-?[\d\.]+%?)\s*[\,\/]?\s*[\d\.]*%?\))$/i;function bt(e){return"string"===typeof e}const wt=e=>({test:t=>bt(t)&&t.endsWith(e)&&1===t.split(" ").length,parse:parseFloat,transform:t=>`${t}${e}`}),St=wt("deg"),Tt=wt("%"),kt=wt("px"),Et=wt("vh"),Pt=wt("vw"),Ct={...Tt,parse:e=>Tt.parse(e)/100,transform:e=>Tt.transform(100*e)},It={...ft,transform:Math.round},At={borderWidth:kt,borderTopWidth:kt,borderRightWidth:kt,borderBottomWidth:kt,borderLeftWidth:kt,borderRadius:kt,radius:kt,borderTopLeftRadius:kt,borderTopRightRadius:kt,borderBottomRightRadius:kt,borderBottomLeftRadius:kt,width:kt,maxWidth:kt,height:kt,maxHeight:kt,size:kt,top:kt,right:kt,bottom:kt,left:kt,padding:kt,paddingTop:kt,paddingRight:kt,paddingBottom:kt,paddingLeft:kt,margin:kt,marginTop:kt,marginRight:kt,marginBottom:kt,marginLeft:kt,rotate:St,rotateX:St,rotateY:St,rotateZ:St,scale:gt,scaleX:gt,scaleY:gt,scaleZ:gt,skew:St,skewX:St,skewY:St,distance:kt,translateX:kt,translateY:kt,translateZ:kt,x:kt,y:kt,z:kt,perspective:kt,transformPerspective:kt,opacity:mt,originX:Ct,originY:Ct,originZ:kt,zIndex:It,fillOpacity:mt,strokeOpacity:mt,numOctaves:It};function Mt(e,t,i,n){const{style:r,vars:a,transform:s,transformOrigin:o}=e;let l=!1,c=!1,u=!0;for(const h in t){const e=t[h];if(ut(h)){a[h]=e;continue}const i=At[h],n=dt(e,i);if(rt.has(h)){if(l=!0,s[h]=n,!u)continue;e!==(i.default||0)&&(u=!1)}else h.startsWith("origin")?(c=!0,o[h]=n):r[h]=n}if(t.transform||(l||n?r.transform=function(e,t,i,n){let{enableHardwareAcceleration:r=!0,allowTransformNone:a=!0}=t,s="";for(let o=0;o<lt;o++){const t=nt[o];void 0!==e[t]&&(s+=`${ot[t]||t}(${e[t]}) `)}return r&&!e.z&&(s+="translateZ(0)"),s=s.trim(),n?s=n(e,i?"":s):a&&i&&(s="none"),s}(e.transform,i,u,n):r.transform&&(r.transform="none")),c){const{originX:e="50%",originY:t="50%",originZ:i=0}=o;r.transformOrigin=`${e} ${t} ${i}`}}const zt=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function Dt(e,t,i){for(const n in t)st(t[n])||at(n,i)||(e[n]=t[n])}function Lt(e,i,n){const r={};return Dt(r,e.style||{},e),Object.assign(r,function(e,i,n){let{transformTemplate:r}=e;return(0,t.useMemo)((()=>{const e={style:{},transform:{},transformOrigin:{},vars:{}};return Mt(e,i,{enableHardwareAcceleration:!n},r),Object.assign({},e.vars,e.style)}),[i])}(e,i,n)),e.transformValues?e.transformValues(r):r}function Rt(e,t,i){const n={},r=Lt(e,t,i);return e.drag&&!1!==e.dragListener&&(n.draggable=!1,r.userSelect=r.WebkitUserSelect=r.WebkitTouchCallout="none",r.touchAction=!0===e.drag?"none":"pan-"+("x"===e.drag?"y":"x")),void 0===e.tabIndex&&(e.onTap||e.onTapStart||e.whileTap)&&(n.tabIndex=0),n.style=r,n}const Ft=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","transformValues","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function Bt(e){return e.startsWith("while")||e.startsWith("drag")&&"draggable"!==e||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||Ft.has(e)}let Ot=e=>!Bt(e);try{(Nt=require("@emotion/is-prop-valid").default)&&(Ot=e=>e.startsWith("on")?!Bt(e):Nt(e))}catch(il){}var Nt;function Vt(e,t,i){return"string"===typeof e?e:kt.transform(t+i*e)}const jt={offset:"stroke-dashoffset",array:"stroke-dasharray"},Ut={offset:"strokeDashoffset",array:"strokeDasharray"};function $t(e,t,i,n,r){let{attrX:a,attrY:s,attrScale:o,originX:l,originY:c,pathLength:u,pathSpacing:h=1,pathOffset:d=0,...p}=t;if(Mt(e,p,i,r),n)return void(e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox));e.attrs=e.style,e.style={};const{attrs:f,style:m,dimensions:g}=e;f.transform&&(g&&(m.transform=f.transform),delete f.transform),g&&(void 0!==l||void 0!==c||m.transform)&&(m.transformOrigin=function(e,t,i){return`${Vt(t,e.x,e.width)} ${Vt(i,e.y,e.height)}`}(g,void 0!==l?l:.5,void 0!==c?c:.5)),void 0!==a&&(f.x=a),void 0!==s&&(f.y=s),void 0!==o&&(f.scale=o),void 0!==u&&function(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];e.pathLength=1;const a=r?jt:Ut;e[a.offset]=kt.transform(-n);const s=kt.transform(t),o=kt.transform(i);e[a.array]=`${s} ${o}`}(f,u,h,d,!1)}const qt=()=>({style:{},transform:{},transformOrigin:{},vars:{},attrs:{}}),Zt=e=>"string"===typeof e&&"svg"===e.toLowerCase();function Gt(e,i,n,r){const a=(0,t.useMemo)((()=>{const t={style:{},transform:{},transformOrigin:{},vars:{},attrs:{}};return $t(t,i,{enableHardwareAcceleration:!1},Zt(r),e.transformTemplate),{...t.attrs,style:{...t.style}}}),[i]);if(e.style){const t={};Dt(t,e.style,e),a.style={...t,...a.style}}return a}function Wt(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return(i,n,r,a,s)=>{let{latestValues:o}=a;const l=(tt(i)?Gt:Rt)(n,o,s,i),c=function(e,t,i){const n={};for(const r in e)"values"===r&&"object"===typeof e.values||(Ot(r)||!0===i&&Bt(r)||!t&&!Bt(r)||e.draggable&&r.startsWith("onDrag"))&&(n[r]=e[r]);return n}(n,"string"===typeof i,e),u={...c,...l,ref:r},{children:h}=n,d=(0,t.useMemo)((()=>st(h)?h.get():h),[h]);return(0,t.createElement)(i,{...u,children:d})}}function Ht(e,t,i,n){let{style:r,vars:a}=t;Object.assign(e.style,r,n&&n.getProjectionStyles(i));for(const s in a)e.style.setProperty(s,a[s])}const Xt=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function Kt(e,t,i,n){Ht(e,t,void 0,n);for(const r in t.attrs)e.setAttribute(Xt.has(r)?r:Re(r),t.attrs[r])}function Yt(e,t){const{style:i}=e,n={};for(const r in i)(st(i[r])||t.style&&st(t.style[r])||at(r,e))&&(n[r]=i[r]);return n}function Jt(e,t){const i=Yt(e,t);for(const n in e)if(st(e[n])||st(t[n])){i[-1!==nt.indexOf(n)?"attr"+n.charAt(0).toUpperCase()+n.substring(1):n]=e[n]}return i}function Qt(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};return"function"===typeof t&&(t=t(void 0!==i?i:e.custom,n,r)),"string"===typeof t&&(t=e.variants&&e.variants[t]),"function"===typeof t&&(t=t(void 0!==i?i:e.custom,n,r)),t}function ei(e){const i=(0,t.useRef)(null);return null===i.current&&(i.current=e()),i.current}const ti=e=>Array.isArray(e);function ii(e){const t=st(e)?e.get():e;return i=t,Boolean(i&&"object"===typeof i&&i.mix&&i.toValue)?t.toValue():t;var i}const ni=e=>(i,n)=>{const r=(0,t.useContext)(Ae),a=(0,t.useContext)(Me),s=()=>function(e,t,i,n){let{scrapeMotionValuesFromProps:r,createRenderState:a,onMount:s}=e;const o={latestValues:ri(t,i,n,r),renderState:a()};return s&&(o.mount=e=>s(t,e,o)),o}(e,i,r,a);return n?s():ei(s)};function ri(e,t,i,n){const r={},a=n(e,{});for(const d in a)r[d]=ii(a[d]);let{initial:s,animate:o}=e;const l=Ue(e),c=$e(e);t&&c&&!l&&!1!==e.inherit&&(void 0===s&&(s=t.initial),void 0===o&&(o=t.animate));let u=!!i&&!1===i.initial;u=u||!1===s;const h=u?o:s;if(h&&"boolean"!==typeof h&&!Ne(h)){(Array.isArray(h)?h:[h]).forEach((t=>{const i=Qt(e,t);if(!i)return;const{transitionEnd:n,transition:a,...s}=i;for(const e in s){let t=s[e];if(Array.isArray(t)){t=t[u?t.length-1:0]}null!==t&&(r[e]=t)}for(const e in n)r[e]=n[e]}))}return r}const ai=e=>e;class si{constructor(){this.order=[],this.scheduled=new Set}add(e){if(!this.scheduled.has(e))return this.scheduled.add(e),this.order.push(e),!0}remove(e){const t=this.order.indexOf(e);-1!==t&&(this.order.splice(t,1),this.scheduled.delete(e))}clear(){this.order.length=0,this.scheduled.clear()}}const oi=["prepare","read","update","preRender","render","postRender"];const{schedule:li,cancel:ci,state:ui,steps:hi}=function(e,t){let i=!1,n=!0;const r={delta:0,timestamp:0,isProcessing:!1},a=oi.reduce(((e,t)=>(e[t]=function(e){let t=new si,i=new si,n=0,r=!1,a=!1;const s=new WeakSet,o={schedule:function(e){const a=arguments.length>2&&void 0!==arguments[2]&&arguments[2]&&r,o=a?t:i;return arguments.length>1&&void 0!==arguments[1]&&arguments[1]&&s.add(e),o.add(e)&&a&&r&&(n=t.order.length),e},cancel:e=>{i.remove(e),s.delete(e)},process:l=>{if(r)a=!0;else{if(r=!0,[t,i]=[i,t],i.clear(),n=t.order.length,n)for(let i=0;i<n;i++){const n=t.order[i];n(l),s.has(n)&&(o.schedule(n),e())}r=!1,a&&(a=!1,o.process(l))}}};return o}((()=>i=!0)),e)),{}),s=e=>a[e].process(r),o=()=>{const a=performance.now();i=!1,r.delta=n?1e3/60:Math.max(Math.min(a-r.timestamp,40),1),r.timestamp=a,r.isProcessing=!0,oi.forEach(s),r.isProcessing=!1,i&&t&&(n=!1,e(o))},l=oi.reduce(((t,s)=>{const l=a[s];return t[s]=function(t){let a=arguments.length>1&&void 0!==arguments[1]&&arguments[1],s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return i||(i=!0,n=!0,r.isProcessing||e(o)),l.schedule(t,a,s)},t}),{});return{schedule:l,cancel:e=>oi.forEach((t=>a[t].cancel(e))),state:r,steps:a}}("undefined"!==typeof requestAnimationFrame?requestAnimationFrame:ai,!0),di={useVisualState:ni({scrapeMotionValuesFromProps:Jt,createRenderState:qt,onMount:(e,t,i)=>{let{renderState:n,latestValues:r}=i;li.read((()=>{try{n.dimensions="function"===typeof t.getBBox?t.getBBox():t.getBoundingClientRect()}catch(tl){n.dimensions={x:0,y:0,width:0,height:0}}})),li.render((()=>{$t(n,r,{enableHardwareAcceleration:!1},Zt(t.tagName),e.transformTemplate),Kt(t,n)}))}})},pi={useVisualState:ni({scrapeMotionValuesFromProps:Yt,createRenderState:zt})};function fi(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{passive:!0};return e.addEventListener(t,i,n),()=>e.removeEventListener(t,i)}const mi=e=>"mouse"===e.pointerType?"number"!==typeof e.button||e.button<=0:!1!==e.isPrimary;function gi(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"page";return{point:{x:e[t+"X"],y:e[t+"Y"]}}}function yi(e,t,i,n){return fi(e,t,(e=>t=>mi(t)&&e(t,gi(t)))(i),n)}const _i=(e,t)=>i=>t(e(i)),vi=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return t.reduce(_i)};function xi(e){let t=null;return()=>{const i=()=>{t=null};return null===t&&(t=e,i)}}const bi=xi("dragHorizontal"),wi=xi("dragVertical");function Si(e){let t=!1;if("y"===e)t=wi();else if("x"===e)t=bi();else{const e=bi(),i=wi();e&&i?t=()=>{e(),i()}:(e&&e(),i&&i())}return t}function Ti(){const e=Si(!0);return!e||(e(),!1)}class ki{constructor(e){this.isMounted=!1,this.node=e}update(){}}function Ei(e,t){const i="pointer"+(t?"enter":"leave"),n="onHover"+(t?"Start":"End");return yi(e.current,i,((i,r)=>{if("touch"===i.pointerType||Ti())return;const a=e.getProps();e.animationState&&a.whileHover&&e.animationState.setActive("whileHover",t),a[n]&&li.update((()=>a[n](i,r)))}),{passive:!e.getProps()[n]})}const Pi=(e,t)=>!!t&&(e===t||Pi(e,t.parentElement));function Ci(e,t){if(!t)return;const i=new PointerEvent("pointer"+e);t(i,gi(i))}const Ii=new WeakMap,Ai=new WeakMap,Mi=e=>{const t=Ii.get(e.target);t&&t(e)},zi=e=>{e.forEach(Mi)};function Di(e,t,i){const n=function(e){let{root:t,...i}=e;const n=t||document;Ai.has(n)||Ai.set(n,{});const r=Ai.get(n),a=JSON.stringify(i);return r[a]||(r[a]=new IntersectionObserver(zi,{root:t,...i})),r[a]}(t);return Ii.set(e,i),n.observe(e),()=>{Ii.delete(e),n.unobserve(e)}}const Li={some:0,all:1};const Ri={inView:{Feature:class extends ki{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:t,margin:i,amount:n="some",once:r}=e,a={root:t?t.current:void 0,rootMargin:i,threshold:"number"===typeof n?n:Li[n]};return Di(this.node.current,a,(e=>{const{isIntersecting:t}=e;if(this.isInView===t)return;if(this.isInView=t,r&&!t&&this.hasEnteredView)return;t&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",t);const{onViewportEnter:i,onViewportLeave:n}=this.node.getProps(),a=t?i:n;a&&a(e)}))}mount(){this.startObserver()}update(){if("undefined"===typeof IntersectionObserver)return;const{props:e,prevProps:t}=this.node,i=["amount","margin","root"].some(function(e){let{viewport:t={}}=e,{viewport:i={}}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e=>t[e]!==i[e]}(e,t));i&&this.startObserver()}unmount(){}}},tap:{Feature:class extends ki{constructor(){super(...arguments),this.removeStartListeners=ai,this.removeEndListeners=ai,this.removeAccessibleListeners=ai,this.startPointerPress=(e,t)=>{if(this.isPressing)return;this.removeEndListeners();const i=this.node.getProps(),n=yi(window,"pointerup",((e,t)=>{if(!this.checkPressEnd())return;const{onTap:i,onTapCancel:n,globalTapTarget:r}=this.node.getProps();li.update((()=>{r||Pi(this.node.current,e.target)?i&&i(e,t):n&&n(e,t)}))}),{passive:!(i.onTap||i.onPointerUp)}),r=yi(window,"pointercancel",((e,t)=>this.cancelPress(e,t)),{passive:!(i.onTapCancel||i.onPointerCancel)});this.removeEndListeners=vi(n,r),this.startPress(e,t)},this.startAccessiblePress=()=>{const e=fi(this.node.current,"keydown",(e=>{if("Enter"!==e.key||this.isPressing)return;this.removeEndListeners(),this.removeEndListeners=fi(this.node.current,"keyup",(e=>{"Enter"===e.key&&this.checkPressEnd()&&Ci("up",((e,t)=>{const{onTap:i}=this.node.getProps();i&&li.update((()=>i(e,t)))}))})),Ci("down",((e,t)=>{this.startPress(e,t)}))})),t=fi(this.node.current,"blur",(()=>{this.isPressing&&Ci("cancel",((e,t)=>this.cancelPress(e,t)))}));this.removeAccessibleListeners=vi(e,t)}}startPress(e,t){this.isPressing=!0;const{onTapStart:i,whileTap:n}=this.node.getProps();n&&this.node.animationState&&this.node.animationState.setActive("whileTap",!0),i&&li.update((()=>i(e,t)))}checkPressEnd(){this.removeEndListeners(),this.isPressing=!1;return this.node.getProps().whileTap&&this.node.animationState&&this.node.animationState.setActive("whileTap",!1),!Ti()}cancelPress(e,t){if(!this.checkPressEnd())return;const{onTapCancel:i}=this.node.getProps();i&&li.update((()=>i(e,t)))}mount(){const e=this.node.getProps(),t=yi(e.globalTapTarget?window:this.node.current,"pointerdown",this.startPointerPress,{passive:!(e.onTapStart||e.onPointerStart)}),i=fi(this.node.current,"focus",this.startAccessiblePress);this.removeStartListeners=vi(t,i)}unmount(){this.removeStartListeners(),this.removeEndListeners(),this.removeAccessibleListeners()}}},focus:{Feature:class extends ki{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch(tl){e=!0}e&&this.node.animationState&&(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){this.isActive&&this.node.animationState&&(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=vi(fi(this.node.current,"focus",(()=>this.onFocus())),fi(this.node.current,"blur",(()=>this.onBlur())))}unmount(){}}},hover:{Feature:class extends ki{mount(){this.unmount=vi(Ei(this.node,!0),Ei(this.node,!1))}unmount(){}}}};function Fi(e,t){if(!Array.isArray(t))return!1;const i=t.length;if(i!==e.length)return!1;for(let n=0;n<i;n++)if(t[n]!==e[n])return!1;return!0}function Bi(e,t,i){const n=e.getProps();return Qt(n,t,void 0!==i?i:n.custom,function(e){const t={};return e.values.forEach(((e,i)=>t[i]=e.get())),t}(e),function(e){const t={};return e.values.forEach(((e,i)=>t[i]=e.getVelocity())),t}(e))}let Oi=ai,Ni=ai;const Vi=e=>1e3*e,ji=e=>e/1e3,Ui=!1,$i=e=>Array.isArray(e)&&"number"===typeof e[0];function qi(e){return Boolean(!e||"string"===typeof e&&Gi[e]||$i(e)||Array.isArray(e)&&e.every(qi))}const Zi=e=>{let[t,i,n,r]=e;return`cubic-bezier(${t}, ${i}, ${n}, ${r})`},Gi={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:Zi([0,.65,.55,1]),circOut:Zi([.55,0,1,.45]),backIn:Zi([.31,.01,.66,-.59]),backOut:Zi([.33,1.53,.69,.99])};function Wi(e){if(e)return $i(e)?Zi(e):Array.isArray(e)?e.map(Wi):Gi[e]}const Hi=(e,t,i)=>(((1-3*i+3*t)*e+(3*i-6*t))*e+3*t)*e;function Xi(e,t,i,n){if(e===t&&i===n)return ai;const r=t=>function(e,t,i,n,r){let a,s,o=0;do{s=t+(i-t)/2,a=Hi(s,n,r)-e,a>0?i=s:t=s}while(Math.abs(a)>1e-7&&++o<12);return s}(t,0,1,e,i);return e=>0===e||1===e?e:Hi(r(e),t,n)}const Ki=Xi(.42,0,1,1),Yi=Xi(0,0,.58,1),Ji=Xi(.42,0,.58,1),Qi=e=>t=>t<=.5?e(2*t)/2:(2-e(2*(1-t)))/2,en=e=>t=>1-e(1-t),tn=e=>1-Math.sin(Math.acos(e)),nn=en(tn),rn=Qi(tn),an=Xi(.33,1.53,.69,.99),sn=en(an),on=Qi(sn),ln={linear:ai,easeIn:Ki,easeInOut:Ji,easeOut:Yi,circIn:tn,circInOut:rn,circOut:nn,backIn:sn,backInOut:on,backOut:an,anticipate:e=>(e*=2)<1?.5*sn(e):.5*(2-Math.pow(2,-10*(e-1)))},cn=e=>{if(Array.isArray(e)){Ni(4===e.length,"Cubic bezier arrays must contain four numerical values.");const[t,i,n,r]=e;return Xi(t,i,n,r)}return"string"===typeof e?(Ni(void 0!==ln[e],`Invalid easing type '${e}'`),ln[e]):e},un=(e,t)=>i=>Boolean(bt(i)&&xt.test(i)&&i.startsWith(e)||t&&Object.prototype.hasOwnProperty.call(i,t)),hn=(e,t,i)=>n=>{if(!bt(n))return n;const[r,a,s,o]=n.match(_t);return{[e]:parseFloat(r),[t]:parseFloat(a),[i]:parseFloat(s),alpha:void 0!==o?parseFloat(o):1}},dn={...ft,transform:e=>Math.round((e=>pt(0,255,e))(e))},pn={test:un("rgb","red"),parse:hn("red","green","blue"),transform:e=>{let{red:t,green:i,blue:n,alpha:r=1}=e;return"rgba("+dn.transform(t)+", "+dn.transform(i)+", "+dn.transform(n)+", "+yt(mt.transform(r))+")"}};const fn={test:un("#"),parse:function(e){let t="",i="",n="",r="";return e.length>5?(t=e.substring(1,3),i=e.substring(3,5),n=e.substring(5,7),r=e.substring(7,9)):(t=e.substring(1,2),i=e.substring(2,3),n=e.substring(3,4),r=e.substring(4,5),t+=t,i+=i,n+=n,r+=r),{red:parseInt(t,16),green:parseInt(i,16),blue:parseInt(n,16),alpha:r?parseInt(r,16)/255:1}},transform:pn.transform},mn={test:un("hsl","hue"),parse:hn("hue","saturation","lightness"),transform:e=>{let{hue:t,saturation:i,lightness:n,alpha:r=1}=e;return"hsla("+Math.round(t)+", "+Tt.transform(yt(i))+", "+Tt.transform(yt(n))+", "+yt(mt.transform(r))+")"}},gn={test:e=>pn.test(e)||fn.test(e)||mn.test(e),parse:e=>pn.test(e)?pn.parse(e):mn.test(e)?mn.parse(e):fn.parse(e),transform:e=>bt(e)?e:e.hasOwnProperty("red")?pn.transform(e):mn.transform(e)},yn=(e,t,i)=>-i*e+i*t+e;function _n(e,t,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?e+6*(t-e)*i:i<.5?t:i<2/3?e+(t-e)*(2/3-i)*6:e}const vn=(e,t,i)=>{const n=e*e;return Math.sqrt(Math.max(0,i*(t*t-n)+n))},xn=[fn,pn,mn];function bn(e){const t=(i=e,xn.find((e=>e.test(i))));var i;Ni(Boolean(t),`'${e}' is not an animatable color. Use the equivalent color code instead.`);let n=t.parse(e);return t===mn&&(n=function(e){let{hue:t,saturation:i,lightness:n,alpha:r}=e;t/=360,i/=100,n/=100;let a=0,s=0,o=0;if(i){const e=n<.5?n*(1+i):n+i-n*i,r=2*n-e;a=_n(r,e,t+1/3),s=_n(r,e,t),o=_n(r,e,t-1/3)}else a=s=o=n;return{red:Math.round(255*a),green:Math.round(255*s),blue:Math.round(255*o),alpha:r}}(n)),n}const wn=(e,t)=>{const i=bn(e),n=bn(t),r={...i};return e=>(r.red=vn(i.red,n.red,e),r.green=vn(i.green,n.green,e),r.blue=vn(i.blue,n.blue,e),r.alpha=yn(i.alpha,n.alpha,e),pn.transform(r))};const Sn={regex:/var\s*\(\s*--[\w-]+(\s*,\s*(?:(?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)+)?\s*\)/g,countKey:"Vars",token:"${v}",parse:ai},Tn={regex:vt,countKey:"Colors",token:"${c}",parse:gn.parse},kn={regex:_t,countKey:"Numbers",token:"${n}",parse:ft.parse};function En(e,t){let{regex:i,countKey:n,token:r,parse:a}=t;const s=e.tokenised.match(i);s&&(e["num"+n]=s.length,e.tokenised=e.tokenised.replace(i,r),e.values.push(...s.map(a)))}function Pn(e){const t=e.toString(),i={value:t,tokenised:t,values:[],numVars:0,numColors:0,numNumbers:0};return i.value.includes("var(--")&&En(i,Sn),En(i,Tn),En(i,kn),i}function Cn(e){return Pn(e).values}function In(e){const{values:t,numColors:i,numVars:n,tokenised:r}=Pn(e),a=t.length;return e=>{let t=r;for(let r=0;r<a;r++)t=r<n?t.replace(Sn.token,e[r]):r<n+i?t.replace(Tn.token,gn.transform(e[r])):t.replace(kn.token,yt(e[r]));return t}}const An=e=>"number"===typeof e?0:e;const Mn={test:function(e){var t,i;return isNaN(e)&&bt(e)&&((null===(t=e.match(_t))||void 0===t?void 0:t.length)||0)+((null===(i=e.match(vt))||void 0===i?void 0:i.length)||0)>0},parse:Cn,createTransformer:In,getAnimatableNone:function(e){const t=Cn(e);return In(e)(t.map(An))}},zn=(e,t)=>i=>`${i>0?t:e}`;function Dn(e,t){return"number"===typeof e?i=>yn(e,t,i):gn.test(e)?wn(e,t):e.startsWith("var(")?zn(e,t):Fn(e,t)}const Ln=(e,t)=>{const i=[...e],n=i.length,r=e.map(((e,i)=>Dn(e,t[i])));return e=>{for(let t=0;t<n;t++)i[t]=r[t](e);return i}},Rn=(e,t)=>{const i={...e,...t},n={};for(const r in i)void 0!==e[r]&&void 0!==t[r]&&(n[r]=Dn(e[r],t[r]));return e=>{for(const t in n)i[t]=n[t](e);return i}},Fn=(e,t)=>{const i=Mn.createTransformer(t),n=Pn(e),r=Pn(t);return n.numVars===r.numVars&&n.numColors===r.numColors&&n.numNumbers>=r.numNumbers?vi(Ln(n.values,r.values),i):(Oi(!0,`Complex values '${e}' and '${t}' too different to mix. Ensure all colors are of the same type, and that each contains the same quantity of number and color values. Falling back to instant transition.`),zn(e,t))},Bn=(e,t,i)=>{const n=t-e;return 0===n?1:(i-e)/n},On=(e,t)=>i=>yn(e,t,i);function Nn(e,t,i){const n=[],r=i||("number"===typeof(a=e[0])?On:"string"===typeof a?gn.test(a)?wn:Fn:Array.isArray(a)?Ln:"object"===typeof a?Rn:On);var a;const s=e.length-1;for(let o=0;o<s;o++){let i=r(e[o],e[o+1]);if(t){const e=Array.isArray(t)?t[o]||ai:t;i=vi(e,i)}n.push(i)}return n}function Vn(e,t){let{clamp:i=!0,ease:n,mixer:r}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const a=e.length;if(Ni(a===t.length,"Both input and output ranges must be the same length"),1===a)return()=>t[0];e[0]>e[a-1]&&(e=[...e].reverse(),t=[...t].reverse());const s=Nn(t,n,r),o=s.length,l=t=>{let i=0;if(o>1)for(;i<e.length-2&&!(t<e[i+1]);i++);const n=Bn(e[i],e[i+1],t);return s[i](n)};return i?t=>l(pt(e[0],e[a-1],t)):l}function jn(e){const t=[0];return function(e,t){const i=e[e.length-1];for(let n=1;n<=t;n++){const r=Bn(0,t,n);e.push(yn(i,1,r))}}(t,e.length-1),t}function Un(e){let{duration:t=300,keyframes:i,times:n,ease:r="easeInOut"}=e;const a=(e=>Array.isArray(e)&&"number"!==typeof e[0])(r)?r.map(cn):cn(r),s={done:!1,value:i[0]},o=function(e,t){return e.map((e=>e*t))}(n&&n.length===i.length?n:jn(i),t),l=Vn(o,i,{ease:Array.isArray(a)?a:(c=i,u=a,c.map((()=>u||Ji)).splice(0,c.length-1))});var c,u;return{calculatedDuration:t,next:e=>(s.value=l(e),s.done=e>=t,s)}}function $n(e,t){return t?e*(1e3/t):0}function qn(e,t,i){const n=Math.max(t-5,0);return $n(i-e(n),t-n)}const Zn=.001;function Gn(e){let t,i,{duration:n=800,bounce:r=.25,velocity:a=0,mass:s=1}=e;Oi(n<=Vi(10),"Spring duration must be 10 seconds or less");let o=1-r;o=pt(.05,1,o),n=pt(.01,10,ji(n)),o<1?(t=e=>{const t=e*o,i=t*n,r=t-a,s=Hn(e,o),l=Math.exp(-i);return Zn-r/s*l},i=e=>{const i=e*o*n,r=i*a+a,s=Math.pow(o,2)*Math.pow(e,2)*n,l=Math.exp(-i),c=Hn(Math.pow(e,2),o);return(-t(e)+Zn>0?-1:1)*((r-s)*l)/c}):(t=e=>Math.exp(-e*n)*((e-a)*n+1)-.001,i=e=>Math.exp(-e*n)*(n*n*(a-e)));const l=function(e,t,i){let n=i;for(let r=1;r<Wn;r++)n-=e(n)/t(n);return n}(t,i,5/n);if(n=Vi(n),isNaN(l))return{stiffness:100,damping:10,duration:n};{const e=Math.pow(l,2)*s;return{stiffness:e,damping:2*o*Math.sqrt(s*e),duration:n}}}const Wn=12;function Hn(e,t){return e*Math.sqrt(1-t*t)}const Xn=["duration","bounce"],Kn=["stiffness","damping","mass"];function Yn(e,t){return t.some((t=>void 0!==e[t]))}function Jn(e){let{keyframes:t,restDelta:i,restSpeed:n,...r}=e;const a=t[0],s=t[t.length-1],o={done:!1,value:a},{stiffness:l,damping:c,mass:u,duration:h,velocity:d,isResolvedFromDuration:p}=function(e){let t={velocity:0,stiffness:100,damping:10,mass:1,isResolvedFromDuration:!1,...e};if(!Yn(e,Kn)&&Yn(e,Xn)){const i=Gn(e);t={...t,...i,mass:1},t.isResolvedFromDuration=!0}return t}({...r,velocity:-ji(r.velocity||0)}),f=d||0,m=c/(2*Math.sqrt(l*u)),g=s-a,y=ji(Math.sqrt(l/u)),_=Math.abs(g)<5;let v;if(n||(n=_?.01:2),i||(i=_?.005:.5),m<1){const e=Hn(y,m);v=t=>{const i=Math.exp(-m*y*t);return s-i*((f+m*y*g)/e*Math.sin(e*t)+g*Math.cos(e*t))}}else if(1===m)v=e=>s-Math.exp(-y*e)*(g+(f+y*g)*e);else{const e=y*Math.sqrt(m*m-1);v=t=>{const i=Math.exp(-m*y*t),n=Math.min(e*t,300);return s-i*((f+m*y*g)*Math.sinh(n)+e*g*Math.cosh(n))/e}}return{calculatedDuration:p&&h||null,next:e=>{const t=v(e);if(p)o.done=e>=h;else{let r=f;0!==e&&(r=m<1?qn(v,e,t):0);const a=Math.abs(r)<=n,l=Math.abs(s-t)<=i;o.done=a&&l}return o.value=o.done?s:t,o}}}function Qn(e){let{keyframes:t,velocity:i=0,power:n=.8,timeConstant:r=325,bounceDamping:a=10,bounceStiffness:s=500,modifyTarget:o,min:l,max:c,restDelta:u=.5,restSpeed:h}=e;const d=t[0],p={done:!1,value:d},f=e=>void 0===l?c:void 0===c||Math.abs(l-e)<Math.abs(c-e)?l:c;let m=n*i;const g=d+m,y=void 0===o?g:o(g);y!==g&&(m=y-d);const _=e=>-m*Math.exp(-e/r),v=e=>y+_(e),x=e=>{const t=_(e),i=v(e);p.done=Math.abs(t)<=u,p.value=p.done?y:i};let b,w;const S=e=>{var t;(t=p.value,void 0!==l&&t<l||void 0!==c&&t>c)&&(b=e,w=Jn({keyframes:[p.value,f(p.value)],velocity:qn(v,e,p.value),damping:a,stiffness:s,restDelta:u,restSpeed:h}))};return S(0),{calculatedDuration:null,next:e=>{let t=!1;return w||void 0!==b||(t=!0,x(e),S(e)),void 0!==b&&e>b?w.next(e-b):(!t&&x(e),p)}}}const er=e=>{const t=t=>{let{timestamp:i}=t;return e(i)};return{start:()=>li.update(t,!0),stop:()=>ci(t),now:()=>ui.isProcessing?ui.timestamp:performance.now()}};function tr(e){let t=0;let i=e.next(t);for(;!i.done&&t<2e4;)t+=50,i=e.next(t);return t>=2e4?1/0:t}const ir={decay:Qn,inertia:Qn,tween:Un,keyframes:Un,spring:Jn};function nr(e){let t,i,{autoplay:n=!0,delay:r=0,driver:a=er,keyframes:s,type:o="keyframes",repeat:l=0,repeatDelay:c=0,repeatType:u="loop",onPlay:h,onStop:d,onComplete:p,onUpdate:f,...m}=e,g=1,y=!1;const _=()=>{i=new Promise((e=>{t=e}))};let v;_();const x=ir[o]||Un;let b;x!==Un&&"number"!==typeof s[0]&&(b=Vn([0,100],s,{clamp:!1}),s=[0,100]);const w=x({...m,keyframes:s});let S;"mirror"===u&&(S=x({...m,keyframes:[...s].reverse(),velocity:-(m.velocity||0)}));let T="idle",k=null,E=null,P=null;null===w.calculatedDuration&&l&&(w.calculatedDuration=tr(w));const{calculatedDuration:C}=w;let I=1/0,A=1/0;null!==C&&(I=C+c,A=I*(l+1)-c);let M=0;const z=e=>{if(null===E)return;g>0&&(E=Math.min(E,e)),g<0&&(E=Math.min(e-A/g,E)),M=null!==k?k:Math.round(e-E)*g;const t=M-r*(g>=0?1:-1),i=g>=0?t<0:t>A;M=Math.max(t,0),"finished"===T&&null===k&&(M=A);let n=M,a=w;if(l){const e=Math.min(M,A)/I;let t=Math.floor(e),i=e%1;!i&&e>=1&&(i=1),1===i&&t--,t=Math.min(t,l+1);Boolean(t%2)&&("reverse"===u?(i=1-i,c&&(i-=c/I)):"mirror"===u&&(a=S)),n=pt(0,1,i)*I}const o=i?{done:!1,value:s[0]}:a.next(n);b&&(o.value=b(o.value));let{done:h}=o;i||null===C||(h=g>=0?M>=A:M<=0);const d=null===k&&("finished"===T||"running"===T&&h);return f&&f(o.value),d&&R(),o},D=()=>{v&&v.stop(),v=void 0},L=()=>{T="idle",D(),t(),_(),E=P=null},R=()=>{T="finished",p&&p(),D(),t()},F=()=>{if(y)return;v||(v=a(z));const e=v.now();h&&h(),null!==k?E=e-k:E&&"finished"!==T||(E=e),"finished"===T&&_(),P=E,k=null,T="running",v.start()};n&&F();const B={then:(e,t)=>i.then(e,t),get time(){return ji(M)},set time(e){e=Vi(e),M=e,null===k&&v&&0!==g?E=v.now()-e/g:k=e},get duration(){const e=null===w.calculatedDuration?tr(w):w.calculatedDuration;return ji(e)},get speed(){return g},set speed(e){e!==g&&v&&(g=e,B.time=ji(M))},get state(){return T},play:F,pause:()=>{T="paused",k=M},stop:()=>{y=!0,"idle"!==T&&(T="idle",d&&d(),L())},cancel:()=>{null!==P&&z(P),L()},complete:()=>{T="finished"},sample:e=>(E=0,z(e))};return B}const rr=function(e){let t;return()=>(void 0===t&&(t=e()),t)}((()=>Object.hasOwnProperty.call(Element.prototype,"animate"))),ar=new Set(["opacity","clipPath","filter","transform","backgroundColor"]);function sr(e,t,i){let{onUpdate:n,onComplete:r,...a}=i;if(!(rr()&&ar.has(t)&&!a.repeatDelay&&"mirror"!==a.repeatType&&0!==a.damping&&"inertia"!==a.type))return!1;let s,o,l=!1,c=!1;const u=()=>{o=new Promise((e=>{s=e}))};u();let{keyframes:h,duration:d=300,ease:p,times:f}=a;if(((e,t)=>"spring"===t.type||"backgroundColor"===e||!qi(t.ease))(t,a)){const e=nr({...a,repeat:0,delay:0});let t={done:!1,value:h[0]};const i=[];let n=0;for(;!t.done&&n<2e4;)t=e.sample(n),i.push(t.value),n+=10;f=void 0,h=i,d=n-10,p="linear"}const m=function(e,t,i){let{delay:n=0,duration:r,repeat:a=0,repeatType:s="loop",ease:o,times:l}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const c={[t]:i};l&&(c.offset=l);const u=Wi(o);return Array.isArray(u)&&(c.easing=u),e.animate(c,{delay:n,duration:r,easing:Array.isArray(u)?"linear":u,fill:"both",iterations:a+1,direction:"reverse"===s?"alternate":"normal"})}(e.owner.current,t,h,{...a,duration:d,ease:p,times:f}),g=()=>{c=!1,m.cancel()},y=()=>{c=!0,li.update(g),s(),u()};m.onfinish=()=>{c||(e.set(function(e,t){let{repeat:i,repeatType:n="loop"}=t;return e[i&&"loop"!==n&&i%2===1?0:e.length-1]}(h,a)),r&&r(),y())};return{then:(e,t)=>o.then(e,t),attachTimeline:e=>(m.timeline=e,m.onfinish=null,ai),get time(){return ji(m.currentTime||0)},set time(e){m.currentTime=Vi(e)},get speed(){return m.playbackRate},set speed(e){m.playbackRate=e},get duration(){return ji(d)},play:()=>{l||(m.play(),ci(g))},pause:()=>m.pause(),stop:()=>{if(l=!0,"idle"===m.playState)return;const{currentTime:t}=m;if(t){const i=nr({...a,autoplay:!1});e.setWithVelocity(i.sample(t-10).value,i.sample(t).value,10)}y()},complete:()=>{c||m.finish()},cancel:y}}const or={type:"spring",stiffness:500,damping:25,restSpeed:10},lr={type:"keyframes",duration:.8},cr={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},ur=(e,t)=>{let{keyframes:i}=t;return i.length>2?lr:rt.has(e)?e.startsWith("scale")?{type:"spring",stiffness:550,damping:0===i[1]?2*Math.sqrt(550):30,restSpeed:10}:or:cr},hr=(e,t)=>"zIndex"!==e&&(!("number"!==typeof t&&!Array.isArray(t))||!("string"!==typeof t||!Mn.test(t)&&"0"!==t||t.startsWith("url("))),dr=new Set(["brightness","contrast","saturate","opacity"]);function pr(e){const[t,i]=e.slice(0,-1).split("(");if("drop-shadow"===t)return e;const[n]=i.match(_t)||[];if(!n)return e;const r=i.replace(n,"");let a=dr.has(t)?1:0;return n!==i&&(a*=100),t+"("+a+r+")"}const fr=/([a-z-]*)\(.*?\)/g,mr={...Mn,getAnimatableNone:e=>{const t=e.match(fr);return t?t.map(pr).join(" "):e}},gr={...At,color:gn,backgroundColor:gn,outlineColor:gn,fill:gn,stroke:gn,borderColor:gn,borderTopColor:gn,borderRightColor:gn,borderBottomColor:gn,borderLeftColor:gn,filter:mr,WebkitFilter:mr},yr=e=>gr[e];function _r(e,t){let i=yr(e);return i!==mr&&(i=Mn),i.getAnimatableNone?i.getAnimatableNone(t):void 0}const vr=e=>/^0[^.\s]+$/.test(e);function xr(e){return"number"===typeof e?0===e:null!==e?"none"===e||"0"===e||vr(e):void 0}function br(e,t){return e[t]||e.default||e}const wr=!1,Sr=function(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return r=>{const a=br(n,e)||{},s=a.delay||n.delay||0;let{elapsed:o=0}=n;o-=Vi(s);const l=function(e,t,i,n){const r=hr(t,i);let a;a=Array.isArray(i)?[...i]:[null,i];const s=void 0!==n.from?n.from:e.get();let o;const l=[];for(let c=0;c<a.length;c++)null===a[c]&&(a[c]=0===c?s:a[c-1]),xr(a[c])&&l.push(c),"string"===typeof a[c]&&"none"!==a[c]&&"0"!==a[c]&&(o=a[c]);if(r&&l.length&&o)for(let c=0;c<l.length;c++)a[l[c]]=_r(t,o);return a}(t,e,i,a),c=l[0],u=l[l.length-1],h=hr(e,c),d=hr(e,u);Oi(h===d,`You are trying to animate ${e} from "${c}" to "${u}". ${c} is not an animatable value - to enable this animation set ${c} to a value animatable to ${u} via the \`style\` property.`);let p={keyframes:l,velocity:t.getVelocity(),ease:"easeOut",...a,delay:-o,onUpdate:e=>{t.set(e),a.onUpdate&&a.onUpdate(e)},onComplete:()=>{r(),a.onComplete&&a.onComplete()}};if(function(e){let{when:t,delay:i,delayChildren:n,staggerChildren:r,staggerDirection:a,repeat:s,repeatType:o,repeatDelay:l,from:c,elapsed:u,...h}=e;return!!Object.keys(h).length}(a)||(p={...p,...ur(e,p)}),p.duration&&(p.duration=Vi(p.duration)),p.repeatDelay&&(p.repeatDelay=Vi(p.repeatDelay)),!h||!d||Ui||!1===a.type||wr)return function(e){let{keyframes:t,delay:i,onUpdate:n,onComplete:r}=e;const a=()=>(n&&n(t[t.length-1]),r&&r(),{time:0,speed:1,duration:0,play:ai,pause:ai,stop:ai,then:e=>(e(),Promise.resolve()),cancel:ai,complete:ai});return i?nr({keyframes:[0,1],duration:0,delay:i,onComplete:a}):a()}(Ui?{...p,delay:0}:p);if(!n.isHandoff&&t.owner&&t.owner.current instanceof HTMLElement&&!t.owner.getProps().onUpdate){const i=sr(t,e,p);if(i)return i}return nr(p)}};function Tr(e){return Boolean(st(e)&&e.add)}const kr=e=>/^\-?\d*\.?\d+$/.test(e);function Er(e,t){-1===e.indexOf(t)&&e.push(t)}function Pr(e,t){const i=e.indexOf(t);i>-1&&e.splice(i,1)}class Cr{constructor(){this.subscriptions=[]}add(e){return Er(this.subscriptions,e),()=>Pr(this.subscriptions,e)}notify(e,t,i){const n=this.subscriptions.length;if(n)if(1===n)this.subscriptions[0](e,t,i);else for(let r=0;r<n;r++){const n=this.subscriptions[r];n&&n(e,t,i)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const Ir={current:void 0};class Ar{constructor(e){var t=this;let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var n;this.version="10.18.0",this.timeDelta=0,this.lastUpdated=0,this.canTrackVelocity=!1,this.events={},this.updateAndNotify=function(e){let i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];t.prev=t.current,t.current=e;const{delta:n,timestamp:r}=ui;t.lastUpdated!==r&&(t.timeDelta=n,t.lastUpdated=r,li.postRender(t.scheduleVelocityCheck)),t.prev!==t.current&&t.events.change&&t.events.change.notify(t.current),t.events.velocityChange&&t.events.velocityChange.notify(t.getVelocity()),i&&t.events.renderRequest&&t.events.renderRequest.notify(t.current)},this.scheduleVelocityCheck=()=>li.postRender(this.velocityCheck),this.velocityCheck=e=>{let{timestamp:t}=e;t!==this.lastUpdated&&(this.prev=this.current,this.events.velocityChange&&this.events.velocityChange.notify(this.getVelocity()))},this.hasAnimated=!1,this.prev=this.current=e,this.canTrackVelocity=(n=this.current,!isNaN(parseFloat(n))),this.owner=i.owner}onChange(e){return this.on("change",e)}on(e,t){this.events[e]||(this.events[e]=new Cr);const i=this.events[e].add(t);return"change"===e?()=>{i(),li.read((()=>{this.events.change.getSize()||this.stop()}))}:i}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,t){this.passiveEffect=e,this.stopPassiveEffect=t}set(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];t&&this.passiveEffect?this.passiveEffect(e,this.updateAndNotify):this.updateAndNotify(e,t)}setWithVelocity(e,t,i){this.set(t),this.prev=e,this.timeDelta=i}jump(e){this.updateAndNotify(e),this.prev=e,this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return Ir.current&&Ir.current.push(this),this.current}getPrevious(){return this.prev}getVelocity(){return this.canTrackVelocity?$n(parseFloat(this.current)-parseFloat(this.prev),this.timeDelta):0}start(e){return this.stop(),new Promise((t=>{this.hasAnimated=!0,this.animation=e(t),this.events.animationStart&&this.events.animationStart.notify()})).then((()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()}))}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function Mr(e,t){return new Ar(e,t)}const zr=e=>t=>t.test(e),Dr=[ft,kt,Tt,St,Pt,Et,{test:e=>"auto"===e,parse:e=>e}],Lr=e=>Dr.find(zr(e)),Rr=[...Dr,gn,Mn];function Fr(e,t,i){e.hasValue(t)?e.getValue(t).set(i):e.addValue(t,Mr(i))}function Br(e,t){const i=Bi(e,t);let{transitionEnd:n={},transition:r={},...a}=i?e.makeTargetAnimatable(i,!1):{};a={...a,...n};for(const o in a){Fr(e,o,(s=a[o],ti(s)?s[s.length-1]||0:s))}var s}function Or(e,t){if(!t)return;return(t[e]||t.default||t).from}function Nr(e,t){let{protectedKeys:i,needsAnimating:n}=e;const r=i.hasOwnProperty(t)&&!0!==n[t];return n[t]=!1,r}function Vr(e,t){const i=e.get();if(!Array.isArray(t))return i!==t;for(let n=0;n<t.length;n++)if(t[n]!==i)return!0}function jr(e,t){let{delay:i=0,transitionOverride:n,type:r}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},{transition:a=e.getDefaultTransition(),transitionEnd:s,...o}=e.makeTargetAnimatable(t);const l=e.getValue("willChange");n&&(a=n);const c=[],u=r&&e.animationState&&e.animationState.getState()[r];for(const h in o){const t=e.getValue(h),n=o[h];if(!t||void 0===n||u&&Nr(u,h))continue;const r={delay:i,elapsed:0,...br(a||{},h)};if(window.HandoffAppearAnimations){const i=e.getProps()[Fe];if(i){const e=window.HandoffAppearAnimations(i,h,t,li);null!==e&&(r.elapsed=e,r.isHandoff=!0)}}let s=!r.isHandoff&&!Vr(t,n);if("spring"===r.type&&(t.getVelocity()||r.velocity)&&(s=!1),t.animation&&(s=!1),s)continue;t.start(Sr(h,t,n,e.shouldReduceMotion&&rt.has(h)?{type:!1}:r));const d=t.animation;Tr(l)&&(l.add(h),d.then((()=>l.remove(h)))),c.push(d)}return s&&Promise.all(c).then((()=>{s&&Br(e,s)})),c}function Ur(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const n=Bi(e,t,i.custom);let{transition:r=e.getDefaultTransition()||{}}=n||{};i.transitionOverride&&(r=i.transitionOverride);const a=n?()=>Promise.all(jr(e,n,i)):()=>Promise.resolve(),s=e.variantChildren&&e.variantChildren.size?function(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;const{delayChildren:a=0,staggerChildren:s,staggerDirection:o}=r;return function(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,a=arguments.length>5?arguments[5]:void 0;const s=[],o=(e.variantChildren.size-1)*n,l=1===r?function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)*n}:function(){return o-(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)*n};return Array.from(e.variantChildren).sort($r).forEach(((e,n)=>{e.notify("AnimationStart",t),s.push(Ur(e,t,{...a,delay:i+l(n)}).then((()=>e.notify("AnimationComplete",t))))})),Promise.all(s)}(e,t,a+n,s,o,i)}:()=>Promise.resolve(),{when:o}=r;if(o){const[e,t]="beforeChildren"===o?[a,s]:[s,a];return e().then((()=>t()))}return Promise.all([a(),s(i.delay)])}function $r(e,t){return e.sortNodePosition(t)}const qr=[...Ve].reverse(),Zr=Ve.length;function Gr(e){return t=>Promise.all(t.map((t=>{let{animation:i,options:n}=t;return function(e,t){let i,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(e.notify("AnimationStart",t),Array.isArray(t)){const r=t.map((t=>Ur(e,t,n)));i=Promise.all(r)}else if("string"===typeof t)i=Ur(e,t,n);else{const r="function"===typeof t?Bi(e,t,n.custom):t;i=Promise.all(jr(e,r,n))}return i.then((()=>e.notify("AnimationComplete",t)))}(e,i,n)})))}function Wr(e){let t=Gr(e);const i={animate:Xr(!0),whileInView:Xr(),whileHover:Xr(),whileTap:Xr(),whileDrag:Xr(),whileFocus:Xr(),exit:Xr()};let n=!0;const r=(t,i)=>{const n=Bi(e,i);if(n){const{transition:e,transitionEnd:i,...r}=n;t={...t,...r,...i}}return t};function a(a,s){const o=e.getProps(),l=e.getVariantContext(!0)||{},c=[],u=new Set;let h={},d=1/0;for(let t=0;t<Zr;t++){const p=qr[t],f=i[p],m=void 0!==o[p]?o[p]:l[p],g=Oe(m),y=p===s?f.isActive:null;!1===y&&(d=t);let _=m===l[p]&&m!==o[p]&&g;if(_&&n&&e.manuallyAnimateOnMount&&(_=!1),f.protectedKeys={...h},!f.isActive&&null===y||!m&&!f.prevProp||Ne(m)||"boolean"===typeof m)continue;let v=Hr(f.prevProp,m)||p===s&&f.isActive&&!_&&g||t>d&&g,x=!1;const b=Array.isArray(m)?m:[m];let w=b.reduce(r,{});!1===y&&(w={});const{prevResolvedValues:S={}}=f,T={...S,...w},k=e=>{v=!0,u.has(e)&&(x=!0,u.delete(e)),f.needsAnimating[e]=!0};for(const e in T){const t=w[e],i=S[e];if(h.hasOwnProperty(e))continue;let n=!1;n=ti(t)&&ti(i)?!Fi(t,i):t!==i,n?void 0!==t?k(e):u.add(e):void 0!==t&&u.has(e)?k(e):f.protectedKeys[e]=!0}f.prevProp=m,f.prevResolvedValues=w,f.isActive&&(h={...h,...w}),n&&e.blockInitialAnimation&&(v=!1),!v||_&&!x||c.push(...b.map((e=>({animation:e,options:{type:p,...a}}))))}if(u.size){const t={};u.forEach((i=>{const n=e.getBaseTarget(i);void 0!==n&&(t[i]=n)})),c.push({animation:t})}let p=Boolean(c.length);return!n||!1!==o.initial&&o.initial!==o.animate||e.manuallyAnimateOnMount||(p=!1),n=!1,p?t(c):Promise.resolve()}return{animateChanges:a,setActive:function(t,n,r){var s;if(i[t].isActive===n)return Promise.resolve();null===(s=e.variantChildren)||void 0===s||s.forEach((e=>{var i;return null===(i=e.animationState)||void 0===i?void 0:i.setActive(t,n)})),i[t].isActive=n;const o=a(r,t);for(const e in i)i[e].protectedKeys={};return o},setAnimateFunction:function(i){t=i(e)},getState:()=>i}}function Hr(e,t){return"string"===typeof t?t!==e:!!Array.isArray(t)&&!Fi(t,e)}function Xr(){return{isActive:arguments.length>0&&void 0!==arguments[0]&&arguments[0],protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}let Kr=0;const Yr={animation:{Feature:class extends ki{constructor(e){super(e),e.animationState||(e.animationState=Wr(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();this.unmount(),Ne(e)&&(this.unmount=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:t}=this.node.prevProps||{};e!==t&&this.updateAnimationControlsSubscription()}unmount(){}}},exit:{Feature:class extends ki{constructor(){super(...arguments),this.id=Kr++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:t,custom:i}=this.node.presenceContext,{isPresent:n}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===n)return;const r=this.node.animationState.setActive("exit",!e,{custom:null!==i&&void 0!==i?i:this.node.getProps().custom});t&&!e&&r.then((()=>t(this.id)))}mount(){const{register:e}=this.node.presenceContext||{};e&&(this.unmount=e(this.id))}unmount(){}}}},Jr=(e,t)=>Math.abs(e-t);class Qr{constructor(e,t){let{transformPagePoint:i,contextWindow:n,dragSnapToOrigin:r=!1}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!this.lastMoveEvent||!this.lastMoveEventInfo)return;const e=ia(this.lastMoveEventInfo,this.history),t=null!==this.startEvent,i=function(e,t){const i=Jr(e.x,t.x),n=Jr(e.y,t.y);return Math.sqrt(i**2+n**2)}(e.offset,{x:0,y:0})>=3;if(!t&&!i)return;const{point:n}=e,{timestamp:r}=ui;this.history.push({...n,timestamp:r});const{onStart:a,onMove:s}=this.handlers;t||(a&&a(this.lastMoveEvent,e),this.startEvent=this.lastMoveEvent),s&&s(this.lastMoveEvent,e)},this.handlePointerMove=(e,t)=>{this.lastMoveEvent=e,this.lastMoveEventInfo=ea(t,this.transformPagePoint),li.update(this.updatePoint,!0)},this.handlePointerUp=(e,t)=>{this.end();const{onEnd:i,onSessionEnd:n,resumeAnimation:r}=this.handlers;if(this.dragSnapToOrigin&&r&&r(),!this.lastMoveEvent||!this.lastMoveEventInfo)return;const a=ia("pointercancel"===e.type?this.lastMoveEventInfo:ea(t,this.transformPagePoint),this.history);this.startEvent&&i&&i(e,a),n&&n(e,a)},!mi(e))return;this.dragSnapToOrigin=r,this.handlers=t,this.transformPagePoint=i,this.contextWindow=n||window;const a=ea(gi(e),this.transformPagePoint),{point:s}=a,{timestamp:o}=ui;this.history=[{...s,timestamp:o}];const{onSessionStart:l}=t;l&&l(e,ia(a,this.history)),this.removeListeners=vi(yi(this.contextWindow,"pointermove",this.handlePointerMove),yi(this.contextWindow,"pointerup",this.handlePointerUp),yi(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),ci(this.updatePoint)}}function ea(e,t){return t?{point:t(e.point)}:e}function ta(e,t){return{x:e.x-t.x,y:e.y-t.y}}function ia(e,t){let{point:i}=e;return{point:i,delta:ta(i,ra(t)),offset:ta(i,na(t)),velocity:aa(t,.1)}}function na(e){return e[0]}function ra(e){return e[e.length-1]}function aa(e,t){if(e.length<2)return{x:0,y:0};let i=e.length-1,n=null;const r=ra(e);for(;i>=0&&(n=e[i],!(r.timestamp-n.timestamp>Vi(t)));)i--;if(!n)return{x:0,y:0};const a=ji(r.timestamp-n.timestamp);if(0===a)return{x:0,y:0};const s={x:(r.x-n.x)/a,y:(r.y-n.y)/a};return s.x===1/0&&(s.x=0),s.y===1/0&&(s.y=0),s}function sa(e){return e.max-e.min}function oa(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.01;return Math.abs(e-t)<=i}function la(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5;e.origin=n,e.originPoint=yn(t.min,t.max,e.origin),e.scale=sa(i)/sa(t),(oa(e.scale,1,1e-4)||isNaN(e.scale))&&(e.scale=1),e.translate=yn(i.min,i.max,e.origin)-e.originPoint,(oa(e.translate)||isNaN(e.translate))&&(e.translate=0)}function ca(e,t,i,n){la(e.x,t.x,i.x,n?n.originX:void 0),la(e.y,t.y,i.y,n?n.originY:void 0)}function ua(e,t,i){e.min=i.min+t.min,e.max=e.min+sa(t)}function ha(e,t,i){e.min=t.min-i.min,e.max=e.min+sa(t)}function da(e,t,i){ha(e.x,t.x,i.x),ha(e.y,t.y,i.y)}function pa(e,t,i){return{min:void 0!==t?e.min+t:void 0,max:void 0!==i?e.max+i-(e.max-e.min):void 0}}function fa(e,t){let i=t.min-e.min,n=t.max-e.max;return t.max-t.min<e.max-e.min&&([i,n]=[n,i]),{min:i,max:n}}const ma=.35;function ga(e,t,i){return{min:ya(e,t),max:ya(e,i)}}function ya(e,t){return"number"===typeof e?e:e[t]||0}function _a(e){return[e("x"),e("y")]}function va(e){let{top:t,left:i,right:n,bottom:r}=e;return{x:{min:i,max:n},y:{min:t,max:r}}}function xa(e){return void 0===e||1===e}function ba(e){let{scale:t,scaleX:i,scaleY:n}=e;return!xa(t)||!xa(i)||!xa(n)}function wa(e){return ba(e)||Sa(e)||e.z||e.rotate||e.rotateX||e.rotateY}function Sa(e){return Ta(e.x)||Ta(e.y)}function Ta(e){return e&&"0%"!==e}function ka(e,t,i){return i+t*(e-i)}function Ea(e,t,i,n,r){return void 0!==r&&(e=ka(e,r,n)),ka(e,i,n)+t}function Pa(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=arguments.length>3?arguments[3]:void 0,r=arguments.length>4?arguments[4]:void 0;e.min=Ea(e.min,t,i,n,r),e.max=Ea(e.max,t,i,n,r)}function Ca(e,t){let{x:i,y:n}=t;Pa(e.x,i.translate,i.scale,i.originPoint),Pa(e.y,n.translate,n.scale,n.originPoint)}function Ia(e){return Number.isInteger(e)||e>1.0000000000001||e<.999999999999?e:1}function Aa(e,t){e.min=e.min+t,e.max=e.max+t}function Ma(e,t,i){let[n,r,a]=i;const s=void 0!==t[a]?t[a]:.5,o=yn(e.min,e.max,s);Pa(e,t[n],t[r],o,t.scale)}const za=["x","scaleX","originX"],Da=["y","scaleY","originY"];function La(e,t){Ma(e.x,t,za),Ma(e.y,t,Da)}function Ra(e,t){return va(function(e,t){if(!t)return e;const i=t({x:e.left,y:e.top}),n=t({x:e.right,y:e.bottom});return{top:i.y,left:i.x,bottom:n.y,right:n.x}}(e.getBoundingClientRect(),t))}const Fa=e=>{let{current:t}=e;return t?t.ownerDocument.defaultView:null},Ba=new WeakMap;class Oa{constructor(e){this.openGlobalLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic={x:{min:0,max:0},y:{min:0,max:0}},this.visualElement=e}start(e){let{snapToCursor:t=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{presenceContext:i}=this.visualElement;if(i&&!1===i.isPresent)return;const{dragSnapToOrigin:n}=this.getProps();this.panSession=new Qr(e,{onSessionStart:e=>{const{dragSnapToOrigin:i}=this.getProps();i?this.pauseAnimation():this.stopAnimation(),t&&this.snapToCursor(gi(e,"page").point)},onStart:(e,t)=>{const{drag:i,dragPropagation:n,onDragStart:r}=this.getProps();if(i&&!n&&(this.openGlobalLock&&this.openGlobalLock(),this.openGlobalLock=Si(i),!this.openGlobalLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),_a((e=>{let t=this.getAxisMotionValue(e).get()||0;if(Tt.test(t)){const{projection:i}=this.visualElement;if(i&&i.layout){const n=i.layout.layoutBox[e];if(n){t=sa(n)*(parseFloat(t)/100)}}}this.originPoint[e]=t})),r&&li.update((()=>r(e,t)),!1,!0);const{animationState:a}=this.visualElement;a&&a.setActive("whileDrag",!0)},onMove:(e,t)=>{const{dragPropagation:i,dragDirectionLock:n,onDirectionLock:r,onDrag:a}=this.getProps();if(!i&&!this.openGlobalLock)return;const{offset:s}=t;if(n&&null===this.currentDirection)return this.currentDirection=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,i=null;Math.abs(e.y)>t?i="y":Math.abs(e.x)>t&&(i="x");return i}(s),void(null!==this.currentDirection&&r&&r(this.currentDirection));this.updateAxis("x",t.point,s),this.updateAxis("y",t.point,s),this.visualElement.render(),a&&a(e,t)},onSessionEnd:(e,t)=>this.stop(e,t),resumeAnimation:()=>_a((e=>{var t;return"paused"===this.getAnimationState(e)&&(null===(t=this.getAxisMotionValue(e).animation)||void 0===t?void 0:t.play())}))},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:n,contextWindow:Fa(this.visualElement)})}stop(e,t){const i=this.isDragging;if(this.cancel(),!i)return;const{velocity:n}=t;this.startAnimation(n);const{onDragEnd:r}=this.getProps();r&&li.update((()=>r(e,t)))}cancel(){this.isDragging=!1;const{projection:e,animationState:t}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:i}=this.getProps();!i&&this.openGlobalLock&&(this.openGlobalLock(),this.openGlobalLock=null),t&&t.setActive("whileDrag",!1)}updateAxis(e,t,i){const{drag:n}=this.getProps();if(!i||!Na(e,n,this.currentDirection))return;const r=this.getAxisMotionValue(e);let a=this.originPoint[e]+i[e];this.constraints&&this.constraints[e]&&(a=function(e,t,i){let{min:n,max:r}=t;return void 0!==n&&e<n?e=i?yn(n,e,i.min):Math.max(e,n):void 0!==r&&e>r&&(e=i?yn(r,e,i.max):Math.min(e,r)),e}(a,this.constraints[e],this.elastic[e])),r.set(a)}resolveConstraints(){var e;const{dragConstraints:t,dragElastic:i}=this.getProps(),n=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):null===(e=this.visualElement.projection)||void 0===e?void 0:e.layout,r=this.constraints;t&&Be(t)?this.constraints||(this.constraints=this.resolveRefConstraints()):this.constraints=!(!t||!n)&&function(e,t){let{top:i,left:n,bottom:r,right:a}=t;return{x:pa(e.x,n,a),y:pa(e.y,i,r)}}(n.layoutBox,t),this.elastic=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ma;return!1===e?e=0:!0===e&&(e=ma),{x:ga(e,"left","right"),y:ga(e,"top","bottom")}}(i),r!==this.constraints&&n&&this.constraints&&!this.hasMutatedConstraints&&_a((e=>{this.getAxisMotionValue(e)&&(this.constraints[e]=function(e,t){const i={};return void 0!==t.min&&(i.min=t.min-e.min),void 0!==t.max&&(i.max=t.max-e.min),i}(n.layoutBox[e],this.constraints[e]))}))}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:t}=this.getProps();if(!e||!Be(e))return!1;const i=e.current;Ni(null!==i,"If `dragConstraints` is set as a React ref, that ref must be passed to another component's `ref` prop.");const{projection:n}=this.visualElement;if(!n||!n.layout)return!1;const r=function(e,t,i){const n=Ra(e,i),{scroll:r}=t;return r&&(Aa(n.x,r.offset.x),Aa(n.y,r.offset.y)),n}(i,n.root,this.visualElement.getTransformPagePoint());let a=function(e,t){return{x:fa(e.x,t.x),y:fa(e.y,t.y)}}(n.layout.layoutBox,r);if(t){const e=t(function(e){let{x:t,y:i}=e;return{top:i.min,right:t.max,bottom:i.max,left:t.min}}(a));this.hasMutatedConstraints=!!e,e&&(a=va(e))}return a}startAnimation(e){const{drag:t,dragMomentum:i,dragElastic:n,dragTransition:r,dragSnapToOrigin:a,onDragTransitionEnd:s}=this.getProps(),o=this.constraints||{},l=_a((s=>{if(!Na(s,t,this.currentDirection))return;let l=o&&o[s]||{};a&&(l={min:0,max:0});const c=n?200:1e6,u=n?40:1e7,h={type:"inertia",velocity:i?e[s]:0,bounceStiffness:c,bounceDamping:u,timeConstant:750,restDelta:1,restSpeed:10,...r,...l};return this.startAxisValueAnimation(s,h)}));return Promise.all(l).then(s)}startAxisValueAnimation(e,t){const i=this.getAxisMotionValue(e);return i.start(Sr(e,i,0,t))}stopAnimation(){_a((e=>this.getAxisMotionValue(e).stop()))}pauseAnimation(){_a((e=>{var t;return null===(t=this.getAxisMotionValue(e).animation)||void 0===t?void 0:t.pause()}))}getAnimationState(e){var t;return null===(t=this.getAxisMotionValue(e).animation)||void 0===t?void 0:t.state}getAxisMotionValue(e){const t="_drag"+e.toUpperCase(),i=this.visualElement.getProps(),n=i[t];return n||this.visualElement.getValue(e,(i.initial?i.initial[e]:void 0)||0)}snapToCursor(e){_a((t=>{const{drag:i}=this.getProps();if(!Na(t,i,this.currentDirection))return;const{projection:n}=this.visualElement,r=this.getAxisMotionValue(t);if(n&&n.layout){const{min:i,max:a}=n.layout.layoutBox[t];r.set(e[t]-yn(i,a,.5))}}))}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:t}=this.getProps(),{projection:i}=this.visualElement;if(!Be(t)||!i||!this.constraints)return;this.stopAnimation();const n={x:0,y:0};_a((e=>{const t=this.getAxisMotionValue(e);if(t){const i=t.get();n[e]=function(e,t){let i=.5;const n=sa(e),r=sa(t);return r>n?i=Bn(t.min,t.max-n,e.min):n>r&&(i=Bn(e.min,e.max-r,t.min)),pt(0,1,i)}({min:i,max:i},this.constraints[e])}}));const{transformTemplate:r}=this.visualElement.getProps();this.visualElement.current.style.transform=r?r({},""):"none",i.root&&i.root.updateScroll(),i.updateLayout(),this.resolveConstraints(),_a((t=>{if(!Na(t,e,null))return;const i=this.getAxisMotionValue(t),{min:r,max:a}=this.constraints[t];i.set(yn(r,a,n[t]))}))}addListeners(){if(!this.visualElement.current)return;Ba.set(this.visualElement,this);const e=yi(this.visualElement.current,"pointerdown",(e=>{const{drag:t,dragListener:i=!0}=this.getProps();t&&i&&this.start(e)})),t=()=>{const{dragConstraints:e}=this.getProps();Be(e)&&(this.constraints=this.resolveRefConstraints())},{projection:i}=this.visualElement,n=i.addEventListener("measure",t);i&&!i.layout&&(i.root&&i.root.updateScroll(),i.updateLayout()),t();const r=fi(window,"resize",(()=>this.scalePositionWithinConstraints())),a=i.addEventListener("didUpdate",(e=>{let{delta:t,hasLayoutChanged:i}=e;this.isDragging&&i&&(_a((e=>{const i=this.getAxisMotionValue(e);i&&(this.originPoint[e]+=t[e].translate,i.set(i.get()+t[e].translate))})),this.visualElement.render())}));return()=>{r(),e(),n(),a&&a()}}getProps(){const e=this.visualElement.getProps(),{drag:t=!1,dragDirectionLock:i=!1,dragPropagation:n=!1,dragConstraints:r=!1,dragElastic:a=ma,dragMomentum:s=!0}=e;return{...e,drag:t,dragDirectionLock:i,dragPropagation:n,dragConstraints:r,dragElastic:a,dragMomentum:s}}}function Na(e,t,i){return(!0===t||t===e)&&(null===i||i===e)}const Va=e=>(t,i)=>{e&&li.update((()=>e(t,i)))};const ja={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function Ua(e,t){return t.max===t.min?0:e/(t.max-t.min)*100}const $a={correct:(e,t)=>{if(!t.target)return e;if("string"===typeof e){if(!kt.test(e))return e;e=parseFloat(e)}return`${Ua(e,t.target.x)}% ${Ua(e,t.target.y)}%`}},qa={correct:(e,t)=>{let{treeScale:i,projectionDelta:n}=t;const r=e,a=Mn.parse(e);if(a.length>5)return r;const s=Mn.createTransformer(e),o="number"!==typeof a[0]?1:0,l=n.x.scale*i.x,c=n.y.scale*i.y;a[0+o]/=l,a[1+o]/=c;const u=yn(l,c,.5);return"number"===typeof a[2+o]&&(a[2+o]/=u),"number"===typeof a[3+o]&&(a[3+o]/=u),s(a)}};class Za extends t.Component{componentDidMount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:i,layoutId:n}=this.props,{projection:r}=e;var a;a=Wa,Object.assign(it,a),r&&(t.group&&t.group.add(r),i&&i.register&&n&&i.register(r),r.root.didUpdate(),r.addEventListener("animationComplete",(()=>{this.safeToRemove()})),r.setOptions({...r.options,onExitComplete:()=>this.safeToRemove()})),ja.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:t,visualElement:i,drag:n,isPresent:r}=this.props,a=i.projection;return a?(a.isPresent=r,n||e.layoutDependency!==t||void 0===t?a.willUpdate():this.safeToRemove(),e.isPresent!==r&&(r?a.promote():a.relegate()||li.postRender((()=>{const e=a.getStack();e&&e.members.length||this.safeToRemove()}))),null):null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),queueMicrotask((()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()})))}componentWillUnmount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:i}=this.props,{projection:n}=e;n&&(n.scheduleCheckAfterUnmount(),t&&t.group&&t.group.remove(n),i&&i.deregister&&i.deregister(n))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function Ga(e){const[i,n]=function(){const e=(0,t.useContext)(Me);if(null===e)return[!0,null];const{isPresent:i,onExitComplete:n,register:r}=e,a=(0,t.useId)();return(0,t.useEffect)((()=>r(a)),[]),!i&&n?[!1,()=>n&&n(a)]:[!0]}(),r=(0,t.useContext)(He);return t.createElement(Za,{...e,layoutGroup:r,switchLayoutGroup:(0,t.useContext)(Xe),isPresent:i,safeToRemove:n})}const Wa={borderRadius:{...$a,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:$a,borderTopRightRadius:$a,borderBottomLeftRadius:$a,borderBottomRightRadius:$a,boxShadow:qa},Ha=["TopLeft","TopRight","BottomLeft","BottomRight"],Xa=Ha.length,Ka=e=>"string"===typeof e?parseFloat(e):e,Ya=e=>"number"===typeof e||kt.test(e);function Ja(e,t){return void 0!==e[t]?e[t]:e.borderRadius}const Qa=ts(0,.5,nn),es=ts(.5,.95,ai);function ts(e,t,i){return n=>n<e?0:n>t?1:i(Bn(e,t,n))}function is(e,t){e.min=t.min,e.max=t.max}function ns(e,t){is(e.x,t.x),is(e.y,t.y)}function rs(e,t,i,n,r){return e=ka(e-=t,1/i,n),void 0!==r&&(e=ka(e,1/r,n)),e}function as(e,t,i,n,r){let[a,s,o]=i;!function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,r=arguments.length>4?arguments[4]:void 0,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:e,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:e;Tt.test(t)&&(t=parseFloat(t),t=yn(s.min,s.max,t/100)-s.min);if("number"!==typeof t)return;let o=yn(a.min,a.max,n);e===a&&(o-=t),e.min=rs(e.min,t,i,o,r),e.max=rs(e.max,t,i,o,r)}(e,t[a],t[s],t[o],t.scale,n,r)}const ss=["x","scaleX","originX"],os=["y","scaleY","originY"];function ls(e,t,i,n){as(e.x,t,ss,i?i.x:void 0,n?n.x:void 0),as(e.y,t,os,i?i.y:void 0,n?n.y:void 0)}function cs(e){return 0===e.translate&&1===e.scale}function us(e){return cs(e.x)&&cs(e.y)}function hs(e,t){return Math.round(e.x.min)===Math.round(t.x.min)&&Math.round(e.x.max)===Math.round(t.x.max)&&Math.round(e.y.min)===Math.round(t.y.min)&&Math.round(e.y.max)===Math.round(t.y.max)}function ds(e){return sa(e.x)/sa(e.y)}class ps{constructor(){this.members=[]}add(e){Er(this.members,e),e.scheduleRender()}remove(e){if(Pr(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const e=this.members[this.members.length-1];e&&this.promote(e)}}relegate(e){const t=this.members.findIndex((t=>e===t));if(0===t)return!1;let i;for(let n=t;n>=0;n--){const e=this.members[n];if(!1!==e.isPresent){i=e;break}}return!!i&&(this.promote(i),!0)}promote(e,t){const i=this.lead;if(e!==i&&(this.prevLead=i,this.lead=e,e.show(),i)){i.instance&&i.scheduleRender(),e.scheduleRender(),e.resumeFrom=i,t&&(e.resumeFrom.preserveOpacity=!0),i.snapshot&&(e.snapshot=i.snapshot,e.snapshot.latestValues=i.animationValues||i.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:n}=e.options;!1===n&&i.hide()}}exitAnimationComplete(){this.members.forEach((e=>{const{options:t,resumingFrom:i}=e;t.onExitComplete&&t.onExitComplete(),i&&i.options.onExitComplete&&i.options.onExitComplete()}))}scheduleRender(){this.members.forEach((e=>{e.instance&&e.scheduleRender(!1)}))}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function fs(e,t,i){let n="";const r=e.x.translate/t.x,a=e.y.translate/t.y;if((r||a)&&(n=`translate3d(${r}px, ${a}px, 0) `),1===t.x&&1===t.y||(n+=`scale(${1/t.x}, ${1/t.y}) `),i){const{rotate:e,rotateX:t,rotateY:r}=i;e&&(n+=`rotate(${e}deg) `),t&&(n+=`rotateX(${t}deg) `),r&&(n+=`rotateY(${r}deg) `)}const s=e.x.scale*t.x,o=e.y.scale*t.y;return 1===s&&1===o||(n+=`scale(${s}, ${o})`),n||"none"}const ms=(e,t)=>e.depth-t.depth;class gs{constructor(){this.children=[],this.isDirty=!1}add(e){Er(this.children,e),this.isDirty=!0}remove(e){Pr(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(ms),this.isDirty=!1,this.children.forEach(e)}}const ys=["","X","Y","Z"],_s={visibility:"hidden"};let vs=0;const xs={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0};function bs(e){let{attachResizeListener:t,defaultParent:i,measureScroll:n,checkIsScrollRoot:r,resetTransform:a}=e;return class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null===i||void 0===i?void 0:i();this.id=vs++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,xs.totalNodes=xs.resolvedTargetDeltas=xs.recalculatedProjection=0,this.nodes.forEach(Ts),this.nodes.forEach(Ms),this.nodes.forEach(zs),this.nodes.forEach(ks),function(e){window.MotionDebug&&window.MotionDebug.record(e)}(xs)},this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=e,this.root=t?t.root||t:this,this.path=t?[...t.path,t]:[],this.parent=t,this.depth=t?t.depth+1:0;for(let i=0;i<this.path.length;i++)this.path[i].shouldResetTransform=!0;this.root===this&&(this.nodes=new gs)}addEventListener(e,t){return this.eventHandlers.has(e)||this.eventHandlers.set(e,new Cr),this.eventHandlers.get(e).add(t)}notifyListeners(e){const t=this.eventHandlers.get(e);for(var i=arguments.length,n=new Array(i>1?i-1:0),r=1;r<i;r++)n[r-1]=arguments[r];t&&t.notify(...n)}hasListeners(e){return this.eventHandlers.has(e)}mount(e){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.root.hasTreeAnimated;if(this.instance)return;var n;this.isSVG=(n=e)instanceof SVGElement&&"svg"!==n.tagName,this.instance=e;const{layoutId:r,layout:a,visualElement:s}=this.options;if(s&&!s.current&&s.mount(e),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),i&&(a||r)&&(this.isLayoutDirty=!0),t){let i;const n=()=>this.root.updateBlockedByResize=!1;t(e,(()=>{this.root.updateBlockedByResize=!0,i&&i(),i=function(e,t){const i=performance.now(),n=r=>{let{timestamp:a}=r;const s=a-i;s>=t&&(ci(n),e(s-t))};return li.read(n,!0),()=>ci(n)}(n,250),ja.hasAnimatedSinceResize&&(ja.hasAnimatedSinceResize=!1,this.nodes.forEach(As))}))}r&&this.root.registerSharedNode(r,this),!1!==this.options.animate&&s&&(r||a)&&this.addEventListener("didUpdate",(e=>{let{delta:t,hasLayoutChanged:i,hasRelativeTargetChanged:n,layout:r}=e;if(this.isTreeAnimationBlocked())return this.target=void 0,void(this.relativeTarget=void 0);const a=this.options.transition||s.getDefaultTransition()||Os,{onLayoutAnimationStart:o,onLayoutAnimationComplete:l}=s.getProps(),c=!this.targetLayout||!hs(this.targetLayout,r)||n,u=!i&&n;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||u||i&&(c||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(t,u);const e={...br(a,"layout"),onPlay:o,onComplete:l};(s.shouldReduceMotion||this.options.layoutRoot)&&(e.delay=0,e.type=!1),this.startAnimation(e)}else i||As(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=r}))}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const e=this.getStack();e&&e.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,ci(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(Ds),this.animationId++)}getTransformTemplate(){const{visualElement:e}=this.options;return e&&e.getProps().transformTemplate}willUpdate(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked())return void(this.options.onExitComplete&&this.options.onExitComplete());if(!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let r=0;r<this.path.length;r++){const e=this.path[r];e.shouldResetTransform=!0,e.updateScroll("snapshot"),e.options.layoutRoot&&e.willUpdate(!1)}const{layoutId:t,layout:i}=this.options;if(void 0===t&&!i)return;const n=this.getTransformTemplate();this.prevTransformTemplateValue=n?n(this.latestValues,""):void 0,this.updateSnapshot(),e&&this.notifyListeners("willUpdate")}update(){this.updateScheduled=!1;if(this.isUpdateBlocked())return this.unblockUpdate(),this.clearAllSnapshots(),void this.nodes.forEach(Ps);this.isUpdating||this.nodes.forEach(Cs),this.isUpdating=!1,this.nodes.forEach(Is),this.nodes.forEach(ws),this.nodes.forEach(Ss),this.clearAllSnapshots();const e=performance.now();ui.delta=pt(0,1e3/60,e-ui.timestamp),ui.timestamp=e,ui.isProcessing=!0,hi.update.process(ui),hi.preRender.process(ui),hi.render.process(ui),ui.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,queueMicrotask((()=>this.update())))}clearAllSnapshots(){this.nodes.forEach(Es),this.sharedNodes.forEach(Ls)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,li.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){li.postRender((()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()}))}updateSnapshot(){!this.snapshot&&this.instance&&(this.snapshot=this.measure())}updateLayout(){if(!this.instance)return;if(this.updateScroll(),(!this.options.alwaysMeasureLayout||!this.isLead())&&!this.isLayoutDirty)return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let i=0;i<this.path.length;i++){this.path[i].updateScroll()}const e=this.layout;this.layout=this.measure(!1),this.layoutCorrected={x:{min:0,max:0},y:{min:0,max:0}},this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:t}=this.options;t&&t.notify("LayoutMeasure",this.layout.layoutBox,e?e.layoutBox:void 0)}updateScroll(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"measure",t=Boolean(this.options.layoutScroll&&this.instance);this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===e&&(t=!1),t&&(this.scroll={animationId:this.root.animationId,phase:e,isRoot:r(this.instance),offset:n(this.instance)})}resetTransform(){if(!a)return;const e=this.isLayoutDirty||this.shouldResetTransform,t=this.projectionDelta&&!us(this.projectionDelta),i=this.getTransformTemplate(),n=i?i(this.latestValues,""):void 0,r=n!==this.prevTransformTemplateValue;e&&(t||wa(this.latestValues)||r)&&(a(this.instance,n),this.shouldResetTransform=!1,this.scheduleRender())}measure(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];const t=this.measurePageBox();let i=this.removeElementScroll(t);var n;return e&&(i=this.removeTransform(i)),js((n=i).x),js(n.y),{animationId:this.root.animationId,measuredBox:t,layoutBox:i,latestValues:{},source:this.id}}measurePageBox(){const{visualElement:e}=this.options;if(!e)return{x:{min:0,max:0},y:{min:0,max:0}};const t=e.measureViewportBox(),{scroll:i}=this.root;return i&&(Aa(t.x,i.offset.x),Aa(t.y,i.offset.y)),t}removeElementScroll(e){const t={x:{min:0,max:0},y:{min:0,max:0}};ns(t,e);for(let i=0;i<this.path.length;i++){const n=this.path[i],{scroll:r,options:a}=n;if(n!==this.root&&r&&a.layoutScroll){if(r.isRoot){ns(t,e);const{scroll:i}=this.root;i&&(Aa(t.x,-i.offset.x),Aa(t.y,-i.offset.y))}Aa(t.x,r.offset.x),Aa(t.y,r.offset.y)}}return t}applyTransform(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const i={x:{min:0,max:0},y:{min:0,max:0}};ns(i,e);for(let n=0;n<this.path.length;n++){const e=this.path[n];!t&&e.options.layoutScroll&&e.scroll&&e!==e.root&&La(i,{x:-e.scroll.offset.x,y:-e.scroll.offset.y}),wa(e.latestValues)&&La(i,e.latestValues)}return wa(this.latestValues)&&La(i,this.latestValues),i}removeTransform(e){const t={x:{min:0,max:0},y:{min:0,max:0}};ns(t,e);for(let i=0;i<this.path.length;i++){const e=this.path[i];if(!e.instance)continue;if(!wa(e.latestValues))continue;ba(e.latestValues)&&e.updateSnapshot();const n={x:{min:0,max:0},y:{min:0,max:0}};ns(n,e.measurePageBox()),ls(t,e.latestValues,e.snapshot?e.snapshot.layoutBox:void 0,n)}return wa(this.latestValues)&&ls(t,this.latestValues),t}setTargetDelta(e){this.targetDelta=e,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(e){this.options={...this.options,...e,crossfade:void 0===e.crossfade||e.crossfade}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==ui.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];var t;const i=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=i.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=i.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=i.isSharedProjectionDirty);const n=Boolean(this.resumingFrom)||this!==i;if(!(e||n&&this.isSharedProjectionDirty||this.isProjectionDirty||(null===(t=this.parent)||void 0===t?void 0:t.isProjectionDirty)||this.attemptToResolveRelativeTarget))return;const{layout:r,layoutId:a}=this.options;if(this.layout&&(r||a)){if(this.resolvedRelativeTargetAt=ui.timestamp,!this.targetDelta&&!this.relativeTarget){const e=this.getClosestProjectingParent();e&&e.layout&&1!==this.animationProgress?(this.relativeParent=e,this.forceRelativeParentToResolveTarget(),this.relativeTarget={x:{min:0,max:0},y:{min:0,max:0}},this.relativeTargetOrigin={x:{min:0,max:0},y:{min:0,max:0}},da(this.relativeTargetOrigin,this.layout.layoutBox,e.layout.layoutBox),ns(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(this.relativeTarget||this.targetDelta){var s,o,l;if(this.target||(this.target={x:{min:0,max:0},y:{min:0,max:0}},this.targetWithTransforms={x:{min:0,max:0},y:{min:0,max:0}}),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),s=this.target,o=this.relativeTarget,l=this.relativeParent.target,ua(s.x,o.x,l.x),ua(s.y,o.y,l.y)):this.targetDelta?(Boolean(this.resumingFrom)?this.target=this.applyTransform(this.layout.layoutBox):ns(this.target,this.layout.layoutBox),Ca(this.target,this.targetDelta)):ns(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const e=this.getClosestProjectingParent();e&&Boolean(e.resumingFrom)===Boolean(this.resumingFrom)&&!e.options.layoutScroll&&e.target&&1!==this.animationProgress?(this.relativeParent=e,this.forceRelativeParentToResolveTarget(),this.relativeTarget={x:{min:0,max:0},y:{min:0,max:0}},this.relativeTargetOrigin={x:{min:0,max:0},y:{min:0,max:0}},da(this.relativeTargetOrigin,this.target,e.target),ns(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}xs.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(this.parent&&!ba(this.parent.latestValues)&&!Sa(this.parent.latestValues))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return Boolean((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var e;const t=this.getLead(),i=Boolean(this.resumingFrom)||this!==t;let n=!0;if((this.isProjectionDirty||(null===(e=this.parent)||void 0===e?void 0:e.isProjectionDirty))&&(n=!1),i&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(n=!1),this.resolvedRelativeTargetAt===ui.timestamp&&(n=!1),n)return;const{layout:r,layoutId:a}=this.options;if(this.isTreeAnimating=Boolean(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!r&&!a)return;ns(this.layoutCorrected,this.layout.layoutBox);const s=this.treeScale.x,o=this.treeScale.y;!function(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const r=i.length;if(!r)return;let a,s;t.x=t.y=1;for(let o=0;o<r;o++){a=i[o],s=a.projectionDelta;const r=a.instance;r&&r.style&&"contents"===r.style.display||(n&&a.options.layoutScroll&&a.scroll&&a!==a.root&&La(e,{x:-a.scroll.offset.x,y:-a.scroll.offset.y}),s&&(t.x*=s.x.scale,t.y*=s.y.scale,Ca(e,s)),n&&wa(a.latestValues)&&La(e,a.latestValues))}t.x=Ia(t.x),t.y=Ia(t.y)}(this.layoutCorrected,this.treeScale,this.path,i),!t.layout||t.target||1===this.treeScale.x&&1===this.treeScale.y||(t.target=t.layout.layoutBox);const{target:l}=t;if(!l)return void(this.projectionTransform&&(this.projectionDelta={x:{translate:0,scale:1,origin:0,originPoint:0},y:{translate:0,scale:1,origin:0,originPoint:0}},this.projectionTransform="none",this.scheduleRender()));this.projectionDelta||(this.projectionDelta={x:{translate:0,scale:1,origin:0,originPoint:0},y:{translate:0,scale:1,origin:0,originPoint:0}},this.projectionDeltaWithTransform={x:{translate:0,scale:1,origin:0,originPoint:0},y:{translate:0,scale:1,origin:0,originPoint:0}});const c=this.projectionTransform;ca(this.projectionDelta,this.layoutCorrected,l,this.latestValues),this.projectionTransform=fs(this.projectionDelta,this.treeScale),this.projectionTransform===c&&this.treeScale.x===s&&this.treeScale.y===o||(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",l)),xs.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(this.options.scheduleRender&&this.options.scheduleRender(),e){const e=this.getStack();e&&e.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}setAnimationOrigin(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const i=this.snapshot,n=i?i.latestValues:{},r={...this.latestValues},a={x:{translate:0,scale:1,origin:0,originPoint:0},y:{translate:0,scale:1,origin:0,originPoint:0}};this.relativeParent&&this.relativeParent.options.layoutRoot||(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!t;const s={x:{min:0,max:0},y:{min:0,max:0}},o=(i?i.source:void 0)!==(this.layout?this.layout.source:void 0),l=this.getStack(),c=!l||l.members.length<=1,u=Boolean(o&&!c&&!0===this.options.crossfade&&!this.path.some(Bs));let h;this.animationProgress=0,this.mixTargetDelta=t=>{const i=t/1e3;var l,d,p,f,m,g;Rs(a.x,e.x,i),Rs(a.y,e.y,i),this.setTargetDelta(a),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(da(s,this.layout.layoutBox,this.relativeParent.layout.layoutBox),p=this.relativeTarget,f=this.relativeTargetOrigin,m=s,g=i,Fs(p.x,f.x,m.x,g),Fs(p.y,f.y,m.y,g),h&&(l=this.relativeTarget,d=h,l.x.min===d.x.min&&l.x.max===d.x.max&&l.y.min===d.y.min&&l.y.max===d.y.max)&&(this.isProjectionDirty=!1),h||(h={x:{min:0,max:0},y:{min:0,max:0}}),ns(h,this.relativeTarget)),o&&(this.animationValues=r,function(e,t,i,n,r,a){r?(e.opacity=yn(0,void 0!==i.opacity?i.opacity:1,Qa(n)),e.opacityExit=yn(void 0!==t.opacity?t.opacity:1,0,es(n))):a&&(e.opacity=yn(void 0!==t.opacity?t.opacity:1,void 0!==i.opacity?i.opacity:1,n));for(let s=0;s<Xa;s++){const r=`border${Ha[s]}Radius`;let a=Ja(t,r),o=Ja(i,r);void 0===a&&void 0===o||(a||(a=0),o||(o=0),0===a||0===o||Ya(a)===Ya(o)?(e[r]=Math.max(yn(Ka(a),Ka(o),n),0),(Tt.test(o)||Tt.test(a))&&(e[r]+="%")):e[r]=o)}(t.rotate||i.rotate)&&(e.rotate=yn(t.rotate||0,i.rotate||0,n))}(r,n,this.latestValues,i,u,c)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=i},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(e){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(ci(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=li.update((()=>{ja.hasAnimatedSinceResize=!0,this.currentAnimation=function(e,t,i){const n=st(e)?e:Mr(e);return n.start(Sr("",n,t,i)),n.animation}(0,1e3,{...e,onUpdate:t=>{this.mixTargetDelta(t),e.onUpdate&&e.onUpdate(t)},onComplete:()=>{e.onComplete&&e.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0}))}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const e=this.getStack();e&&e.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(1e3),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const e=this.getLead();let{targetWithTransforms:t,target:i,layout:n,latestValues:r}=e;if(t&&i&&n){if(this!==e&&this.layout&&n&&Us(this.options.animationType,this.layout.layoutBox,n.layoutBox)){i=this.target||{x:{min:0,max:0},y:{min:0,max:0}};const t=sa(this.layout.layoutBox.x);i.x.min=e.target.x.min,i.x.max=i.x.min+t;const n=sa(this.layout.layoutBox.y);i.y.min=e.target.y.min,i.y.max=i.y.min+n}ns(t,i),La(t,r),ca(this.projectionDeltaWithTransform,this.layoutCorrected,t,r)}}registerSharedNode(e,t){this.sharedNodes.has(e)||this.sharedNodes.set(e,new ps);this.sharedNodes.get(e).add(t);const i=t.options.initialPromotionConfig;t.promote({transition:i?i.transition:void 0,preserveFollowOpacity:i&&i.shouldPreserveFollowOpacity?i.shouldPreserveFollowOpacity(t):void 0})}isLead(){const e=this.getStack();return!e||e.lead===this}getLead(){var e;const{layoutId:t}=this.options;return t&&(null===(e=this.getStack())||void 0===e?void 0:e.lead)||this}getPrevLead(){var e;const{layoutId:t}=this.options;return t?null===(e=this.getStack())||void 0===e?void 0:e.prevLead:void 0}getStack(){const{layoutId:e}=this.options;if(e)return this.root.sharedNodes.get(e)}promote(){let{needsReset:e,transition:t,preserveFollowOpacity:i}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const n=this.getStack();n&&n.promote(this,i),e&&(this.projectionDelta=void 0,this.needsReset=!0),t&&this.setOptions({transition:t})}relegate(){const e=this.getStack();return!!e&&e.relegate(this)}resetRotation(){const{visualElement:e}=this.options;if(!e)return;let t=!1;const{latestValues:i}=e;if((i.rotate||i.rotateX||i.rotateY||i.rotateZ)&&(t=!0),!t)return;const n={};for(let r=0;r<ys.length;r++){const t="rotate"+ys[r];i[t]&&(n[t]=i[t],e.setStaticValue(t,0))}e.render();for(const r in n)e.setStaticValue(r,n[r]);e.scheduleRender()}getProjectionStyles(e){var t,i;if(!this.instance||this.isSVG)return;if(!this.isVisible)return _s;const n={visibility:""},r=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,n.opacity="",n.pointerEvents=ii(null===e||void 0===e?void 0:e.pointerEvents)||"",n.transform=r?r(this.latestValues,""):"none",n;const a=this.getLead();if(!this.projectionDelta||!this.layout||!a.target){const t={};return this.options.layoutId&&(t.opacity=void 0!==this.latestValues.opacity?this.latestValues.opacity:1,t.pointerEvents=ii(null===e||void 0===e?void 0:e.pointerEvents)||""),this.hasProjected&&!wa(this.latestValues)&&(t.transform=r?r({},""):"none",this.hasProjected=!1),t}const s=a.animationValues||a.latestValues;this.applyTransformsToTarget(),n.transform=fs(this.projectionDeltaWithTransform,this.treeScale,s),r&&(n.transform=r(s,n.transform));const{x:o,y:l}=this.projectionDelta;n.transformOrigin=`${100*o.origin}% ${100*l.origin}% 0`,a.animationValues?n.opacity=a===this?null!==(i=null!==(t=s.opacity)&&void 0!==t?t:this.latestValues.opacity)&&void 0!==i?i:1:this.preserveOpacity?this.latestValues.opacity:s.opacityExit:n.opacity=a===this?void 0!==s.opacity?s.opacity:"":void 0!==s.opacityExit?s.opacityExit:0;for(const c in it){if(void 0===s[c])continue;const{correct:e,applyTo:t}=it[c],i="none"===n.transform?s[c]:e(s[c],a);if(t){const e=t.length;for(let r=0;r<e;r++)n[t[r]]=i}else n[c]=i}return this.options.layoutId&&(n.pointerEvents=a===this?ii(null===e||void 0===e?void 0:e.pointerEvents)||"":"none"),n}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach((e=>{var t;return null===(t=e.currentAnimation)||void 0===t?void 0:t.stop()})),this.root.nodes.forEach(Ps),this.root.sharedNodes.clear()}}}function ws(e){e.updateLayout()}function Ss(e){var t;const i=(null===(t=e.resumeFrom)||void 0===t?void 0:t.snapshot)||e.snapshot;if(e.isLead()&&e.layout&&i&&e.hasListeners("didUpdate")){const{layoutBox:t,measuredBox:n}=e.layout,{animationType:r}=e.options,a=i.source!==e.layout.source;"size"===r?_a((e=>{const n=a?i.measuredBox[e]:i.layoutBox[e],r=sa(n);n.min=t[e].min,n.max=n.min+r})):Us(r,i.layoutBox,t)&&_a((n=>{const r=a?i.measuredBox[n]:i.layoutBox[n],s=sa(t[n]);r.max=r.min+s,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[n].max=e.relativeTarget[n].min+s)}));const s={x:{translate:0,scale:1,origin:0,originPoint:0},y:{translate:0,scale:1,origin:0,originPoint:0}};ca(s,t,i.layoutBox);const o={x:{translate:0,scale:1,origin:0,originPoint:0},y:{translate:0,scale:1,origin:0,originPoint:0}};a?ca(o,e.applyTransform(n,!0),i.measuredBox):ca(o,t,i.layoutBox);const l=!us(s);let c=!1;if(!e.resumeFrom){const n=e.getClosestProjectingParent();if(n&&!n.resumeFrom){const{snapshot:r,layout:a}=n;if(r&&a){const s={x:{min:0,max:0},y:{min:0,max:0}};da(s,i.layoutBox,r.layoutBox);const o={x:{min:0,max:0},y:{min:0,max:0}};da(o,t,a.layoutBox),hs(s,o)||(c=!0),n.options.layoutRoot&&(e.relativeTarget=o,e.relativeTargetOrigin=s,e.relativeParent=n)}}}e.notifyListeners("didUpdate",{layout:t,snapshot:i,delta:o,layoutDelta:s,hasLayoutChanged:l,hasRelativeTargetChanged:c})}else if(e.isLead()){const{onExitComplete:t}=e.options;t&&t()}e.options.transition=void 0}function Ts(e){xs.totalNodes++,e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=Boolean(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function ks(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function Es(e){e.clearSnapshot()}function Ps(e){e.clearMeasurements()}function Cs(e){e.isLayoutDirty=!1}function Is(e){const{visualElement:t}=e.options;t&&t.getProps().onBeforeLayoutMeasure&&t.notify("BeforeLayoutMeasure"),e.resetTransform()}function As(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function Ms(e){e.resolveTargetDelta()}function zs(e){e.calcProjection()}function Ds(e){e.resetRotation()}function Ls(e){e.removeLeadSnapshot()}function Rs(e,t,i){e.translate=yn(t.translate,0,i),e.scale=yn(t.scale,1,i),e.origin=t.origin,e.originPoint=t.originPoint}function Fs(e,t,i,n){e.min=yn(t.min,i.min,n),e.max=yn(t.max,i.max,n)}function Bs(e){return e.animationValues&&void 0!==e.animationValues.opacityExit}const Os={duration:.45,ease:[.4,0,.1,1]},Ns=e=>"undefined"!==typeof navigator&&navigator.userAgent.toLowerCase().includes(e),Vs=Ns("applewebkit/")&&!Ns("chrome/")?Math.round:ai;function js(e){e.min=Vs(e.min),e.max=Vs(e.max)}function Us(e,t,i){return"position"===e||"preserve-aspect"===e&&!oa(ds(t),ds(i),.2)}const $s=bs({attachResizeListener:(e,t)=>fi(e,"resize",t),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),qs={current:void 0},Zs=bs({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!qs.current){const e=new $s({});e.mount(window),e.setOptions({layoutScroll:!0}),qs.current=e}return qs.current},resetTransform:(e,t)=>{e.style.transform=void 0!==t?t:"none"},checkIsScrollRoot:e=>Boolean("fixed"===window.getComputedStyle(e).position)}),Gs={pan:{Feature:class extends ki{constructor(){super(...arguments),this.removePointerDownListener=ai}onPointerDown(e){this.session=new Qr(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:Fa(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:t,onPan:i,onPanEnd:n}=this.node.getProps();return{onSessionStart:Va(e),onStart:Va(t),onMove:i,onEnd:(e,t)=>{delete this.session,n&&li.update((()=>n(e,t)))}}}mount(){this.removePointerDownListener=yi(this.node.current,"pointerdown",(e=>this.onPointerDown(e)))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}},drag:{Feature:class extends ki{constructor(e){super(e),this.removeGroupControls=ai,this.removeListeners=ai,this.controls=new Oa(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||ai}unmount(){this.removeGroupControls(),this.removeListeners()}},ProjectionNode:Zs,MeasureLayout:Ga}},Ws=/var\((--[a-zA-Z0-9-_]+),? ?([a-zA-Z0-9 ()%#.,-]+)?\)/;function Hs(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;Ni(i<=4,`Max CSS variable fallback depth detected in property "${e}". This may indicate a circular fallback dependency.`);const[n,r]=function(e){const t=Ws.exec(e);if(!t)return[,];const[,i,n]=t;return[i,n]}(e);if(!n)return;const a=window.getComputedStyle(t).getPropertyValue(n);if(a){const e=a.trim();return kr(e)?parseFloat(e):e}return ht(r)?Hs(r,t,i+1):r}const Xs=new Set(["width","height","top","left","right","bottom","x","y","translateX","translateY"]),Ks=e=>Xs.has(e),Ys=e=>e===ft||e===kt,Js=(e,t)=>parseFloat(e.split(", ")[t]),Qs=(e,t)=>(i,n)=>{let{transform:r}=n;if("none"===r||!r)return 0;const a=r.match(/^matrix3d\((.+)\)$/);if(a)return Js(a[1],t);{const t=r.match(/^matrix\((.+)\)$/);return t?Js(t[1],e):0}},eo=new Set(["x","y","z"]),to=nt.filter((e=>!eo.has(e)));const io={width:(e,t)=>{let{x:i}=e,{paddingLeft:n="0",paddingRight:r="0"}=t;return i.max-i.min-parseFloat(n)-parseFloat(r)},height:(e,t)=>{let{y:i}=e,{paddingTop:n="0",paddingBottom:r="0"}=t;return i.max-i.min-parseFloat(n)-parseFloat(r)},top:(e,t)=>{let{top:i}=t;return parseFloat(i)},left:(e,t)=>{let{left:i}=t;return parseFloat(i)},bottom:(e,t)=>{let{y:i}=e,{top:n}=t;return parseFloat(n)+(i.max-i.min)},right:(e,t)=>{let{x:i}=e,{left:n}=t;return parseFloat(n)+(i.max-i.min)},x:Qs(4,13),y:Qs(5,14)};io.translateX=io.x,io.translateY=io.y;const no=function(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};t={...t},n={...n};const r=Object.keys(t).filter(Ks);let a=[],s=!1;const o=[];if(r.forEach((r=>{const l=e.getValue(r);if(!e.hasValue(r))return;let c=i[r],u=Lr(c);const h=t[r];let d;if(ti(h)){const e=h.length,t=null===h[0]?1:0;c=h[t],u=Lr(c);for(let i=t;i<e&&null!==h[i];i++)d?Ni(Lr(h[i])===d,"All keyframes must be of the same type"):(d=Lr(h[i]),Ni(d===u||Ys(u)&&Ys(d),"Keyframes must be of the same dimension as the current value"))}else d=Lr(h);if(u!==d)if(Ys(u)&&Ys(d)){const e=l.get();"string"===typeof e&&l.set(parseFloat(e)),"string"===typeof h?t[r]=parseFloat(h):Array.isArray(h)&&d===kt&&(t[r]=h.map(parseFloat))}else(null===u||void 0===u?void 0:u.transform)&&(null===d||void 0===d?void 0:d.transform)&&(0===c||0===h)?0===c?l.set(d.transform(c)):t[r]=u.transform(h):(s||(a=function(e){const t=[];return to.forEach((i=>{const n=e.getValue(i);void 0!==n&&(t.push([i,n.get()]),n.set(i.startsWith("scale")?1:0))})),t.length&&e.render(),t}(e),s=!0),o.push(r),n[r]=void 0!==n[r]?n[r]:t[r],l.jump(h))})),o.length){const i=o.indexOf("height")>=0?window.pageYOffset:null,r=((e,t,i)=>{const n=t.measureViewportBox(),r=t.current,a=getComputedStyle(r),{display:s}=a,o={};"none"===s&&t.setStaticValue("display",e.display||"block"),i.forEach((e=>{o[e]=io[e](n,a)})),t.render();const l=t.measureViewportBox();return i.forEach((i=>{const n=t.getValue(i);n&&n.jump(o[i]),e[i]=io[i](l,a)})),e})(t,e,o);return a.length&&a.forEach((t=>{let[i,n]=t;e.getValue(i).set(n)})),e.render(),ze&&null!==i&&window.scrollTo({top:i}),{target:r,transitionEnd:n}}return{target:t,transitionEnd:n}};function ro(e,t,i,n){return(e=>Object.keys(e).some(Ks))(t)?no(e,t,i,n):{target:t,transitionEnd:n}}const ao=(e,t,i,n)=>{const r=function(e,t,i){let{...n}=t;const r=e.current;if(!(r instanceof Element))return{target:n,transitionEnd:i};i&&(i={...i}),e.values.forEach((e=>{const t=e.get();if(!ht(t))return;const i=Hs(t,r);i&&e.set(i)}));for(const a in n){const e=n[a];if(!ht(e))continue;const t=Hs(e,r);t&&(n[a]=t,i||(i={}),void 0===i[a]&&(i[a]=e))}return{target:n,transitionEnd:i}}(e,t,n);return ro(e,t=r.target,i,n=r.transitionEnd)},so={current:null},oo={current:!1};const lo=new WeakMap,co=Object.keys(We),uo=co.length,ho=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"],po=je.length;class fo{constructor(e){let{parent:t,props:i,presenceContext:n,reducedMotionConfig:r,visualState:a}=e,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.scheduleRender=()=>li.render(this.render,!1,!0);const{latestValues:o,renderState:l}=a;this.latestValues=o,this.baseTarget={...o},this.initialValues=i.initial?{...o}:{},this.renderState=l,this.parent=t,this.props=i,this.presenceContext=n,this.depth=t?t.depth+1:0,this.reducedMotionConfig=r,this.options=s,this.isControllingVariants=Ue(i),this.isVariantNode=$e(i),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=Boolean(t&&t.current);const{willChange:c,...u}=this.scrapeMotionValuesFromProps(i,{});for(const h in u){const e=u[h];void 0!==o[h]&&st(e)&&(e.set(o[h],!1),Tr(c)&&c.add(h))}}scrapeMotionValuesFromProps(e,t){return{}}mount(e){this.current=e,lo.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach(((e,t)=>this.bindToMotionValue(t,e))),oo.current||function(){if(oo.current=!0,ze)if(window.matchMedia){const e=window.matchMedia("(prefers-reduced-motion)"),t=()=>so.current=e.matches;e.addListener(t),t()}else so.current=!1}(),this.shouldReduceMotion="never"!==this.reducedMotionConfig&&("always"===this.reducedMotionConfig||so.current),this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){lo.delete(this.current),this.projection&&this.projection.unmount(),ci(this.notifyUpdate),ci(this.render),this.valueSubscriptions.forEach((e=>e())),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const e in this.events)this.events[e].clear();for(const e in this.features)this.features[e].unmount();this.current=null}bindToMotionValue(e,t){const i=rt.has(e),n=t.on("change",(t=>{this.latestValues[e]=t,this.props.onUpdate&&li.update(this.notifyUpdate,!1,!0),i&&this.projection&&(this.projection.isTransformDirty=!0)})),r=t.on("renderRequest",this.scheduleRender);this.valueSubscriptions.set(e,(()=>{n(),r()}))}sortNodePosition(e){return this.current&&this.sortInstanceNodePosition&&this.type===e.type?this.sortInstanceNodePosition(this.current,e.current):0}loadFeatures(e,t,i,n){let r,a,{children:s,...o}=e;for(let l=0;l<uo;l++){const e=co[l],{isEnabled:t,Feature:i,ProjectionNode:n,MeasureLayout:s}=We[e];n&&(r=n),t(o)&&(!this.features[e]&&i&&(this.features[e]=new i(this)),s&&(a=s))}if(("html"===this.type||"svg"===this.type)&&!this.projection&&r){this.projection=new r(this.latestValues,this.parent&&this.parent.projection);const{layoutId:e,layout:t,drag:i,dragConstraints:a,layoutScroll:s,layoutRoot:l}=o;this.projection.setOptions({layoutId:e,layout:t,alwaysMeasureLayout:Boolean(i)||a&&Be(a),visualElement:this,scheduleRender:()=>this.scheduleRender(),animationType:"string"===typeof t?t:"both",initialPromotionConfig:n,layoutScroll:s,layoutRoot:l})}return a}updateFeatures(){for(const e in this.features){const t=this.features[e];t.isMounted?t.update():(t.mount(),t.isMounted=!0)}}triggerBuild(){this.build(this.renderState,this.latestValues,this.options,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):{x:{min:0,max:0},y:{min:0,max:0}}}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,t){this.latestValues[e]=t}makeTargetAnimatable(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this.makeTargetAnimatableFromInstance(e,this.props,t)}update(e,t){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=t;for(let i=0;i<ho.length;i++){const t=ho[i];this.propEventSubscriptions[t]&&(this.propEventSubscriptions[t](),delete this.propEventSubscriptions[t]);const n=e["on"+t];n&&(this.propEventSubscriptions[t]=this.on(t,n))}this.prevMotionValues=function(e,t,i){const{willChange:n}=t;for(const r in t){const a=t[r],s=i[r];if(st(a))e.addValue(r,a),Tr(n)&&n.add(r);else if(st(s))e.addValue(r,Mr(a,{owner:e})),Tr(n)&&n.remove(r);else if(s!==a)if(e.hasValue(r)){const t=e.getValue(r);!t.hasAnimated&&t.set(a)}else{const t=e.getStaticValue(r);e.addValue(r,Mr(void 0!==t?t:a,{owner:e}))}}for(const r in i)void 0===t[r]&&e.removeValue(r);return t}(this,this.scrapeMotionValuesFromProps(e,this.prevProps),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}getVariantContext(){if(arguments.length>0&&void 0!==arguments[0]&&arguments[0])return this.parent?this.parent.getVariantContext():void 0;if(!this.isControllingVariants){const e=this.parent&&this.parent.getVariantContext()||{};return void 0!==this.props.initial&&(e.initial=this.props.initial),e}const e={};for(let t=0;t<po;t++){const i=je[t],n=this.props[i];(Oe(n)||!1===n)&&(e[i]=n)}return e}addVariantChild(e){const t=this.getClosestVariantNode();if(t)return t.variantChildren&&t.variantChildren.add(e),()=>t.variantChildren.delete(e)}addValue(e,t){t!==this.values.get(e)&&(this.removeValue(e),this.bindToMotionValue(e,t)),this.values.set(e,t),this.latestValues[e]=t.get()}removeValue(e){this.values.delete(e);const t=this.valueSubscriptions.get(e);t&&(t(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,t){if(this.props.values&&this.props.values[e])return this.props.values[e];let i=this.values.get(e);return void 0===i&&void 0!==t&&(i=Mr(t,{owner:this}),this.addValue(e,i)),i}readValue(e){var t;return void 0===this.latestValues[e]&&this.current?null!==(t=this.getBaseTargetFromProps(this.props,e))&&void 0!==t?t:this.readValueFromInstance(this.current,e,this.options):this.latestValues[e]}setBaseTarget(e,t){this.baseTarget[e]=t}getBaseTarget(e){var t;const{initial:i}=this.props,n="string"===typeof i||"object"===typeof i?null===(t=Qt(this.props,i))||void 0===t?void 0:t[e]:void 0;if(i&&void 0!==n)return n;const r=this.getBaseTargetFromProps(this.props,e);return void 0===r||st(r)?void 0!==this.initialValues[e]&&void 0===n?void 0:this.baseTarget[e]:r}on(e,t){return this.events[e]||(this.events[e]=new Cr),this.events[e].add(t)}notify(e){if(this.events[e]){for(var t=arguments.length,i=new Array(t>1?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];this.events[e].notify(...i)}}}class mo extends fo{sortInstanceNodePosition(e,t){return 2&e.compareDocumentPosition(t)?1:-1}getBaseTargetFromProps(e,t){return e.style?e.style[t]:void 0}removeValueFromRenderState(e,t){let{vars:i,style:n}=t;delete i[e],delete n[e]}makeTargetAnimatableFromInstance(e,t,i){let{transition:n,transitionEnd:r,...a}=e,{transformValues:s}=t,o=function(e,t,i){const n={};for(const r in e){const e=Or(r,t);if(void 0!==e)n[r]=e;else{const e=i.getValue(r);e&&(n[r]=e.get())}}return n}(a,n||{},this);if(s&&(r&&(r=s(r)),a&&(a=s(a)),o&&(o=s(o))),i){!function(e,t,i){var n,r;const a=Object.keys(t).filter((t=>!e.hasValue(t))),s=a.length;var o;if(s)for(let l=0;l<s;l++){const s=a[l],c=t[s];let u=null;Array.isArray(c)&&(u=c[0]),null===u&&(u=null!==(r=null!==(n=i[s])&&void 0!==n?n:e.readValue(s))&&void 0!==r?r:t[s]),void 0!==u&&null!==u&&("string"===typeof u&&(kr(u)||vr(u))?u=parseFloat(u):(o=u,!Rr.find(zr(o))&&Mn.test(c)&&(u=_r(s,c))),e.addValue(s,Mr(u,{owner:e})),void 0===i[s]&&(i[s]=u),null!==u&&e.setBaseTarget(s,u))}}(this,a,o);const e=ao(this,a,o,r);r=e.transitionEnd,a=e.target}return{transition:n,transitionEnd:r,...a}}}class go extends mo{constructor(){super(...arguments),this.type="html"}readValueFromInstance(e,t){if(rt.has(t)){const e=yr(t);return e&&e.default||0}{const n=(i=e,window.getComputedStyle(i)),r=(ut(t)?n.getPropertyValue(t):n[t])||0;return"string"===typeof r?r.trim():r}var i}measureInstanceViewportBox(e,t){let{transformPagePoint:i}=t;return Ra(e,i)}build(e,t,i,n){Mt(e,t,i,n.transformTemplate)}scrapeMotionValuesFromProps(e,t){return Yt(e,t)}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;st(e)&&(this.childSubscription=e.on("change",(e=>{this.current&&(this.current.textContent=`${e}`)})))}renderInstance(e,t,i,n){Ht(e,t,i,n)}}class yo extends mo{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1}getBaseTargetFromProps(e,t){return e[t]}readValueFromInstance(e,t){if(rt.has(t)){const e=yr(t);return e&&e.default||0}return t=Xt.has(t)?t:Re(t),e.getAttribute(t)}measureInstanceViewportBox(){return{x:{min:0,max:0},y:{min:0,max:0}}}scrapeMotionValuesFromProps(e,t){return Jt(e,t)}build(e,t,i,n){$t(e,t,i,this.isSVGTag,n.transformTemplate)}renderInstance(e,t,i,n){Kt(e,t,0,n)}mount(e){this.isSVGTag=Zt(e.tagName),super.mount(e)}}const _o=(e,t)=>tt(e)?new yo(t,{enableHardwareAcceleration:!1}):new go(t,{enableHardwareAcceleration:!0}),vo={...Yr,...Ri,...Gs,...{layout:{ProjectionNode:Zs,MeasureLayout:Ga}}},xo=Qe(((e,t)=>function(e,t,i,n){let{forwardMotionProps:r=!1}=t;return{...tt(e)?di:pi,preloadedFeatures:i,useRender:Wt(r),createVisualElement:n,Component:e}}(e,t,vo,_o)));var bo={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const wo=(e,i)=>{const n=(0,t.forwardRef)(((n,r)=>{let{color:a="currentColor",size:s=24,strokeWidth:o=2,absoluteStrokeWidth:l,className:c="",children:u,...h}=n;return(0,t.createElement)("svg",{ref:r,...bo,width:s,height:s,stroke:a,strokeWidth:l?24*Number(o)/Number(s):o,className:["lucide",`lucide-${d=e,d.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim()}`,c].join(" "),...h},[...i.map((e=>{let[i,n]=e;return(0,t.createElement)(i,n)})),...Array.isArray(u)?u:[u]]);var d}));return n.displayName=`${e}`,n},So=wo("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]),To=wo("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),ko=wo("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);var Eo=i(579);function Po(e){let{onSearch:i}=e;const[n,r]=(0,t.useState)(!1),[a,s]=(0,t.useState)(""),o=e=>{e.preventDefault(),null===i||void 0===i||i(a)};return(0,Eo.jsxs)("nav",{className:"bg-background/80 backdrop-blur-md sticky top-0 z-50 border-b",children:[(0,Eo.jsx)("div",{className:"container mx-auto px-4",children:(0,Eo.jsxs)("div",{className:"flex items-center justify-between h-16",children:[(0,Eo.jsx)(Ee,{to:"/",className:"text-xl font-bold text-primary",children:"Nepal Organics"}),(0,Eo.jsxs)("div",{className:"hidden md:flex items-center space-x-8",children:[(0,Eo.jsx)(Ee,{to:"/",className:"hover:text-primary transition-colors",children:"Home"}),(0,Eo.jsx)(Ee,{to:"/products",className:"hover:text-primary transition-colors",children:"Products"}),(0,Eo.jsx)(Ee,{to:"/map",className:"hover:text-primary transition-colors",children:"Map"}),(0,Eo.jsx)(Ee,{to:"/about",className:"hover:text-primary transition-colors",children:"About"})]}),(0,Eo.jsx)("form",{onSubmit:o,className:"hidden md:flex items-center",children:(0,Eo.jsxs)("div",{className:"relative",children:[(0,Eo.jsx)("input",{type:"text",placeholder:"Search products...",value:a,onChange:e=>s(e.target.value),className:"pl-10 pr-4 py-2 rounded-full bg-muted focus:outline-none focus:ring-2 focus:ring-primary"}),(0,Eo.jsx)(So,{className:"absolute left-3 top-2.5 h-5 w-5 text-muted-foreground"})]})}),(0,Eo.jsx)("button",{className:"md:hidden",onClick:()=>r(!n),children:n?(0,Eo.jsx)(To,{}):(0,Eo.jsx)(ko,{})})]})}),(0,Eo.jsx)(xo.div,{initial:!1,animate:{height:n?"auto":0},className:"md:hidden overflow-hidden",children:(0,Eo.jsxs)("div",{className:"px-4 py-2 space-y-4",children:[(0,Eo.jsx)(Ee,{to:"/",className:"block hover:text-primary transition-colors",children:"Home"}),(0,Eo.jsx)(Ee,{to:"/products",className:"block hover:text-primary transition-colors",children:"Products"}),(0,Eo.jsx)(Ee,{to:"/map",className:"block hover:text-primary transition-colors",children:"Map"}),(0,Eo.jsx)(Ee,{to:"/about",className:"block hover:text-primary transition-colors",children:"About"}),(0,Eo.jsx)("form",{onSubmit:o,className:"flex items-center",children:(0,Eo.jsxs)("div",{className:"relative flex-1",children:[(0,Eo.jsx)("input",{type:"text",placeholder:"Search products...",value:a,onChange:e=>s(e.target.value),className:"w-full pl-10 pr-4 py-2 rounded-full bg-muted focus:outline-none focus:ring-2 focus:ring-primary"}),(0,Eo.jsx)(So,{className:"absolute left-3 top-2.5 h-5 w-5 text-muted-foreground"})]})})]})})]})}const Co=wo("Facebook",[["path",{d:"M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z",key:"1jg4f8"}]]),Io=wo("Instagram",[["rect",{width:"20",height:"20",x:"2",y:"2",rx:"5",ry:"5",key:"2e1cvw"}],["path",{d:"M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z",key:"9exkf1"}],["line",{x1:"17.5",x2:"17.51",y1:"6.5",y2:"6.5",key:"r4j83e"}]]),Ao=wo("Twitter",[["path",{d:"M22 4s-.7 2.1-2 3.4c1.6 10-9.4 17.3-18 11.6 2.2.1 4.4-.6 6-2C3 15.5.5 9.6 3 5c2.2 2.6 5.6 4.1 9 4-.9-4.2 4-6.6 7-3.8 1.1 0 3-1.2 3-1.2z",key:"pff0z6"}]]);function Mo(){return(0,Eo.jsx)("footer",{className:"bg-background border-t",children:(0,Eo.jsxs)("div",{className:"container mx-auto px-4 py-12",children:[(0,Eo.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-8",children:[(0,Eo.jsxs)("div",{className:"space-y-4",children:[(0,Eo.jsx)("h3",{className:"text-lg font-semibold",children:"Nepal Organics"}),(0,Eo.jsx)("p",{className:"text-muted-foreground",children:"Connecting you with authentic organic products from the heart of Nepal."})]}),(0,Eo.jsxs)("div",{className:"space-y-4",children:[(0,Eo.jsx)("h3",{className:"text-lg font-semibold",children:"Quick Links"}),(0,Eo.jsxs)("ul",{className:"space-y-2",children:[(0,Eo.jsx)("li",{children:(0,Eo.jsx)(Ee,{to:"/products",className:"text-muted-foreground hover:text-primary transition-colors",children:"Products"})}),(0,Eo.jsx)("li",{children:(0,Eo.jsx)(Ee,{to:"/map",className:"text-muted-foreground hover:text-primary transition-colors",children:"Village Map"})}),(0,Eo.jsx)("li",{children:(0,Eo.jsx)(Ee,{to:"/about",className:"text-muted-foreground hover:text-primary transition-colors",children:"About Us"})})]})]}),(0,Eo.jsxs)("div",{className:"space-y-4",children:[(0,Eo.jsx)("h3",{className:"text-lg font-semibold",children:"Categories"}),(0,Eo.jsxs)("ul",{className:"space-y-2",children:[(0,Eo.jsx)("li",{children:(0,Eo.jsx)(Ee,{to:"/products?category=Tea",className:"text-muted-foreground hover:text-primary transition-colors",children:"Tea"})}),(0,Eo.jsx)("li",{children:(0,Eo.jsx)(Ee,{to:"/products?category=Honey",className:"text-muted-foreground hover:text-primary transition-colors",children:"Honey"})}),(0,Eo.jsx)("li",{children:(0,Eo.jsx)(Ee,{to:"/products?category=Spices",className:"text-muted-foreground hover:text-primary transition-colors",children:"Spices"})})]})]}),(0,Eo.jsxs)("div",{className:"space-y-4",children:[(0,Eo.jsx)("h3",{className:"text-lg font-semibold",children:"Connect With Us"}),(0,Eo.jsxs)("div",{className:"flex space-x-4",children:[(0,Eo.jsx)("a",{href:"#",className:"text-muted-foreground hover:text-primary transition-colors",children:(0,Eo.jsx)(Co,{className:"h-6 w-6"})}),(0,Eo.jsx)("a",{href:"#",className:"text-muted-foreground hover:text-primary transition-colors",children:(0,Eo.jsx)(Io,{className:"h-6 w-6"})}),(0,Eo.jsx)("a",{href:"#",className:"text-muted-foreground hover:text-primary transition-colors",children:(0,Eo.jsx)(Ao,{className:"h-6 w-6"})})]}),(0,Eo.jsx)("p",{className:"text-muted-foreground",children:"Email: contact@nepalorganics.com"})]})]}),(0,Eo.jsx)("div",{className:"mt-8 pt-8 border-t text-center text-muted-foreground",children:(0,Eo.jsxs)("p",{children:["\xa9 ",(new Date).getFullYear()," Nepal Organics. All rights reserved."]})})]})})}const zo=wo("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);function Do(){return(0,Eo.jsxs)("div",{className:"relative h-[80vh] flex items-center justify-center overflow-hidden",children:[(0,Eo.jsx)("div",{className:"absolute inset-0 z-0",style:{backgroundImage:'url("https://images.unsplash.com/photo-1544735716-392fe2489ffa?w=1920&q=80")',backgroundPosition:"center",backgroundSize:"cover"},children:(0,Eo.jsx)("div",{className:"absolute inset-0 bg-black/50"})}),(0,Eo.jsx)("div",{className:"container mx-auto px-4 z-10 text-white",children:(0,Eo.jsxs)(xo.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.8},className:"max-w-3xl mx-auto text-center",children:[(0,Eo.jsx)("h1",{className:"text-4xl md:text-6xl font-bold mb-6",children:"Discover Authentic Organic Products from Nepal"}),(0,Eo.jsx)("p",{className:"text-lg md:text-xl mb-8 text-gray-200",children:"Ethically sourced products from rural villages, bringing centuries-old traditions to your doorstep."}),(0,Eo.jsxs)(Ee,{to:"/products",className:"inline-flex items-center gap-2 bg-primary text-primary-foreground px-8 py-3 rounded-full text-lg font-semibold hover:bg-primary/90 transition-colors",children:["Explore Products",(0,Eo.jsx)(zo,{className:"w-5 h-5"})]})]})})]})}const Lo=[{id:"1",name:"Himalayan Wild Honey",price:15.99,description:"Pure wild honey harvested from the foothills of the Himalayas by indigenous communities using traditional methods. This golden nectar carries the essence of rare Himalayan flowers.",image:"https://images.unsplash.com/photo-1587049352846-4a222e784d38?w=800&q=80",category:"Honey",village:{name:"Ghandruk",latitude:28.3949,longitude:83.8074,story:"Ghandruk is a picturesque village known for its traditional honey harvesting practices passed down through generations."}},{id:"2",name:"Premium Ilam Tea",price:12.99,description:"Hand-picked organic tea leaves from high-altitude plantations. Known for its distinct aroma and smooth flavor profile.",image:"https://images.unsplash.com/photo-1597481499750-3e6b22637e12?w=800&q=80",category:"Tea",village:{name:"Ilam",latitude:26.9112,longitude:87.9237,story:"Ilam is Nepal's tea capital, where the perfect climate and altitude create exceptional tea."}},{id:"3",name:"Himalayan Rock Salt",price:8.99,description:"Pure, mineral-rich pink salt from ancient Himalayan deposits. Perfect for cooking and natural remedies.",image:"https://images.unsplash.com/photo-1517705600644-cbc52b0caa66?w=800&q=80",category:"Spices",village:{name:"Namche Bazaar",latitude:27.8069,longitude:86.714,story:"Namche Bazaar, the gateway to Everest, has been a trading hub for Himalayan goods for centuries."}},{id:"4",name:"Hand-woven Pashmina Shawl",price:89.99,description:"Luxuriously soft pashmina shawl hand-woven by skilled artisans using traditional techniques.",image:"https://images.unsplash.com/photo-1601244005535-a48d21d951ac?w=800&q=80",category:"Textiles",village:{name:"Patan",latitude:27.6766,longitude:85.3241,story:"Patan is renowned for its skilled artisans who have preserved traditional crafts for generations."}},{id:"5",name:"Handcrafted Prayer Bells",price:34.99,description:"Traditional bronze prayer bells crafted by local artisans, featuring intricate designs and pure sound.",image:"https://images.unsplash.com/photo-1600161777932-f8335b68f3bb?w=800&q=80",category:"Handicrafts",village:{name:"Bhaktapur",latitude:27.671,longitude:85.4298,story:"Bhaktapur is a living museum of traditional Newari crafts and architecture."}},{id:"6",name:"Rice",price:89.99,description:"Luxuriously soft pashmina shawl hand-woven by skilled artisans using traditional techniques.",image:i.p+"static/media/rice.1e22664afc2e06543e1c.jpeg",category:"Spices",village:{name:"Patan",latitude:27.6766,longitude:85.3241,story:"Patan is renowned for its skilled artisans who have preserved traditional crafts for generations."}}],Ro=["Tea","Honey","Spices","Handicrafts","Textiles"];function Fo(e){let{product:t}=e;return(0,Eo.jsx)(xo.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"bg-card rounded-lg overflow-hidden shadow-lg hover:shadow-xl transition-shadow",children:(0,Eo.jsxs)(Ee,{to:`/product/${t.id}`,children:[(0,Eo.jsx)("div",{className:"relative h-48",children:(0,Eo.jsx)("img",{src:t.image||"/placeholder.svg",alt:t.name,className:"w-full h-full object-cover"})}),(0,Eo.jsxs)("div",{className:"p-4",children:[(0,Eo.jsx)("h3",{className:"text-lg font-semibold",children:t.name}),(0,Eo.jsx)("p",{className:"text-sm text-muted-foreground mb-2",children:t.village.name}),(0,Eo.jsxs)("p",{className:"text-primary font-bold",children:["Rs ",t.price.toFixed(2)]})]})]})})}function Bo(){const e=Lo.slice(0,3);return(0,Eo.jsxs)("main",{children:[(0,Eo.jsx)(Do,{}),(0,Eo.jsx)("section",{className:"py-16 bg-muted/30",children:(0,Eo.jsxs)("div",{className:"container mx-auto px-4",children:[(0,Eo.jsxs)("div",{className:"text-center mb-12",children:[(0,Eo.jsx)("h2",{className:"text-3xl font-bold mb-4",children:"Featured Products"}),(0,Eo.jsx)("p",{className:"text-muted-foreground max-w-2xl mx-auto",children:"Discover our handpicked selection of authentic Nepalese organic products, crafted with care and tradition."})]}),(0,Eo.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8 mb-8",children:e.map((e=>(0,Eo.jsx)(Fo,{product:e},e.id)))}),(0,Eo.jsx)("div",{className:"text-center",children:(0,Eo.jsxs)(Ee,{to:"/products",className:"inline-flex items-center gap-2 text-primary hover:text-primary/90 transition-colors",children:["View All Products",(0,Eo.jsx)(zo,{className:"w-5 h-5"})]})})]})}),(0,Eo.jsx)("section",{className:"py-16",children:(0,Eo.jsx)("div",{className:"container mx-auto px-4",children:(0,Eo.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-12 items-center",children:[(0,Eo.jsxs)("div",{children:[(0,Eo.jsx)("h2",{className:"text-3xl font-bold mb-6",children:"Our Story"}),(0,Eo.jsx)("p",{className:"text-muted-foreground mb-6",children:"We work directly with rural Nepalese communities to bring you the finest organic products while supporting sustainable farming practices and preserving traditional methods."}),(0,Eo.jsxs)(Ee,{to:"/about",className:"inline-flex items-center gap-2 text-primary hover:text-primary/90 transition-colors",children:["Learn More",(0,Eo.jsx)(zo,{className:"w-5 h-5"})]})]}),(0,Eo.jsx)("div",{className:"relative h-[400px] rounded-lg overflow-hidden",children:(0,Eo.jsx)("img",{src:"https://images.unsplash.com/photo-1544735716-392fe2489ffa?w=800&q=80",alt:"Nepalese farmers",className:"object-cover w-full h-full"})})]})})})]})}function Oo(){const e=(0,t.useRef)(!1);return De((()=>(e.current=!0,()=>{e.current=!1})),[]),e}class No extends t.Component{getSnapshotBeforeUpdate(e){const t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){const e=this.props.sizeRef.current;e.height=t.offsetHeight||0,e.width=t.offsetWidth||0,e.top=t.offsetTop,e.left=t.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function Vo(e){let{children:i,isPresent:n}=e;const r=(0,t.useId)(),a=(0,t.useRef)(null),s=(0,t.useRef)({width:0,height:0,top:0,left:0});return(0,t.useInsertionEffect)((()=>{const{width:e,height:t,top:i,left:o}=s.current;if(n||!a.current||!e||!t)return;a.current.dataset.motionPopId=r;const l=document.createElement("style");return document.head.appendChild(l),l.sheet&&l.sheet.insertRule(`\n          [data-motion-pop-id="${r}"] {\n            position: absolute !important;\n            width: ${e}px !important;\n            height: ${t}px !important;\n            top: ${i}px !important;\n            left: ${o}px !important;\n          }\n        `),()=>{document.head.removeChild(l)}}),[n]),t.createElement(No,{isPresent:n,childRef:a,sizeRef:s},t.cloneElement(i,{ref:a}))}const jo=e=>{let{children:i,initial:n,isPresent:r,onExitComplete:a,custom:s,presenceAffectsLayout:o,mode:l}=e;const c=ei(Uo),u=(0,t.useId)(),h=(0,t.useMemo)((()=>({id:u,initial:n,isPresent:r,custom:s,onExitComplete:e=>{c.set(e,!0);for(const t of c.values())if(!t)return;a&&a()},register:e=>(c.set(e,!1),()=>c.delete(e))})),o?void 0:[r]);return(0,t.useMemo)((()=>{c.forEach(((e,t)=>c.set(t,!1)))}),[r]),t.useEffect((()=>{!r&&!c.size&&a&&a()}),[r]),"popLayout"===l&&(i=t.createElement(Vo,{isPresent:r},i)),t.createElement(Me.Provider,{value:h},i)};function Uo(){return new Map}const $o=e=>e.key||"";const qo=e=>{let{children:i,custom:n,initial:r=!0,onExitComplete:a,exitBeforeEnter:s,presenceAffectsLayout:o=!0,mode:l="sync"}=e;Ni(!s,"Replace exitBeforeEnter with mode='wait'");const c=(0,t.useContext)(He).forceRender||function(){const e=Oo(),[i,n]=(0,t.useState)(0),r=(0,t.useCallback)((()=>{e.current&&n(i+1)}),[i]);return[(0,t.useCallback)((()=>li.postRender(r)),[r]),i]}()[0],u=Oo(),h=function(e){const i=[];return t.Children.forEach(e,(e=>{(0,t.isValidElement)(e)&&i.push(e)})),i}(i);let d=h;const p=(0,t.useRef)(new Map).current,f=(0,t.useRef)(d),m=(0,t.useRef)(new Map).current,g=(0,t.useRef)(!0);var y;if(De((()=>{g.current=!1,function(e,t){e.forEach((e=>{const i=$o(e);t.set(i,e)}))}(h,m),f.current=d})),y=()=>{g.current=!0,m.clear(),p.clear()},(0,t.useEffect)((()=>()=>y()),[]),g.current)return t.createElement(t.Fragment,null,d.map((e=>t.createElement(jo,{key:$o(e),isPresent:!0,initial:!!r&&void 0,presenceAffectsLayout:o,mode:l},e))));d=[...d];const _=f.current.map($o),v=h.map($o),x=_.length;for(let t=0;t<x;t++){const e=_[t];-1!==v.indexOf(e)||p.has(e)||p.set(e,void 0)}return"wait"===l&&p.size&&(d=[]),p.forEach(((e,i)=>{if(-1!==v.indexOf(i))return;const r=m.get(i);if(!r)return;const s=_.indexOf(i);let g=e;if(!g){const e=()=>{p.delete(i);const e=Array.from(m.keys()).filter((e=>!v.includes(e)));if(e.forEach((e=>m.delete(e))),f.current=h.filter((t=>{const n=$o(t);return n===i||e.includes(n)})),!p.size){if(!1===u.current)return;c(),a&&a()}};g=t.createElement(jo,{key:$o(r),isPresent:!1,onExitComplete:e,custom:n,presenceAffectsLayout:o,mode:l},r),p.set(i,g)}d.splice(s,0,g)})),d=d.map((e=>{const i=e.key;return p.has(i)?e:t.createElement(jo,{key:$o(e),isPresent:!0,presenceAffectsLayout:o,mode:l},e)})),t.createElement(t.Fragment,null,p.size?d:d.map((e=>(0,t.cloneElement)(e))))};function Zo(e){let{selectedCategory:t,onCategoryChange:i,onPriceRangeChange:n}=e;return(0,Eo.jsxs)("div",{className:"space-y-6",children:[(0,Eo.jsxs)("div",{children:[(0,Eo.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Categories"}),(0,Eo.jsxs)("div",{className:"space-y-2",children:[(0,Eo.jsx)("button",{onClick:()=>i(null),className:"w-full text-left px-4 py-2 rounded-lg transition-colors "+(null===t?"bg-primary text-primary-foreground":"hover:bg-muted"),children:"All Products"}),Ro.map((e=>(0,Eo.jsx)("button",{onClick:()=>i(e),className:"w-full text-left px-4 py-2 rounded-lg transition-colors "+(t===e?"bg-primary text-primary-foreground":"hover:bg-muted"),children:e},e)))]})]}),(0,Eo.jsxs)("div",{children:[(0,Eo.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Price Range"}),(0,Eo.jsxs)("div",{className:"px-4",children:[(0,Eo.jsx)("input",{type:"range",min:"0",max:"100",className:"w-full",onChange:e=>n([0,Number.parseInt(e.target.value)])}),(0,Eo.jsxs)("div",{className:"flex justify-between text-sm text-muted-foreground",children:[(0,Eo.jsx)("span",{children:"Rs 0"}),(0,Eo.jsx)("span",{children:"Rs 100"})]})]})]})]})}function Go(){const[e,i]=(0,t.useState)(""),[n,r]=(0,t.useState)(null),[a,s]=(0,t.useState)([0,100]),o=Lo.filter((t=>{const i=t.name.toLowerCase().includes(e.toLowerCase())||t.description.toLowerCase().includes(e.toLowerCase()),r=!n||t.category===n,s=t.price>=a[0]&&t.price<=a[1];return i&&r&&s}));return(0,Eo.jsx)("div",{className:"min-h-screen bg-background",children:(0,Eo.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,Eo.jsx)("div",{className:"mb-8",children:(0,Eo.jsxs)("div",{className:"relative max-w-xl mx-auto",children:[(0,Eo.jsx)("input",{type:"text",placeholder:"Search products...",value:e,onChange:e=>i(e.target.value),className:"w-full pl-12 pr-4 py-3 rounded-full bg-muted focus:outline-none focus:ring-2 focus:ring-primary"}),(0,Eo.jsx)(So,{className:"absolute left-4 top-3.5 h-5 w-5 text-muted-foreground"})]})}),(0,Eo.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-8",children:[(0,Eo.jsx)("div",{className:"lg:col-span-1",children:(0,Eo.jsx)(Zo,{selectedCategory:n,onCategoryChange:r,onPriceRangeChange:s})}),(0,Eo.jsx)("div",{className:"lg:col-span-3",children:(0,Eo.jsx)(qo,{mode:"popLayout",children:0===o.length?(0,Eo.jsx)(xo.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"text-center py-12",children:(0,Eo.jsx)("p",{className:"text-muted-foreground",children:"No products found."})}):(0,Eo.jsx)(xo.div,{layout:!0,className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:o.map((e=>(0,Eo.jsx)(xo.div,{layout:!0,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:(0,Eo.jsx)(Fo,{product:e})},e.id)))})})})]})]})})}const Wo=wo("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);var Ho=i(66),Xo=i.n(Ho);function Ko(e){let{villages:i,onVillageClick:n,center:r=[84.124,28.3949],zoom:a=7,selectedVillage:s=null}=e;const o=(0,t.useRef)(null),l=(0,t.useRef)(null);return(0,t.useEffect)((()=>{if(o.current)return l.current=new(Xo().Map)({container:o.current,style:"https://api.maptiler.com/maps/basic-v2/style.json?key=zSKe702Zq1told0U6bDZ",center:r,zoom:a}),l.current.addControl(new(Xo().NavigationControl)),()=>{var e;null===(e=l.current)||void 0===e||e.remove()}}),[r,a]),(0,t.useEffect)((()=>{if(!l.current)return;const e=document.getElementsByClassName("maplibre-marker");for(;e[0];)e[0].remove();i.forEach((e=>{const t=document.createElement("div");t.className="maplibre-marker",t.innerHTML=`\n        <div class="w-6 h-6 bg-primary rounded-full border-2 border-white shadow-lg cursor-pointer\n          ${(null===s||void 0===s?void 0:s.name)===e.name?"scale-150":"hover:scale-125"} \n          transition-transform duration-200"\n        ></div>\n      `,t.addEventListener("click",(()=>{null===n||void 0===n||n(e)})),new(Xo().Marker)({element:t}).setLngLat([e.longitude,e.latitude]).addTo(l.current)}))}),[i,s,n]),(0,Eo.jsx)("div",{ref:o,className:"w-full h-full rounded-lg overflow-hidden"})}function Yo(){const{id:e}=function(){let{matches:e}=t.useContext(X),i=e[e.length-1];return i?i.params:{}}(),i=Lo.find((t=>t.id===e));return i?(0,Eo.jsxs)("div",{className:"min-h-screen bg-background",children:[(0,Eo.jsx)(Ee,{to:"/products",className:"fixed top-4 left-4 z-10 bg-background/80 backdrop-blur p-2 rounded-full shadow-lg hover:shadow-xl transition-shadow",children:(0,Eo.jsx)(Wo,{className:"w-6 h-6"})}),(0,Eo.jsxs)("div",{className:"grid lg:grid-cols-2 gap-8 p-8",children:[(0,Eo.jsxs)(xo.div,{initial:{opacity:0,x:-50},animate:{opacity:1,x:0},className:"space-y-6",children:[(0,Eo.jsx)("div",{className:"relative h-96 rounded-lg overflow-hidden",children:(0,Eo.jsx)("img",{src:i.image||"/placeholder.svg",alt:i.name,className:"w-full h-full object-cover"})}),(0,Eo.jsxs)("div",{children:[(0,Eo.jsx)("h1",{className:"text-3xl font-bold",children:i.name}),(0,Eo.jsxs)("p",{className:"text-xl text-primary font-semibold mt-2",children:["Rs",i.price.toFixed(2)]})]}),(0,Eo.jsxs)("div",{children:[(0,Eo.jsx)("h2",{className:"text-xl font-semibold mb-2",children:"About this product"}),(0,Eo.jsx)("p",{className:"text-muted-foreground",children:i.description})]}),(0,Eo.jsxs)("div",{children:[(0,Eo.jsxs)("h2",{className:"text-xl font-semibold mb-2",children:["From ",i.village.name]}),(0,Eo.jsx)("p",{className:"text-muted-foreground",children:i.village.story})]})]}),(0,Eo.jsx)(xo.div,{initial:{opacity:0,x:50},animate:{opacity:1,x:0},className:"h-[calc(100vh-4rem)] sticky top-8",children:(0,Eo.jsx)(Ko,{villages:[i.village],center:[i.village.longitude,i.village.latitude],zoom:10,selectedVillage:i.village})})]})]}):(0,Eo.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,Eo.jsxs)("div",{className:"text-center",children:[(0,Eo.jsx)("h2",{className:"text-2xl font-bold mb-4",children:"Product not found"}),(0,Eo.jsx)(Ee,{to:"/products",className:"text-primary hover:text-primary/90 transition-colors",children:"Back to Products"})]})})}function Jo(){const[e,i]=(0,t.useState)(null),n=Array.from(new Set(Lo.map((e=>e.village)))),r=Lo.filter((t=>t.village.name===(null===e||void 0===e?void 0:e.name)));return(0,Eo.jsxs)("div",{className:"relative h-[calc(100vh-4rem)]",children:[(0,Eo.jsx)(Ko,{villages:n,onVillageClick:i,selectedVillage:e}),(0,Eo.jsx)(qo,{children:e&&(0,Eo.jsxs)(xo.div,{initial:{x:"100%"},animate:{x:0},exit:{x:"100%"},transition:{type:"spring",damping:20},className:"fixed right-0 top-0 h-full w-96 bg-background/95 backdrop-blur shadow-lg p-6 overflow-y-auto",children:[(0,Eo.jsx)("h2",{className:"text-2xl font-bold mb-4",children:e.name}),(0,Eo.jsx)("p",{className:"text-muted-foreground mb-6",children:e.story}),(0,Eo.jsx)("div",{className:"space-y-4",children:r.map((e=>(0,Eo.jsx)(Fo,{product:e},e.id)))})]})})]})}function Qo(){return(0,Eo.jsx)("div",{className:"min-h-screen bg-background",children:(0,Eo.jsx)("div",{className:"container mx-auto px-4 py-12",children:(0,Eo.jsxs)(xo.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"max-w-3xl mx-auto",children:[(0,Eo.jsx)("h1",{className:"text-4xl font-bold mb-8",children:"About Nepal Organics"}),(0,Eo.jsxs)("div",{className:"prose prose-lg",children:[(0,Eo.jsx)("p",{className:"text-muted-foreground mb-6",children:"Nepal Organics is dedicated to bringing the finest organic products from rural Nepal to conscious consumers worldwide. Our mission is to support local communities while preserving traditional farming and crafting methods."}),(0,Eo.jsx)("div",{className:"my-12",children:(0,Eo.jsx)("img",{src:"https://images.unsplash.com/photo-1544735716-392fe2489ffa?w=1200&q=80",alt:"Nepalese farmers",className:"w-full h-[400px] object-cover rounded-lg"})}),(0,Eo.jsx)("h2",{className:"text-2xl font-bold mb-4",children:"Our Mission"}),(0,Eo.jsx)("p",{className:"text-muted-foreground mb-6",children:"We believe in sustainable agriculture, fair trade practices, and preserving traditional knowledge. By connecting rural producers directly with global consumers, we ensure fair compensation for their hard work and expertise."}),(0,Eo.jsx)("h2",{className:"text-2xl font-bold mb-4",children:"The Communities"}),(0,Eo.jsx)("p",{className:"text-muted-foreground mb-6",children:"Each product in our collection tells a story of the village it comes from. From the tea gardens of Ilam to the honey hunters of Ghandruk, we work with communities that have been perfecting their craft for generations."}),(0,Eo.jsx)("h2",{className:"text-2xl font-bold mb-4",children:"Quality & Sustainability"}),(0,Eo.jsx)("p",{className:"text-muted-foreground",children:"All our products are organic, ethically sourced, and produced using sustainable methods. We work closely with local communities to ensure the highest quality while maintaining environmental responsibility."})]})]})})})}function el(){return(0,Eo.jsx)(Se,{children:(0,Eo.jsxs)("div",{className:"flex flex-col min-h-screen",children:[(0,Eo.jsx)(Po,{}),(0,Eo.jsx)("main",{className:"flex-grow",children:(0,Eo.jsxs)(ye,{children:[(0,Eo.jsx)(me,{path:"/",element:(0,Eo.jsx)(Bo,{})}),(0,Eo.jsx)(me,{path:"/products",element:(0,Eo.jsx)(Go,{})}),(0,Eo.jsx)(me,{path:"/product/:id",element:(0,Eo.jsx)(Yo,{})}),(0,Eo.jsx)(me,{path:"/map",element:(0,Eo.jsx)(Jo,{})}),(0,Eo.jsx)(me,{path:"/about",element:(0,Eo.jsx)(Qo,{})})]})}),(0,Eo.jsx)(Mo,{})]})})}r.createRoot(document.getElementById("root")).render((0,Eo.jsx)(t.StrictMode,{children:(0,Eo.jsx)(el,{})}))})()})();
//# sourceMappingURL=main.dc4b6270.js.map